<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>ubuntu16 --svn</title>
      <link href="/2019/01/26/ubuntu/linux_ubuntu_svn/"/>
      <url>/2019/01/26/ubuntu/linux_ubuntu_svn/</url>
      <content type="html"><![CDATA[<p>ubuntu16 系统通过 apt-get 安装svn</p><h3 id="检查是否安装-svn-并安装"><a href="#检查是否安装-svn-并安装" class="headerlink" title="检查是否安装 svn,并安装"></a>检查是否安装 svn,并安装</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">svn </span><br><span class="line">svn <span class="keyword">help</span>            //<span class="comment">--svn帮助</span></span><br><span class="line">svn <span class="comment">--version       //--svn版本</span></span><br><span class="line">svnserve <span class="comment">--version  //--svn server版本</span></span><br><span class="line"></span><br><span class="line">卸载命令(–<span class="keyword">purge</span> 选项表示彻底删除改软件和相关文件)</span><br><span class="line">sudo apt-<span class="keyword">get</span> remove <span class="comment">--purge subversion</span></span><br><span class="line"></span><br><span class="line">开始安装</span><br><span class="line">apt <span class="keyword">install</span> subversion</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/svn_info.png" alt="svn 信息" title="svn 信息"></p><h3 id="创建-svn-版本库"><a href="#创建-svn-版本库" class="headerlink" title="创建 svn 版本库"></a>创建 svn 版本库</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir  <span class="meta-keyword">/data/</span>server/svn</span><br><span class="line">mkdir  <span class="meta-keyword">/data/</span>server<span class="meta-keyword">/svn/</span>repository</span><br><span class="line">chmod -R <span class="number">777</span> <span class="meta-keyword">/data/</span>server<span class="meta-keyword">/svn/</span>repository</span><br><span class="line">svnadmin create <span class="meta-keyword">/data/</span>server<span class="meta-keyword">/svn/</span>repository   <span class="meta">#创建一个新的版本仓库</span></span><br><span class="line">chmod -R <span class="number">777</span> <span class="meta-keyword">/data/</span>server<span class="meta-keyword">/svn/</span>repository/db</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/create_svn.png" alt="创建版本仓库" title="创建版本仓库"></p><h3 id="设置访问权限"><a href="#设置访问权限" class="headerlink" title="设置访问权限"></a>设置访问权限</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim conf/svnserve.conf   #设置读写,启用密码文件路径  </span><br><span class="line"></span><br><span class="line">这三个的注释去掉!!!!  注意这三行前面不要有空格,否则后面会一直找不到仓库,报错</span><br><span class="line">anon-access = read</span><br><span class="line">auth-access = write</span><br><span class="line">password-db = passwd</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/svnserve.png" alt="访问权限" title="访问权限"></p><h3 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim conf/passwd </span><br><span class="line">账户密码内容为: <span class="attribute">fei_svn</span>=123456</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/passwd.png" alt="添加用户" title="添加用户"></p><h3 id="添加访问用户"><a href="#添加访问用户" class="headerlink" title="添加访问用户"></a>添加访问用户</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim conf/authz</span><br><span class="line"></span><br><span class="line"><span class="section">内容如下:</span></span><br><span class="line">admin_groups=fei_svn   <span class="comment">#用户fei_svn属于admin_groups权限组</span></span><br><span class="line">@admin_groups=rw       <span class="comment">#admin_groups权限组有读和写</span></span><br><span class="line">*=r                    <span class="comment">#其他用户具只能读</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/authz.png" alt="添加访问用户" title="添加访问用户"></p><h3 id="启动svn"><a href="#启动svn" class="headerlink" title="启动svn"></a>启动svn</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">svnserve -d -r <span class="regexp">/data/</span>server<span class="regexp">/svn/</span>       <span class="comment">#-d 后台启动;  -r 指定根目录启动 !!!注意这里的路径</span></span><br><span class="line">ps -aux | grep svnserve      <span class="comment">#查看svnserve是否启动</span></span><br><span class="line">killall svnserve       <span class="comment">#停止服务</span></span><br></pre></td></tr></table></figure><h3 id="访问svn版本库"><a href="#访问svn版本库" class="headerlink" title="访问svn版本库"></a>访问svn版本库</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#vim</span> conf/svnserve<span class="selector-class">.conf</span>   这个配置文件修改的时候有空格这时候这里会一直练不上</span><br><span class="line">#报错信息: unable to connect to <span class="selector-tag">a</span> repository url line <span class="number">19</span>:Option expected</span><br><span class="line"></span><br><span class="line">svn:<span class="comment">//192.168.1.104/repository   #访问版本控制</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/svn/success.png" alt="访问svn版本控制" title="访问svn版本控制"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Yii2  -model层不为人知的秘密</title>
      <link href="/2019/01/26/Yii2/Yii2_model/"/>
      <url>/2019/01/26/Yii2/Yii2_model/</url>
      <content type="html"><![CDATA[<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>在 PHP 中，类的成员变量也被称为<em>属性</em>。它们是类定义的一部分， 用来表现一个实例的状态（也就是区分类的不同实例）。 在具体实践中，常常会想用一个稍微特殊些的方法实现属性的读写</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo, 场景举例:有一个 int 型时间戳,需要显示为格式化的时间,每次格式化太麻烦</span></span><br><span class="line"><span class="comment">//在 model 层中</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span> <span class="keyword">extends</span> \<span class="title">yii</span>\<span class="title">db</span>\<span class="title">ActiveRecord</span></span></span><br><span class="line">    public function getTimeText()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> date(<span class="string">'Y/m/d'</span>, <span class="keyword">$this</span>-&gt;time);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setTimeText</span><span class="params">($value)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;time = strtotime($value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在 controller 层中</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionView</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $model = Book::findOne($id);  </span><br><span class="line">        print_r($model-&gt;TimeText); <span class="comment">//格式化的时间</span></span><br><span class="line">         print_r($model-&gt;time);  <span class="comment">//原来的 int 时间</span></span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>linux -useradd</title>
      <link href="/2019/01/20/ubuntu/linux_ubuntu_useradd/"/>
      <url>/2019/01/20/ubuntu/linux_ubuntu_useradd/</url>
      <content type="html"><![CDATA[<p>查看所有用户和用户组,添加删除用户</p><p>…………………………….</p><h3 id="查看所有用户"><a href="#查看所有用户" class="headerlink" title="查看所有用户"></a>查看所有用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/etc<span class="built_in">/group </span>  文件包含所有组</span><br><span class="line">/etc/shadow 和 /etc/passwd    系统存在的所有用户名</span><br><span class="line"></span><br><span class="line">tail -3 /etc/group</span><br><span class="line">tail -3 /etc/shadow</span><br><span class="line">tail -3 /etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_useradd/user.png" alt="查看所有用户" title="查看所有用户"></p><h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">useradd fei_02    #创建用户</span><br><span class="line">passwd fei_02     #设定密码</span><br><span class="line">tail -4 /etc<span class="built_in">/group </span> #查看用户</span><br><span class="line">这样创建的用户登录后不能使用 ll,touch 等其他命令</span><br><span class="line"></span><br><span class="line">useradd -m fei_03  #创建一个有家目录,远程登录后不能执行命令</span><br><span class="line">useradd -m -s /bin/bash fei_04  #可以远程登录,也可以执行shell命令</span><br><span class="line">useradd -s /sbin/nologin fei_05  #创建一个没有家目录,且不能登录的用户</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_useradd/m.png" alt="m 选项" title="m 选项"></p><p><img src="/img/ubuntu/linux_command/linux_useradd/s.png" alt="s 选项" title="s 选项"></p><p><img src="/img/ubuntu/linux_command/linux_useradd/no_login.png" alt="不能登录" title="不能登录"></p><h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">userdel fei_03   <span class="comment">#如果用户还在登录状态,会出现无法删除,此时要先强制用户退</span></span><br><span class="line">w    <span class="comment">#查看当前登录用户</span></span><br><span class="line">pkill -<span class="built_in">kill</span> -t pts/20  <span class="comment"># 强制退出用户</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_useradd/userdel.png" alt="删除用户" title="删除用户"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>mysql -sql other02</title>
      <link href="/2019/01/12/mysql/sql_other02/"/>
      <url>/2019/01/12/mysql/sql_other02/</url>
      <content type="html"><![CDATA[<h3 id="MySQL-的复制原理及负载均衡"><a href="#MySQL-的复制原理及负载均衡" class="headerlink" title="MySQL 的复制原理及负载均衡"></a>MySQL 的复制原理及负载均衡</h3><h4 id="MySQL主从复制工作原理"><a href="#MySQL主从复制工作原理" class="headerlink" title="MySQL主从复制工作原理:"></a>MySQL主从复制工作原理:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在主库上把数据更改记录到二进制日志</span><br><span class="line">从库将主库的日志复制到自己的中继日志</span><br><span class="line">从库读取中继日志中的事件,将其重放到从库数据库中</span><br></pre></td></tr></table></figure><h4 id="MySQL主从复制解决的问题"><a href="#MySQL主从复制解决的问题" class="headerlink" title="MySQL主从复制解决的问题:"></a>MySQL主从复制解决的问题:</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">数据分布: 随意停止或开始复制,并在不同地理位置分布数据库备份</span></span><br><span class="line"><span class="section">负载均衡:降低单个服务器的压力</span></span><br><span class="line"><span class="section">高可用和故障切换: 帮助应用程序避免单点失败</span></span><br><span class="line"><span class="section">升级测试:可使用更高版本的MySQL作为从库</span></span><br></pre></td></tr></table></figure><h3 id="SQL查询处理的安全方案"><a href="#SQL查询处理的安全方案" class="headerlink" title="SQL查询处理的安全方案"></a>SQL查询处理的安全方案</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) 使用预处理语句放置SQL注入</span><br><span class="line"><span class="number">2</span>)写入数据库的数据要进行特殊字符的转义</span><br><span class="line"><span class="number">3</span>)查询错误信息不要反悔给用户,将错误记录到日志</span><br><span class="line"></span><br><span class="line">PHP端尽量使用PDO对数据库进行相关操作,PDO拥有对预处理语句很好的支持,MySQLi也有,但是可扩展性不如PDO,效率高于PDO</span><br></pre></td></tr></table></figure><h3 id="MySQL的其他安全设置"><a href="#MySQL的其他安全设置" class="headerlink" title="MySQL的其他安全设置"></a>MySQL的其他安全设置</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)定期做备份</span><br><span class="line"><span class="number">2</span>)不给用户root权限,合理分配权限</span><br><span class="line"><span class="number">3</span>)关闭远程访问数据库权限</span><br><span class="line"><span class="number">4</span>)修改root口令,不用默认口令,使用较复杂的口令</span><br><span class="line"><span class="number">5</span>)删除多余的用户</span><br><span class="line"><span class="number">6</span>)改变root用户名称</span><br><span class="line"><span class="number">7</span>)限制一般用户浏览其他库</span><br><span class="line"><span class="number">8</span>)限制用户对数据库的访问权限</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-kill -pkill -killall 终结进程</title>
      <link href="/2019/01/06/ubuntu/linux_ubuntu_kill/"/>
      <url>/2019/01/06/ubuntu/linux_ubuntu_kill/</url>
      <content type="html"><![CDATA[<h3 id="kill-发送指定信号到相应进程"><a href="#kill-发送指定信号到相应进程" class="headerlink" title="kill 发送指定信号到相应进程"></a>kill 发送指定信号到相应进程</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">kill <span class="number">3453</span></span><br><span class="line"></span><br><span class="line">#demo</span><br><span class="line">root@ubuntu:/# <span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">fei        <span class="number">3452</span>  <span class="number">0.0</span>  <span class="number">0.9</span>  <span class="number">62048</span>  <span class="number">9344</span> <span class="keyword">pts</span>/<span class="number">19</span>   S+   <span class="number">20</span>:<span class="number">11</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">vim</span> hello.php</span><br><span class="line">fei        <span class="number">3453</span>  <span class="number">0.0</span>  <span class="number">0.8</span>  <span class="number">60916</span>  <span class="number">8252</span> <span class="keyword">pts</span>/<span class="number">18</span>   S+   <span class="number">20</span>:<span class="number">11</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">vim</span> aaa.txt</span><br><span class="line">root       <span class="number">3468</span>  <span class="number">0.0</span>  <span class="number">0.1</span>  <span class="number">21292</span>  <span class="number">1028</span> <span class="keyword">pts</span>/<span class="number">1</span>    S+   <span class="number">20</span>:<span class="number">14</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">grep</span> --color=auto <span class="keyword">vim</span></span><br><span class="line">root@ubuntu:/# kill <span class="number">3453</span></span><br><span class="line">root@ubuntu:/# <span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">fei        <span class="number">3452</span>  <span class="number">0.0</span>  <span class="number">0.9</span>  <span class="number">62048</span>  <span class="number">9344</span> <span class="keyword">pts</span>/<span class="number">19</span>   S+   <span class="number">20</span>:<span class="number">11</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">vim</span> hello.php</span><br><span class="line">root       <span class="number">3472</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">21292</span>   <span class="number">880</span> <span class="keyword">pts</span>/<span class="number">1</span>    S+   <span class="number">20</span>:<span class="number">15</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">grep</span> --color=auto <span class="keyword">vim</span></span><br><span class="line">root@ubuntu:/#</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_kill/kill.png" alt="kiil" title="kill"></p><h3 id="pkill-按照进程名称杀死进程"><a href="#pkill-按照进程名称杀死进程" class="headerlink" title="pkill 按照进程名称杀死进程"></a>pkill 按照进程名称杀死进程</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">pkill <span class="keyword">vim</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#demo</span><br><span class="line">root@ubuntu:/# <span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">fei        <span class="number">3497</span>  <span class="number">1.6</span>  <span class="number">0.9</span>  <span class="number">62048</span>  <span class="number">9328</span> <span class="keyword">pts</span>/<span class="number">19</span>   S+   <span class="number">20</span>:<span class="number">20</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">vim</span> hello.php</span><br><span class="line">fei        <span class="number">3499</span>  <span class="number">1.0</span>  <span class="number">0.8</span>  <span class="number">60916</span>  <span class="number">8368</span> <span class="keyword">pts</span>/<span class="number">18</span>   S+   <span class="number">20</span>:<span class="number">20</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">vim</span> aaa.txt</span><br><span class="line">root       <span class="number">3501</span>  <span class="number">0.0</span>  <span class="number">0.1</span>  <span class="number">21292</span>  <span class="number">1012</span> <span class="keyword">pts</span>/<span class="number">1</span>    S+   <span class="number">20</span>:<span class="number">20</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">grep</span> --color=auto <span class="keyword">vim</span></span><br><span class="line">root@ubuntu:/# pkill <span class="keyword">vim</span></span><br><span class="line">root@ubuntu:/# <span class="keyword">ps</span> -aux | <span class="keyword">grep</span> <span class="keyword">vim</span></span><br><span class="line">root       <span class="number">3504</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">21292</span>   <span class="number">912</span> <span class="keyword">pts</span>/<span class="number">1</span>    S+   <span class="number">20</span>:<span class="number">20</span>   <span class="number">0</span>:<span class="number">00</span> <span class="keyword">grep</span> --color=auto <span class="keyword">vim</span></span><br><span class="line">root@ubuntu:/# </span><br><span class="line"></span><br><span class="line">### 特殊demo, 踢某个用户下线(who <span class="keyword">w</span> 查看登录用户)</span><br><span class="line">pkill -kill -t <span class="keyword">pts</span>/<span class="number">17</span></span><br><span class="line">pkill -<span class="number">9</span> -t <span class="keyword">pts</span>/<span class="number">17</span></span><br><span class="line">fuser -<span class="keyword">k</span> /dev/<span class="keyword">pts</span>/<span class="number">17</span></span><br><span class="line"><span class="keyword">echo</span> “你被管理员踢出了” &gt; /dev/<span class="keyword">pts</span>/<span class="number">17</span> &amp;&amp; fuser -<span class="keyword">k</span> /dev/<span class="keyword">pts</span>/<span class="number">17</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_kill/pkill.png" alt="pkiil" title="pkill"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -path 环境变量篇 -composer 测试</title>
      <link href="/2018/12/29/ubuntu/ubuntu_path%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F_composer/"/>
      <url>/2018/12/29/ubuntu/ubuntu_path%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F_composer/</url>
      <content type="html"><![CDATA[<p>源码编译完的包,很多时候在任何目录时访问不到的,这时候需要添加环境变量,或者通过链接的形式,链接到系统默认的PATH目录下的一个,这篇文章就是介绍一下这2中添加环境变量的方式; !!!修改系统环境变量后,要退出当前用户重新登录后才可以看到效果;</p><p>demo背景,采用composer测试,前提编译安装完php</p><h3 id="安装composer"><a href="#安装composer" class="headerlink" title="安装composer"></a>安装composer</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sS https:<span class="regexp">//g</span>etcomposer.org<span class="regexp">/installer | /</span>data<span class="regexp">/server/</span>php7<span class="regexp">/bin/</span>php</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/path/composer_install.png" alt="composer 安装" title="composer 安装"></p><h3 id="配置环境变量方法-01"><a href="#配置环境变量方法-01" class="headerlink" title="配置环境变量方法 01"></a>配置环境变量方法 01</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#第一种方式,放到系统默认PATH环境变量目录下</span></span><br><span class="line">cp <span class="string">/test/composer.phar</span> <span class="string">/usr/local/bin/composer</span>  或者</span><br><span class="line">mv <span class="string">/test/composer.phar</span> <span class="string">/usr/local/bin/composer</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###扩展,使用 echo $PATH 可以看到当前的环境变量内容,系统默认的环境变量包括:</span></span><br><span class="line">root@ubuntu:<span class="string">/test</span><span class="comment"># echo $PATH</span></span><br><span class="line"><span class="string">/usr/local/sbin</span>:<span class="string">/usr/local/bin</span>:<span class="string">/usr/sbin</span>:<span class="string">/usr/bin</span>:<span class="string">/sbin</span>:<span class="string">/bin</span>:<span class="string">/usr/games</span>:<span class="string">/usr/local/games</span></span><br><span class="line">root@ubuntu:<span class="string">/test</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/path/path_01.png" alt="composer 环境变量" title="composer 环境变量"></p><p><img src="/img/ubuntu/path/path_01_1.png" alt="composer 环境变量" title="composer 环境变量"></p><h3 id="配置环境变量方法-02-使用-PHP-来测试-系统-centos7"><a href="#配置环境变量方法-02-使用-PHP-来测试-系统-centos7" class="headerlink" title="配置环境变量方法 02 , 使用 PHP 来测试,系统 centos7"></a>配置环境变量方法 02 , 使用 PHP 来测试,系统 centos7</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PHP编译安装后的目录:  /data/server/php/bin</span><br><span class="line">vim  /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#centos中配置PHP环境变量:</span></span><br><span class="line">修改 /etc<span class="built_in">/profile </span>配置环境变量</span><br><span class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:/data/server/php/bin</span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br><span class="line">然后执行source /etc<span class="built_in">/profile </span>或者 .<span class="built_in">/profile </span>使其生效; 执行完后可以通过 echo <span class="variable">$PATH</span>  命令查看环境变量</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/path/path_02.png" alt="php 环境变量2" title="php 环境变量2"></p><p><a href="https://docs.phpcomposer.com/00-intro.html#Installation-*nix" target="_blank" rel="noopener">composer官方安装文档</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-算法02</title>
      <link href="/2018/12/23/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95_02/"/>
      <url>/2018/12/23/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95_02/</url>
      <content type="html"><![CDATA[<h3 id="01-输出-1-到-100-之间的素数-质数"><a href="#01-输出-1-到-100-之间的素数-质数" class="headerlink" title="01). 输出 1 到 100 之间的素数(质数)"></a>01). 输出 1 到 100 之间的素数(质数)</h3><p> 用一个数分别去除2到这个数之间的所有数,如果被整除就是素数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 </span></span><br><span class="line"><span class="comment">//分析: 用一个数分别去除2到这个数之间的所有数,如果被整除就是素数</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt;= <span class="number">100</span>; $i++) &#123;</span><br><span class="line">    $k = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//判断开始和结束的值是否也是素数</span></span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">1</span>; $j &lt;= $i; $j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($i % $j == <span class="number">0</span>) &#123;</span><br><span class="line">            $k++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($k == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $i;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&amp;nbsp;&amp;nbsp;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="02-打印出所有的-“水仙花数-“"><a href="#02-打印出所有的-“水仙花数-“" class="headerlink" title="02).   打印出所有的 “水仙花数 “"></a>02).   打印出所有的 “水仙花数 “</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打印出所有的 "水仙花数 "， 三位的水仙花数共有4个：153，370，371，407</span></span><br><span class="line"><span class="comment">// 所谓 "水仙花数 "是指一个三位数，其各位数字立方和等于该数本身。</span></span><br><span class="line"><span class="comment">// 例如：153是一个 "水仙花数 "，因为 1^3 + 5^3+ 3^3 = 153</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">100</span>; $i &lt; <span class="number">1000</span>; $i++) &#123;</span><br><span class="line">    $hunderds = floor($i / <span class="number">100</span>);</span><br><span class="line">    $tens = floor($i / <span class="number">10</span>) % <span class="number">10</span>;</span><br><span class="line">    $ones = floor($i % <span class="number">10</span>);</span><br><span class="line">    $temp = pow($hunderds, <span class="number">3</span>) + pow($tens, <span class="number">3</span>) + pow($ones, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> ($temp == $i) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $i;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&amp;nbsp;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="03-正整数分解质因数"><a href="#03-正整数分解质因数" class="headerlink" title="03).  正整数分解质因数"></a>03).  正整数分解质因数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将一个正整数分解质因数。例如：输入90,打印出90=2*3*3*5。</span></span><br><span class="line"><span class="comment">// 分析:</span></span><br><span class="line"><span class="comment">// 对n进行分解质因数，应先找到一个最小的质数k，然后按下述步骤完成：</span></span><br><span class="line"><span class="comment">// (1)如果这个质数恰等于n，则说明分解质因数的过程已经结束，打印出即可。</span></span><br><span class="line"><span class="comment">// (2)如果n&lt;&gt;k，但n能被k整除，则应打印出k的值，并用n除以k的商,作为新的正整数n,重复执行第一步。</span></span><br><span class="line"><span class="comment">// (3)如果n不能被k整除，则用k+1作为k的值,重复执行第一步</span></span><br><span class="line"></span><br><span class="line">$n = <span class="number">90</span>;</span><br><span class="line"><span class="keyword">echo</span> $n . <span class="string">'='</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">2</span>; $i &lt; $n + <span class="number">1</span>; $i ++)&#123;</span><br><span class="line">    <span class="keyword">while</span> ($n % $i == <span class="number">0</span> &amp;&amp; $n != $i) &#123;</span><br><span class="line">        $n /= $i;</span><br><span class="line">        <span class="keyword">echo</span> $i . <span class="string">"*"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($n == $i) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $i;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="04-三目条件嵌套"><a href="#04-三目条件嵌套" class="headerlink" title="04). 三目条件嵌套"></a>04). 三目条件嵌套</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用条件运算符的嵌套来完成此题：</span></span><br><span class="line"><span class="comment">// 学习成绩&gt; =90分的同学用A表示，</span></span><br><span class="line"><span class="comment">// 60-89分之间的用B表示，</span></span><br><span class="line"><span class="comment">// 60分以下的用C表示。</span></span><br><span class="line"></span><br><span class="line">$score = <span class="number">89</span>;</span><br><span class="line"></span><br><span class="line">$grade = $score &gt;= <span class="number">90</span> ? <span class="string">'A'</span> : ($score &gt;= <span class="number">60</span> &amp;&amp; $score &lt;= <span class="number">89</span> ? <span class="string">'B'</span> : <span class="string">"C"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $grade;</span><br></pre></td></tr></table></figure><h3 id="05-输入两个正整数m和n，求其最大公约数和最小公倍数"><a href="#05-输入两个正整数m和n，求其最大公约数和最小公倍数" class="headerlink" title="05). 输入两个正整数m和n，求其最大公约数和最小公倍数"></a>05). 输入两个正整数m和n，求其最大公约数和最小公倍数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 题目：输入两个正整数m和n，求其最大公约数和最小公倍数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在循环中，只要除数不等于0，用较大数除以较小的数，</span></span><br><span class="line"><span class="comment">// 将小的一个数作为下一轮循环的大数，取得的余数作为下一轮循环的较小的数，</span></span><br><span class="line"><span class="comment">// 如此循环直到较小的数的值为0，</span></span><br><span class="line"><span class="comment">// 返回较大的数，此数即为最大公约数，最小公倍数为两数之积除以最大公约数。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这种方法叫做: 辗除法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span><span class="params">($x, $y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($x &lt; $y) &#123;</span><br><span class="line">        $temp = $x;</span><br><span class="line">        $x = $y;</span><br><span class="line">        $y = $temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ($y!=<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($x==$y)&#123;</span><br><span class="line">            <span class="keyword">return</span> $x;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $k = $x % $y;</span><br><span class="line">            $x = $y;</span><br><span class="line">            $y = $k;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $x;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="number">21</span>;  $b = <span class="number">24</span>;</span><br><span class="line">$m =  f($a, $b); <span class="comment">//最大公约数</span></span><br><span class="line">$n = $a * $b / $m; <span class="comment">//最小公倍数</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'最大公约数为: '</span> . $m.<span class="string">"&amp;nbsp;&amp;nbsp;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'最小公倍数为: '</span> . $n.<span class="string">"&amp;nbsp;&amp;nbsp;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// 方法2, 使用php自带的函数,获取最小公约数</span></span><br><span class="line">$gcd = gmp_gcd(<span class="string">"21"</span>, <span class="string">"24"</span>);</span><br><span class="line"><span class="keyword">echo</span> gmp_strval($gcd) . <span class="string">"\n"</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>--login 登录系统后常用命令</title>
      <link href="/2018/12/09/ubuntu/linux_ubuntu_login/"/>
      <url>/2018/12/09/ubuntu/linux_ubuntu_login/</url>
      <content type="html"><![CDATA[<p>介绍：</p><p>登录新系统后常用命令</p><h3 id="uname-打印系统相关信息"><a href="#uname-打印系统相关信息" class="headerlink" title="uname 打印系统相关信息"></a>uname 打印系统相关信息</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uname </span><br><span class="line">uname -<span class="keyword">a</span>   <span class="comment">#显示全部信息</span></span><br><span class="line">uname -m   <span class="comment">#系统类型</span></span><br><span class="line">uname -n</span><br><span class="line">uname -r</span><br><span class="line">uname -s</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/uname.png" alt="uname" title="uname"></p><h3 id="free-查看内存"><a href="#free-查看内存" class="headerlink" title="free  查看内存"></a>free  查看内存</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">free</span> -h   <span class="comment">#以K，M，G为单位，提高信息的可读性</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/free_h.png" alt="free 参数h" title="free 参数h"></p><h3 id="df-显示磁盘分区上的可使用的磁盘空间"><a href="#df-显示磁盘分区上的可使用的磁盘空间" class="headerlink" title="df  显示磁盘分区上的可使用的磁盘空间"></a>df  显示磁盘分区上的可使用的磁盘空间</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">df</span> -h   <span class="comment">#以K，M，G为单位，提高信息的可读性</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/df_h.png" alt="df 参数h" title="df 参数h"></p><p>du :  与地方不同的是,du命令是对文件和目录磁盘使用的空间查看</p><h3 id="du-对文件和目录磁盘使用的空间查看"><a href="#du-对文件和目录磁盘使用的空间查看" class="headerlink" title="du  对文件和目录磁盘使用的空间查看"></a>du  对文件和目录磁盘使用的空间查看</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">du</span> -h   <span class="comment">#以K，M，G为单位，提高信息的可读性</span></span><br><span class="line">du -s   <span class="comment">#显示目录中文件总和</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/du_h.png" alt="df 参数h" title="du 参数h"></p><h3 id="uptime-查看系统运行时间、用户数、负载"><a href="#uptime-查看系统运行时间、用户数、负载" class="headerlink" title="uptime 查看系统运行时间、用户数、负载"></a>uptime 查看系统运行时间、用户数、负载</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uptime</span><br><span class="line"></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/www</span><span class="comment"># uptime</span></span><br><span class="line"> <span class="number">18</span><span class="symbol">:</span><span class="number">24</span><span class="symbol">:</span><span class="number">03</span> up  <span class="number">1</span><span class="symbol">:</span><span class="number">52</span>,  <span class="number">1</span> user,  load <span class="symbol">average:</span> <span class="number">0</span>.<span class="number">39</span>, <span class="number">0</span>.<span class="number">69</span>, <span class="number">0</span>.<span class="number">37</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/www</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="netstat-系统中网络状态信息-端口-lsof-i-22"><a href="#netstat-系统中网络状态信息-端口-lsof-i-22" class="headerlink" title="netstat  系统中网络状态信息(端口)   [lsof -i:22 ]"></a>netstat  系统中网络状态信息(端口)   [lsof -i:22 ]</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">netstat -lntp <span class="meta"># 查看所有监听端口  </span></span><br><span class="line">netstat -antp <span class="meta"># 查看所有已经建立的连接, 查看端口是否被应用</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#查看占用端口22的进程</span></span><br><span class="line">netstat -tnlp <span class="string">| grep 22</span></span><br><span class="line">lsof -i:<span class="number">22</span></span><br></pre></td></tr></table></figure><h3 id="ps-当前系统的进程状态"><a href="#ps-当前系统的进程状态" class="headerlink" title="ps 当前系统的进程状态"></a>ps 当前系统的进程状态</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#选项很多,列举2个demo</span></span><br><span class="line">ps -aux <span class="string">| grep php</span></span><br><span class="line">ps -aux <span class="string">| nginx</span></span><br></pre></td></tr></table></figure><h3 id="crontab-计划任务"><a href="#crontab-计划任务" class="headerlink" title="crontab 计划任务"></a>crontab 计划任务</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">crontab</span> -l <span class="comment"># 查看当前用户的计划任务服务</span></span><br></pre></td></tr></table></figure><h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">top</span> </span><br><span class="line">然后按 shift + <span class="selector-tag">p</span> ,按照进程处理器占用率排序</span><br><span class="line">然后按 Shift + m, 按照进程内存占用率排序</span><br></pre></td></tr></table></figure><h3 id="w-显示已经登陆系统的用户列表，并显示用户正在执行的指令"><a href="#w-显示已经登陆系统的用户列表，并显示用户正在执行的指令" class="headerlink" title="w  显示已经登陆系统的用户列表，并显示用户正在执行的指令"></a>w  显示已经登陆系统的用户列表，并显示用户正在执行的指令</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w</span><br><span class="line"></span><br><span class="line">root@ubuntu:/# w      #当前登录用户 fei, fei_02</span><br><span class="line"> 19:46:31 up  1:19,  2 users,  load average: 0.18, 0.10, 0.03</span><br><span class="line">USER     TTY      <span class="keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">fei      tty7     :0               18:27    1:19m  7.79s  0.58s /sbin/upstart -</span><br><span class="line">fei_02   pts/18   192.168.47.1     19:46   12.00s  0.00s  0.00s -sh</span><br></pre></td></tr></table></figure><h3 id="who-显示目前登录系统的用户信息"><a href="#who-显示目前登录系统的用户信息" class="headerlink" title="who 显示目前登录系统的用户信息"></a>who 显示目前登录系统的用户信息</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei</span><span class="comment"># who</span></span><br><span class="line">fei      tty7         <span class="number">2019</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">18</span><span class="symbol">:</span><span class="number">27</span> (<span class="symbol">:</span><span class="number">0</span>)</span><br><span class="line">fei_02   pts/<span class="number">17</span>       <span class="number">2019</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">22</span><span class="symbol">:</span><span class="number">05</span> (<span class="number">192.168</span>.<span class="number">47.1</span>)</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="write-终端给登录用户发消息"><a href="#write-终端给登录用户发消息" class="headerlink" title="write 终端给登录用户发消息"></a>write 终端给登录用户发消息</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">write</span> fei_02 <span class="keyword">pts</span>/<span class="number">17</span></span><br><span class="line">ctrl+<span class="keyword">c</span> 或者 ctrl + d 结束</span><br><span class="line"></span><br><span class="line">或者:</span><br><span class="line"><span class="keyword">echo</span> “你被管理员踢出了” &gt; /dev/<span class="keyword">pts</span>/<span class="number">17</span></span><br><span class="line">fuser -<span class="keyword">k</span> /dev/<span class="keyword">pts</span>/<span class="number">17</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/w_who_write.png" alt="w who write" title="w who write"></p><h3 id="fuser-踢用户下线"><a href="#fuser-踢用户下线" class="headerlink" title="fuser 踢用户下线"></a>fuser 踢用户下线</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fuser -k <span class="string">/dev/pts/17</span>  <span class="comment">#使用 w 或者 who 可查看在线用户</span></span><br><span class="line"><span class="keyword">echo</span> “你被管理员踢出了” &gt; <span class="string">/dev/pts/17</span> &amp;&amp; fuser -k <span class="string">/dev/pts/17</span>  <span class="comment">#发送消息并踢下线</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_login/fuser.png" alt="fuser" title="fuser"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>vagrant_03 --VirtualBox --硬盘扩容</title>
      <link href="/2018/11/30/centos/vagrant_03_VirtualBox_%E7%A1%AC%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
      <url>/2018/11/30/centos/vagrant_03_VirtualBox_%E7%A1%AC%E7%9B%98%E6%89%A9%E5%AE%B9/</url>
      <content type="html"><![CDATA[<p>vagrant  初始的 box 硬盘空间只有 10G,安装 mysql8 就不够用 :(  ,下面介绍给主硬盘空间扩容, 操作平台 windows7, box[ubuntu18]</p><h3 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h3><p>为了接下来方便操作在 windows 中添加 virtualbox 的环境变量 [ 因为下面会多次用到 vboxmanage 命令 ]</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!!! 备份要扩容的文件, 或者全部备份</span><br><span class="line">!!  vbox , vbox-prev 配置文件要备份</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_VirtualBox/backups.png" alt="备份源文件"></p><h3 id="记录要扩容的硬盘的原始信息"><a href="#记录要扩容的硬盘的原始信息" class="headerlink" title="记录要扩容的硬盘的原始信息"></a>记录要扩容的硬盘的原始信息</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vboxmanage showhdinfo ubuntu-bionic-18.04-cloudimg.vmdk</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line">$ vboxmanage showhdinfo ubuntu-bionic-18.04-cloudimg.vmdk</span><br><span class="line">UUID:           5d02ba81-6f7e-4a8e-8e1b-eadbb30d11d4</span><br><span class="line">Parent UUID:    base</span><br><span class="line">.....</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_VirtualBox/showinfo.png" alt="原始信息"></p><h3 id="开始扩容"><a href="#开始扩容" class="headerlink" title="开始扩容"></a>开始扩容</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#克隆成 vdi 文件</span><br><span class="line">vboxmanage clonehd <span class="string">"ubuntu-bionic-18.04-cloudimg.vmdk"</span> <span class="string">"new-ubuntu-bionic-18.04-cloudimg.vdi"</span> --format vdi</span><br><span class="line"></span><br><span class="line">#扩容为 <span class="number">30</span>G</span><br><span class="line">vboxmanage modifyhd <span class="string">"new-ubuntu-bionic-18.04-cloudimg.vdi"</span> --<span class="attribute">resize</span> <span class="number">30720</span></span><br><span class="line"></span><br><span class="line">#转化为原来的 vmdk 格式</span><br><span class="line">VBoxManage clonehd <span class="string">"new-ubuntu-bionic-18.04-cloudimg.vdi"</span> <span class="string">"new-ubuntu-bionic-18.04-cloudimg.vmdk"</span> --format vmdk</span><br><span class="line"></span><br><span class="line">#查看新 vmdk 信息,记录uuid</span><br><span class="line"> vboxmanage showhdinfo new-ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br><span class="line"></span><br><span class="line">$ vboxmanage showhdinfo new-ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br><span class="line">UUID:           f6b42381-fde2-<span class="number">43</span>c2-bcab-<span class="number">3</span>e37731caa9a</span><br><span class="line">Parent UUID:    base</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">#[ <span class="selector-tag">del</span>,ren  命令只能在 cmd 或 powershell 中执行]</span><br><span class="line">#删除需要扩容的 vmdk </span><br><span class="line"><span class="selector-tag">del</span>  ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br><span class="line"></span><br><span class="line">#将扩容后的 vmdk 重命名为原来的文件名</span><br><span class="line">ren new-ubuntu-bionic-<span class="number">18.04</span>-cloudimg<span class="selector-class">.vmdk</span>  ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line">D:\soft_position\VirtualBox_linux\ubuntu18_default_1543569229538_92064&gt; <span class="selector-tag">del</span>  ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br><span class="line">D:\soft_position\VirtualBox_linux\ubuntu18_default_1543569229538_92064&gt; ren new-ubuntu-bionic-<span class="number">18.04</span>-cloudimg<span class="selector-class">.vmdk</span>  ubuntu-bionic-<span class="number">18.04</span>-cloudimg.vmdk</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_VirtualBox/vmdk_vdi.png" alt="扩容_01"></p><p><img src="/img/centos/vagrant_VirtualBox/vmdk_vdi_02.png" alt="扩容_02"></p><h3 id="修改-配置文件-uuid"><a href="#修改-配置文件-uuid" class="headerlink" title="修改 配置文件 uuid"></a>修改 配置文件 uuid</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 手动修改,图形界面修改都可以</span><br><span class="line">ubuntu18_default_1543569229538_92064.vbox</span><br><span class="line">ubuntu18_default_1543569229538_92064.vbox-prev</span><br><span class="line">这<span class="number">2</span>个文件中旧的 uuid  <span class="number">5</span>d02ba81<span class="number">-6</span>f7e<span class="number">-4</span>a8e<span class="number">-8e1</span>b-eadbb30d11d4</span><br><span class="line">全部替换为新的  uuid  f6b42381-fde2<span class="number">-43</span>c2-bcab<span class="number">-3e37731</span>caa9a</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_VirtualBox/uuid.png" alt="uuid 修改"></p><h3 id="扩容成功"><a href="#扩容成功" class="headerlink" title="扩容成功"></a>扩容成功</h3><p><img src="/img/centos/vagrant_VirtualBox/success.png" alt="扩容成功"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>mysql -sql other</title>
      <link href="/2018/11/26/mysql/sql_other/"/>
      <url>/2018/11/26/mysql/sql_other/</url>
      <content type="html"><![CDATA[<h3 id="mysql-简单整理"><a href="#mysql-简单整理" class="headerlink" title="mysql 简单整理"></a>mysql 简单整理</h3><p> group by  ;  group_concat </p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SELECT <span class="symbol">*</span> FROM student_01 GROUP BY `name`;</span><br><span class="line"></span><br><span class="line">SELECT <span class="symbol">*</span>,GROUP_CONCAT(name) FROM student_01 GROUP BY `name`;</span><br><span class="line"></span><br><span class="line">+----+------+---------+-------+</span><br><span class="line">|<span class="string"> id </span>|<span class="string"> name </span>|<span class="string"> kecheng </span>|<span class="string"> score </span>|</span><br><span class="line">+----+------+---------+-------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> 张三  </span>|<span class="string"> 语文    </span>|<span class="string"> 81    </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> 李四  </span>|<span class="string"> 语文    </span>|<span class="string"> 76    </span>|</span><br><span class="line">|<span class="string">  5 </span>|<span class="string"> 王五  </span>|<span class="string"> 语文    </span>|<span class="string"> 81    </span>|</span><br><span class="line">+----+------+---------+-------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+----+------+---------+-------+--------------------+</span><br><span class="line">|<span class="string"> id </span>|<span class="string"> name </span>|<span class="string"> kecheng </span>|<span class="string"> score </span>|<span class="string"> GROUP_CONCAT(name) </span>|</span><br><span class="line">+----+------+---------+-------+--------------------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> 张三  </span>|<span class="string"> 语文    </span>|<span class="string"> 81    </span>|<span class="string"> 张三,张三           </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> 李四  </span>|<span class="string"> 语文    </span>|<span class="string"> 76    </span>|<span class="string"> 李四,李四           </span>|</span><br><span class="line">|<span class="string">  5 </span>|<span class="string"> 王五  </span>|<span class="string"> 语文    </span>|<span class="string"> 81    </span>|<span class="string"> 王五,王五,王五      </span>|</span><br><span class="line">+----+------+---------+-------+--------------------+</span><br></pre></td></tr></table></figure><h3 id="int-3-int-5-区别-是否需要零填充"><a href="#int-3-int-5-区别-是否需要零填充" class="headerlink" title="int (3)   int (5) 区别,是否需要零填充"></a>int (3)   int (5) 区别,是否需要零填充</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#没有使用零填充 init(3)  </span></span><br><span class="line">CREATE TABLE `test` (</span><br><span class="line">  `id` int(3) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_unicode_ci<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=MyISAM<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8mb4 <span class="attribute">COLLATE</span>=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> test;</span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">|  1 | 许褚  |</span><br><span class="line">|  2 | 郭嘉  |</span><br><span class="line">|  3 | 贾诩  |</span><br><span class="line">+----+------+</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用零填充 init(3)  zerofill </span></span><br><span class="line">CREATE TABLE `test` (</span><br><span class="line">  `id` int(3) unsigned zerofill <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_unicode_ci<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=MyISAM<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8mb4 <span class="attribute">COLLATE</span>=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> test;</span><br><span class="line">+-----+------+</span><br><span class="line">| id  | name |</span><br><span class="line">+-----+------+</span><br><span class="line">| 001 | 许褚  |</span><br><span class="line">| 002 | 郭嘉  |</span><br><span class="line">| 003 | 贾诩  |</span><br><span class="line">+-----+------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="builtin-name">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用零填充 init(5)  zerofill </span></span><br><span class="line">CREATE TABLE `test` (</span><br><span class="line">  `id` int(5) unsigned zerofill <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_unicode_ci<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=MyISAM <span class="attribute">AUTO_INCREMENT</span>=4<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8mb4 <span class="attribute">COLLATE</span>=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> test;</span><br><span class="line">+-------+------+</span><br><span class="line">| id    | name |</span><br><span class="line">+-------+------+</span><br><span class="line">| 00001 | 许褚  |</span><br><span class="line">| 00002 | 郭嘉  |</span><br><span class="line">| 00003 | 贾诩  |</span><br><span class="line">+-------+------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="builtin-name">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/other/int.png" alt="int zerofill" title="init zerofill"></p><h3 id="mysql-存储引擎"><a href="#mysql-存储引擎" class="headerlink" title="mysql 存储引擎"></a>mysql 存储引擎</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">InnoDB表引擎</span></span><br><span class="line">通过一些机制和工具支持真真的热备份</span><br><span class="line">支持奔溃后的安全恢复</span><br><span class="line">支持行级锁</span><br><span class="line">支持外键</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">MyISAM表引擎</span></span><br><span class="line">5.1版本之前,MyISAM是默认的存储引擎</span><br><span class="line">拥有全文索引、压缩、 空间函数</span><br><span class="line">不支持事务和行级锁,不支持奔溃后的安全恢复</span><br><span class="line">表存储在两个文件,MYD和MYI</span><br></pre></td></tr></table></figure><h3 id="mysql-锁"><a href="#mysql-锁" class="headerlink" title="mysql 锁"></a>mysql 锁</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">当多个查询同一时刻进行数据修改时,就会产生并发控制的问题, 共享锁(读锁) 、排他锁(写锁)</span><br><span class="line"></span><br><span class="line"><span class="comment">#共享锁(读锁)</span></span><br><span class="line">共享的,不堵塞,多个用户可以同时读取一个资源,互不干扰</span><br><span class="line"><span class="comment">#排他锁(写锁)</span></span><br><span class="line">排他的,一个写锁会阻塞一塔的写锁和读锁,这样可以值允许一个人写进行写入,防止其他用户读取正在写入的资源</span><br><span class="line"></span><br><span class="line"><span class="comment">#demo共享锁(读锁)</span></span><br><span class="line">select * <span class="keyword">from</span> test; </span><br><span class="line">lock table test <span class="built_in">read</span>; <span class="comment">#共享锁</span></span><br><span class="line">unlock TABLES;  <span class="comment">#解锁</span></span><br><span class="line">update test <span class="keyword">set</span> <span class="built_in">name</span>=<span class="string">"贾诩_update"</span> <span class="keyword">where</span> <span class="built_in">id</span>=<span class="number">03</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">#排他锁  执行完lock加锁后,update 结束后及时执行解锁操作</span></span><br><span class="line">lock tables test <span class="built_in">write</span>;</span><br><span class="line">update test <span class="keyword">set</span> <span class="built_in">name</span>=<span class="string">"贾诩_update"</span> <span class="keyword">where</span> <span class="built_in">id</span>=<span class="number">03</span>;</span><br><span class="line">unlock TABLES;</span><br><span class="line">在排他锁执行期间.在当前窗口其他SQL是不能执行的,</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过进程id, kill 掉锁</span></span><br><span class="line">show processlist;  <span class="comment">#查看锁状态</span></span><br><span class="line">kill <span class="built_in">id</span>  <span class="comment">#杀掉等待sql</span></span><br><span class="line">show OPEN TABLES <span class="keyword">where</span> In_use &gt; <span class="number">0</span>; <span class="comment">#查看是否有在锁表</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">粒度锁</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">表锁</span></span><br><span class="line">系统性能开销最小,会锁定整张表,MyISAM 使用表锁</span><br><span class="line"><span class="meta">#</span><span class="bash">行锁</span></span><br><span class="line">最大程度地支持并发处理,但是也带来了最大的的锁开销,InnoDb 实现行级锁</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">Mysql 存储过程</span></span><br><span class="line">使用场景,通过处理把封装在容易使用的单元中,简化复杂的操作,保证数据的一致性</span><br></pre></td></tr></table></figure><h3 id="mysql-索引"><a href="#mysql-索引" class="headerlink" title="mysql 索引"></a>mysql 索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#索引类型: 普通索引(index  另一个名字normal)、唯一索引(unique)、全文索引(fulltext)、空间索引(SPATIAL)</span><br><span class="line">ALTER TABLE `test`.`test` </span><br><span class="line">ADD INDEX `id_score_score2`(`id`, `score`, `score2`);</span><br><span class="line"></span><br><span class="line">ALTER TABLE `test`.`test` </span><br><span class="line">ADD UNIQUE INDEX `id_score_score2`(`id`, `score`, `score2`);</span><br><span class="line"></span><br><span class="line">ALTER TABLE `test`.`test` </span><br><span class="line">ADD FULLTEXT INDEX `id_score_score2`(`id`, `score`, `score2`);</span><br><span class="line"></span><br><span class="line">ALTER TABLE `test`.`test` </span><br><span class="line">ADD SPATIAL INDEX `id_score_score2`(`id`, `score`, `score2`);</span><br></pre></td></tr></table></figure><h3 id="mysql-连接查询"><a href="#mysql-连接查询" class="headerlink" title="mysql 连接查询"></a>mysql 连接查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#自己关联自己查询</span><br><span class="line">select * from test a1 inner join  test a2 on a1.score=a2.score2</span><br></pre></td></tr></table></figure><h3 id="数据库优化"><a href="#数据库优化" class="headerlink" title="数据库优化"></a>数据库优化</h3><p>查找分析查询速度慢的原因 ↓</p><ol><li>↑优化查询过程中的数据访问 <strong>↓↓</strong></li><li>↑优化长难查询语句 <strong>↓↓</strong></li><li>↑优化特定类型的查询语句 <strong>↓↓</strong></li></ol><h4 id="↑↑查找分析查询速度慢的原因"><a href="#↑↑查找分析查询速度慢的原因" class="headerlink" title="↑↑查找分析查询速度慢的原因"></a><strong>↑↑</strong>查找分析查询速度慢的原因</h4><ol><li><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">分析SQL查询慢的方法</span><br><span class="line">   记录慢查询日志</span><br><span class="line">   分析查询日志,不要直接打开慢日志进行分析,</span><br><span class="line">   这样比较浪费时间和经理,可以使用pt-<span class="keyword">query</span>-digest工具进行分析</span><br></pre></td></tr></table></figure></li><li><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用show profile</span><br><span class="line"><span class="builtin-name">set</span> <span class="attribute">profiling</span>=1;开启,服务器上执行的所有语句会检测消耗的时间,存到临时表中</span><br><span class="line">show profiles</span><br><span class="line">show<span class="built_in"> profile </span><span class="keyword">for</span> query 临时表ID</span><br></pre></td></tr></table></figure></li><li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用<span class="keyword">show</span> <span class="keyword">status</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> 会返回一些计数器,<span class="keyword">show</span> <span class="keyword">global</span> <span class="keyword">status</span>查看服务器级别的所有计数</span><br><span class="line">有时候根据这些计数,可以猜测出那些操作代价较高或者消耗时间多</span><br></pre></td></tr></table></figure></li><li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用<span class="keyword">show</span> <span class="keyword">processlist</span></span><br><span class="line">观察是否有大量线程处于不正常的状态护着特征</span><br></pre></td></tr></table></figure></li><li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用<span class="keyword">explain</span></span><br><span class="line">分析单条<span class="keyword">SQL</span>语句</span><br></pre></td></tr></table></figure></li><li><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby"> 访问数据太多导致查询性能下降</span></span><br><span class="line"><span class="ruby">- 确定应用程序是否存在检索大量超过需要的数据,可能是太多行或列</span></span><br><span class="line"><span class="ruby">- 确认MySQL服务器是否存在分析大量不必要的数据行</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="↑↑-优化查询过程中的数据访问"><a href="#↑↑-优化查询过程中的数据访问" class="headerlink" title="↑↑ 优化查询过程中的数据访问"></a><strong>↑↑</strong> 优化查询过程中的数据访问</h4><ol><li><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">避免使用如下SQL语句</span><br><span class="line">-<span class="ruby">  查询不需要的记录,使用limit解决</span></span><br><span class="line"><span class="ruby">多表关联返回全部列,指定A.id,A.name,B.age</span></span><br><span class="line"><span class="ruby">-  总是取出全部列,select * 会让优化器无法完成索引覆盖扫描的优化</span></span><br><span class="line"><span class="ruby">     -  重复查询相同的数据,可以缓存数据,下次直接读取缓存</span></span><br></pre></td></tr></table></figure></li><li><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">是否在扫描额外的记录</span><br><span class="line"> -<span class="ruby"> 使用explain来进行分析,如果发现查询需要扫描大量的数据大只返回少数的行,</span></span><br><span class="line"><span class="ruby">    可以通过以下技巧去优化<span class="symbol">:</span></span></span><br><span class="line"><span class="ruby"> --  使用索引覆盖扫描,吧所有用的列都放在索引中,</span></span><br><span class="line"><span class="ruby">      这样存储引擎不需要返回表获取对应行就可返回结果</span></span><br><span class="line"><span class="ruby"> --  改变数据库和表结构,修改数据表范式</span></span><br><span class="line"><span class="ruby"> --  重写SQL语句,让优化器可以以更优的方式进行执行查询</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="↑↑-优化长难语句查询语句"><a href="#↑↑-优化长难语句查询语句" class="headerlink" title="↑↑ 优化长难语句查询语句"></a><strong>↑↑</strong> 优化长难语句查询语句</h4><ol><li><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">切分查询 </span><br><span class="line">   将一个大的查询分为多个小的相同的查询:</span><br><span class="line">   一次行删除<span class="number">1000</span>万的数据要比一次删除一次<span class="number">1</span>万更加损耗服务器开销,</span><br><span class="line">   <span class="string">[可先先删除一万暂停一会儿在删除一万]</span></span><br><span class="line"></span><br><span class="line">其他:一个复杂查询还是多个简单查询???</span><br><span class="line">     MySQL内部每秒能扫描内存中上百万行数据,相比之下,相应数据给客户端就压慢很多</span><br><span class="line">使用尽可能少的查询是好的,但是有时将一个大的查询分解为多个小的查血是很有必要的</span><br></pre></td></tr></table></figure></li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">分辨关联查询</span><br><span class="line">可以将一条关联语句分解成多条SQL来执行,好处:</span><br><span class="line">让缓存的效率更高</span><br><span class="line">执行单个查询可以减少锁的竞争</span><br><span class="line">在应用层做关联可以更加容易对数据进行拆分,</span><br><span class="line">查询效率会有大幅提升</span><br><span class="line">较少冗余记录查询</span><br></pre></td></tr></table></figure></li></ol><h4 id="↑↑-优化特定类型的查询"><a href="#↑↑-优化特定类型的查询" class="headerlink" title="↑↑ 优化特定类型的查询"></a><strong>↑↑</strong> 优化特定类型的查询</h4><ol><li><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">优化 count() 查询</span><br><span class="line">    count<span class="comment">(*)中的*会忽略所有的列,直接统计所有列数,因此不要使用count(别名)</span></span><br><span class="line"><span class="comment">    MyISAM中,没有任何where条件非常快</span></span><br><span class="line"><span class="comment">    可以使用explain查询近似值,用近似值代替count(*)</span>,</span><br><span class="line">    增加汇总表</span><br><span class="line">    使用缓存</span><br></pre></td></tr></table></figure></li><li><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">优化关联查询</span><br><span class="line">    确定on或者using子句的列上有索引</span><br><span class="line">    确保<span class="keyword">group</span> <span class="title">by</span> 和 <span class="keyword">order</span> <span class="title">by</span> 中只有一个表中的列,这样MySQL才有可能使用索引</span><br></pre></td></tr></table></figure></li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">优化子查询</span><br><span class="line">    尽可能使用关联查询代替</span><br></pre></td></tr></table></figure></li><li><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">优化<span class="keyword">group</span> <span class="title">by</span> 和 distinct </span><br><span class="line">这两种查询可使用索引来优化,是最有效的优化方法</span><br><span class="line">关联查询中,使用表示列进行分组的效率会更高</span><br><span class="line">如果不需要<span class="keyword">order</span> <span class="title">by</span> ,进行<span class="keyword">group</span> <span class="title">by</span> 时使用<span class="keyword">order</span> <span class="title">by</span> NUll,MySQL不会进行文件排序</span><br></pre></td></tr></table></figure></li><li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">优化<span class="built_in">limit</span>分页</span><br><span class="line">    <span class="built_in">limit</span> 便宜量大的时候,查询效率较低,可以记录上次查询的最大id</span><br><span class="line">    下次查询的时候直接根据该id来查询</span><br></pre></td></tr></table></figure></li><li><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">优化<span class="class"><span class="keyword">union</span>查询</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">all</span> 的效率高于<span class="title">union</span></span></span><br></pre></td></tr></table></figure></li><li><p>综上, 数据库优化: 先找原因定位低效SQL语句,然后根据SQL语句坑你低效的原因做排查,先从索引着手,如果索引没有问题,考虑以上几个方面,数据库访问的问题,长难度语句的问题还是一些特定类型优化的问题</p></li></ol>]]></content>
      
      
    </entry>
    
    <entry>
      <title>--redis key 设计技巧</title>
      <link href="/2018/11/17/centos/redis_key_%E8%AE%BE%E8%AE%A1%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/11/17/centos/redis_key_%E8%AE%BE%E8%AE%A1%E6%8A%80%E5%B7%A7/</url>
      <content type="html"><![CDATA[<h3 id="redis-key-设计技巧"><a href="#redis-key-设计技巧" class="headerlink" title="redis  key 设计技巧"></a>redis  key 设计技巧</h3><p>第一段 表名转化为key的前缀,如 book:  tag:<br>第二段 放置用于分区 key 的字段—对于的 mysql 中的主键的列名,如 id userid<br>第三段 放置主键的值,如1 2 3 4 a b c<br>第四段,写要储存的列名</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">第一段 表名转化为key的前缀,如 book:  tag:</span><br><span class="line">第二段 放置用于分区 key 的字段---对于的 mysql 中的主键的列名,如 id userid </span><br><span class="line">第三段 放置主键的值,如1 2 3 4 a b c</span><br><span class="line">第四段,写要储存的列名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">用户表 user , 转换为 key-value 存储   </span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span>-----------+</span><br><span class="line">| id | username | password | email     |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span>-----------+</span><br><span class="line">|  1 | 张三     | 123456   | 1@qwq.com |</span><br><span class="line">|  2 | 李四     | 123456   | 2@qq.com  |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span>-----------+</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; set user:id:1:username zhangsan</span><br><span class="line">127.0.0.1:6379&gt; set user:id:1:password 123456</span><br><span class="line">127.0.0.1:6379&gt; set user:id:1:email 1@qwq.com</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; set user:id:2:username lisi</span><br><span class="line">127.0.0.1:6379&gt; set user:id:2:password 123456</span><br><span class="line">127.0.0.1:6379&gt; set user:id:2:email 2@qq.com</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; keys user*</span><br><span class="line">127.0.0.1:6379&gt; keys user:id*</span><br></pre></td></tr></table></figure><p><img src="/img/centos/redis/reids_01.png" alt="redis" title="redis"></p><h3 id="mysql-弊端"><a href="#mysql-弊端" class="headerlink" title="mysql 弊端"></a>mysql 弊端</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#book 表 tags 表</span><br><span class="line">DROP TABLE IF EXISTS `book`;</span><br><span class="line">CREATE TABLE `book` (</span><br><span class="line">  `bookid` int(10) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `title` char(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`bookid`)</span><br><span class="line">) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS `tags`;</span><br><span class="line">CREATE TABLE `tags` (</span><br><span class="line">  `tid` int(10) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `bookid` int(11) DEFAULT NULL,</span><br><span class="line">  `content` char(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`tid`)</span><br><span class="line">) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">#------------------- 测试数据 ---------------</span><br><span class="line">INSERT INTO `book` VALUES (&apos;5&apos;, &apos;PHP圣经&apos;);</span><br><span class="line">INSERT INTO `book` VALUES (&apos;6&apos;, &apos;ruby实战&apos;);</span><br><span class="line">INSERT INTO `book` VALUES (&apos;7&apos;, &apos;mysql 运维&apos;);</span><br><span class="line">INSERT INTO `book` VALUES (&apos;8&apos;, &apos;ruby服务端编程&apos;);</span><br><span class="line"></span><br><span class="line">INSERT INTO `tags` VALUES (&apos;10&apos;, &apos;5&apos;, &apos;PHP&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;11&apos;, &apos;5&apos;, &apos;WEB&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;13&apos;, &apos;6&apos;, &apos;ruby&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;14&apos;, &apos;7&apos;, &apos;database&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;15&apos;, &apos;8&apos;, &apos;ruby&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;16&apos;, &apos;8&apos;, &apos;server&apos;);</span><br><span class="line">INSERT INTO `tags` VALUES (&apos;12&apos;, &apos;6&apos;, &apos;WEB&apos;);</span><br><span class="line"></span><br><span class="line"># 查询:即有 web 标签又有 PPH  标签,要用连接查询</span><br><span class="line"> select t1.bookid from tags as t1 inner join tags as t2  </span><br><span class="line"> on t1.bookid=t2.bookid where t1.content=&apos;PHP&apos; and t2.content=&apos;WEB&apos;;   </span><br><span class="line"></span><br><span class="line"># 如果在查有其他标签 web php  ruby ,关联的又要多了</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-crontab 定时任务</title>
      <link href="/2018/11/12/centos/crontab_%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/"/>
      <url>/2018/11/12/centos/crontab_%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/</url>
      <content type="html"><![CDATA[<h3 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h3><p>crontab 文件说明,每个用户都会生成一个自己的 crontab 文件,位于 /var/spool/cron 目录下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost cron]# cat /etc/crontab</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">MAILTO=root</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> For details see man 4 crontabs</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example of job definition:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> |  |  |  |  |</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> *  *  *  *  * user-name  <span class="built_in">command</span> to be executed</span></span><br><span class="line"></span><br><span class="line">[root@localhost cron]# ls /var/spool/cron</span><br><span class="line">root</span><br></pre></td></tr></table></figure><h3 id="crontab-命令"><a href="#crontab-命令" class="headerlink" title="crontab 命令"></a>crontab 命令</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cron</span><br><span class="line"></span><br><span class="line">/sbin/service crond start    //启动服务</span><br><span class="line">/sbin/service crond stop     //关闭服务</span><br><span class="line">/sbin/service crond restart  //重启服务</span><br><span class="line">/sbin/service crond reload   //重新载入配置</span><br><span class="line">/sbin/service crond status   //查看服务状态 </span><br><span class="line"></span><br><span class="line">systemctl start crond.service</span><br><span class="line">systemctl stop crond.service</span><br><span class="line">systemctl restart crond.service</span><br><span class="line">systemctl reload crond.service</span><br><span class="line">systemctl status crond.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//-----------------------------------------------</span><br><span class="line">crontab -u //设定某个用户的cron服务，一般root用户在执行这个命令的时候需要此参数</span><br><span class="line">crontab -l //列出某个用户cron服务的详细内容</span><br><span class="line">crontab -r //删除没个用户的cron服务</span><br><span class="line">crontab -e //编辑某个用户的cron服务</span><br></pre></td></tr></table></figure><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#每隔一分钟执行一次</span></span><br><span class="line">*<span class="string">/1</span> * * * *  php <span class="string">/crontab_test/index.php</span></span><br><span class="line"><span class="comment">#每小时的第一分,执行</span></span><br><span class="line">1 * * * *  php <span class="string">/crontab_test/index.php</span></span><br><span class="line"><span class="params">----------------------------------------------</span></span><br><span class="line"><span class="comment">#每隔2小时执行一次; 从整点开始计数</span></span><br><span class="line">0 *<span class="string">/2</span> * * *  sh <span class="string">/fei/test.sh</span></span><br><span class="line"><span class="comment">#每天的第2小时执行一次</span></span><br><span class="line">0 2 * * *  sh <span class="string">/fei/test.sh</span></span><br><span class="line"><span class="params">------------------------</span> !!!注意这种错误写法 <span class="params">------</span></span><br><span class="line"><span class="comment">#每隔一分钟执行一次</span></span><br><span class="line">* *<span class="string">/1</span> * * *  sh <span class="string">/fei/test.sh</span></span><br></pre></td></tr></table></figure><h3 id="demo-test-sh"><a href="#demo-test-sh" class="headerlink" title="demo test.sh"></a>demo test.sh</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d<span class="number">1</span>=`date +<span class="symbol">%Y-</span><span class="symbol">%m-</span><span class="symbol">%d-</span><span class="symbol">%H</span>:<span class="symbol">%M</span>:<span class="symbol">%S</span>`</span><br><span class="line">echo <span class="string">" $d1.    [ 0 */2 * * *  sh /fei/test.sh ] "</span> &gt;&gt; /fei/<span class="keyword">ccc</span>.txt</span><br><span class="line"></span><br><span class="line">d<span class="number">1</span>=`date +<span class="symbol">%Y-</span><span class="symbol">%m-</span><span class="symbol">%d-</span><span class="symbol">%H</span>:<span class="symbol">%M</span>:<span class="symbol">%S</span>`</span><br><span class="line">echo <span class="string">" $d1.    [ 0 2 * * *  sh /fei/test.sh ] "</span> &gt;&gt; /fei/<span class="keyword">ccc</span>.txt</span><br><span class="line"></span><br><span class="line">d<span class="number">1</span>=`date +<span class="symbol">%Y-</span><span class="symbol">%m-</span><span class="symbol">%d-</span><span class="symbol">%H</span>:<span class="symbol">%M</span>:<span class="symbol">%S</span>`</span><br><span class="line">echo <span class="string">" $d1.    [ * */1 * * *  sh /fei/test.sh ] "</span> &gt;&gt; /fei/<span class="keyword">ccc</span>.txt</span><br></pre></td></tr></table></figure><p><img src="/img/centos/crontab/crontab_01.png" alt="定时任务" title="定时任务"></p><p><img src="/img/centos/crontab/crontab_02.png" alt="定时任务" title="定时任务"></p><p><img src="/img/centos/crontab/crontab_03.png" alt="定时任务" title="定时任务"></p><p><img src="/img/centos/crontab/crontab_04.png" alt="定时任务" title="定时任务"></p><p><img src="/img/centos/crontab/crontab_05.png" alt="定时任务" title="定时任务"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-适配器模式</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_05_%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_05_%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>将一个类的接口转换成客户希望的另外一个接口。适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 适配器模式   -------- 其实平时一直在使用,没有起个名字, 呵呵呵</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 服务器端的代码</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weather</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $today = [<span class="string">'temperature'</span> =&gt; <span class="number">25</span>, <span class="string">'wind'</span> =&gt; <span class="number">7</span>, <span class="string">'sun'</span> =&gt; <span class="string">'sunny'</span>];</span><br><span class="line">        <span class="keyword">return</span> serialize($today);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= 客户端调用 ==========</span></span><br><span class="line">$weather = unserialize(weather::show());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'温度: '</span>, $weather[<span class="string">'temperature'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'风力: '</span>, $weather[<span class="string">'wind'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'阳光: '</span>, $weather[<span class="string">'sun'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 来了一批手机上的 java 客户端,不认识 PHP 的串行化后的字符串,怎么办?</span></span><br><span class="line"><span class="comment">//  把服务器端的代码改了?? ---旧的客户端又会受影响???</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 增加一个适配器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdapterWeather</span> <span class="keyword">extends</span> <span class="title">weather</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $today = <span class="keyword">parent</span>::show();</span><br><span class="line">        $today = unserialize($today);</span><br><span class="line">        $today = json_encode($today);</span><br><span class="line">        <span class="keyword">return</span> $today;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// =====  客户端调用 ======</span></span><br><span class="line">$todayWeather = AdapterWeather::show();</span><br><span class="line">$todayWeather = json_decode($todayWeather, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'温度: '</span>, $weather[<span class="string">'temperature'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'风力: '</span>, $weather[<span class="string">'wind'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'阳光: '</span>, $weather[<span class="string">'sun'</span>], <span class="string">'&lt;br&gt;'</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-观察者模式</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_04_%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_04_%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>当对象间存在一对多关系时，则使用观察者模式（Observer Pattern）。比如，当一个对象被修改时，则会自动通知它的依赖对象。观察者模式属于行为型模式。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------PHP 实现观察者模式</span></span><br><span class="line"><span class="comment">// php5中提供观察者 observer 与被观察者 subject 的接口</span></span><br><span class="line"><span class="comment">// @link http://php.net/manual/zh/class.splsubject.php</span></span><br><span class="line"><span class="comment">// @link http://php.net/manual/zh/class.splobjectstorage.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">implements</span> <span class="title">SplSubject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  attach()  detach()  notify()  PHP自带</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span><span class="params">(SplObserver $observer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement attach() method.</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;observers-&gt;attach($observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span><span class="params">(SplObserver $observer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement detach() method.</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;observers-&gt;detach($observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement notify() method.</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;observers-&gt;rewind();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">$this</span>-&gt;observers-&gt;valid()) &#123;</span><br><span class="line">            $observer = <span class="keyword">$this</span>-&gt;observers-&gt;current();</span><br><span class="line">            $observer-&gt;update(<span class="keyword">$this</span>); <span class="comment">// 参数</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;observers-&gt;next();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//--------------------------------------------</span></span><br><span class="line">    <span class="keyword">public</span> $lognum;</span><br><span class="line">    <span class="keyword">public</span> $hobby;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $observers = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($hobby)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;lognum = rand(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;hobby = $hobby;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observers = <span class="keyword">new</span> SplObjectStorage();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 操作 session...</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;notify();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">security</span> <span class="keyword">implements</span> <span class="title">SplObserver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(SplSubject $subject)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement update() method.</span></span><br><span class="line">        <span class="keyword">if</span> ($subject-&gt;lognum &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'这是第 '</span> . $subject-&gt;lognum . <span class="string">' 次安全登录 '</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'这是第'</span> . $subject-&gt;lognum . <span class="string">' 次安全登录,异常 '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ad</span> <span class="keyword">implements</span> <span class="title">SplObserver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(SplSubject $subject)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement update() method.</span></span><br><span class="line">        <span class="keyword">if</span> ($subject-&gt;hobby == <span class="string">'sports'</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">' 台球英锦赛门票预订 '</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">' 好好学习,天天向上 '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实施观察</span></span><br><span class="line">$user = <span class="keyword">new</span> user(<span class="string">'sports'</span>);</span><br><span class="line">$user-&gt;attach(<span class="keyword">new</span> security());</span><br><span class="line">$user-&gt;attach(<span class="keyword">new</span> ad());</span><br><span class="line"></span><br><span class="line">$user-&gt;login();</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-桥接模式</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_06_%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_06_%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>将抽象部分与实现部分分离，使它们都可以独立的变化。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 桥接模式 bridge</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 论坛给用户发消息,可以是站内短息,email,手机</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $send = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($send)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;send = $send;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">msg</span><span class="params">($content)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($to, $content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;msg($content);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;send-&gt;send($to, $content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">zn</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($to, $content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">' 站内给 '</span>, $to, <span class="string">' 内容是: '</span>, $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">email</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($to, $content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">' email给 '</span>, $to, <span class="string">' 内容是: '</span>, $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sms</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($to, $content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">' sms给 '</span>, $to, <span class="string">' 内容是: '</span>, $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">commonInfo</span> <span class="keyword">extends</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">msg</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement msg() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">' 普通 '</span> . $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">warnInfo</span> <span class="keyword">extends</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">msg</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement msg() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">' 紧急 '</span> . $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dangerInfo</span> <span class="keyword">extends</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">msg</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement msg() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">' 特急 '</span> . $content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用站内发普通消息</span></span><br><span class="line">$commonInfo = <span class="keyword">new</span> commonInfo(<span class="keyword">new</span> zn());</span><br><span class="line">$commonInfo-&gt;send(<span class="string">'小飞飞'</span>, <span class="string">'hello world'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="comment">// 用手机发特急信息</span></span><br><span class="line">$dangerInfo = <span class="keyword">new</span> commonInfo(<span class="keyword">new</span> sms());</span><br><span class="line">$dangerInfo-&gt;send(<span class="string">'飞'</span>, <span class="string">'这是手机信息'</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-单例模式</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_03_%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_03_%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h3 id="单例模式-三私一公"><a href="#单例模式-三私一公" class="headerlink" title="单例模式( 三私一公 )"></a>单例模式( 三私一公 )</h3><ol><li>私有的构造方法( 防止类被多次实例化 )</li><li>私有的克隆方法( 防止类被多次克隆 )</li><li>私有的静态属性( 保存类的实例 )</li><li>公有的静态方法( 访问这个类 )</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单例模式 singleton</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">singleton</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $ins = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getIns</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>::$ins == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>::$ins = <span class="keyword">new</span> <span class="keyword">self</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$ins;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 封锁多次 new</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 封锁克隆 clone</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$s1 = singleton::getIns();</span><br><span class="line">$s2 = singleton::getIns();</span><br><span class="line"><span class="keyword">if</span> ($s1 === $s2) &#123;  <span class="comment">//是一个对象</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"是一个对象"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"不是一个对象"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-工厂方法</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_02_%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_02_%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<h3 id="工厂方法"><a href="#工厂方法" class="headerlink" title="工厂方法"></a>工厂方法</h3><p>定义一个创建对象的接口，让其子类自己决定实例化哪一个工厂类，工厂模式使其创建过程延迟到子类进行。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 工厂方法</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">conn</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解决简单工厂中在扩展 其他数据库问题,</span></span><br><span class="line"><span class="comment">// 比如新增 oracle 数据库 (开闭原则:对于修改是封闭,对于扩展是开放)</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Factory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createDB</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//服务端开发(不知道将会被谁调用)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbmysql</span> <span class="keyword">implements</span> <span class="title">db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">conn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement conn() method.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">" 连接上Mysql "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbsqlite</span> <span class="keyword">implements</span> <span class="title">db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">conn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement conn() method.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">" 连接上了sqlite "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysqlFactory</span> <span class="keyword">implements</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createDB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement createDB() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> dbmysql();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sqliteFactory</span> <span class="keyword">implements</span> <span class="title">Factory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createDB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement createDB() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> dbsqlite();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =====  客户端开始 ====</span></span><br><span class="line">$mysql_factory = <span class="keyword">new</span> mysqlFactory();</span><br><span class="line">$mysql_create = $mysql_factory-&gt;createDB();</span><br><span class="line">$mysql_create-&gt;conn();</span><br><span class="line"></span><br><span class="line">$sqlite_factory = <span class="keyword">new</span> sqliteFactory();</span><br><span class="line">$sqlite_create = $sqlite_factory-&gt;createDB();</span><br><span class="line">$sqlite_create-&gt;conn();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//  新增 oracle 数据库</span></span><br><span class="line"><span class="comment">//  现在要在服务器端添加 oracle 类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dboracle</span> <span class="keyword">implements</span> <span class="title">db</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">conn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement conn() method.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"连接上 oracle 数据库"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">oracleFactory</span> <span class="keyword">implements</span> <span class="title">Factory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createDB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement createDB() method.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> dboracle();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$oracle_factory = <span class="keyword">new</span> oracleFactory();</span><br><span class="line">$oracle_create = $oracle_factory-&gt;createDB();</span><br><span class="line">$oracle_create-&gt;conn();</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-多态</title>
      <link href="/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_01%E5%A4%9A%E6%80%81/"/>
      <url>/2018/11/09/%E9%9D%A2%E8%AF%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index_01%E5%A4%9A%E6%80%81/</url>
      <content type="html"><![CDATA[<h3 id="多态满足三个条件"><a href="#多态满足三个条件" class="headerlink" title="多态满足三个条件:"></a>多态满足三个条件:</h3><ol><li><p>子类继承父类</p></li><li><p>子类重写父类</p></li><li><p>父类引用指向子类</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多态  动物(猫,狗)  猫吃鱼,牛吃草</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement eat() method.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">' 猫吃鱼 '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement eat() method.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">' 牛吃草 '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// java 中 foo(Animal $animal) ,声明 cat 和 dog 的父类 animal ,只能传递 animal 的子类</span></span><br><span class="line">    <span class="comment">// public function foo(Animal $animal)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">($animal)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $animal-&gt;eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$catClient = <span class="keyword">new</span> Client();</span><br><span class="line">$catClient-&gt;foo(<span class="keyword">new</span> Cat());</span><br><span class="line"></span><br><span class="line">$dogClietn = <span class="keyword">new</span> Client();</span><br><span class="line">$dogClietn-&gt;foo(<span class="keyword">new</span> Dog());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//  如果在 class Client 中这样写 public function foo(Animal $animal)</span></span><br><span class="line"><span class="comment">// 下面的就会报错</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pig</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">" 猪飞到上天 "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$pigClient = <span class="keyword">new</span> Client();</span><br><span class="line">$pigClient-&gt;foo(<span class="keyword">new</span> Pig());</span><br></pre></td></tr></table></figure></li></ol><p>设计模式参考地址: </p><p><a href="http://www.runoob.com/design-pattern/design-pattern-tutorial.html" target="_blank" rel="noopener">设计模式01</a></p><p><a href="https://www.w3cschool.cn/shejimoshi/design-pattern-tutorial.html" target="_blank" rel="noopener">设计模式02</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-centos 中开机自启</title>
      <link href="/2018/11/09/centos/%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/"/>
      <url>/2018/11/09/centos/%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/</url>
      <content type="html"><![CDATA[<h3 id="systemctl-设置开机启动"><a href="#systemctl-设置开机启动" class="headerlink" title="systemctl 设置开机启动"></a>systemctl 设置开机启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx     <span class="comment"># 安装nginx 做开机启动测试</span></span><br><span class="line">systemctl <span class="built_in">enable</span> nginx.service   <span class="comment"># 设为开机启动</span></span><br><span class="line">systemctl <span class="built_in">disable</span> nginx.service  <span class="comment"># 停止开机启动</span></span><br></pre></td></tr></table></figure><h3 id="修改-rc-local-设置为开机启动"><a href="#修改-rc-local-设置为开机启动" class="headerlink" title="修改 rc.local 设置为开机启动"></a>修改 rc.local 设置为开机启动</h3><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### /etc/rc.local 和 /etc/rc.d/rc.local 修改那个都行,我这里修改 /etc/rc.d/rc.local</span></span><br><span class="line">[root<span class="meta">@localhost</span> vagrant]<span class="comment"># locate rc.local</span></span><br><span class="line">/etc/rc.<span class="keyword">local</span></span><br><span class="line">/etc/rc.d/rc.<span class="keyword">local</span></span><br><span class="line">[root<span class="meta">@localhost</span> vagrant]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">在  /etc/rc.d 目录下,修改 rc.<span class="keyword">local</span> ,添加执行命令,比如  mkdir /fei_03   </span><br><span class="line">创建一个名字叫 fei_03 的目录; 然后 chmod +x /etc/rc.d/rc.<span class="keyword">local</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##### ---- 温馨提示,请注意 rc.local 文件里面有个提示如下, </span></span><br><span class="line"><span class="comment"># Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure</span></span><br><span class="line"><span class="comment"># that this script will be executed during boot.</span></span><br></pre></td></tr></table></figure><p><img src="/img/centos/other/start_up.png" alt="开机启动" title="开机启动"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-算法01</title>
      <link href="/2018/10/31/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95/"/>
      <url>/2018/10/31/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95/</url>
      <content type="html"><![CDATA[<h3 id="01-羊生羊"><a href="#01-羊生羊" class="headerlink" title="01).  羊生羊"></a>01).  羊生羊</h3><p>一种羊, 第一年生一只小羊, 第四年生生一只小羊, 第五年死 20年后有多少只羊</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$arr = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt;= <span class="number">20</span>; $i++) &#123;</span><br><span class="line">    $tmp = $arr[<span class="number">1</span>] + $arr[<span class="number">3</span>];</span><br><span class="line">    array_unshift($arr, $tmp);</span><br><span class="line">    array_pop($arr);</span><br><span class="line">&#125;</span><br><span class="line">print_r($arr);</span><br><span class="line"><span class="keyword">echo</span> array_sum($arr);</span><br></pre></td></tr></table></figure><h3 id="02-猴子选大王"><a href="#02-猴子选大王" class="headerlink" title="02). 猴子选大王"></a>02). 猴子选大王</h3><p>一群猴子排成一圈，按1,2,…,n依次编号。然后从第1只开始数，数到第m只,把它踢出圈，从它后面再开始数，再数到第m只，在把它踢出去…，如此不停的进行下去，直到最后只剩下一只猴子为止，那只猴子就叫做大王。要求编程模拟此过程，输入m、n, 输出最后那个大王的编号。用程序模拟该过程</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">monkey</span><span class="params">($n ,$m)</span></span>&#123;</span><br><span class="line">    $arr = range(<span class="number">1</span>,$n);     <span class="comment">//构造数组  array(1,2,3,4,5,6,7,8);</span></span><br><span class="line">    $i = <span class="number">0</span>;                 <span class="comment">//设置数组指针</span></span><br><span class="line">    <span class="keyword">while</span>(count($arr)&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">//遍历数组，判断当前猴子是否为出局序号，如果是则出局，否则放到数组最后</span></span><br><span class="line">        <span class="keyword">if</span>(($i+<span class="number">1</span>) % $m ==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>($arr[$i]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//array_push() 函数向第一个参数的数组尾部添加一个或多个元素（入栈），然后返回新数组的长度。</span></span><br><span class="line">            array_push($arr ,$arr[$i]); <span class="comment">//本轮非出局猴子放数组尾部</span></span><br><span class="line">            <span class="keyword">unset</span>($arr[$i]);   <span class="comment">//删除</span></span><br><span class="line">        &#125;</span><br><span class="line">        $i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print_r(monkey(<span class="number">10</span>,<span class="number">4</span>));</span><br></pre></td></tr></table></figure><h3 id="03-10-进制-8进制-16进制-2-进制"><a href="#03-10-进制-8进制-16进制-2-进制" class="headerlink" title="03).  10 进制; 8进制; 16进制 ; 2 进制"></a>03).  10 进制; 8进制; 16进制 ; 2 进制</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生活中常用10进制</span></span><br><span class="line"><span class="comment"> * 计算机中常用2进制,8进制,16进制</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 10 进制</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">123</span>;  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;   <span class="comment">//从右到左3个位,分别是以1顶1,以1顶10,以1顶100</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">100</span> * <span class="number">1</span> + <span class="number">10</span> * <span class="number">2</span> + <span class="number">1</span> * <span class="number">3</span>; <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8 进制</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">0123</span>; <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>; <span class="comment">//从做到右3个位,分别是以1顶1,以1顶8,以1顶64</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">64</span> * <span class="number">1</span> + <span class="number">8</span> * <span class="number">2</span> + <span class="number">3</span>;  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="number">027</span>;  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="number">8</span> * <span class="number">2</span> + <span class="number">7</span>;  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//16进制   0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F</span></span><br><span class="line"><span class="comment">// A、B、C、D、E、F 不去分大小写</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">0x123</span>; <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;  <span class="comment">//从左到右3个位,分别是1顶1,以1顶16,以1顶256</span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">256</span> * <span class="number">1</span> + <span class="number">16</span> * <span class="number">2</span> + <span class="number">3</span>; <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 进制, PHP 目前不支持直接表示</span></span><br><span class="line"><span class="comment">// 从右到左,分别以1顶1,顶2,顶4,顶8...........</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  10 进制    2 进制</span></span><br><span class="line"><span class="comment"> *    5       0000 0101</span></span><br><span class="line"><span class="comment"> *   255      1111 1111, 128+64+32+16+8+4+2+1</span></span><br><span class="line"><span class="comment"> *   -1       1111 1111</span></span><br><span class="line"><span class="comment"> * 像上面8个1,到底理解成255,还是理解成-1</span></span><br><span class="line"><span class="comment"> * 这个取决于程序</span></span><br><span class="line"><span class="comment"> * 比如在 mysql 中 ,int 则理解为 -1 ,unsigned  int理解为255</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 为什么 程序员总是分不清万圣节和圣诞节? 因为 Oct 31=Dec 25</span></span><br></pre></td></tr></table></figure><h4 id="04-8瓶水-其中1瓶有毒-那小白鼠做试验-药效发挥需要2小时"><a href="#04-8瓶水-其中1瓶有毒-那小白鼠做试验-药效发挥需要2小时" class="headerlink" title="04). 8瓶水,其中1瓶有毒,那小白鼠做试验,药效发挥需要2小时"></a>04). 8瓶水,其中1瓶有毒,那小白鼠做试验,药效发挥需要2小时</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 8瓶水,其中1瓶有毒,拿小白鼠做试验,药效发挥需要2小时,最少需要几只老鼠,只能试一次</span></span><br><span class="line"><span class="comment">// 分析:</span></span><br><span class="line"><span class="comment">//       2 个小时后,小白鼠,只有2种状态: 死/活</span></span><br><span class="line"><span class="comment">//       2只小白鼠,有4中组合状态;</span></span><br><span class="line"><span class="comment">//       n只小白鼠有2^n 次方组合状态</span></span><br><span class="line"><span class="comment">//       一共有8瓶药水,最多需要8中状态,就可以区分</span></span><br><span class="line"><span class="comment">//       3只老鼠,组合8种状态</span></span><br><span class="line"><span class="comment">//       因此理论上与3只老鼠就可以</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 思路:</span></span><br><span class="line"><span class="comment">//      把8瓶药水分成两堆,让一只老鼠在其中一堆里面喝水,如果死了,毒药就在这堆里面,</span></span><br><span class="line"><span class="comment">//      反之,毒药就在另外一堆里面, 然后</span></span><br><span class="line"><span class="comment">//      把有毒药的那一堆分成2堆,让第2只老鼠在其中一堆里喝,如果喝死毒药就在这堆里面,</span></span><br><span class="line"><span class="comment">//      反之,毒药就在另外一堆里面, 然后</span></span><br><span class="line"><span class="comment">//      把有毒要的那一堆再分成2堆,让第三只老鼠喝就能知道毒药在几号里</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 解答:</span></span><br><span class="line"><span class="comment">//     1代表活着,0代表死</span></span><br><span class="line"><span class="comment">//     毒药:      1 2 3 4 5 6 7 8</span></span><br><span class="line"><span class="comment">//     白鼠1:     0 0 0 0 1 1 1 1</span></span><br><span class="line"><span class="comment">//     白鼠2:     0 0 1 1 0 0 1 1</span></span><br><span class="line"><span class="comment">//     白鼠3:     0 1 0 1 0 1 0 1</span></span><br><span class="line"><span class="comment">//    </span></span><br><span class="line"><span class="comment">//     白鼠一死, 毒药在 1 2 3 4</span></span><br><span class="line"><span class="comment">//     白鼠二死, 毒药在 3 4</span></span><br><span class="line"><span class="comment">//     白鼠三死, 毒药在 4</span></span><br></pre></td></tr></table></figure><h3 id="05-递归"><a href="#05-递归" class="headerlink" title="05). 递归"></a>05). 递归</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">($n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $n + sum($n<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> sum(<span class="number">100</span>);</span><br></pre></td></tr></table></figure><h4 id="06-PHP实现斐波那契数列"><a href="#06-PHP实现斐波那契数列" class="headerlink" title="06). PHP实现斐波那契数列"></a>06). PHP实现斐波那契数列</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> <span class="number">55</span> .........</span><br><span class="line"></span><br><span class="line"><span class="comment">//用递归实现 输出某一位的数字</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fbnq</span><span class="params">($n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>($n == <span class="number">1</span> || $n == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> fbnq($n - <span class="number">1</span>) + fbnq($n - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> fbnq(<span class="number">10</span>);  <span class="comment">//输出第十个数是 55</span></span><br><span class="line"><span class="comment">//经典案例</span></span><br><span class="line"><span class="comment">//有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少 (注意:这里是总数,还是对, 斐波那契数列结果是对)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第30位数字的值</span></span><br><span class="line">$arr = [<span class="number">1</span>,<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">2</span>; $i &lt; <span class="number">30</span>; $i++) &#123; </span><br><span class="line">$arr[$i]=$arr[$i<span class="number">-1</span>]+$arr[$i<span class="number">-2</span>];</span><br><span class="line">&#125;</span><br><span class="line">var_dump($arr);</span><br></pre></td></tr></table></figure><h3 id="07-静态变量"><a href="#07-静态变量" class="headerlink" title="07). 静态变量"></a>07). 静态变量</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  静态变量</span></span><br><span class="line"><span class="comment"> *  static 变量有一个特点,在第一次调用声明之后存在,切不随函数结束而结束</span></span><br><span class="line"><span class="comment"> *  当函数再次调用时,可以直接利用上次的结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> $a = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// $a = 5;</span></span><br><span class="line">    $a += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> $a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> t();</span><br><span class="line"><span class="keyword">echo</span> t();</span><br><span class="line"><span class="keyword">echo</span> t();</span><br></pre></td></tr></table></figure><h3 id="08-递归练习-计算所有单元的和"><a href="#08-递归练习-计算所有单元的和" class="headerlink" title="08). 递归练习,计算所有单元的和"></a>08). 递归练习,计算所有单元的和</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归函数,计算所有单元的和</span></span><br><span class="line">$arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span>  $sum = <span class="number">0</span>;  <span class="comment">// static 当函数再次调用时,可以直接利用上次的结果</span></span><br><span class="line">    <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($value)) &#123;</span><br><span class="line">            sum($value);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $sum += $value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> sum($arr);</span><br></pre></td></tr></table></figure><h3 id="09-递归练习-一个多维数组-如果单元值为数字-则把其值修改为原来2倍"><a href="#09-递归练习-一个多维数组-如果单元值为数字-则把其值修改为原来2倍" class="headerlink" title="09). 递归练习  一个多维数组,如果单元值为数字,则把其值修改为原来2倍"></a>09). 递归练习  一个多维数组,如果单元值为数字,则把其值修改为原来2倍</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一个多维数组,如果单元值为数字,则把其值修改为原来2倍</span></span><br><span class="line"><span class="comment">// 方法1</span></span><br><span class="line">$arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="string">'b'</span>, [<span class="number">3</span>, <span class="string">'c'</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $key=&gt;$value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($value)) &#123;</span><br><span class="line">            $arr[$key] = double($arr[$key]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_numeric($value)) &#123;</span><br><span class="line">                $arr[$key] *= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">print_r( double($arr));</span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////-----------------------</span></span><br><span class="line"><span class="comment">// 方法2 ,使用系统函数 array_walk_recursive</span></span><br><span class="line"><span class="comment">// @see http://php.net/manual/zh/function.array-walk-recursive.php</span></span><br><span class="line">$crr = [<span class="number">1</span>, <span class="number">2</span>, <span class="string">'b'</span>, [<span class="number">3</span>, <span class="string">'c'</span>, [<span class="number">5</span>, <span class="number">6</span>]]];;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double_2</span><span class="params">(&amp;$crr,$key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_numeric($crr)) &#123;</span><br><span class="line">        $crr*=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array_walk_recursive($crr, <span class="string">'double_2'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">print_r($crr);</span><br></pre></td></tr></table></figure><h3 id="10-递归创建目录"><a href="#10-递归创建目录" class="headerlink" title="10). 递归创建目录"></a>10). 递归创建目录</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$filepath = <span class="string">"./test/upload/2018/test.txt"</span>;</span><br><span class="line"></span><br><span class="line">mk_dir($filepath);</span><br><span class="line"><span class="comment">//  循环创建目录</span></span><br><span class="line"><span class="comment">//  注意,$filepath 最后的文件,名字也会被当成目录创建</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mk_dir</span><span class="params">($dir, $mode = <span class="number">0755</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_dir($dir) || @mkdir($dir,$mode)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!mk_dir(dirname($dir),$mode)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> @mkdir($dir,$mode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////-----------------------</span></span><br><span class="line"><span class="comment">// 方法2 ,使用系统函数 mkdir  第三个参数</span></span><br><span class="line"><span class="comment">// @see http://www.php.net/mkdir</span></span><br><span class="line"><span class="comment">//  注意,$filepath 最后的文件,名字也会被当成目录创建</span></span><br><span class="line">$filepath = <span class="string">"./test/upload/2018/test.txt"</span>;</span><br><span class="line">mkdir($filepath, <span class="number">0755</span>, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>--JavaScript -3种事件绑定</title>
      <link href="/2018/10/27/JavaScript/JavaScript_15_%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A/"/>
      <url>/2018/10/27/JavaScript/JavaScript_15_%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A/</url>
      <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 第一种绑定:行为结构不分离,效率也低    </span></span><br><span class="line"><span class="comment"> * &lt;a onclick="xxx()"&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  第二种绑定:只能绑定1个事件</span></span><br><span class="line"><span class="comment"> *  xxxDomObject.onclick = function()&#123;&#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  第三种绑定: addEventLister</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个页面的 js 由多人团队开发;</span></span><br><span class="line"><span class="comment">// A,B 都在写 onload 事件</span></span><br><span class="line"><span class="comment">// 则 后面的事件,吧前面的onload 属性值都给覆盖了</span></span><br><span class="line"><span class="comment">// 这里只会输出 world</span></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">"hello"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'world'</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-- JavaScript -面向对象之静态方法</title>
      <link href="/2018/10/27/JavaScript/JavaScript_13_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95/"/>
      <url>/2018/10/27/JavaScript/JavaScript_13_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>JS 面向对象中的静态方法<br>1: 构造函数通过 new 来制造对象<br>2: 函数本身也是对象</p><p>比如一台豆浆机,转动 (new 调用)时,能返回一杯豆浆(制造出的对象)<br>但反观豆浆机本身,也是台机器,也是个对象<br>豆浆机身上也有属性—如开关,进水口等</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  JS 面向对象中的静态方法</span></span><br><span class="line"><span class="comment"> *  1: 构造函数通过 new 来制造对象</span></span><br><span class="line"><span class="comment"> *  2: 函数本身也是对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  比如一台豆浆机,转动 (new 调用)时,能返回一杯豆浆(制造出的对象)</span></span><br><span class="line"><span class="comment"> *  但反观豆浆机本身,也是台机器,也是个对象</span></span><br><span class="line"><span class="comment"> *  豆浆机身上也有属性---如开关,进水口等</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// var Hashiqi = function () &#123;</span></span><br><span class="line"><span class="comment">//     this.bark=function () &#123;</span></span><br><span class="line"><span class="comment">//         console.log('www');</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//上面这个 等效 下面这个</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hashiqi</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.bark= <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'www'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Hashiqi.ajax = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ajax'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// var h = new Hashiqi(); //h方法有没有ajax方法?? 答:没有,豆浆机上的开关会跑到豆浆里面吗?</span></span><br><span class="line"><span class="comment">// console.log(h);</span></span><br><span class="line"><span class="built_in">console</span>.log(Hashiqi.ajax);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  即:</span></span><br><span class="line"><span class="comment"> *  1: ajax() 方法是属于"函数"本省的,和返回的对象没有关系</span></span><br><span class="line"><span class="comment"> *  2: bark要调用,必须 new Hashiqi()得到对象,切由返回对象才能调用,</span></span><br><span class="line"><span class="comment"> *  3: ajax()方法要调用,不需要 new 对象,直接用 Hashiqi 来调用.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// h.bark();</span></span><br><span class="line">Hashiqi.ajax();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 我们之前有没有接触过静态方法?</span></span><br><span class="line"><span class="comment"> * 答: 有</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 1: Math.random(); 静态方法</span></span><br><span class="line"><span class="comment"> * 2:$.ajax();  静态方法</span></span><br><span class="line"><span class="comment"> * 3:写 jQuery 插件,2种办法</span></span><br><span class="line"><span class="comment"> *      3.1: 通过闭包,把方法写到 jQuery 上的原型上( 稍复杂)</span></span><br><span class="line"><span class="comment"> *      3.3; 直接增加 $ 对象的静态方法</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-1.9.1.js"</span>&gt;</span><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="comment">//---------------- demo ------------</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">//通过静态方法给 jQuery 增加唱歌插件</span></span></span><br><span class="line"><span class="javascript">    $.sing = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">        alert(<span class="string">'人生最大的悲剧莫过于失去自由 人生最大的痛苦莫过于失去亲人和朋友'</span>);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="javascript">    $.sing();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-JavaScript  -闭包</title>
      <link href="/2018/10/24/JavaScript/JavaScript_06_%E9%97%AD%E5%8C%85/"/>
      <url>/2018/10/24/JavaScript/JavaScript_06_%E9%97%AD%E5%8C%85/</url>
      <content type="html"><![CDATA[<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>一句话概括 :函数的作用域取决于声明时,而不取决一调用是!!<br>函数的作用取决于声明时,而非调用时</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(age)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> t2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tmp = t1();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  1: 在大部分的语言中, t1 被调用执行,则申请内存</span></span><br><span class="line"><span class="comment"> *  并把其局部变量, push 入栈!!!</span></span><br><span class="line"><span class="comment"> *  t1 函数 执行完毕,内部的局部变量,随着函数的退出而销毁</span></span><br><span class="line"><span class="comment"> *  因此, age = 20 的局部变量,依靠已经消失了</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  但是在 js 中 , age = 20 这个变量,却被 t2 捕捉,</span></span><br><span class="line"><span class="comment"> *  即使 t1 执行完毕,通过 t2 依然能访问该变量</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  这种情况---返回的函数,并非孤立的函数,甚至吧其周围的变量环境.</span></span><br><span class="line"><span class="comment"> *  形成了一封闭的"环境包",并同返回,所以叫"闭包"</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  ----  一句话概括---  函数的作用域取决于声明时,而不取决一调用是!!</span></span><br><span class="line"><span class="comment"> * @type &#123;number&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">99</span>;</span><br><span class="line">tmp();<span class="comment">// 输出 20</span></span><br></pre></td></tr></table></figure><h3 id="函数的作用取决于声明时-而非调用时"><a href="#函数的作用取决于声明时-而非调用时" class="headerlink" title="函数的作用取决于声明时,而非调用时"></a>函数的作用取决于声明时,而非调用时</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closure</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sister = <span class="string">'大桃花'</span>;</span><br><span class="line">    <span class="keyword">var</span> me = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(sister);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> me;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">place</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sister = <span class="string">'大福晋'</span>;</span><br><span class="line">    <span class="keyword">var</span> girl = closure();</span><br><span class="line">    girl();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">place();  <span class="comment">// 输出 大桃花</span></span><br></pre></td></tr></table></figure><h3 id="闭包计数器01"><a href="#闭包计数器01" class="headerlink" title="闭包计数器01"></a>闭包计数器01</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多个人开发 js 程序,需要一个全局的计数器</span></span><br><span class="line"><span class="comment">// 多个人的函数共同用一个计数器,计数器一直增长</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解决办法:</span></span><br><span class="line"><span class="comment"> *  1: 设立一个全局变量</span></span><br><span class="line"><span class="comment"> *  window.cat = 0;</span></span><br><span class="line"><span class="comment"> *  调用 ++window.cnt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  这个办法可行,但是污染了全局变量,</span></span><br><span class="line"><span class="comment"> *  其次引入了多人的 js 程序,别人的程序里,也有一个 window.cnt = 'hello';</span></span><br><span class="line"><span class="comment"> *  该计数器就损坏了,(所以要尽量避免用全局变量)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="闭包计数器02-—-闭包维护一个别人污染不到的变量-做计数器"><a href="#闭包计数器02-—-闭包维护一个别人污染不到的变量-做计数器" class="headerlink" title="闭包计数器02  — 闭包维护一个别人污染不到的变量,做计数器"></a>闭包计数器02  — 闭包维护一个别人污染不到的变量,做计数器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 闭包维护一个别人污染不到的变量,做计数器</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cnt = <span class="number">0</span>; <span class="comment">// 当 ccounter 执行完毕后,除了返回的 cnter 函数,谁也别想碰到 cnt 变量了</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> cnter = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++cnt;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> cnter;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> inc = counter();</span><br><span class="line"><span class="built_in">console</span>.log(inc());</span><br><span class="line"><span class="built_in">console</span>.log(inc());</span><br><span class="line"><span class="built_in">console</span>.log(inc());</span><br><span class="line"></span><br><span class="line"><span class="comment">//-----------简化版-----------</span></span><br><span class="line"><span class="keyword">var</span> cnt = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> ++cnt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(cnt());</span><br><span class="line"><span class="built_in">console</span>.log(cnt());</span><br><span class="line"><span class="built_in">console</span>.log(cnt());</span><br></pre></td></tr></table></figure><h3 id="闭包计数器03-—在工作中-一般如何避免全局污染或冲突"><a href="#闭包计数器03-—在工作中-一般如何避免全局污染或冲突" class="headerlink" title="闭包计数器03  —在工作中,一般如何避免全局污染或冲突"></a>闭包计数器03  —在工作中,一般如何避免全局污染或冲突</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  疑问: cnt 不依然是全局变量吗?</span></span><br><span class="line"><span class="comment">*  第3版---在工作中,一般如何避免全局污染或冲突</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  1: 统一放在一个全局对象上,如 jQuery-&gt;$</span></span><br><span class="line"><span class="comment">*  2:每个人用自己的命名空间</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// jQuery 的计数插件形式</span></span><br><span class="line">$ = &#123;&#125;;</span><br><span class="line">$.cnt = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log($.cnt());</span><br><span class="line"><span class="built_in">console</span>.log($.cnt());</span><br><span class="line"><span class="built_in">console</span>.log($.cnt());</span><br></pre></td></tr></table></figure><h3 id="闭包计数器04-–-把自己的变量-函数-都放在一个对象里"><a href="#闭包计数器04-–-把自己的变量-函数-都放在一个对象里" class="headerlink" title="闭包计数器04   – 把自己的变量,函数,都放在一个对象里"></a>闭包计数器04   – 把自己的变量,函数,都放在一个对象里</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第4版 个人命名空间,在团队开发中也很常见</span></span><br><span class="line"><span class="comment">// 其实就是把自己的变量,函数,都放在一个对象里</span></span><br><span class="line"><span class="keyword">var</span> Y18 = &#123;&#125;;</span><br><span class="line">Y18.cnt = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ++cnt;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(Y18.cnt());</span><br><span class="line"><span class="built_in">console</span>.log(Y18.cnt());</span><br><span class="line"><span class="built_in">console</span>.log(Y18.cnt());</span><br></pre></td></tr></table></figure><h3 id="demo-练习"><a href="#demo-练习" class="headerlink" title="demo 练习"></a>demo 练习</h3><p>要求:点击 li ,分别弹出 0,1,2,3</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>男<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>女<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>老<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>少<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="comment">//要求:点击 li ,分别弹出 0,1,2,3</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, lis = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>), len = lis.length; i &lt; len; i++) &#123;</span></span><br><span class="line"><span class="actionscript">        lis[i].onclick = (<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> p=i;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> alert(p);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)();</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-JavaScript -this</title>
      <link href="/2018/10/22/JavaScript/JavaScript_04_this/"/>
      <url>/2018/10/22/JavaScript/JavaScript_04_this/</url>
      <content type="html"><![CDATA[<p>js 的 this 到底是谁???  js 中函数的4中条用方式</p><h3 id="1-作为普通函数来调用"><a href="#1-作为普通函数来调用" class="headerlink" title="1). 作为普通函数来调用"></a>1). 作为普通函数来调用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  console.log(window.xxx);</span></span><br><span class="line"><span class="comment"> *  1: 作为普通函数来调用时,</span></span><br><span class="line"><span class="comment"> *  this 的值指向--&gt;window</span></span><br><span class="line"><span class="comment"> *  准确的说,this 为 null ,但被解释成 window</span></span><br><span class="line"><span class="comment"> *  在 ECMAScript 表准中, 如果 this 为 null ,则解释成 undefined</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.xxx); <span class="comment">//undefined</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.xxx = <span class="number">333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.xxx);<span class="comment">// 输出 333</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.test_window);</span><br><span class="line">&#125;</span><br><span class="line">test(); <span class="comment">//输出  undefined</span></span><br></pre></td></tr></table></figure><h3 id="作为对象的方法来调用"><a href="#作为对象的方法来调用" class="headerlink" title="作为对象的方法来调用"></a>作为对象的方法来调用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2: 作为对象的方法来调用</span></span><br><span class="line"><span class="comment"> * this 指向方法的调用这,即该对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    xx: <span class="number">99</span>, <span class="attr">yy</span>: <span class="number">88</span>, <span class="attr">t</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.xx);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.t();  <span class="comment">// 输出 99</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = &#123;<span class="attr">xx</span>: <span class="string">'wangwang'</span>&#125;;</span><br><span class="line">dog.t = obj.t;</span><br><span class="line">dog.t(); <span class="comment">// 输出 wangwang</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 作为方法调用时,</span></span><br><span class="line"><span class="comment"> * this 指向其调用那一刻的调用者,即母体对象</span></span><br><span class="line"><span class="comment"> * 不管被调用函数,声明时属于方法,还是函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">show = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'show'</span> + <span class="keyword">this</span>.xx);</span><br><span class="line">&#125;</span><br><span class="line">dog.t = show;</span><br><span class="line">dog.t(); <span class="comment">// show wangwang</span></span><br></pre></td></tr></table></figure><h3 id="函数作为构造函数调用时"><a href="#函数作为构造函数调用时" class="headerlink" title="函数作为构造函数调用时"></a>函数作为构造函数调用时</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 3: 函数作为构造函数调用时</span></span><br><span class="line"><span class="comment"> *  js 中没有类的概念,创建对象是用构造函数来完成,或者直接用json格式&#123;&#125;来写对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  new Dog 发生了一下几个步骤</span></span><br><span class="line"><span class="comment"> *  a: x系统创建空对象 &#123;&#125; ,(空对象 constructor 属性指向 Dog 函数,先别管)</span></span><br><span class="line"><span class="comment"> *  b: 把函数的 this --&gt; 指向--&gt;该空对象</span></span><br><span class="line"><span class="comment"> *  c: 执行该函数</span></span><br><span class="line"><span class="comment"> *  d: 返回该对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.bark = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'this is '</span> + <span class="keyword">this</span>.name);  <span class="comment">//输出 this is huzi</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> Dog(<span class="string">'huzi'</span>, <span class="number">2</span>);</span><br><span class="line">dog.bark();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面这个返回什么???</span></span><br><span class="line"><span class="comment">// 分析: 输出 Pig对象:  Pig &#123;age: 99&#125;; 因为函数作为构造函数运行时,return 的值是忽略的,还是返回对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pig</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">99</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'abc'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pig = <span class="keyword">new</span> Pig();</span><br><span class="line"><span class="built_in">console</span>.log(pig);</span><br></pre></td></tr></table></figure><h3 id="函数通过-call-apply-调用"><a href="#函数通过-call-apply-调用" class="headerlink" title="函数通过 call , apply 调用"></a>函数通过 call , apply 调用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  4. 函数通过 call , apply 调用</span></span><br><span class="line"><span class="comment"> *     语法格式: 函数.call(对象,参数,参数,参数,参数........参数N.)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我的真实年龄是'</span> + <span class="keyword">this</span>.age);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'但是我一般告诉别人我'</span> + (<span class="keyword">this</span>.age + num));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> humanObject = &#123;<span class="attr">name</span>: <span class="string">'lisi'</span>, <span class="attr">age</span>: <span class="number">28</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 我的真实年龄是28</span></span><br><span class="line"><span class="comment">// 但是我一般告诉别人我18</span></span><br><span class="line">humanObject.t = t;</span><br><span class="line">humanObject.t(<span class="number">-10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接下来,我们不把 t 赋值为 human 的属性,也能把 this 指向 human</span></span><br><span class="line"><span class="comment">// 运行结果:</span></span><br><span class="line"><span class="comment">//      我的真实年龄是30</span></span><br><span class="line"><span class="comment">//      但是我一般告诉别人我35</span></span><br><span class="line"><span class="comment">// 分析:</span></span><br><span class="line"><span class="comment">// fn.call(对象obj,参数1,参数2,....参数N)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 运行如下:</span></span><br><span class="line"><span class="comment">// a):  fn 函数中的 this---&gt;指向-----&gt;obj</span></span><br><span class="line"><span class="comment">// b):  运行 fn(参数1,参数2.....参数N);</span></span><br><span class="line"><span class="keyword">var</span> wangwuObject = &#123;<span class="attr">name</span>: <span class="string">'wangwu'</span>, <span class="attr">age</span>: <span class="number">30</span>&#125;;</span><br><span class="line">t.call(wangwuObject, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// t.apply(wangwuObject,[5]);</span></span><br></pre></td></tr></table></figure><h3 id="demo-练习"><a href="#demo-练习" class="headerlink" title="demo 练习"></a>demo 练习</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">'this is window'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">'php'</span>, <span class="attr">t</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> dog = &#123;<span class="attr">name</span>: <span class="string">'huzi'</span>&#125;;</span><br><span class="line">obj.t();  <span class="comment">// 输出 php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tmp = obj.t;</span><br><span class="line">tmp(); <span class="comment">//相当于window.tmp()  输出: this is window</span></span><br><span class="line"></span><br><span class="line">dog.t = obj.t;</span><br><span class="line">dog.t(); <span class="comment">//输出 huzi</span></span><br><span class="line"></span><br><span class="line">(dog.t = obj.t)(); <span class="comment">//输出 this is window</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="keyword">this</span>.name)&#125;)(); <span class="comment">//输出 this is window</span></span><br><span class="line"><span class="comment">// 分析</span></span><br><span class="line"><span class="comment">// (dog.t = obj.t) 是一个表达式,返回值值"值",即 t 函数</span></span><br><span class="line"><span class="comment">// 强调是值,说明不是通过应用来调用的,而是立即使用函数本身</span></span><br><span class="line"><span class="comment">// 效果等同于 (function()&#123;console.log(this.name)&#125;)</span></span><br><span class="line"><span class="comment">// null 又被解释成 window</span></span><br></pre></td></tr></table></figure><h3 id="其他-window-全局变量污染"><a href="#其他-window-全局变量污染" class="headerlink" title="其他 window 全局变量污染"></a>其他 window 全局变量污染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  有一些经验的,但对 js 理解的不深的同学说:</span></span><br><span class="line"><span class="comment"> *  有 this 操作的,(如 this.age=xx ) 的函数不能直接用,而是要new 来调用?????</span></span><br><span class="line"><span class="comment"> *  答: 因为直接用, this 会指向 window ,将会污染去全局变量</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-JavaScript arguments</title>
      <link href="/2018/10/21/JavaScript/JavaScript_03_arguments/"/>
      <url>/2018/10/21/JavaScript/JavaScript_03_arguments/</url>
      <content type="html"><![CDATA[<p>argumets 是什么? </p><p>答: 是一个对象,是一个长得很像数组的对象  </p><p>arguments 内容是什么???  </p><p>答: arguments是函数运行时的实体参数列表</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 函数运行期内,关键的三个对象</span></span><br><span class="line"><span class="comment">*  AO -----&gt; 本函数 AO 上没有某属性,则继续去外层函数的</span></span><br><span class="line"><span class="comment">*  arguments -----&gt; 每个函数都有自己的 callee ,但 不 向外层接着找 arguments 的相关属性,即 不形成链</span></span><br><span class="line"><span class="comment">*  this</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="demo-01-arguments-是什么"><a href="#demo-01-arguments-是什么" class="headerlink" title="demo_01   arguments 是什么?"></a>demo_01   arguments 是什么?</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">d, e, f</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 在此函数中无法用 d,e,f 形参来取的 'haha',因为没有相对应的形参</span></span><br><span class="line">    <span class="comment">// 但我们可以用 arguments 来获取任意多个的实参</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">typeof</span>  <span class="built_in">arguments</span>); <span class="comment">// 输出 object</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);  <span class="comment">// 对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>[<span class="number">0</span>]); <span class="comment">// hello --&gt;长得像数组</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>[<span class="number">3</span>]);</span><br><span class="line">&#125;)(<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'!'</span>, <span class="string">'haha'</span>);</span><br></pre></td></tr></table></figure><h3 id="arguments-实际内容"><a href="#arguments-实际内容" class="headerlink" title="arguments 实际内容"></a>arguments 实际内容</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">d, e, f</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(d); <span class="comment">// 输出 hello</span></span><br><span class="line">    <span class="built_in">arguments</span>[<span class="number">0</span>] = <span class="string">'China'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(d); <span class="comment">// 输出 China ; 形参与对应的 arguments 单元,其实是互相映射的,互相影响</span></span><br><span class="line">&#125;)(<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'!'</span>, <span class="string">'haha'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//---------------------------------------</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">d, e, f</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.length); <span class="comment">// 输出长度 4 ; 实参个数</span></span><br><span class="line">&#125;)(<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'!'</span>, <span class="string">'haha'</span>);</span><br></pre></td></tr></table></figure><h3 id="递归-arguments-callee"><a href="#递归-arguments-callee" class="headerlink" title="递归 arguments.callee"></a>递归 arguments.callee</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">d, e, f</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee); <span class="comment">// 输出  function(d, e, f) &#123; console.log(arguments.callee); &#125;</span></span><br><span class="line">&#125;)(<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'!'</span>, <span class="string">'haha'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//-----------------------------</span></span><br><span class="line"><span class="comment">// 递归 , 求和,输出 5050</span></span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> n + <span class="built_in">arguments</span>.callee(n - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(<span class="number">100</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-JavaScript  词法分析期  执行期</title>
      <link href="/2018/10/21/JavaScript/JavaScript_02_%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/"/>
      <url>/2018/10/21/JavaScript/JavaScript_02_%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h3 id="词法分析期-执行期"><a href="#词法分析期-执行期" class="headerlink" title="词法分析期  执行期"></a>词法分析期  执行期</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 第一步: 先分析参数</span></span><br><span class="line"><span class="comment"> * 第二部: 在分析变量声明</span></span><br><span class="line"><span class="comment"> * 第三个: 分析函数声明</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 一个函数就能使用的局部变量,就从上面的3步分析而来</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 具体步骤:</span></span><br><span class="line"><span class="comment"> * 0: 函数运行前的一瞬间,生成 Active Object(活动对象),下称为 AO</span></span><br><span class="line"><span class="comment"> * 1:把声明的参数,形成 AO 的属性,值全是 undefined</span></span><br><span class="line"><span class="comment"> * 2:分析变量声明声明声明!!! 如 var age</span></span><br><span class="line"><span class="comment"> *      如果 AO 上还没有 age 属性,则添加 AO 属性,值是 undefined</span></span><br><span class="line"><span class="comment"> *      如果 AO 上已经有 age 属性,则不做任何影响</span></span><br><span class="line"><span class="comment"> * 3: 分析函数声明,如 function foo()&#123;&#125;</span></span><br><span class="line"><span class="comment"> *      则把函数赋给 AO.foo 属性</span></span><br><span class="line"><span class="comment"> *      注: 如果此前 foo 属性已经存在,则被无情覆盖了</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="demo-1"><a href="#demo-1" class="headerlink" title="demo_1"></a>demo_1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分析过程</span></span><br><span class="line"><span class="comment">// AO &#123;age:unfettered&#125;</span></span><br><span class="line"><span class="comment">// 运行过程:</span></span><br><span class="line"><span class="comment">// t(5)--&gt;AO.age=5; alert(AO.age);  //5</span></span><br><span class="line"><span class="comment">// t()---&gt;AO.age 没得到复制,还是 undefined</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    alert(age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t(<span class="number">5</span>); <span class="comment">// 输出 5</span></span><br><span class="line">t(); <span class="comment">//输出undefined</span></span><br></pre></td></tr></table></figure><h3 id="demo-02"><a href="#demo-02" class="headerlink" title="demo_02"></a>demo_02</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  分析过程:</span></span><br><span class="line"><span class="comment"> *  0: 形成 AO=&#123;&#125;</span></span><br><span class="line"><span class="comment"> *  1: 分析形参 AO = &#123;age:undefined&#125;</span></span><br><span class="line"><span class="comment"> *     接受形参 AO= &#123;age:5&#125;</span></span><br><span class="line"><span class="comment"> *  2: 分析 var age ,发现 AO 已经有 age属性,不做任何影响</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  执行过程:</span></span><br><span class="line"><span class="comment"> *   console.log(age);  //66</span></span><br><span class="line"><span class="comment"> *   AO.age = 66;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t2</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age= <span class="number">66</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(age); <span class="comment">//输出66</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t2(<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h3 id="demo-03"><a href="#demo-03" class="headerlink" title="demo_03"></a>demo_03</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  词法分析过程:</span></span><br><span class="line"><span class="comment"> *      0: AO = &#123;&#125;</span></span><br><span class="line"><span class="comment"> *      1: 分析参数 AO = &#123;greet:undefined&#125;</span></span><br><span class="line"><span class="comment"> *      2: 分析 greet 变量声明, AO 已经有greet 属性,因此不做任何影响</span></span><br><span class="line"><span class="comment"> *      3: 分析 greet 函数声明, AO.greet = function()&#123;&#125;, 被覆盖成函数</span></span><br><span class="line"><span class="comment"> *  执行过程</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> *      greet = 'hello';</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出greet() &#123;&#125;</span></span><br><span class="line">    <span class="keyword">var</span> greet = <span class="string">'hello'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出 hello</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出 hello</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t3(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><h3 id="demo-04"><a href="#demo-04" class="headerlink" title="demo_04"></a>demo_04</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  词法分析过程:</span></span><br><span class="line"><span class="comment"> *      0: AO = &#123;&#125;</span></span><br><span class="line"><span class="comment"> *      1: 分析参数 AO = &#123;greet:undefined&#125;</span></span><br><span class="line"><span class="comment"> *      2: 分析 greet 变量声明, AO 已经有greet 属性,因此不做任何影响</span></span><br><span class="line"><span class="comment"> *      3: 分析 greet 函数声明, AO.greet = function()&#123;&#125;, 被覆盖成函数</span></span><br><span class="line"><span class="comment"> *  执行过程</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> *      console.log(greet);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出 greet() &#123;&#125;</span></span><br><span class="line">    <span class="keyword">var</span> greet;</span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出 greet() &#123;&#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(greet);<span class="comment">// 输出 greet() &#123;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t3(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><h3 id="demo-05"><a href="#demo-05" class="headerlink" title="demo_05"></a>demo_05</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分析</span></span><br><span class="line"><span class="comment"> * 0: AO = &#123;&#125;</span></span><br><span class="line"><span class="comment"> * 1: 分析参数 AO =&#123;b:undefined&#125;</span></span><br><span class="line"><span class="comment"> *    接受参数 AO = &#123;b:2&#125;</span></span><br><span class="line"><span class="comment"> * 2: 分析 var 声明,此函数没有 var</span></span><br><span class="line"><span class="comment"> * 3: 分析函数声明, AO = &#123;b:function()&#123;console.log(b);&#125;&#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 执行期:</span></span><br><span class="line"><span class="comment"> * console.log(b)  //function</span></span><br><span class="line"><span class="comment"> * b();  //由作用域寻找到 a 函数中的 b , 即 function , console.log() 出来</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">b</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(b); <span class="comment">// 输出 b() &#123; console.log(b); &#125;   ****注意这里的注释也会被输出***</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(b); <span class="comment">// 输出 b() &#123; console.log(b); &#125;  ****注意这里的注释也会被输出***</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    b();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><h3 id="demo-06"><a href="#demo-06" class="headerlink" title="demo_06"></a>demo_06</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 词法分析</span></span><br><span class="line"><span class="comment"> *      0: AO = &#123;&#125;</span></span><br><span class="line"><span class="comment"> *      1: 分析参数 AO = &#123;b:undefined&#125; --&gt; &#123;b:2&#125;</span></span><br><span class="line"><span class="comment"> *      2: 分析 var 声明,没有</span></span><br><span class="line"><span class="comment"> *      3: 分析函数声明???  [没有!!!]!!!***</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *      (注: b = function()&#123;&#125; ,是一个赋值过程,在执行期才有用)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 执行过程</span></span><br><span class="line"><span class="comment"> *  console.log(b);</span></span><br><span class="line"><span class="comment"> *  b = function()&#123; console.log(b);  &#125;</span></span><br><span class="line"><span class="comment"> *  console.log(b);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">b</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(b);  <span class="comment">//输出 2</span></span><br><span class="line">    b = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(b); <span class="comment">// b() &#123; console.log(b); &#125;  ****注意这里的注释也会被输出***</span></span><br><span class="line">    &#125;;</span><br><span class="line">    b();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><h3 id="demo-07-函数声明-函数赋值"><a href="#demo-07-函数声明-函数赋值" class="headerlink" title="demo_07  函数声明  函数赋值"></a>demo_07  函数声明  函数赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这两种方式 效果不同</span></span><br><span class="line"><span class="comment">// t1 是函数声明,虽然全局内也得到一个 t1 变量,值是 function</span></span><br><span class="line"><span class="comment">// 而 t2 只是一个复制过程----值是谁? 值是右侧的表达式的返回结果,即函数</span></span><br><span class="line"><span class="comment">// 就是说 function ()&#123;&#125; 在js 看来,就和 2*4  8/4 一样,是一个表达式,返回一个结果</span></span><br><span class="line"><span class="comment">// 因此 , t1 t2 两种方式在词法分析是,有这本质的区别</span></span><br><span class="line"><span class="comment">// 前者 在词法分析阶段,就发挥作用</span></span><br><span class="line"><span class="comment">// 而后者,在运行阶段,才发挥作用</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t2 =<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="jQuery-最外层代码分析"><a href="#jQuery-最外层代码分析" class="headerlink" title="jQuery 最外层代码分析"></a>jQuery 最外层代码分析</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//----------------- jQuery 最外层代码分析---------------</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window, undefined</span>) </span>&#123; &#125;) <span class="comment">//内层表达式.返回值是函数,包括在小括号李,当成表达式来执行</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window, undefined</span>) </span>&#123; &#125;(<span class="built_in">window</span>)) <span class="comment">//立即调用</span></span><br><span class="line"><span class="comment">// 而内层函数又没有起名字,成为匿名函数</span></span><br><span class="line"><span class="comment">// 这种手法,匿名函数,立即执行,不污染全局, 称为 立即执行匿名函数表达式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------  思路: 为什么传 window , 而又不会传 undefined ???--------------</span></span><br><span class="line"><span class="comment">//------------------  传window 是为了速度 --------------</span></span><br><span class="line"><span class="comment">// function () &#123;</span></span><br><span class="line"><span class="comment">//     function () &#123;</span></span><br><span class="line"><span class="comment">//         function () &#123;</span></span><br><span class="line"><span class="comment">//             function () &#123;</span></span><br><span class="line"><span class="comment">//                 document.getElementById........  //这个 document 将会向作用域层层上找,直到最外层</span></span><br><span class="line"><span class="comment">//             &#125;</span></span><br><span class="line"><span class="comment">//         &#125;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// jQuery 就是为了加快内部查找局部变量的速度,而直接把 window 以参数形式传进来</span></span><br><span class="line"><span class="comment">// 这样 window 就在jQuery 内部 AO 上</span></span><br><span class="line"><span class="comment">// 不传 undefined 是为了安全</span></span><br><span class="line"><span class="comment">// 因为在 IE ,低版本中, undefined 竟然可以重新赋值, 如 undefined = 6;</span></span><br><span class="line"><span class="comment">// 声明 undefined 局部变量( 名字是undefined而已),</span></span><br><span class="line"><span class="comment">// 同时,又不传参,值自然是 undefined 防止了对外界 undefined 的污染</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-JavaScript 作用域   词法分析</title>
      <link href="/2018/10/21/JavaScript/JavaScript_01_%E4%BD%9C%E7%94%A8%E5%9F%9F/"/>
      <url>/2018/10/21/JavaScript/JavaScript_01_%E4%BD%9C%E7%94%A8%E5%9F%9F/</url>
      <content type="html"><![CDATA[<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>​          以 window.xxx 引用全局变量寻找不到,作为某个属性不存在,返回 undefined<br>​          直接以 xxx 引用某变量,寻找不到,则是报错 xxx is not defined 错误       </p><h3 id="作用域-入门"><a href="#作用域-入门" class="headerlink" title="作用域 入门"></a>作用域 入门</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test;</span><br><span class="line"><span class="built_in">console</span>.log(test); <span class="comment">// 输出 undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(test2); <span class="comment">//报错 test2 is not defined</span></span><br></pre></td></tr></table></figure><h3 id="词法分析入门"><a href="#词法分析入门" class="headerlink" title="词法分析入门"></a>词法分析入门</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 词法分析 入门</span></span><br><span class="line"><span class="comment">* js 代码自上而下执行!!!</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 但是---------</span></span><br><span class="line"><span class="comment">* js 代码在整体运行分:</span></span><br><span class="line"><span class="comment">* 词法分析期</span></span><br><span class="line"><span class="comment">* 运行期</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 自上而下执行,先有个一个"词法分析过程"!!!</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// 分析 词法分析期 var test_1;  赋值期 tes_1='fei';</span></span><br><span class="line"><span class="keyword">var</span> test_1 = <span class="string">'fei'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(test_1); <span class="comment">//输出 fei</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.test_1); <span class="comment">//输出 fei</span></span><br></pre></td></tr></table></figure><h3 id="作用域-demo"><a href="#作用域-demo" class="headerlink" title="作用域  demo"></a>作用域  demo</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 作用域</span></span><br><span class="line"><span class="comment"> * 在js中,函数嵌套是非常普遍的</span></span><br><span class="line"><span class="comment"> * 在函数嵌套中,</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 对变量是如何寻找的?</span></span><br><span class="line"><span class="comment"> * 答:首先在函数内寻找</span></span><br><span class="line"><span class="comment"> * 寻找不到,则往外层寻找</span></span><br><span class="line"><span class="comment"> * 直到....全局(window)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="number">6</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="number">7</span>;</span><br><span class="line">        alert(c + d + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t2();</span><br><span class="line">&#125;</span><br><span class="line">t1(); <span class="comment">//输出 18</span></span><br><span class="line"><span class="comment">//----------------------------</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="number">6</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">var</span> d=<span class="number">3</span>;</span><br><span class="line">        alert(c + d + e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t2();</span><br><span class="line">&#125;</span><br><span class="line">t1(); <span class="comment">//输出 15</span></span><br></pre></td></tr></table></figure><h3 id="声明变量-var-的作用"><a href="#声明变量-var-的作用" class="headerlink" title="声明变量 var 的作用"></a>声明变量 var 的作用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 声明变量 var 的作用</span></span><br><span class="line"><span class="comment"> * var 是在函数运行的上下文中,声明一个变量</span></span><br><span class="line"><span class="comment"> * 如果不加 var , 则是一个赋值操作</span></span><br><span class="line"><span class="comment"> * 但不要狭隘的理解为----声明了一个全局变量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">alert(<span class="built_in">window</span>.d);<span class="comment">//输出 undefined</span></span><br><span class="line">alert(<span class="built_in">window</span>.e);<span class="comment">//输出 undefined</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    d = <span class="number">5</span>;<span class="comment">//赋值操作</span></span><br><span class="line">    <span class="keyword">var</span> e = <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t();</span><br><span class="line"><span class="comment">// 5   d没有加 var 仅仅是一个赋值操作,</span></span><br><span class="line"><span class="comment">// 寻找t域内的函数,没有找到继续寻找...直到..&gt;window,最后 window.d = 5</span></span><br><span class="line">alert(<span class="built_in">window</span>.d); <span class="comment">// 输出 5</span></span><br><span class="line">alert(<span class="built_in">window</span>.e); <span class="comment">//输出 undefined</span></span><br><span class="line"><span class="comment">//----------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span>  d;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        d = <span class="number">5</span>;</span><br><span class="line">        e = <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t2();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t1();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(e);  <span class="comment">// 输出 6</span></span><br><span class="line"><span class="built_in">console</span>.log(d);  <span class="comment">//报错 is not defined</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.e); <span class="comment">//输出 6</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.d); <span class="comment">//输出 undefined</span></span><br></pre></td></tr></table></figure><h3 id="作用域-demo-2"><a href="#作用域-demo-2" class="headerlink" title="作用域 demo 2"></a>作用域 demo 2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 分析</span></span><br><span class="line">    <span class="comment">// 这里 str1 这一行执行,在 t1 内寻找 str1--没有找到,又在 window 上寻找 str1--有,打印global</span></span><br><span class="line">    <span class="comment">// 这里 str2 这一行执行,在 t1 内寻找 str2--没有找到,又在 window 上寻找str2--没有,报错 str2 is not defined</span></span><br><span class="line">    <span class="built_in">console</span>.log(str1); <span class="comment">// 输出 global</span></span><br><span class="line">    <span class="built_in">console</span>.log(str2); <span class="comment">// 报错 is not defined</span></span><br><span class="line">    <span class="comment">// console.log(window.str1);// 输出 global</span></span><br><span class="line">    <span class="comment">// console.log(window.str2);// 输出 undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分析</span></span><br><span class="line">    <span class="comment">// 如果执行到这里,才会把全局的 str2变量赋上值</span></span><br><span class="line">    str2 = <span class="string">'local'</span>;</span><br><span class="line">    <span class="comment">// console.log(str1); // 输出 global</span></span><br><span class="line">    <span class="comment">// console.log(str2); // 报错 local</span></span><br><span class="line">    <span class="comment">// console.log(window.str1);// 输出 global</span></span><br><span class="line">    <span class="comment">// console.log(window.str2);// 输出 local</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t1();</span><br></pre></td></tr></table></figure><h3 id="词法分析期-运行期"><a href="#词法分析期-运行期" class="headerlink" title="词法分析期   运行期"></a>词法分析期   运行期</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 1步:先分析 t1 函数</span></span><br><span class="line"><span class="comment"> * t()&#123;</span></span><br><span class="line"><span class="comment"> *     var str2;  // 分析 t1 内有str2 局部变量,注意此时函数没有执行,因此str2 的值是 undefined</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 2步:执行 t1 函数</span></span><br><span class="line"><span class="comment"> *       console.log(str1); //global</span></span><br><span class="line"><span class="comment"> *       console.log(str2); //undefined</span></span><br><span class="line"><span class="comment"> *       str2 = 'local'; //此时,str 的值为 local</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> str1 = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(str1); <span class="comment">// 输出 global</span></span><br><span class="line">    <span class="built_in">console</span>.log(str2); <span class="comment">// 报错 undefined</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">window</span>.str1);<span class="comment">// 输出 global</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">window</span>.str2);<span class="comment">// 输出 undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> str2 = <span class="string">'local'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t1();</span><br></pre></td></tr></table></figure><h3 id="扩展-const、let、var之间的区别-………"><a href="#扩展-const、let、var之间的区别-………" class="headerlink" title="扩展 const、let、var之间的区别 ………."></a>扩展 const、let、var之间的区别 ……….</h3>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-php -vagrant[centos] -xdebug</title>
      <link href="/2018/10/20/centos/php_vagrant_xdebug/"/>
      <url>/2018/10/20/centos/php_vagrant_xdebug/</url>
      <content type="html"><![CDATA[<p>!!!! 温馨提醒 PHP版本一点要和xdebug版本对应<br>!!!! 温馨提醒 PHP版本一点要和xdebug版本对应<br>!!!! 温馨提醒 PHP版本一点要和xdebug版本对应</p><h3 id="查看安装的xdebug-01"><a href="#查看安装的xdebug-01" class="headerlink" title="查看安装的xdebug  01"></a>查看安装的xdebug  01</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost php.d]# yum list | grep xdebug</span><br><span class="line"></span><br><span class="line">Repodata is over <span class="number">2</span> weeks old. Install yum-cron? <span class="keyword">Or</span> run: yum makecache fast</span><br><span class="line">php-composer-xdebug-handler.noarch         <span class="number">1.3</span><span class="meta">.0</span>-<span class="number">1.</span>el7                epel      </span><br><span class="line">php-pecl-xdebug.x86_64                     <span class="number">2.6</span><span class="meta">.1</span>-<span class="number">1.</span>el7.remi<span class="meta">.7</span><span class="meta">.2</span>       remi-php72</span><br><span class="line">php54-php-pecl-xdebug.x86_64               <span class="number">2.4</span><span class="meta">.1</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php55-php-pecl-xdebug.x86_64               <span class="number">2.5</span><span class="meta">.5</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php56-php-pecl-xdebug.x86_64               <span class="number">2.5</span><span class="meta">.5</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php70-php-pecl-xdebug.x86_64               <span class="number">2.6</span><span class="meta">.1</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php71-php-pecl-xdebug.x86_64               <span class="number">2.6</span><span class="meta">.1</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php72-php-pecl-xdebug.x86_64               <span class="number">2.6</span><span class="meta">.1</span>-<span class="number">1.</span>el7.remi           remi-safe </span><br><span class="line">php73-php-pecl-xdebug.x86_64               <span class="number">2.7</span><span class="meta">.0</span>~beta1-<span class="number">1.</span>el7.remi     remi-safe </span><br><span class="line"></span><br><span class="line">[root@localhost php.d]# yum install php-pecl-xdebug</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_xdebug/01.png" alt="查看xdebug"></p><h3 id="查看安装的xdebug-02"><a href="#查看安装的xdebug-02" class="headerlink" title="查看安装的xdebug  02"></a>查看安装的xdebug  02</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost php.d]<span class="comment"># ll /etc/php.d/  | grep xdebug</span></span><br><span class="line">-rw-r--r--  <span class="number">1</span> root root <span class="number">37784</span> Aug  <span class="number">4</span> <span class="number">05</span>:<span class="number">54</span> <span class="number">15</span>-xdebug.ini</span><br><span class="line">[root@localhost php.d]<span class="comment"># vim 15-xdebug.ini</span></span><br><span class="line">    <span class="attr">zend_extension=xdebug.so</span></span><br><span class="line">    xdebug.<span class="attr">idekey</span> = <span class="string">"PHPSTORM"</span></span><br><span class="line">    xdebug.<span class="attr">default_enable</span> = <span class="number">1</span></span><br><span class="line">    xdebug.<span class="attr">remote_connect_back</span> = <span class="number">1</span></span><br><span class="line">    xdebug.<span class="attr">remote_port</span> = <span class="number">9001</span></span><br><span class="line">    xdebug.<span class="attr">remote_enable</span> = <span class="number">1</span></span><br><span class="line">    xdebug.<span class="attr">remote_autostart</span> = <span class="number">1</span></span><br><span class="line">    xdebug.<span class="attr">remote_handler="dbgp"</span></span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_xdebug/02.png" alt="查看xdebug"></p><h3 id="查看安装的xdebug-03"><a href="#查看安装的xdebug-03" class="headerlink" title="查看安装的xdebug 03"></a>查看安装的xdebug 03</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost php.d]<span class="comment"># php -v</span></span><br><span class="line">PHP <span class="number">7.2</span>.<span class="number">9</span> (cli) (built: Aug <span class="number">15</span> <span class="number">2018</span> <span class="number">09</span>:<span class="number">19</span>:<span class="number">33</span>) ( NTS )</span><br><span class="line">Copyright (c) <span class="number">1997</span>-<span class="number">2018</span> The PHP Group</span><br><span class="line">Zend Engine v3.<span class="number">2.0</span>, Copyright (c) <span class="number">1998</span>-<span class="number">2018</span> Zend Technologies</span><br><span class="line">    <span class="keyword">with</span> Xdebug v2.<span class="number">6.1</span>, Copyright (c) <span class="number">2002</span>-<span class="number">2018</span>, by Derick Rethans</span><br><span class="line">    </span><br><span class="line"><span class="comment">###这里的配置不要写错了,remote_connect_back这项很重要</span></span><br><span class="line">[root@localhost php.d]<span class="comment">#  vim 15-xdebug.ini </span></span><br><span class="line">        <span class="attr">zend_extension=xdebug.so</span></span><br><span class="line">        xdebug.<span class="attr">idekey</span> = <span class="string">"PHPSTORM"</span></span><br><span class="line">        xdebug.<span class="attr">default_enable</span> = <span class="number">1</span></span><br><span class="line">        xdebug.<span class="attr">remote_connect_back</span> = <span class="number">1</span></span><br><span class="line">        xdebug.<span class="attr">remote_port</span> = <span class="number">9001</span></span><br><span class="line">        xdebug.<span class="attr">remote_enable</span> = <span class="number">1</span></span><br><span class="line">        xdebug.<span class="attr">remote_autostart</span> = <span class="number">1</span></span><br><span class="line">        xdebug.<span class="attr">remote_handler="dbgp"</span></span><br><span class="line">        </span><br><span class="line">        或者</span><br><span class="line">        <span class="attr">zend_extension=xdebug.so</span></span><br><span class="line">        xdebug.<span class="attr">idekey="PHPSTORM"</span></span><br><span class="line">        xdebug.<span class="attr">remote_connect_back</span> = <span class="number">1</span>   //这项不要丢了</span><br><span class="line">        xdebug.<span class="attr">remote_handler</span> = <span class="string">"dbgp"</span></span><br><span class="line">        xdebug.<span class="attr">remote_mode</span> = <span class="string">"req"</span></span><br><span class="line">        xdebug.<span class="attr">remote_host=127.0.0.1</span></span><br><span class="line">        xdebug.<span class="attr">remote_enable=on</span></span><br><span class="line">        xdebug.<span class="attr">remote_port</span> = <span class="number">9001</span></span><br><span class="line">        xdebug.<span class="attr">remote_autostart</span> = no</span><br><span class="line"></span><br><span class="line">---------------虚拟机配置完毕------------------</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_xdebug/03.png" alt="查看xdebug"></p><h3 id="windows中配置"><a href="#windows中配置" class="headerlink" title="windows中配置"></a>windows中配置</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">04 </span> Tools--&gt;Vagrant </span><br><span class="line"><span class="symbol">05 </span> Languages &amp; Frameworks --&gt;PHP--&gt; Debug </span><br><span class="line"><span class="symbol">06 </span> Languages &amp; Frameworks --&gt;PHP--&gt; Debug --&gt; DBGp Proxy</span><br><span class="line"><span class="symbol">07 </span> Languages &amp; Frameworks --&gt;PHP--&gt; Servers</span><br><span class="line"></span><br><span class="line"><span class="symbol">08 </span><span class="keyword">Run</span> --&gt; <span class="keyword">Edit</span> Configurations  添加PHP Web Page</span><br><span class="line"><span class="number">09</span>接下来接可以断点调试了</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant_xdebug/04.png" alt="windows 配置"></p><p><img src="/img/centos/vagrant_xdebug/05.png" alt="windows 配置"></p><p><img src="/img/centos/vagrant_xdebug/06.png" alt="windows 配置"></p><p><img src="/img/centos/vagrant_xdebug/07.png" alt="windows 配置"></p><p><img src="/img/centos/vagrant_xdebug/08.png" alt="windows 配置"></p><p><img src="/img/centos/vagrant_xdebug/09.png" alt="windows 配置"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-Yii2 验证器  -不为人知的秘密</title>
      <link href="/2018/10/20/Yii2/Yii2_validators/"/>
      <url>/2018/10/20/Yii2/Yii2_validators/</url>
      <content type="html"><![CDATA[<h3 id="required-必须值验证属性"><a href="#required-必须值验证属性" class="headerlink" title="required : 必须值验证属性"></a>required : 必须值验证属性</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'字段名'</span>],required,<span class="string">'requiredValue'</span>=&gt;<span class="string">'必填值'</span>,<span class="string">'message'</span>=&gt;<span class="string">'提示信息'</span>];</span><br><span class="line"><span class="comment">#说明:CRequiredValidator 的别名, 确保了特性不为空.</span></span><br></pre></td></tr></table></figure><h3 id="指定场景"><a href="#指定场景" class="headerlink" title="指定场景"></a>指定场景</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'title'</span>, <span class="string">'content'</span>], <span class="string">'required'</span>, <span class="string">'on'</span> =&gt; [<span class="string">'create'</span>, <span class="string">'update'</span>]],</span><br></pre></td></tr></table></figure><h3 id="email-邮箱验证"><a href="#email-邮箱验证" class="headerlink" title="email : 邮箱验证"></a>email : 邮箱验证</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'email'</span>, <span class="string">'email'</span>];</span><br><span class="line"><span class="comment">#说明:CEmailValidator的别名,确保了特性的值是一个有效的电邮地址.</span></span><br></pre></td></tr></table></figure><h3 id="match-正则验证"><a href="#match-正则验证" class="headerlink" title="match : 正则验证"></a>match : 正则验证</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'字段名'</span>],match,<span class="string">'pattern'</span>=&gt;<span class="string">'正则表达式'</span>,<span class="string">'message'</span>=&gt;<span class="string">'提示信息'</span>];    </span><br><span class="line">[[<span class="string">'字段名'</span>],<span class="string">'match'</span>,<span class="string">'pattern'</span>=&gt;<span class="string">'/^[1-9]d*|0$/'</span>,<span class="string">'message'</span>=&gt;<span class="string">'必须为正整数'</span>];</span><br><span class="line">[[<span class="string">'字段名'</span>],match,<span class="string">'not'</span>=&gt;ture,<span class="string">'pattern'</span>=&gt;<span class="string">'正则表达式'</span>,<span class="string">'message'</span>=&gt;<span class="string">'提示信息'</span>];</span><br><span class="line"><span class="comment">/*正则取反*/</span> <span class="comment">#说明:CRegularExpressionValidator 的别名, 确保了特性匹配一个正则表达式.</span></span><br></pre></td></tr></table></figure><h3 id="safe-安全"><a href="#safe-安全" class="headerlink" title="safe : 安全"></a>safe : 安全</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'description'</span>, <span class="string">'safe'</span>];</span><br></pre></td></tr></table></figure><h3 id="compare-比较"><a href="#compare-比较" class="headerlink" title="compare : 比较"></a>compare : 比较</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'age'</span>, <span class="string">'compare'</span>, <span class="string">'compareValue'</span> =&gt; <span class="number">30</span>, <span class="string">'operator'</span> =&gt; <span class="string">'&gt;='</span>];</span><br><span class="line"><span class="comment">#说明:compareValue(比较常量值) - operator(比较操作符)  </span></span><br><span class="line"><span class="comment">#说明:CCompareValidator 的别名,确保了特性的值等于另一个特性或常量.</span></span><br></pre></td></tr></table></figure><h3 id="default-默认值"><a href="#default-默认值" class="headerlink" title="default : 默认值"></a>default : 默认值</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'age'</span>, <span class="string">'default'</span>, <span class="string">'value'</span> =&gt; <span class="keyword">null</span>];</span><br><span class="line"><span class="comment">#说明:CDefaultValueValidator 的别名, 为特性指派了一个默认值.</span></span><br></pre></td></tr></table></figure><h3 id="file-文件"><a href="#file-文件" class="headerlink" title="file : 文件"></a>file : 文件</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'primaryImage'</span>, <span class="string">'file'</span>, <span class="string">'extensions'</span> =&gt; [<span class="string">'png'</span>, <span class="string">'jpg'</span>, <span class="string">'gif'</span>], <span class="string">'maxSize'</span> =&gt; <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">1024</span>]; </span><br><span class="line"><span class="comment">#说明:CFileValidator 的别名, 确保了特性包含了一个上传文件的名称.</span></span><br></pre></td></tr></table></figure><h3 id="filter-滤镜"><a href="#filter-滤镜" class="headerlink" title="filter : 滤镜"></a>filter : 滤镜</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'username'</span>, <span class="string">'email'</span>], <span class="string">'filter'</span>, <span class="string">'filter'</span> =&gt; <span class="string">'trim'</span>, <span class="string">'skipOnArray'</span> =&gt; <span class="keyword">true</span>]; </span><br><span class="line"><span class="comment">#说明:CFilterValidator 的别名, 使用一个filter转换属性.</span></span><br></pre></td></tr></table></figure><h3 id="in-范围"><a href="#in-范围" class="headerlink" title="in : 范围"></a>in : 范围</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'level'</span>, <span class="string">'in'</span>, <span class="string">'range'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]; </span><br><span class="line"><span class="comment">#说明:CRangeValidator 的别名,确保了特性出现在一个预订的值列表里.</span></span><br></pre></td></tr></table></figure><h3 id="unique-唯一性"><a href="#unique-唯一性" class="headerlink" title="unique : 唯一性"></a>unique : 唯一性</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'username'</span>, <span class="string">'unique'</span>] </span><br><span class="line"><span class="comment">#说明:CUniqueValidator 的别名,确保了特性在数据表字段中是唯一的.</span></span><br></pre></td></tr></table></figure><h3 id="integer-整数"><a href="#integer-整数" class="headerlink" title="integer : 整数"></a>integer : 整数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'age'</span>, <span class="string">'integer'</span>];</span><br></pre></td></tr></table></figure><h3 id="number-数字"><a href="#number-数字" class="headerlink" title="number : 数字"></a>number : 数字</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'salary'</span>, <span class="string">'number'</span>];</span><br></pre></td></tr></table></figure><h3 id="double-双精度浮点型"><a href="#double-双精度浮点型" class="headerlink" title="double : 双精度浮点型"></a>double : 双精度浮点型</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'salary'</span>, <span class="string">'double'</span>];</span><br></pre></td></tr></table></figure><h3 id="date-日期"><a href="#date-日期" class="headerlink" title="date : 日期"></a>date : 日期</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'from'</span>, <span class="string">'to'</span>], <span class="string">'date'</span>];</span><br></pre></td></tr></table></figure><h3 id="string-字符串"><a href="#string-字符串" class="headerlink" title="string : 字符串"></a>string : 字符串</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'username'</span>, <span class="string">'string'</span>, <span class="string">'length'</span> =&gt; [<span class="number">4</span>, <span class="number">24</span>]];</span><br></pre></td></tr></table></figure><h3 id="boolean-是否为一个布尔值"><a href="#boolean-是否为一个布尔值" class="headerlink" title="boolean : 是否为一个布尔值"></a>boolean : 是否为一个布尔值</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'字段名'</span>, <span class="string">'boolean'</span>, <span class="string">'trueValue'</span> =&gt; <span class="keyword">true</span>, <span class="string">'falseValue'</span> =&gt; <span class="keyword">false</span>, <span class="string">'strict'</span> =&gt; <span class="keyword">true</span>]; </span><br><span class="line"><span class="comment">#说明:CBooleanValidator 的别名</span></span><br></pre></td></tr></table></figure><h3 id="when条件："><a href="#when条件：" class="headerlink" title="when条件："></a>when条件：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'name2'</span>, <span class="string">'required'</span>, <span class="string">'when'</span> =&gt; <span class="function"><span class="keyword">function</span> <span class="params">($model)</span> </span>&#123;    <span class="keyword">return</span> <span class="keyword">empty</span>($model-&gt;name1);&#125;],<span class="comment">#说明:</span></span><br></pre></td></tr></table></figure><h3 id="行内验证器–"><a href="#行内验证器–" class="headerlink" title="行内验证器–"></a>行内验证器–</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// password is validated by foo()</span></span><br><span class="line"> [<span class="string">'password'</span>, <span class="string">'foo'</span>]</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="keyword">$this</span>-&gt;addError(<span class="string">'password'</span>, <span class="string">'调用这个方法了.'</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line">[<span class="string">'password'</span>, <span class="string">'validatePassword'</span>],</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">validatePassword</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $user = User::findByUsername(<span class="keyword">$this</span>-&gt;username);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!$user || !$user-&gt;validatePassword(<span class="keyword">$this</span>-&gt;password)) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;addError(<span class="string">'password'</span>, <span class="string">'Incorrect username or password.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <a href="https://www.yiiframework.com/doc/guide/2.0/en/input-validation" title="核心验证旗 en" target="_blank" rel="noopener">核心验证器 en</a></p><p> <a href="https://www.yiiframework.com/doc/guide/2.0/zh-cn/tutorial-core-validators" title="核心验证旗 zh-cn" target="_blank" rel="noopener">核心验证器 zh-cn</a></p><p> <a href="https://www.yiiframework.com/doc/guide/2.0/zh-cn/input-validation" title="输入验证" target="_blank" rel="noopener">输入验证</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-sql -DDL</title>
      <link href="/2018/10/14/mysql/sql_DDL/"/>
      <url>/2018/10/14/mysql/sql_DDL/</url>
      <content type="html"><![CDATA[<h3 id="列操作"><a href="#列操作" class="headerlink" title="列操作"></a>列操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">desc 表名;  ...................................... #查看表结构</span><br><span class="line">alter table 表名 add 列名称 属性;    .............. # 添加列</span><br><span class="line">alter table 表名 add 列名称 属性 after 列名;  ...   # 指定在某列后面添加</span><br><span class="line">alter table 表名 drop 列名;      ..............    #删除列名</span><br><span class="line">alter table 表名 change 旧列名 新列名 新属性  .....  #修改列名</span><br><span class="line">alter table a modify change_username varchar(20) ; # 修改列属性</span><br><span class="line"></span><br><span class="line">alter table a add new_username char(10);         # 添加列</span><br><span class="line">alter table a add new_username2 char(10) after id; # 添加列,指定在某列后面添加</span><br><span class="line">alter table a drop new_username2;    #删除列名</span><br><span class="line">alter table a change new_username change_username char(5);  # 修改列名</span><br><span class="line">alter table a modify change_username varchar(20);   #修改列属性</span><br></pre></td></tr></table></figure><h3 id="表操作"><a href="#表操作" class="headerlink" title="表操作"></a>表操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">show tables;  #查看所有表</span><br><span class="line">desc 表名;    #查看表结构</span><br><span class="line">show create table 表名;  # 查看创建表sql</span><br><span class="line">show tables;  #查看表信息</span><br><span class="line">show table status where name =&apos;表名&apos;;  # 查看某一张表信息</span><br><span class="line">rename table 旧表名 to 新表名 #修改表名字</span><br><span class="line">delete from user_t; #清空表内容</span><br><span class="line">truncate user_t;    #清空表内容 id 从最初开始</span><br></pre></td></tr></table></figure><h3 id="索引"><a href="#索引" class="headerlink" title="索引????"></a>索引????</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#普通索引(index  另一个名字normal)、</span><br><span class="line">#唯一索引(unique)、</span><br><span class="line">#全文索引(fulltext)、</span><br><span class="line">#空间索引(SPATIAL)</span><br><span class="line"></span><br><span class="line">unique key email(email(10))  #使用索引长度</span><br><span class="line">alter table 表名 add  index 索引名(字段名) #添加普通索引</span><br><span class="line">alter table 表名 drop index 索引名    #删除索引</span><br><span class="line">show index from 表名    #查看索引</span><br><span class="line"></span><br><span class="line">create table a1(</span><br><span class="line">    name char(5),</span><br><span class="line">    email char(15),</span><br><span class="line">    key name(name),</span><br><span class="line">    unique key email(email)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#多列索引</span><br><span class="line">create table a3(</span><br><span class="line">    name char(5),</span><br><span class="line">    email char(15),</span><br><span class="line">    key name(name),</span><br><span class="line">    unique key name_email(name,email)</span><br><span class="line">);</span><br><span class="line">explain select * from a3 WHERE name=&quot;张&quot;; # 分析sql</span><br><span class="line">alter table a1 add unique(name);  # 添加唯一索引</span><br><span class="line">alter table a1 add index index_name(email) #添加普通索引</span><br><span class="line">alter table a1 drop index index_name    #删除索引</span><br><span class="line">show index from a1 \G    #查看索引</span><br></pre></td></tr></table></figure><h3 id="库操作-此操作比较危险-请谨慎操作"><a href="#库操作-此操作比较危险-请谨慎操作" class="headerlink" title="!!!库操作  [此操作比较危险,请谨慎操作]"></a>!!!库操作  [此操作比较危险,请谨慎操作]</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create database 数据库; #创建库</span><br><span class="line">create database 数据库<span class="built_in"> default </span>character <span class="builtin-name">set</span> 字符集 collate 排序规则; #创建库指定字符集</span><br><span class="line"></span><br><span class="line">create database yourdb; #创建库</span><br><span class="line">create database yourdb3<span class="built_in"> default </span>character <span class="builtin-name">set</span> utf8mb4 collate utf8mb4_unicode_ci; #创建库指定字符集</span><br><span class="line"></span><br><span class="line">!!! 数据库的的名字不要直接修改,容易丢数据!!!</span><br></pre></td></tr></table></figure><h3 id="不常用-有实际用处sql"><a href="#不常用-有实际用处sql" class="headerlink" title="不常用,有实际用处sql"></a>不常用,有实际用处sql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    name,</span><br><span class="line">    NULL AS hello, ---空值作为一列</span><br><span class="line">    &quot;foo&quot; AS bar   ---字符串作为一列</span><br><span class="line">FROM  student2</span><br></pre></td></tr></table></figure><p><img src="/img/mysql/mysql_other_01.png" alt="添加列" title="添加列"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Yii2 ArrayHelp类</title>
      <link href="/2018/10/13/Yii2/Yii2_ArrayHelp/"/>
      <url>/2018/10/13/Yii2/Yii2_ArrayHelp/</url>
      <content type="html"><![CDATA[<h3 id="ArrayHelper-toArray"><a href="#ArrayHelper-toArray" class="headerlink" title="ArrayHelper::toArray"></a>ArrayHelper::toArray</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$post = User::find()-&gt;limit(<span class="number">2</span>)-&gt;all();</span><br><span class="line"><span class="comment">//$post = User::find()-&gt;limit(2)-&gt;asArray()-&gt;all();</span></span><br><span class="line"><span class="comment">// echo "&lt;pre&gt;"; print_r($post);exit();  //输出所有字段 id,username,email......</span></span><br><span class="line">$data = ArrayHelper::toArray($post,[</span><br><span class="line">    <span class="string">'common\models\User'</span>=&gt;[</span><br><span class="line">        <span class="string">'id'</span>,</span><br><span class="line">        <span class="string">'username'</span></span><br><span class="line">    ]</span><br><span class="line">]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>; print_r($data); <span class="comment">//输出 id username</span></span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/ArrayHelp/toArray.png" alt="ArrayHelper::toArray" title="ArrayHelper::toArray"></p><h3 id="ArrayHelper-merge"><a href="#ArrayHelper-merge" class="headerlink" title="ArrayHelper::merge"></a>ArrayHelper::merge</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$array1 = [</span><br><span class="line">    <span class="string">'name'</span> =&gt; <span class="string">'Yii'</span>,</span><br><span class="line">    <span class="string">'version'</span> =&gt; <span class="string">'1.1'</span>,</span><br><span class="line">    <span class="string">'ids'</span> =&gt; [</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'validDomains'</span> =&gt; [</span><br><span class="line">        <span class="string">'example.com'</span>,</span><br><span class="line">        <span class="string">'www.example.com'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'emails'</span> =&gt; [</span><br><span class="line">        <span class="string">'admin'</span> =&gt; <span class="string">'admin@example.com'</span>,</span><br><span class="line">        <span class="string">'dev'</span> =&gt; <span class="string">'dev@example.com'</span>,</span><br><span class="line">    ],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$array2 = [</span><br><span class="line">    <span class="string">'version'</span> =&gt; <span class="string">'2.0'</span>,</span><br><span class="line">    <span class="string">'ids'</span> =&gt; [</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// Object that represents the replacement of</span></span><br><span class="line">    <span class="comment">// array value while performing [[ArrayHelper::merge()]].</span></span><br><span class="line">    <span class="string">'validDomains'</span> =&gt; <span class="keyword">new</span> \yii\helpers\ReplaceArrayValue([</span><br><span class="line">        <span class="string">'yiiframework.com'</span>,</span><br><span class="line">        <span class="string">'www.yiiframework.com'</span>,</span><br><span class="line">    ]),</span><br><span class="line">    <span class="comment">// Object that represents the removal of</span></span><br><span class="line">    <span class="comment">// array value while performing [[ArrayHelper::merge()]].</span></span><br><span class="line">    <span class="string">'emails'</span> =&gt; [</span><br><span class="line">        <span class="string">'dev'</span> =&gt; <span class="keyword">new</span> \yii\helpers\UnsetArrayValue(),</span><br><span class="line">    ],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$result = ArrayHelper::merge($array1, $array2);</span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line">[</span><br><span class="line">    <span class="string">'name'</span> =&gt; <span class="string">'Yii'</span>,</span><br><span class="line">    <span class="string">'version'</span> =&gt; <span class="string">'2.0'</span>,</span><br><span class="line">    <span class="string">'ids'</span> =&gt; [   <span class="comment">//这里合并</span></span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'validDomains'</span> =&gt; [ <span class="comment">//这里替换</span></span><br><span class="line">        <span class="string">'yiiframework.com'</span>,</span><br><span class="line">        <span class="string">'www.yiiframework.com'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'emails'</span> =&gt; [ <span class="comment">//这里删除</span></span><br><span class="line">        <span class="string">'admin'</span> =&gt; <span class="string">'admin@example.com'</span>,</span><br><span class="line">    ],</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-getValue"><a href="#ArrayHelper-getValue" class="headerlink" title="ArrayHelper::getValue"></a>ArrayHelper::getValue</h3><p>用原生PHP从一个对象、数组、或者包含这两者的一个复杂数据结构中获取数据是非常繁琐的。 你首先得使用 <code>isset</code> 检查 key 是否存在, 然后如果存在你就获取它，如果不存在， 则提供一个默认返回值;;;;;;<br>Yii 提供了一个非常方便的方法来做这件事：ArrayHelper::getValue</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name;</span><br><span class="line">    <span class="keyword">public</span> $name_002=<span class="string">"我是name_002"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$array = [</span><br><span class="line">    <span class="string">'foo'</span> =&gt; [</span><br><span class="line">        <span class="string">'bar'</span> =&gt; <span class="keyword">new</span> User(),</span><br><span class="line">        <span class="string">'bar_002'</span> =&gt; <span class="keyword">new</span> User(),</span><br><span class="line">    ]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$value = <span class="keyword">isset</span>($array[<span class="string">'foo'</span>][<span class="string">'bar'</span>]-&gt;name) ? $array[<span class="string">'foo'</span>][<span class="string">'bar'</span>]-&gt;name : <span class="keyword">null</span>;</span><br><span class="line">$value002 = <span class="keyword">isset</span>($array[<span class="string">'foo'</span>][<span class="string">'bar'</span>]-&gt;name_002) ? $array[<span class="string">'foo'</span>][<span class="string">'bar'</span>]-&gt;name_002 : <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">var_dump($value);  <span class="comment">//输出 null</span></span><br><span class="line">var_dump($value002); <span class="comment">//输出 我是name_002</span></span><br><span class="line"></span><br><span class="line">var_dump(ArrayHelper::getValue($array,<span class="string">'foo.bar.name'</span>)); <span class="comment">//输出 null</span></span><br><span class="line">var_dump(ArrayHelper::getValue($array,<span class="string">'foo.bar.name_002'</span>)); <span class="comment">//输出 我是name_002</span></span><br><span class="line"></span><br><span class="line">var_dump(ArrayHelper::getValue($array, <span class="function"><span class="keyword">function</span> <span class="params">($array,$defaultValue)</span> </span>&#123;  <span class="comment">//输出 我是name_002</span></span><br><span class="line">    <span class="keyword">return</span> $array[<span class="string">'foo'</span>][<span class="string">'bar'</span>]-&gt;name_002;</span><br><span class="line">&#125;));</span><br><span class="line">var_dump(ArrayHelper::getValue($array, <span class="string">'foo.bar.name_002'</span>));  <span class="comment">//输出 我是name_002</span></span><br><span class="line">var_dump(ArrayHelper::getValue($array, [<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'name_002'</span>]));  <span class="comment">//输出 我是name_002</span></span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/ArrayHelp/getValue.png" alt="ArrayHelper::getValue" title="ArrayHelper::getValue"></p><h3 id="ArrayHelper-setValue"><a href="#ArrayHelper-setValue" class="headerlink" title="ArrayHelper::setValue"></a>ArrayHelper::setValue</h3><p>覆盖初始值,如果数组中不存在则被创建</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$array = [</span><br><span class="line">    <span class="string">'key'</span> =&gt; [</span><br><span class="line">        <span class="string">'in'</span> =&gt; [<span class="string">'k'</span> =&gt; <span class="string">'value'</span>]</span><br><span class="line">    ]</span><br><span class="line">];</span><br><span class="line">ArrayHelper::setValue($array, <span class="string">'key.in'</span>, [<span class="string">'arr'</span> =&gt; <span class="string">'val'</span>]);</span><br><span class="line"><span class="comment">// 在 `$array` 中写入值的路径可以被指定为一个数组</span></span><br><span class="line">ArrayHelper::setValue($array, [<span class="string">'key'</span>, <span class="string">'in'</span>], [<span class="string">'arr'</span> =&gt; <span class="string">'val'</span>]);</span><br></pre></td></tr></table></figure><h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="string">'key'</span> =&gt; [</span><br><span class="line">        <span class="string">'in'</span> =&gt; [<span class="string">'arr'</span> =&gt; <span class="string">'val'</span>]</span><br><span class="line">    ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="如果路径中包含一个不存在的键-他将被创建"><a href="#如果路径中包含一个不存在的键-他将被创建" class="headerlink" title="如果路径中包含一个不存在的键,他将被创建"></a>如果路径中包含一个不存在的键,他将被创建</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果 `$array['key']['in']['arr0']` 不为空，则该值将被添加到数组中</span></span><br><span class="line">ArrayHelper::setValue($array, <span class="string">'key.in.arr0.arr1'</span>, <span class="string">'val'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果你想完全覆盖值 `$array['key']['in']['arr0']`</span></span><br><span class="line">ArrayHelper::setValue($array, <span class="string">'key.in.arr0'</span>, [<span class="string">'arr1'</span> =&gt; <span class="string">'val'</span>]);</span><br></pre></td></tr></table></figure><h4 id="输出-1"><a href="#输出-1" class="headerlink" title="输出"></a>输出</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="string">'key'</span> =&gt; [</span><br><span class="line">        <span class="string">'in'</span> =&gt; [</span><br><span class="line">            <span class="string">'k'</span> =&gt; <span class="string">'value'</span>,</span><br><span class="line">            <span class="string">'arr0'</span> =&gt; [<span class="string">'arr1'</span> =&gt; <span class="string">'val'</span>]</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-remove"><a href="#ArrayHelper-remove" class="headerlink" title="ArrayHelper::remove"></a>ArrayHelper::remove</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$array = [<span class="string">'type'</span> =&gt; <span class="string">'A'</span>, <span class="string">'options'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>]];</span><br><span class="line">$type = ArrayHelper::remove($array, <span class="string">'type'</span>);</span><br><span class="line"></span><br><span class="line">print_r($type);   <span class="comment">//输出 A </span></span><br><span class="line">print_r($array);  <span class="comment">//输出 ['options' =&gt; [1, 2]]</span></span><br><span class="line"><span class="comment">//<span class="doctag">note:</span> 与 getValue 方法不同,remove 仅支持简单的键名称,否则返回原来数组</span></span><br><span class="line"><span class="comment">//demo: </span></span><br><span class="line">$array = [</span><br><span class="line">    <span class="string">'key'</span> =&gt; [</span><br><span class="line">        <span class="string">'in'</span> =&gt; [<span class="string">'k'</span> =&gt; <span class="string">'value'</span>]</span><br><span class="line">    ]</span><br><span class="line">];</span><br><span class="line">ArrayHelper::remove($array, <span class="string">'key.in'</span>);</span><br><span class="line">print_r($array);  <span class="comment">//返回原来数组</span></span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-removeValue"><a href="#ArrayHelper-removeValue" class="headerlink" title="ArrayHelper::removeValue"></a>ArrayHelper::removeValue</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$array = [</span><br><span class="line">    <span class="string">'Bob'</span> =&gt; <span class="string">'Dylan'</span>,</span><br><span class="line">    <span class="string">'Michael'</span> =&gt; <span class="string">'Jackson'</span>,</span><br><span class="line">    <span class="string">'Mick'</span> =&gt; <span class="string">'Jagger'</span>,</span><br><span class="line">    <span class="string">'Janet'</span> =&gt; <span class="string">'Jackson'</span></span><br><span class="line">];</span><br><span class="line">ArrayHelper::removeValue($array, <span class="string">'Jackson'</span>);</span><br><span class="line">print_r($array);  <span class="comment">//返回  ['Bob' =&gt; 'Dylan', 'Mick' =&gt; 'Jagger']</span></span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-index"><a href="#ArrayHelper-index" class="headerlink" title="ArrayHelper::index"></a>ArrayHelper::index</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$array = [</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'device'</span> =&gt; <span class="string">'laptop'</span>],</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'def'</span>, <span class="string">'device'</span> =&gt; <span class="string">'tablet'</span>],</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'hgi'</span>, <span class="string">'device'</span> =&gt; <span class="string">'smartphone'</span>],</span><br><span class="line">];</span><br><span class="line">$result = ArrayHelper::index($array, <span class="string">'id'</span>);</span><br><span class="line">$result2 = ArrayHelper::index($array, <span class="function"><span class="keyword">function</span> <span class="params">($element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $element[<span class="string">'id'</span>]; <span class="comment">//匿名函数作为key传递,返回值结果相同</span></span><br><span class="line">&#125;);</span><br><span class="line">print_r($result); </span><br><span class="line">print_r($result2); </span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'123'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'device'</span> =&gt; <span class="string">'laptop'</span>],</span><br><span class="line">    <span class="string">'345'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'hgi'</span>, <span class="string">'device'</span> =&gt; <span class="string">'smartphone'</span>]</span><br><span class="line">    <span class="comment">// 原始数组的第二个元素由于相同的 ID 而被最后一个元素覆盖</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//*******避免第一种的覆盖*****</span></span><br><span class="line">$result = ArrayHelper::index($array, <span class="keyword">null</span>, <span class="string">'id'</span>); <span class="comment">//第一级id</span></span><br><span class="line">$result = ArrayHelper::index($array, <span class="string">'device'</span>,<span class="string">'id'</span>); <span class="comment">//第一级id,第二级 device</span></span><br><span class="line"><span class="comment">//结果分别是</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'123'</span> =&gt; [</span><br><span class="line">        [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'device'</span> =&gt; <span class="string">'laptop'</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'345'</span> =&gt; [ <span class="comment">// all elements with this index are present in the result array</span></span><br><span class="line">        [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'def'</span>, <span class="string">'device'</span> =&gt; <span class="string">'tablet'</span>],</span><br><span class="line">        [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'hgi'</span>, <span class="string">'device'</span> =&gt; <span class="string">'smartphone'</span>],</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">    [</span><br><span class="line">    <span class="string">'123'</span> =&gt; [</span><br><span class="line">        <span class="string">'laptop'</span> =&gt; [</span><br><span class="line">            <span class="string">'abc'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'device'</span> =&gt; <span class="string">'laptop'</span>]</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'345'</span> =&gt; [</span><br><span class="line">        <span class="string">'tablet'</span> =&gt; [</span><br><span class="line">            <span class="string">'def'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'def'</span>, <span class="string">'device'</span> =&gt; <span class="string">'tablet'</span>]</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'smartphone'</span> =&gt; [</span><br><span class="line">            <span class="string">'hgi'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'hgi'</span>, <span class="string">'device'</span> =&gt; <span class="string">'smartphone'</span>]</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line">note: 第三个参数会增加数组的子分组多维数组</span><br><span class="line">$result = ArrayHelper::index($array, <span class="string">'device'</span>,[<span class="string">'id'</span>,<span class="string">'device'</span>]); <span class="comment">//输出</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'123'</span> =&gt; [</span><br><span class="line">        <span class="string">'laptop'</span>=&gt;[</span><br><span class="line">            <span class="string">'laptop'</span> =&gt; [</span><br><span class="line">                <span class="string">'abc'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'device'</span> =&gt; <span class="string">'laptop'</span>]</span><br><span class="line">            ]</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'345'</span> =&gt; [</span><br><span class="line">        <span class="string">'tablet'</span>=&gt;[</span><br><span class="line">            <span class="string">'tablet'</span> =&gt; [</span><br><span class="line">                <span class="string">'def'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'def'</span>, <span class="string">'device'</span> =&gt; <span class="string">'tablet'</span>]</span><br><span class="line">            ],</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'smartphone'</span>=&gt;[</span><br><span class="line">            <span class="string">'smartphone'</span> =&gt; [</span><br><span class="line">                <span class="string">'hgi'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'hgi'</span>, <span class="string">'device'</span> =&gt; <span class="string">'smartphone'</span>]</span><br><span class="line">            ]</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-getColumn"><a href="#ArrayHelper-getColumn" class="headerlink" title="ArrayHelper::getColumn"></a>ArrayHelper::getColumn</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$data = [</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'data'</span> =&gt; <span class="string">'abc'</span>],</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'data'</span> =&gt; <span class="string">'def'</span>],</span><br><span class="line">];</span><br><span class="line">$ids = ArrayHelper::getColumn($array, <span class="string">'id'</span>);  <span class="comment">//输出 ['123', '345']</span></span><br><span class="line"><span class="comment">//如需要额外的转换或者取值的方法比较复杂,第二个参数可以指定一个匿名函数</span></span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-map"><a href="#ArrayHelper-map" class="headerlink" title="ArrayHelper::map"></a>ArrayHelper::map</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$array = [</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'123'</span>, <span class="string">'name'</span> =&gt; <span class="string">'aaa'</span>, <span class="string">'class'</span> =&gt; <span class="string">'x'</span>],</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'124'</span>, <span class="string">'name'</span> =&gt; <span class="string">'bbb'</span>, <span class="string">'class'</span> =&gt; <span class="string">'x'</span>],</span><br><span class="line">    [<span class="string">'id'</span> =&gt; <span class="string">'345'</span>, <span class="string">'name'</span> =&gt; <span class="string">'ccc'</span>, <span class="string">'class'</span> =&gt; <span class="string">'y'</span>],</span><br><span class="line">];</span><br><span class="line">$result1 = ArrayHelper::map($array, <span class="string">'id'</span>, <span class="string">'name'</span>);</span><br><span class="line">$result2 = ArrayHelper::map($array, <span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'class'</span>);</span><br><span class="line"><span class="comment">//结果分别是</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'123'</span> =&gt; <span class="string">'aaa'</span>,</span><br><span class="line">    <span class="string">'124'</span> =&gt; <span class="string">'bbb'</span>,</span><br><span class="line">    <span class="string">'345'</span> =&gt; <span class="string">'ccc'</span>,</span><br><span class="line">]</span><br><span class="line">------- map($array, <span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'class'</span>)这里面的键逆向--------------</span><br><span class="line">[</span><br><span class="line">    <span class="string">'x'</span> =&gt; [</span><br><span class="line">        <span class="string">'123'</span> =&gt; <span class="string">'aaa'</span>,</span><br><span class="line">        <span class="string">'124'</span> =&gt; <span class="string">'bbb'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'y'</span> =&gt; [</span><br><span class="line">        <span class="string">'345'</span> =&gt; <span class="string">'ccc'</span>,</span><br><span class="line">    ],</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-keyExists-只能是一维数组"><a href="#ArrayHelper-keyExists-只能是一维数组" class="headerlink" title="ArrayHelper::keyExists  只能是一维数组"></a>ArrayHelper::keyExists  只能是一维数组</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$data1 = [</span><br><span class="line">    <span class="string">'userName'</span> =&gt; <span class="string">'Alex'</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$data2 = [</span><br><span class="line">    <span class="string">'username'</span> =&gt; <span class="string">'Carsten'</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">var_dump(ArrayHelper::keyExists(<span class="string">'username'</span>,$data1,<span class="keyword">true</span>));<span class="comment">//输出 false</span></span><br><span class="line">var_dump(ArrayHelper::keyExists(<span class="string">'username'</span>,$data2,<span class="keyword">false</span>));<span class="comment">//输出 true</span></span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-multisort-多维数组排序"><a href="#ArrayHelper-multisort-多维数组排序" class="headerlink" title="ArrayHelper::multisort  多维数组排序"></a>ArrayHelper::multisort  多维数组排序</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$data = [</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">30</span>, <span class="string">'name'</span> =&gt; <span class="string">'Alexander'</span>],</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">30</span>, <span class="string">'name'</span> =&gt; <span class="string">'Brian'</span>],</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">19</span>, <span class="string">'name'</span> =&gt; <span class="string">'Barney'</span>],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">ArrayHelper::multisort($data,[<span class="string">'age'</span>,<span class="string">'name'</span>],[SORT_ASC,SORT_DESC]);</span><br><span class="line"><span class="comment">//输出, age 排序, name 排序</span></span><br><span class="line">[</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">19</span>, <span class="string">'name'</span> =&gt; <span class="string">'Barney'</span>],</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">30</span>, <span class="string">'name'</span> =&gt; <span class="string">'Brian'</span>],</span><br><span class="line">    [<span class="string">'age'</span> =&gt; <span class="number">30</span>, <span class="string">'name'</span> =&gt; <span class="string">'Alexander'</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-isIndexed-ArrayHelper-isAssociative-检测数组是索引数组还是联合数组"><a href="#ArrayHelper-isIndexed-ArrayHelper-isAssociative-检测数组是索引数组还是联合数组" class="headerlink" title="ArrayHelper::isIndexed  ArrayHelper::isAssociative 检测数组是索引数组还是联合数组"></a>ArrayHelper::isIndexed  ArrayHelper::isAssociative 检测数组是索引数组还是联合数组</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不指定键名的数组</span></span><br><span class="line">$indexed = [<span class="string">'Qiang'</span>, <span class="string">'Paul'</span>];</span><br><span class="line"><span class="keyword">echo</span> ArrayHelper::isIndexed($indexed);  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有键名都是字符串</span></span><br><span class="line">$associative = [<span class="string">'framework'</span> =&gt; <span class="string">'Yii'</span>, <span class="string">'version'</span> =&gt; <span class="string">'2.0'</span>];</span><br><span class="line"><span class="keyword">echo</span> ArrayHelper::isAssociative($associative); <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-isIn-ArrayHelper-isSubset-测试阵列"><a href="#ArrayHelper-isIn-ArrayHelper-isSubset-测试阵列" class="headerlink" title="ArrayHelper::isIn   ArrayHelper::isSubset  测试阵列"></a>ArrayHelper::isIn   ArrayHelper::isSubset  测试阵列</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// true</span></span><br><span class="line">ArrayHelper::isIn(<span class="string">'a'</span>, [<span class="string">'a'</span>]);</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">ArrayHelper::isIn(<span class="string">'a'</span>, <span class="keyword">new</span> \ArrayObject([<span class="string">'a'</span>]));</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">ArrayHelper::isSubset(<span class="keyword">new</span> \ArrayObject([<span class="string">'a'</span>,<span class="string">'c'</span>]),<span class="keyword">new</span> \ArrayObject([<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]));</span><br></pre></td></tr></table></figure><h3 id="ArrayHelper-filter-过滤"><a href="#ArrayHelper-filter-过滤" class="headerlink" title="ArrayHelper::filter  过滤"></a>ArrayHelper::filter  过滤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$array = [</span><br><span class="line">    <span class="string">'A'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="string">'B'</span> =&gt; [</span><br><span class="line">        <span class="string">'C'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="string">'D'</span> =&gt; <span class="number">2</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'E'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$result1 = ArrayHelper::filter($array,[<span class="string">'A'</span>]);</span><br><span class="line">$result2 = ArrayHelper::filter($array,[<span class="string">'A'</span>,<span class="string">'B.C'</span>]);</span><br><span class="line">$result3 = ArrayHelper::filter($array,[<span class="string">'B'</span>,<span class="string">'!B.C'</span>]);</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">[<span class="string">'A'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>]];</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'A'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>], </span><br><span class="line">    <span class="string">'B'</span> =&gt; [<span class="string">'C'</span> =&gt; <span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">'B'</span> =&gt; [<span class="string">'D'</span> =&gt; <span class="number">2</span>],</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p> <a href="https://www.yiiframework.com/doc/guide/2.0/zh-cn/helper-array" title="官网 zh-cn" target="_blank" rel="noopener">官网 zh-cn</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>win -Yii2 镜像源</title>
      <link href="/2018/09/30/win/composer/"/>
      <url>/2018/09/30/win/composer/</url>
      <content type="html"><![CDATA[<h3 id="查看composer-全局设置"><a href="#查看composer-全局设置" class="headerlink" title="查看composer 全局设置"></a>查看composer 全局设置</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">composer<span class="built_in"> config </span>-gl</span><br><span class="line"></span><br><span class="line">composer 镜像源配置文件:</span><br><span class="line">C:\Users\Administrator\AppData\Roaming\Composer\config.json</span><br></pre></td></tr></table></figure><h3 id="修改镜像源"><a href="#修改镜像源" class="headerlink" title="修改镜像源"></a>修改镜像源</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">国内镜像</span><br><span class="line">composer config -g repo<span class="selector-class">.packagist</span> composer https:<span class="comment">//packagist.phpcomposer.com</span></span><br><span class="line">国际镜像</span><br><span class="line">composer config -g repo<span class="selector-class">.packagist</span> composer https:<span class="comment">//packagist.org</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>wind -Yii2 添加扩展</title>
      <link href="/2018/09/30/win/yii2_composer_vendor/"/>
      <url>/2018/09/30/win/yii2_composer_vendor/</url>
      <content type="html"><![CDATA[<h3 id="安装完-Yii2-没有vendor目录"><a href="#安装完-Yii2-没有vendor目录" class="headerlink" title="安装完 Yii2 没有vendor目录"></a>安装完 Yii2 没有vendor目录</h3><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在 yii 跟目录下执行,首次添加最新扩展包</span><br><span class="line">composer <span class="keyword">update</span></span><br></pre></td></tr></table></figure><p><img src="/img/win/vendor.png" alt="vendor"></p><h3 id="添加-redis-扩展"><a href="#添加-redis-扩展" class="headerlink" title="添加 redis 扩展"></a>添加 redis 扩展</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在根目录执行 </span><br><span class="line"> composer require yiisoft/yii2-redis</span><br><span class="line"> </span><br><span class="line"> 这时在 composer.json 中会自动添加  yiisoft/yii2-redis<span class="string">": "</span>^<span class="number">2.0</span><span class="string">"</span></span><br><span class="line"> 在 vendor/yiisoft/extension.php 中会自动添加</span><br><span class="line">'yiisoft/yii2-redis' =&gt;</span><br><span class="line">    array(</span><br><span class="line">        'name' =&gt; 'yiisoft/yii2-redis',</span><br><span class="line">        'version' =&gt; '2.0.9.0',</span><br><span class="line">        'alias' =&gt;</span><br><span class="line">            array(</span><br><span class="line">                '@yii/redis' =&gt; $vendorDir . '/yiisoft/yii2-redis/src',</span><br><span class="line">            ),</span><br><span class="line">    ),</span><br></pre></td></tr></table></figure><p><img src="/img/win/redis_01.png" alt="redis"></p><p><img src="/img/win/redis_02.png" alt="redis 2"></p><p><img src="/img/win/composer_json.png" alt="composer.json"></p><h3 id="添加-redis-扩展02"><a href="#添加-redis-扩展02" class="headerlink" title="!!!添加 redis 扩展02"></a>!!!添加 redis 扩展02</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在composer.json 文件中添加 redis扩展     <span class="string">"yiisoft/yii2-redis"</span>: <span class="string">"~2.0.0"</span></span><br><span class="line"><span class="string">"require"</span>: &#123;</span><br><span class="line">    <span class="string">"php"</span>: <span class="string">"&gt;=5.4.0"</span>,</span><br><span class="line">    <span class="string">"yiisoft/yii2"</span>: <span class="string">"~2.0.6"</span>,</span><br><span class="line">    <span class="string">"yiisoft/yii2-bootstrap"</span>: <span class="string">"~2.0.0"</span>,</span><br><span class="line">    <span class="string">"yiisoft/yii2-swiftmailer"</span>: <span class="string">"~2.0.0 || ~2.1.0"</span>,</span><br><span class="line">    <span class="string">"yiisoft/yii2-redis"</span>: <span class="string">"~2.0.0"</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">然后在根目录执行 composer update,这时候会自动升级 composer.lock 文件,</span><br><span class="line">redis 扩展添加成功,[ !!!这种方法会自动升级扩展!!! ]</span><br></pre></td></tr></table></figure><h3 id="install-update-require"><a href="#install-update-require" class="headerlink" title="!!!  install  , update  , require"></a>!!!  install  , update  , require</h3><p>添加一个新的扩展包建议使用 composer require</p><p>另外2个会更新所有扩展到最新版本</p><p>composer install 命令从当前目录读取 composer.json 文件，处理了依赖关系，并把其安装到 vendor 目录下。如果当前目录下存在 composer.lock 文件，它会从此文件读取依赖版本，而不是根据 composer.json 文件去获取依赖。这确保了该库的每个使用者都能得到相同的依赖版本。如果没有 composer.lock 文件，composer 将在处理完依赖关系后创建它.</p><p>composer update  为了获取依赖的最新版本，并且升级 composer.lock 文件，你应该使用 update 命令。</p><h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><p>扩展: 这里配置 reids 后,使用 phpstorm 写代码的时候,redis是没有提示的,比如 Yii::$app-&gt;redis-&gt;set(“hello”,”world”);,这里的reids在phpstorm中是跟踪不到的,解决这个问题,在 \vendor\yiisoft\yii2\base\Application.php 中的上面注释中添加如下:</p><ul><li>@property \yii\redis\Connection $redis  </li></ul><p>这样 phpstorm 就可以跟踪代码,并且 Yii::$app-&gt;redis-&gt;set(“hello”,”world”);  这个set 也会有提示;</p><p><img src="/img/win/redis_phpstorm.png" alt="redis 2"></p><h3 id="扩展02-view-层-render-提示"><a href="#扩展02-view-层-render-提示" class="headerlink" title="扩展02 view 层 render 提示"></a>扩展02 view 层 render 提示</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 一般情况下 view 层这个是没有提示的, 在页面的上面添加 /* @var $this \yii\web\View */</span><br><span class="line"><span class="php"><span class="meta">&lt;?</span>= <span class="keyword">$this</span>-&gt;render(<span class="string">'footer/_about'</span>); <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="/img/win/render_phpstorm.png" alt="render 2"></p><h3 id="移除扩展包"><a href="#移除扩展包" class="headerlink" title="移除扩展包"></a>移除扩展包</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="builtin-name">remove</span> yiisoft/yii2-redis</span><br></pre></td></tr></table></figure><p>官方解释</p><p><a href="https://docs.phpcomposer.com/03-cli.html#init" target="_blank" rel="noopener">https://docs.phpcomposer.com/03-cli.html#init</a></p><p><a href="https://docs.phpcomposer.com/03-cli.html#init" target="_blank" rel="noopener">https://docs.phpcomposer.com/03-cli.html#init</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>sql DML (insert update delete select)基本使用</title>
      <link href="/2018/09/28/mysql/sql_DML/"/>
      <url>/2018/09/28/mysql/sql_DML/</url>
      <content type="html"><![CDATA[<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">start transaction;</span><br><span class="line">update 表名 set money=money+500 where id = 2;</span><br><span class="line">update 表名 set money=money-500 where id = 1;</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">select * from 表名 where id =1;</span><br><span class="line">select * from 表名 where id =2;</span><br><span class="line"></span><br><span class="line">+++++++</span><br><span class="line">start transaction;</span><br><span class="line">update 表名 set money=money+500 where id = 2;</span><br><span class="line">rollback;</span><br></pre></td></tr></table></figure><h3 id="where-having-group查询"><a href="#where-having-group查询" class="headerlink" title="where  having  group查询"></a>where  having  group查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">要求:查询出2门及2门以上不及格者的平均成绩 demo sql如下:</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line">CREATE TABLE `student2` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL,</span><br><span class="line">  `subject` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL,</span><br><span class="line">  `score` double(255,0) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">INSERT INTO `student2` VALUES (&apos;1&apos;, &apos;张三&apos;, &apos;数学&apos;, &apos;90&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;2&apos;, &apos;张三&apos;, &apos;语文&apos;, &apos;50&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;3&apos;, &apos;张三&apos;, &apos;地理&apos;, &apos;40&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;4&apos;, &apos;李四&apos;, &apos;语文&apos;, &apos;55&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;5&apos;, &apos;李四&apos;, &apos;政治&apos;, &apos;45&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;6&apos;, &apos;王五&apos;, &apos;政治&apos;, &apos;30&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;7&apos;, &apos;马六&apos;, &apos;地理&apos;, &apos;80&apos;);</span><br><span class="line">INSERT INTO `student2` VALUES (&apos;8&apos;, &apos;马六&apos;, &apos;英语&apos;, &apos;90&apos;);</span><br><span class="line"></span><br><span class="line">+----+------+---------+-------+--------+</span><br><span class="line">| id | name | subject | score | score2 |</span><br><span class="line">+----+------+---------+-------+--------+</span><br><span class="line">|  1 | 张三     | 数学       |    90 |     10 |</span><br><span class="line">|  2 | 张三     | 语文        |    50 |     10 |</span><br><span class="line">|  3 | 张三     | 地理        |    40 |     10 |</span><br><span class="line">|  4 | 李四     | 语文        |    55 |     10 |</span><br><span class="line">|  5 | 李四     | 政治        |    45 |     10 |</span><br><span class="line">|  6 | 王五     | 政治        |    30 |     10 |</span><br><span class="line">|  7 | 马六     | 地理        |    80 |     10 |</span><br><span class="line">|  8 | 马六     | 英语       |    90 |     10 |</span><br><span class="line">+----+------+---------+-------+--------+</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">select name,subject,score,score&lt;60 from student2</span><br><span class="line">select name,sum(score&lt;60) as gk ,avg(score) as pj  from student2  group by name </span><br><span class="line">select name,sum(score&lt;60) as gk ,avg(score) as pj  from student2  group by name HAVING gk&gt;=2</span><br><span class="line">结果:</span><br><span class="line">+--------+------+---------+</span><br><span class="line">| name   | gk   | pj      |</span><br><span class="line">+--------+------+---------+</span><br><span class="line">| 张三   |    2 | 60.0000 |</span><br><span class="line">| 李四   |    2 | 50.0000 |</span><br><span class="line">+--------+------+---------+</span><br><span class="line">+++++++++++++ having 是对表的结果进行查询筛选 ++++++++</span><br><span class="line">select * from student2 where id&gt;1</span><br><span class="line">select * from student2 having id&gt;1</span><br><span class="line">select * from student2 where id&gt;1 having id&lt;5</span><br></pre></td></tr></table></figure><h3 id="INNER-JOIN-查询"><a href="#INNER-JOIN-查询" class="headerlink" title="INNER JOIN 查询"></a>INNER JOIN 查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">demos sql:</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line">DROP TABLE IF EXISTS `m`;</span><br><span class="line">CREATE TABLE `m` (</span><br><span class="line">  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `hid` int(11) DEFAULT NULL COMMENT &apos;主队ID&apos;,</span><br><span class="line">  `gid` int(11) DEFAULT NULL COMMENT &apos;客队ID&apos;,</span><br><span class="line">  `mres` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &apos;比赛结果&apos;,</span><br><span class="line">  `matime` date DEFAULT NULL COMMENT &apos;比赛开始时间&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">INSERT INTO `m` VALUES (&apos;1&apos;, &apos;1&apos;, &apos;2&apos;, &apos;2:0&apos;, &apos;2006-05-21&apos;);</span><br><span class="line">INSERT INTO `m` VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;1:2&apos;, &apos;2006-06-21&apos;);</span><br><span class="line">INSERT INTO `m` VALUES (&apos;3&apos;, &apos;3&apos;, &apos;1&apos;, &apos;2:5&apos;, &apos;2006-06-25&apos;);</span><br><span class="line">INSERT INTO `m` VALUES (&apos;4&apos;, &apos;2&apos;, &apos;1&apos;, &apos;3:2&apos;, &apos;2006-07-21&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS `t`;</span><br><span class="line">CREATE TABLE `t` (</span><br><span class="line">  `tid` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `tname` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &apos;队伍名称&apos;,</span><br><span class="line">  PRIMARY KEY (`tid`)</span><br><span class="line">) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">INSERT INTO `t` VALUES (&apos;1&apos;, &apos;国安&apos;);</span><br><span class="line">INSERT INTO `t` VALUES (&apos;2&apos;, &apos;申花&apos;);</span><br><span class="line">INSERT INTO `t` VALUES (&apos;3&apos;, &apos;布尔联队&apos;);</span><br><span class="line">--------------------------------多次使用INNER JOIN 查询----------------------</span><br><span class="line">SELECT m.id,t1.tname,mres,t2.tname,matime FROM</span><br><span class="line"> m</span><br><span class="line">INNER JOIN t as t1 on m.hid=t1.tid </span><br><span class="line">INNER JOIN t as t2 ON m.gid=t2.tid</span><br></pre></td></tr></table></figure><h2 id="union-和-union-all"><a href="#union-和-union-all" class="headerlink" title="union  和 union all"></a>union  和 union all</h2><p>!!!!   使用union  waring:<br>1.各语句的列数相同<br>2.列名称未必要一直,列名称会使用第一条sql 的列名称为准<br>3.完全相等行将会合并,合并是比较耗时的操作,使用”union all” 可以避免合并</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">demos sql:</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line">DROP TABLE IF EXISTS `a`;</span><br><span class="line">CREATE TABLE `a` (</span><br><span class="line">  `id` char(1) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `num` int(11) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">INSERT INTO `a` VALUES (&apos;a&apos;, &apos;5&apos;);</span><br><span class="line">INSERT INTO `a` VALUES (&apos;b&apos;, &apos;10&apos;);</span><br><span class="line">INSERT INTO `a` VALUES (&apos;c&apos;, &apos;15&apos;);</span><br><span class="line">INSERT INTO `a` VALUES (&apos;d&apos;, &apos;10&apos;);</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS `b`;</span><br><span class="line">CREATE TABLE `b` (</span><br><span class="line">  `id` char(1) COLLATE utf8mb4_unicode_ci NOT NULL,</span><br><span class="line">  `num` int(11) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</span><br><span class="line"></span><br><span class="line">INSERT INTO `b` VALUES (&apos;b&apos;, &apos;5&apos;);</span><br><span class="line">INSERT INTO `b` VALUES (&apos;c&apos;, &apos;15&apos;);</span><br><span class="line">INSERT INTO `b` VALUES (&apos;d&apos;, &apos;20&apos;);</span><br><span class="line">INSERT INTO `b` VALUES (&apos;e&apos;, &apos;99&apos;);</span><br><span class="line">---------------------------------分组后求和--------------------------------------</span><br><span class="line">select id,sum(num) from</span><br><span class="line">(select id,num from a</span><br><span class="line">union all</span><br><span class="line">select id,num from b) as tmp</span><br><span class="line">group by id;</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-systemctl 常用命令</title>
      <link href="/2018/09/26/ubuntu/systemctl_%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2018/09/26/ubuntu/systemctl_%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>systemctl 常用命令</p><p>常用命令</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">常用命令 </span><br><span class="line"></span><br><span class="line">重新加载service文件：     <span class="keyword"> system</span>ctl daemon-reload</span><br><span class="line">启动一个服务：                <span class="keyword"> system</span>ctl start nginx-1.13.0.service</span><br><span class="line">关闭一个服务：                <span class="keyword"> system</span>ctl stop nginx-1.13.0.service</span><br><span class="line">重启一个服务：                <span class="keyword"> system</span>ctl restart nginx-1.13.0.service</span><br><span class="line">显示一个服务的状态：     <span class="keyword"> system</span>ctl status nginx-1.13.0.service</span><br><span class="line">在开机时启用一个服务：  <span class="keyword"> system</span>ctl enable nginx-1.13.0.service</span><br><span class="line">在开机时禁用一个服务：  <span class="keyword"> system</span>ctl disable nginx-1.13.0.service</span><br><span class="line">查看服务是否开机启动：  <span class="keyword"> system</span>ctl is-enabled nginx-1.13.0.service</span><br><span class="line">查看已启动的服务列表：  <span class="keyword"> system</span>ctl list-unit-files|grep enabled</span><br><span class="line">查看启动失败的服务列表：systemctl --failed</span><br><span class="line"></span><br><span class="line">apache</span><br><span class="line">启动 <span class="keyword"> system</span>ctl start httpd</span><br><span class="line">停止 <span class="keyword"> system</span>ctl stop httpd</span><br><span class="line">重启 <span class="keyword"> system</span>ctl restart httpd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql</span><br><span class="line">启动<span class="keyword"> system</span>ctl start mysqld</span><br><span class="line">停止<span class="keyword"> system</span>ctl stop mysqld</span><br><span class="line">重启<span class="keyword"> system</span>ctl restart mysqld</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">php-fpm</span><br><span class="line">启动<span class="keyword"> system</span>ctl start php-fpm</span><br><span class="line">停止<span class="keyword"> system</span>ctl stop php-fpm</span><br><span class="line">重启<span class="keyword"> system</span>ctl restart php-fpm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nginx</span><br><span class="line">启动<span class="keyword"> system</span>ctl start nginx</span><br><span class="line">停止<span class="keyword"> system</span>ctl stop nginx</span><br><span class="line">重启<span class="keyword"> system</span>ctl restart nginx</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>linux-DDU  -vagrant 简单使用02</title>
      <link href="/2018/09/25/centos/vagrant_02/"/>
      <url>/2018/09/25/centos/vagrant_02/</url>
      <content type="html"><![CDATA[<h3 id="添加一个-box"><a href="#添加一个-box" class="headerlink" title="添加一个 box"></a>添加一个 box</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant <span class="built_in">box</span> list</span><br><span class="line">vagrant <span class="built_in">box</span> <span class="built_in">add</span> centos7 centos7-vagrant<span class="number">-180906.</span><span class="built_in">box</span></span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/add.png" alt="vagrant add" title="vagrant add"></p><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vagrant</span> init centos7</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/init.png" alt="vagrant init"></p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant up <span class="comment">--provider virtualbox</span></span><br><span class="line">启动时,SSH 没有权限,下面修改配置,</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/up_ssh.png" alt="vagrant up"></p><h3 id="进入虚拟机-virtualBox-运行远程登录"><a href="#进入虚拟机-virtualBox-运行远程登录" class="headerlink" title="进入虚拟机 virtualBox  ,运行远程登录"></a>进入虚拟机 virtualBox  ,运行远程登录</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vim</span> /etc/ssh/sshd_config   <span class="comment">#修改配置文件</span></span><br><span class="line"></span><br><span class="line">PubkeyAuthentication <span class="literal">yes</span>  <span class="comment">#注释取消掉</span></span><br><span class="line"></span><br><span class="line">重启服务 systemct1 restart sshd.service</span><br><span class="line"></span><br><span class="line">windows端:  ssh vagrant@<span class="number">127.0.0.1</span> -p2222</span><br><span class="line">使用密码登录</span><br><span class="line">windows端:  ssh vagrant@<span class="number">192.168.56.3</span>  <span class="comment">#使用指定ip登录</span></span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/ssh_remote.png" alt="ssh remote"></p><p><img src="/img/centos/vagrant/ssh_remote2.png" alt="ssh remote2"></p><p><img src="/img/centos/vagrant/ssh_remote3.png" alt="ssh remote2"></p><h3 id="windows-添加私钥-ssh-免密码登录-在windows中执行"><a href="#windows-添加私钥-ssh-免密码登录-在windows中执行" class="headerlink" title="windows 添加私钥  ssh 免密码登录,[在windows中执行]"></a>windows 添加私钥  ssh 免密码登录,[在windows中执行]</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vagrant ssh-config   #查看实时连接信息</span><br><span class="line">cd /c/Users/Administrator/.vagrant.d/</span><br><span class="line">scp -P2222 vagrant@127.0.0.1:~/.ssh/id_rsa ./  #从远程复制私钥到windows</span><br><span class="line"></span><br><span class="line">mv insecure_private_key insecure_private_key_old  #备份原来文件</span><br><span class="line">mv id_rsa insecure_private_key</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/scp.png" alt="scp"></p><h3 id="设置-linux-公钥"><a href="#设置-linux-公钥" class="headerlink" title="设置 linux 公钥"></a>设置 linux 公钥</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp authorized_keys authorized_keys_old</span><br><span class="line">cat id_rsa<span class="selector-class">.pub</span> &gt; authorized_keys</span><br></pre></td></tr></table></figure><p><img src="/img/centos/vagrant/id_rsa_pub.png" alt="id_rsa pub"></p><h3 id="配置-Vagrantfile"><a href="#配置-Vagrantfile" class="headerlink" title="配置 Vagrantfile"></a>配置 Vagrantfile</h3><h4 id="vagrantfiile"><a href="#vagrantfiile" class="headerlink" title="vagrantfiile"></a>vagrantfiile</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">config<span class="selector-class">.vm</span><span class="selector-class">.box</span> = <span class="string">"centos7"</span></span><br><span class="line">config<span class="selector-class">.vm</span><span class="selector-class">.network</span> <span class="string">"private_network"</span>, ip: <span class="string">"192.168.56.3"</span></span><br><span class="line">config<span class="selector-class">.vm</span><span class="selector-class">.network</span> <span class="string">"public_network"</span>,:bridge=&gt;<span class="string">'en0: Wi-Fi (AirPort)'</span></span><br><span class="line">config<span class="selector-class">.vm</span><span class="selector-class">.synced_folder</span> <span class="string">"E:/data_web/webroot/"</span>, <span class="string">"/data"</span>,</span><br><span class="line">mount_options: [<span class="string">"dmode=775,fmode=775"</span>]</span><br><span class="line"></span><br><span class="line">------------------  这三种写法都可以 ---------------</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#config</span><span class="selector-class">.vm</span><span class="selector-class">.network</span> <span class="string">"public_network"</span>,:bridge=&gt;<span class="string">'en0: Wi-Fi (AirPort)'</span></span><br><span class="line"><span class="selector-id">#config</span><span class="selector-class">.vm</span><span class="selector-class">.network</span> <span class="string">"public_network"</span>, ip: <span class="string">"192.168.1.201"</span></span><br><span class="line"><span class="selector-id">#config</span><span class="selector-class">.vm</span><span class="selector-class">.network</span> <span class="string">"public_network"</span>, ip: <span class="string">"192.168.1.200"</span>, :bridge =&gt; <span class="string">'en0: Wi-Fi (AirPort)'</span></span><br></pre></td></tr></table></figure><h4 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vagrant reload</span></span><br></pre></td></tr></table></figure><h3 id="ok"><a href="#ok" class="headerlink" title="ok"></a>ok</h3><p>windows中 E:/data_web/webroot/  下创建文件 ,linux 中 /data ,自动同步</p><p><img src="/img/centos/vagrant/w_l.png" alt="文件同步"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-curl  一个利用URL规则在命令行下工作的文件传输工具</title>
      <link href="/2018/09/19/ubuntu/linux_DDU_curl/"/>
      <url>/2018/09/19/ubuntu/linux_DDU_curl/</url>
      <content type="html"><![CDATA[<p>在 linux 中 curl 是一款利用 URL 规则在命令下工作的开源文件传输工具.</p><p>以下 demo 中,使用文件  index.php 作为实例演示, index.php 中内容为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//访问本页面的地址为 www.test.com</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">print_r($_GET);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"分隔符"</span>;</span><br><span class="line"></span><br><span class="line">print_r($_POST);</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/test.png" alt="test" title="test"></p><h3 id="没有参数-获取页面内容"><a href="#没有参数-获取页面内容" class="headerlink" title="没有参数, 获取页面内容"></a>没有参数, 获取页面内容</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  www<span class="selector-class">.test</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/curl_01.png" alt="curl" title="curl"></p><h4 id="参数-I-显示-HTTP-头"><a href="#参数-I-显示-HTTP-头" class="headerlink" title="参数 I 显示 HTTP 头"></a>参数 I 显示 HTTP 头</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -I www<span class="selector-class">.test</span><span class="selector-class">.com</span>   [显示头信息,不显示内容]</span><br><span class="line"></span><br><span class="line">curl -<span class="selector-tag">i</span> www<span class="selector-class">.test</span><span class="selector-class">.com</span>   [显示头和内容]</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/curl_I.png" alt="curl I" title="curl I"></p><p><img src="/img/ubuntu/linux_command/linux_curl/curl_ii.png" alt="curl i" title="curl i"></p><h3 id="链接保存到文件中"><a href="#链接保存到文件中" class="headerlink" title="链接保存到文件中"></a>链接保存到文件中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">curl</span> <span class="selector-tag">www</span><span class="selector-class">.test</span><span class="selector-class">.com</span> &gt; <span class="selector-tag">index</span><span class="selector-class">.html</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/curl_url.png" alt="curl url" title="curl url"></p><h3 id="使用-d-X发送-POST-请求"><a href="#使用-d-X发送-POST-请求" class="headerlink" title="使用 -d  -X发送  POST 请求"></a>使用 -d  -X发送  POST 请求</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -<span class="keyword">d</span> <span class="string">"post1=001&amp;post2=002"</span> www.<span class="keyword">test</span>.com</span><br><span class="line">curl -<span class="keyword">d</span> <span class="string">"post1=001&amp;post2=002"</span> -X <span class="keyword">POST</span> www.<span class="keyword">test</span>.com    # X大写 <span class="keyword">POST</span> 大写</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/curl_post.png" alt="curl post" title="curl post"></p><p><img src="/img/ubuntu/linux_command/linux_curl/curl_post02.png" alt="curl post" title="curl post"></p><p>使用 -d -G 发送 GET 请求</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -d <span class="string">"get01=111&amp;get02=002"</span> -G GET www<span class="selector-class">.test</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_curl/curl_get.png" alt="curl get" title="curl get"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>linux-DDU -ln  为文件创建连接</title>
      <link href="/2018/09/12/ubuntu/linux_DDU_ln/"/>
      <url>/2018/09/12/ubuntu/linux_DDU_ln/</url>
      <content type="html"><![CDATA[<h3 id="ln-使用的时候要写全路径-否则编辑链接后的文件可能会出现错误"><a href="#ln-使用的时候要写全路径-否则编辑链接后的文件可能会出现错误" class="headerlink" title="ln 使用的时候要写全路径,否则编辑链接后的文件可能会出现错误:"></a>ln 使用的时候要写全路径,否则编辑链接后的文件可能会出现错误:</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/web</span><span class="comment"># tail -f index.html </span></span><br><span class="line"><span class="symbol">tail:</span> cannot open <span class="string">'index.html'</span> <span class="keyword">for</span> <span class="symbol">reading:</span> Too many levels of symbolic links</span><br><span class="line"><span class="symbol">tail:</span> no files remaining</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/web</span><span class="comment"># ll</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ln/error.png" alt="ln error" title="ln error"></p><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln [<span class="string">参数</span>] [<span class="string">源文件或目录</span>][<span class="symbol">目标文件或目录</span>]</span><br></pre></td></tr></table></figure><h3 id="demo-硬链接"><a href="#demo-硬链接" class="headerlink" title="demo 硬链接"></a>demo 硬链接</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln <span class="regexp">/home/</span>fei<span class="regexp">/www/i</span>ndex.html <span class="regexp">/home/</span>fei<span class="regexp">/web/</span>    </span><br><span class="line">ln <span class="regexp">/home/</span>fei<span class="regexp">/www/i</span>ndex.html <span class="regexp">/home/</span>fei<span class="regexp">/web/i</span>ndex.txt <span class="comment"># [硬链接]源文件变化后.链接的文件也随着变化</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ln/ln.png" alt="ln" title="ln"></p><p>硬链接<br>链接文件删除后,源文件不影响;<br>删除源文件后,链接文件不收影响<br><img src="/img/ubuntu/linux_command/linux_ln/ln_001.png" alt="链接文件删除后,源文件不影响" title="链接文件删除后,源文件不影响"><br><img src="/img/ubuntu/linux_command/linux_ln/ln_002.png" alt="删除源文件后,链接文件不收影响" title="删除源文件后,链接文件不收影响"></p><h3 id="软连接符号-s-相当于windows中的快捷方式"><a href="#软连接符号-s-相当于windows中的快捷方式" class="headerlink" title="软连接符号 -s   [ 相当于windows中的快捷方式]"></a>软连接符号 -s   [ 相当于windows中的快捷方式]</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /home/fei/www/test01<span class="selector-class">.txt</span> /home/fei/web/</span><br><span class="line">ln -s /home/fei/www/test05<span class="selector-class">.txt</span> /home/fei/web/test_05<span class="selector-class">.txt</span>  <span class="selector-id">#test01</span><span class="selector-class">.txt</span> 源文件变化后.链接的文件也随着变化</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ln/ln_s.png" alt="ln s" title="ln s 软连接符号"></p><p>软连接符号 -s<br>链接文件删除后,源文件不影响;<br>删除源文件后,链接文件失效<br><img src="/img/ubuntu/linux_command/linux_ln/ln_01.png" alt="链接文件删除后,源文件不影响" title="链接文件删除后,源文件不影响"><br><img src="/img/ubuntu/linux_command/linux_ln/ln_02.png" alt="删除源文件后,链接文件失效" title="删除源文件后,链接文件失效"></p><h3 id="软连接目录"><a href="#软连接目录" class="headerlink" title="软连接目录"></a>软连接目录</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s <span class="regexp">/home/</span>fei<span class="regexp">/www/</span>aaa<span class="regexp">/ /</span>home<span class="regexp">/fei/</span>web<span class="regexp">/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ln/ln_s_dir.png" alt="ln s" title="ln s 软连接符号"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>linux-DDU  -vagrant 简单使用</title>
      <link href="/2018/09/11/centos/vagrant%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
      <url>/2018/09/11/centos/vagrant%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>vagrant 常用命令介绍</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vagrant init  <span class="string">[初始化]</span></span><br><span class="line">vagrant up    <span class="string">[启动虚拟机]</span></span><br><span class="line">vagrant halt  <span class="string">[关闭虚拟机]</span></span><br><span class="line">vagrant reload <span class="string">[重新启动虚拟机,主要用于重新载入配置文件]</span></span><br><span class="line">vagrant suspend <span class="string">[暂停虚拟机,这是虚拟机的内存,配置信息会暂存至硬盘]</span></span><br><span class="line">vagrant resume  <span class="string">[恢复虚拟机]</span></span><br><span class="line">vagrant ssh   <span class="string">[ssh登录到虚拟机]</span></span><br><span class="line">vagrant status  <span class="string">[查看虚拟机运行状态]</span></span><br><span class="line">vagrant destroy <span class="string">[销毁当前虚拟机]</span></span><br><span class="line">vagrant box add <span class="string">[添加一个box]</span></span><br><span class="line">vagrant box list <span class="string">[显示当前已经添加的box列表]</span></span><br><span class="line">vagrant box remove <span class="string">[删除相应的box]</span></span><br><span class="line">vagrant package  <span class="string">[打包命令,可以吧当前运行的虚拟机环境进行打包]</span></span><br><span class="line">vagrant plugin  <span class="string">[用于安装卸载插件]</span></span><br><span class="line">vagrant ssh-config <span class="string">[输出用于ssh连接的一些信息]</span></span><br></pre></td></tr></table></figure><p>一般使用</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>vagrant --help</span><br><span class="line"><span class="number">2.</span>vagrant -version</span><br><span class="line"><span class="number">3.</span>显示当前已经添加的<span class="built_in">box</span>列表</span><br><span class="line">vagrant <span class="built_in">box</span> list </span><br><span class="line"><span class="number">4.</span>  添加 <span class="built_in">box</span> </span><br><span class="line">vagrant <span class="built_in">box</span> <span class="built_in">add</span> <span class="keyword">new</span>-<span class="built_in">box</span>-name yours-<span class="built_in">box</span>-name.<span class="built_in">box</span>(你的<span class="built_in">box</span>文件)</span><br><span class="line"><span class="number">5.</span>  删除 <span class="built_in">box</span></span><br><span class="line">vagrant <span class="built_in">box</span> remove yours-<span class="built_in">box</span>-name</span><br><span class="line"><span class="number">6.</span> 指定 <span class="built_in">box</span> 初始化</span><br><span class="line">vagrant init yours-<span class="built_in">box</span>-name</span><br><span class="line"><span class="number">7.</span>启动</span><br><span class="line">vagrant up</span><br><span class="line">vagrant up --provider virtualbox</span><br><span class="line"><span class="number">8.</span>关闭</span><br><span class="line">vagrant halt</span><br><span class="line"><span class="number">9.</span>重新启动,加载配置文件</span><br><span class="line">vagrant reload</span><br><span class="line"><span class="number">10.</span> 挂起</span><br><span class="line">vagrant suspend</span><br><span class="line"><span class="number">11.</span> ssh登录</span><br><span class="line">vagrant ssh</span><br><span class="line"><span class="number">12.</span> 打包<span class="built_in">box</span></span><br><span class="line">打包前删除一个文件</span><br><span class="line">sudo rm -rf /etc/udev/rules.d/<span class="number">70</span>-persistent-net.rules</span><br><span class="line">vagrant <span class="keyword">package</span></span><br><span class="line">vagrant <span class="keyword">package</span> --base ubuntu18_default_1543569229538_92064 --output php72_mysql8_nginx.<span class="built_in">box</span></span><br><span class="line"></span><br><span class="line">demo:</span><br><span class="line">    vagrant --help</span><br><span class="line">    vagrant -version</span><br><span class="line">    vagrant <span class="built_in">box</span> list</span><br><span class="line">    vagrant <span class="built_in">box</span> <span class="built_in">add</span> centos7 centos7-vagrant<span class="number">-123456.</span><span class="built_in">box</span></span><br><span class="line">    vagrant <span class="built_in">box</span> list</span><br><span class="line">    vagrant init centos7</span><br><span class="line">    vagrant up --provider virtualbox</span><br><span class="line">    vagrant ssh</span><br><span class="line">    vagrant reload</span><br><span class="line">    vagrant ssh</span><br><span class="line">    vagrant halt</span><br></pre></td></tr></table></figure><p><a href="http://cloud-images.ubuntu.com/releases/releases/" title="记得要下载release版本" target="_blank" rel="noopener">ubuntu box -releases版本</a></p><p><a href="http://cloud.centos.org/centos/7/vagrant/x86_64/images/" target="_blank" rel="noopener">centos box</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-xargs  用作替换工具，读取输入数据重新格式化后输出</title>
      <link href="/2018/08/28/ubuntu/linux_DDU_xargs/"/>
      <url>/2018/08/28/ubuntu/linux_DDU_xargs/</url>
      <content type="html"><![CDATA[<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><h3 id="在目录中搜索含有固定字符串文件命令，比如："><a href="#在目录中搜索含有固定字符串文件命令，比如：" class="headerlink" title="在目录中搜索含有固定字符串文件命令，比如："></a>在目录中搜索含有固定字符串文件命令，比如：</h3><p>在当前目录(及其子目录)中搜索扩展名为 .txt 结尾文件中包含 hello 的内容的行</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">搜索文件中内容</span><br><span class="line">grep "hello" test01.txt</span><br><span class="line"></span><br><span class="line">查找 .txt 结尾的文件</span><br><span class="line">find -name "*.txt"</span><br><span class="line">find /home/fei/www -name "*.txt"</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">***</span></span><br><span class="line"></span><br><span class="line">find  -name "*.txt" | xargs grep "hello"</span><br><span class="line">find /home/fei/www -name "*.txt" | xargs grep "hello"</span><br><span class="line">locate *.txt | xargs  grep "hello"</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_xargs/xargs_01.png" alt="xargs 典型使用" title="xargs 典型使用"></p><h3 id="单行输出文本内容"><a href="#单行输出文本内容" class="headerlink" title="单行输出文本内容"></a>单行输出文本内容</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat test01.txt <span class="string">| xargs</span></span><br><span class="line"></span><br><span class="line">cat test01.txt <span class="string">| xargs -n3   [选项 -n]</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_xargs/xargs_02.png" alt="xargs 典型使用02" title="xargs 典型使用02"></p><p><img src="/img/ubuntu/linux_command/linux_xargs/xargs_03.png" alt="xargs 典型使用03" title="xargs 典型使用03"></p><h3 id="其他使用场景demo"><a href="#其他使用场景demo" class="headerlink" title="其他使用场景demo"></a>其他使用场景demo</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat url.txt <span class="string">| xargs wget -c     [下载url.txt 中链接的内容]</span></span><br><span class="line">ls <span class="string">| xargs -n2</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>常见4种排序： 冒泡排序、选择排序、插入排序、快速排序</title>
      <link href="/2018/08/27/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/"/>
      <url>/2018/08/27/%E9%9D%A2%E8%AF%95/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/</url>
      <content type="html"><![CDATA[<p>这里介绍4种常见排序： 冒泡排序、选择排序、插入排序、快速排序 、二分查找</p><h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><p>原理：对一组数据，比较相邻数的大小，将值大的放到后面。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 冒泡排序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleOrder</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $count = count($arr);</span><br><span class="line">    $temp = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 外层控制排序次数</span></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count - <span class="number">1</span>; $i++) &#123;</span><br><span class="line">        <span class="comment">// 内层控制每轮比较次数</span></span><br><span class="line">        <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; $count - <span class="number">1</span> - $i; $j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($arr[$j] &gt; $arr[$j + <span class="number">1</span>]) &#123;</span><br><span class="line">                $temp = $arr[$j];</span><br><span class="line">                $arr[$j] = $arr[$j + <span class="number">1</span>];</span><br><span class="line">                $arr[$j + <span class="number">1</span>] = $temp;</span><br><span class="line">            &#125;   <span class="comment">// print_r($arr);  echo "&lt;br&gt;";</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">$res = bubbleOrder($arr);</span><br><span class="line">var_dump($res);</span><br></pre></td></tr></table></figure><p><img src="/img/interview/algorithm/sort/冒泡排序_01.png" alt="冒泡排序代码" title="冒泡排序代码"></p><p><img src="/img/interview/algorithm/sort/冒泡排序_02.png" alt="冒泡排序运行结果" title="冒泡排序运行结果"></p><h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><p>原理：在一组数据中，选出最小的数与第一个位置交换，<br>​     然后在剩下的数据中在找出最小的数和第二个位置交换<br>​     然后在剩下的数据中在找出最小的数和第三个位置交换<br>​     依次类推直到倒数第二个数和最后一个数对比</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 选择排序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selcetOrder</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 定义中间变量</span></span><br><span class="line">    $temp = <span class="number">0</span>;</span><br><span class="line">    $count = count($arr);</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count - <span class="number">1</span>; $i++) &#123;</span><br><span class="line">        <span class="comment">//定义最小位置</span></span><br><span class="line">        $minIndex = $i;</span><br><span class="line">        <span class="keyword">for</span> ($j = $i + <span class="number">1</span>; $j &lt; $count; $j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($arr[$j] &lt; $arr[$minIndex]) &#123;</span><br><span class="line">                $minIndex = $j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($i != $minIndex) &#123;</span><br><span class="line">            $temp = $arr[$i];</span><br><span class="line">            $arr[$i] = $arr[$minIndex];</span><br><span class="line">            $arr[$minIndex] = $temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">$res = selcetOrder($arr);</span><br><span class="line">var_dump($res);</span><br></pre></td></tr></table></figure><p><img src="/img/interview/algorithm/sort/选择排序_01.png" alt="选择排序代码" title="选择排序代码"></p><p><img src="/img/interview/algorithm/sort/选择排序_02.png" alt="选择排序运行结果" title="选择排序运行结果"></p><h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><p>原理： 将需要排序的书，与前面已经排好的数据从后往前进行比较，使其插入到相应的位置；</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 插入排序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertOrder</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $len = count($arr);</span><br><span class="line">    <span class="comment">//控制总循环次数</span></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">        $temp = $arr[$i];</span><br><span class="line">        <span class="keyword">for</span> ($j = $i - <span class="number">1</span>; $j &gt;= <span class="number">0</span>; $j--) &#123;</span><br><span class="line">            <span class="comment">//从当前位置从后往前进行对比</span></span><br><span class="line">            <span class="keyword">if</span> ($temp &lt; $arr[$j]) &#123;</span><br><span class="line">                $arr[$j + <span class="number">1</span>] = $arr[$j];</span><br><span class="line">                $arr[$j] = $temp;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">$res = insertOrder($arr);</span><br><span class="line">var_dump($res);</span><br></pre></td></tr></table></figure><p><img src="/img/interview/algorithm/sort/插入排序_01.png" alt="插入排序代码" title="插入排序代码"></p><p><img src="/img/interview/algorithm/sort/插入排序_02.png" alt="插入排序结果" title="插入排序运行结果"></p><h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><p>原理：初始一个中间值(一般选择第一个)，将需要排序的数组分成3部分，小于中间的值放左边、中间值、大于中间值的放右边，继续用递归用相同的方式来排序左边和右边，最后合并数组</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 快速排序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickOrder</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 判断是否需要运行,下面要拿出一个中间值</span></span><br><span class="line">    <span class="keyword">if</span> (count($arr)&lt;=<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $arr;</span><br><span class="line">    &#125;</span><br><span class="line">    $middle = $arr[<span class="number">0</span>]; <span class="comment">// 中间值</span></span><br><span class="line">    $left   = <span class="keyword">array</span>();</span><br><span class="line">    $right  = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($middle &lt; $arr[$i]) &#123;</span><br><span class="line">            $right[] = $arr[$i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $left[] = $arr[$i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 递归排序划分好的2边数组</span></span><br><span class="line">    $left = quickOrder($left);</span><br><span class="line">    $right = quickOrder($right);</span><br><span class="line">    <span class="keyword">return</span> array_merge($left, <span class="keyword">array</span>($middle), $right);</span><br><span class="line">&#125;</span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">$res = quickOrder($arr);</span><br><span class="line">var_dump($res);</span><br></pre></td></tr></table></figure><h3 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正向排序的数组</span></span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>);</span><br><span class="line"><span class="comment">// $arr = array(1, 3, 20, 7, 9, 11);</span></span><br><span class="line"><span class="comment">// $arr2 = array(11, 9, 7, 5, 3, 1);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binary_search</span><span class="params">($array, $low, $high, $k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($low &lt;= $high)&#123;</span><br><span class="line">        $mid = intval(($low+$high)/<span class="number">2</span>);  <span class="comment">//intval();floor() 都可以无所谓</span></span><br><span class="line">        <span class="keyword">if</span> ($array[$mid] == $k)&#123;</span><br><span class="line">            <span class="keyword">return</span> $mid;</span><br><span class="line">        &#125;<span class="keyword">elseif</span> ($k &lt; $array[$mid])&#123;</span><br><span class="line">            <span class="keyword">return</span> binary_search($array, $low, $mid<span class="number">-1</span>, $k);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> binary_search($array, $mid+<span class="number">1</span>, $high, $k);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'必须是正向排序数组'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> binary_search($arr, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-locate 搜索</title>
      <link href="/2018/08/26/ubuntu/linux_DDU_locate_updatedb/"/>
      <url>/2018/08/26/ubuntu/linux_DDU_locate_updatedb/</url>
      <content type="html"><![CDATA[<p>使用 locate 搜索前一般先执行 updatedb 来更新</p><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locate <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">n 至多显示 n个输出。</span></span><br><span class="line"><span class="ruby">-r 使用正规运算式 做寻找的条件。</span></span><br><span class="line"><span class="ruby">-c 查询指定文件的数目</span></span><br></pre></td></tr></table></figure><p>demo</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">locate</span> pwd</span><br><span class="line"><span class="keyword">locate</span> -n <span class="number">2</span> pwd     [显示<span class="number">2</span>条输出]</span><br><span class="line"><span class="keyword">locate</span> -r  pwdt.*   [使用正则]</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_locate_updatedb/locate_01.png" alt="locate 使用正则搜索" title="使用正则搜索"></p><h3 id="指定位置搜索"><a href="#指定位置搜索" class="headerlink" title="指定位置搜索"></a>指定位置搜索</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">locate</span> aaa/linux.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_locate_updatedb/locate_02.png" alt="locate 指定位置搜素" title="指定位置搜素"></p><h3 id="查询指定文件的数目"><a href="#查询指定文件的数目" class="headerlink" title="查询指定文件的数目"></a>查询指定文件的数目</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">locate</span> -c  pwd</span><br><span class="line"><span class="keyword">locate</span> -c  pwdt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_locate_updatedb/locate_03.png" alt="locate 查询指定文件的数目" title="查询指定文件的数目"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-rename  文件重命名</title>
      <link href="/2018/08/19/ubuntu/linux_DDU_rename/"/>
      <url>/2018/08/19/ubuntu/linux_DDU_rename/</url>
      <content type="html"><![CDATA[<h3 id="命令格式，文件重命名"><a href="#命令格式，文件重命名" class="headerlink" title="命令格式，文件重命名"></a>命令格式，文件重命名</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rename [-v] [-n] [-f] perlexpr[files]</span><br><span class="line"></span><br><span class="line">-<span class="ruby">v 打印被重命名的文件</span></span><br><span class="line"><span class="ruby">-n 只显示被重命名的文件，而不实际重命名</span></span><br><span class="line"><span class="ruby">-f 覆盖已经存在的文件</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">perlexpr 语言格式的正则表达式</span></span><br></pre></td></tr></table></figure><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><h3 id="把-test02-txt-重命名为-test03-txt"><a href="#把-test02-txt-重命名为-test03-txt" class="headerlink" title="把 test02.txt 重命名为 test03.txt"></a>把 test02.txt 重命名为 test03.txt</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rename</span> <span class="string">'s/test02.txt/test03.txt/'</span> test02.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rename/rename_01.png" alt="rename" title="重命名"></p><h3 id="参数-v-打印被重命名的文件"><a href="#参数-v-打印被重命名的文件" class="headerlink" title="参数 -v 打印被重命名的文件"></a>参数 -v 打印被重命名的文件</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rename</span> -v <span class="string">'s/test03.txt/test02.txt/'</span> test03.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rename/rename_v.png" alt="rename v" title="重命名参数v"></p><h3 id="参数-n-只显示被重命名的文件，而不实际重命名"><a href="#参数-n-只显示被重命名的文件，而不实际重命名" class="headerlink" title="参数 -n 只显示被重命名的文件，而不实际重命名"></a>参数 -n 只显示被重命名的文件，而不实际重命名</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename -n <span class="string">'s/test02.txt/test03.txt/'</span> test02<span class="selector-class">.txt</span>   [实际没有重命名]</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rename/rename_n.png" alt="rename n" title="重命名参数n"></p><h3 id="参数-f-覆盖已经存在的文件"><a href="#参数-f-覆盖已经存在的文件" class="headerlink" title="参数 -f 覆盖已经存在的文件"></a>参数 -f 覆盖已经存在的文件</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rename -f <span class="string">'s/test02.txt/test08.txt/'</span> test02.txt</span><br><span class="line">rename -f <span class="string">'s/test02.txt/test08.txt/'</span> *<span class="selector-class">.txt</span>    [也可以]</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rename/rename_f.png" alt="rename f" title="重命名参数f"></p><p><img src="/img/ubuntu/linux_command/linux_rename/rename_f_2.png" alt="rename f" title="重命名参数f"></p><h2 id="表达式中-替换用-s-转化用-y-或者tr"><a href="#表达式中-替换用-s-转化用-y-或者tr" class="headerlink" title="表达式中 替换用 s ,转化用 y 或者tr"></a>表达式中 替换用 s ,转化用 y 或者tr</h2><h3 id="demo-：-将文件名改为大写"><a href="#demo-：-将文件名改为大写" class="headerlink" title="demo ： 将文件名改为大写"></a>demo ： 将文件名改为大写</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rename</span> <span class="string">'y/a-z/A-Z/'</span> <span class="regexp">*.txt</span></span><br><span class="line">rename <span class="string">'tr/a-z/A-Z/'</span> <span class="regexp">*.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rename/rename_zhuanhua.png" alt="rename 转化" title="重命名 转化"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-nl  计算文件中行号</title>
      <link href="/2018/08/13/ubuntu/linux_DDU_nl/"/>
      <url>/2018/08/13/ubuntu/linux_DDU_nl/</url>
      <content type="html"><![CDATA[<p>介绍： 计算文件中行号；</p><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">b ：指定行号指定的方式，主要有两种：</span></span><br><span class="line"><span class="ruby">    -b a ：表示不论是否为空行，也同样列出行号(类似 cat -n)；</span></span><br><span class="line"><span class="ruby">    -b t ：如果有空行，空的那一行不要列出行号(默认值)；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-n ：列出行号表示的方法，主要有三种：</span></span><br><span class="line"><span class="ruby">    -n ln ：行号在萤幕的最左方显示；</span></span><br><span class="line"><span class="ruby">    -n rn ：行号在自己栏位的最右方显示，且不加 <span class="number">0</span> ；</span></span><br><span class="line"><span class="ruby">    -n rz ：行号在自己栏位的最左方显示，且加 <span class="number">0</span> ；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-w ：行号栏位的占用的位数。</span></span><br></pre></td></tr></table></figure><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>-b 指定行号列出 test01.txt 的内容【-b a ;     -b t】</p><p>demo</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nl -<span class="selector-tag">b</span> <span class="selector-tag">a</span> test01<span class="selector-class">.txt</span>    【空行显示行号】</span><br><span class="line"></span><br><span class="line">nl -<span class="selector-tag">b</span> t test01<span class="selector-class">.txt</span>    【空行不显示行号】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_nl/nl_b.png" alt="root passwd" title="-b 指定行号"></p><h3 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h3><p>-n  显示行号列出test01.txt 的内容【-n ln ;  -n ln; -n rz】</p><p>demo</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nl -n ln test01<span class="selector-class">.txt</span>  【行号在左】</span><br><span class="line"></span><br><span class="line">nl -n rn test01<span class="selector-class">.txt</span>  【行号在右】</span><br><span class="line"></span><br><span class="line">nl -n rz test01<span class="selector-class">.txt</span>  【行号在左，且加零】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_nl/nl_n.png" alt="root passwd" title="-n 显示行号"></p><h3 id="参数-2"><a href="#参数-2" class="headerlink" title="参数"></a>参数</h3><p>-w  列出行号占用的位数</p><p>demo</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nl</span> <span class="selector-tag">-n</span> <span class="selector-tag">rz</span> <span class="selector-tag">-w</span> 3 <span class="selector-tag">test01</span><span class="selector-class">.txt</span></span><br><span class="line"><span class="selector-tag">nl</span> <span class="selector-tag">-n</span> <span class="selector-tag">rz</span> <span class="selector-tag">-w</span> 5 <span class="selector-tag">test01</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_nl/nl_w.png" alt="root passwd" title="-w 列出行号占用位数"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Ubuntu -nginx</title>
      <link href="/2018/06/07/ubuntu/linux_ubuntu_nginx_02/"/>
      <url>/2018/06/07/ubuntu/linux_ubuntu_nginx_02/</url>
      <content type="html"><![CDATA[<h3 id="日志切割-testlog-sh"><a href="#日志切割-testlog-sh" class="headerlink" title="日志切割  testlog.sh"></a>日志切割  testlog.sh</h3><p>使用脚本切割 nginx 日志，脚本内容如下</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">--------------------------nginx.conf---------------------</span><br><span class="line">  #打开注释</span><br><span class="line">  #log_format  main </span><br><span class="line">    </span><br><span class="line"> <span class="built_in"> server </span>&#123;</span><br><span class="line">        listen       80;   </span><br><span class="line">        server_name  test.com;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   test.com;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        access_log  logs/test.com.access.log  main;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">--------------------------testlog.sh---------------------</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="attribute">LOGPATH</span>=/data/server/nginx-1.4.2/logs/test.com.access.log</span><br><span class="line"><span class="attribute">BASEPATH</span>=/data/$(date -d yesterday +%Y%m)</span><br><span class="line"></span><br><span class="line">mkdir -p <span class="variable">$BASEPATH</span></span><br><span class="line"><span class="attribute">bak</span>=<span class="variable">$BASEPATH</span>/$(date -d yesterday +%Y%m%d%H%M).test.com.access.log</span><br><span class="line"><span class="comment">#echo $bak</span></span><br><span class="line"></span><br><span class="line">mv <span class="variable">$LOGPATH</span> <span class="variable">$bak</span></span><br><span class="line">touch <span class="variable">$LOGPATH</span></span><br><span class="line">kill -USR1 cat /data/server/nginx-1.4.2/logs/nginx.pid</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/other/nginx_log.png" alt="nginx log" title="nginx log"></p><h3 id="location-精准匹配，正则匹配"><a href="#location-精准匹配，正则匹配" class="headerlink" title="location  精准匹配，正则匹配"></a>location  精准匹配，正则匹配</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:<span class="keyword">location</span> <span class="title">[ = | ~ | ~* | ^~ ] uri</span> &#123; ... &#125;</span><br><span class="line"><span class="keyword">location</span> <span class="title">@name</span> &#123; ... &#125;</span><br><span class="line">Default:—</span><br><span class="line">Context:server, location</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/other/nginx_location.png" alt="nginx location" title="nginx location"></p><p> <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#location&quot;location 模块&quot;" target="_blank" rel="noopener">location 模块</a></p><h3 id="rewrite-重写"><a href="#rewrite-重写" class="headerlink" title="rewrite 重写"></a>rewrite 重写</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-head -tail  输出文件中的内容</title>
      <link href="/2018/06/06/ubuntu/linux_DDU_head_tail/"/>
      <url>/2018/06/06/ubuntu/linux_DDU_head_tail/</url>
      <content type="html"><![CDATA[<h2 id="命令-head"><a href="#命令-head" class="headerlink" title="命令 head"></a>命令 head</h2><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-n<span class="tag">&lt;<span class="name">数字</span>&gt;</span>：指定显示头部内容的行数；</span><br></pre></td></tr></table></figure><p>demo</p><p>默认显示文件前 10 行内容</p><p>参数 n 显示文件的前 2 行</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#显示文件的前<span class="number">2</span>行</span><br><span class="line">head <span class="number">-2</span> d01.txt</span><br><span class="line">head -n <span class="number">2</span> d01.txt</span><br><span class="line"></span><br><span class="line">#输出除了文件最后 <span class="number">2</span> 行的全部内容</span><br><span class="line">head -n <span class="number">-2</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_head_tail/head_n.png" alt="root 显示文件的前 2 行" title="显示文件的前 2 行"></p><p><img src="/img/linux_command/linux_head_tail/head_n2.png" alt="root 显示除了文件的最后 2 行" title="显示除了文件的最后 2 行"></p><h2 id="命令-tail"><a href="#命令-tail" class="headerlink" title="命令 tail"></a>命令 tail</h2><h3 id="命令格式-1"><a href="#命令格式-1" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项-1"><a href="#选项-1" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">n&lt;N&gt;或——line=&lt;N&gt;：输出文件的尾部N（N位数字）行内容。</span></span><br><span class="line"><span class="ruby">-f&lt;name/descriptor&gt;：显示文件最新追加的内容。“name”表示以文件名的方式监视文件的变化。</span></span><br><span class="line"><span class="ruby">-F：与选项“-follow=name”和“--<span class="keyword">retry</span><span class="string">"连用时功能相同；</span></span></span><br></pre></td></tr></table></figure><p>demo</p><p>默认显示文件最后 10 行内容</p><p>选项 n 显示文件最后 2 行内容</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tail <span class="number">-2</span> d01.txt</span><br><span class="line">tail -n <span class="number">2</span> d01.txt</span><br><span class="line"></span><br><span class="line">#从文件第 <span class="number">3</span> 行开始显示内容</span><br><span class="line">tail -n +<span class="number">3</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_head_tail/tail_n.png" alt="root 显示文件的最后 2 行" title="显示文件的最后 2 行"></p><p><img src="/img/linux_command/linux_head_tail/tail_n2.png" alt="root 从文件第 3 行开始显示内容" title="从文件第 3 行开始显示内容"></p><p>选项 f ,动态显示文件内容</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ping</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> &gt; d01.<span class="built_in">log</span> &amp;     <span class="meta">#创建动态任务</span></span><br><span class="line"></span><br><span class="line">tail -f d01.<span class="built_in">log</span>                <span class="meta">#动态显示文件内容</span></span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_head_tail/tail_f.gif" alt="root 动态显示文件内容" title="动态显示文件内容"></p><p>选项 tail -F 功能与 tail -f 功能相同，不同的是执行此命令时文件可以不存在</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-less -more  显示目录列表</title>
      <link href="/2018/05/30/ubuntu/linux_DDU_less_more/"/>
      <url>/2018/05/30/ubuntu/linux_DDU_less_more/</url>
      <content type="html"><![CDATA[<p>less 与 more 类似，但使用 less 可以随意浏览文件，而且 less 在查看之前不会加载整个文件 </p><h2 id="命令-less"><a href="#命令-less" class="headerlink" title="命令 less"></a>命令 less</h2><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/字符串：向下搜索“字符串”的功能</span><br><span class="line">?字符串：向上搜索“字符串”的功能</span><br><span class="line">n：重复前一个搜索（与 / 或 ? 有关）</span><br><span class="line">N：反向重复前一个搜索（与 / 或 ? 有关）</span><br><span class="line">b  向后翻一页</span><br><span class="line">d  向后翻半页</span><br><span class="line">h  显示帮助界面</span><br><span class="line">q  退出less 命令</span><br><span class="line">u  向前滚动半页</span><br><span class="line">y  向前滚动一行</span><br><span class="line">空格键 滚动一行</span><br><span class="line">回车键 滚动一页</span><br><span class="line"><span class="string">[pagedown]</span>： 向下翻动一页</span><br><span class="line"><span class="string">[pageup]</span>：   向上翻动一页</span><br></pre></td></tr></table></figure><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>文件：指定要分屏显示内容的文件。 </p><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">less</span> d01.txt               <span class="comment">#查看文件</span></span><br><span class="line">ps -ef | <span class="keyword">less</span>              <span class="comment">#PS查看进程信息并通过 less 分页显示</span></span><br><span class="line">history | <span class="keyword">less</span>             <span class="comment">#查看历史使用记录并通过 less 分页显示</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q  退出<span class="keyword">less</span> 命令</span><br><span class="line">[pagedown]： 向下翻动一页</span><br><span class="line">[pageup]：   向上翻动一页</span><br><span class="line"></span><br><span class="line"><span class="keyword">less</span> d01.txt d02.txt d03.txt      <span class="comment">#浏览多个文件</span></span><br><span class="line">说明：</span><br><span class="line">输入 :n后,切换到  d02.txt,继续输入:n后,切换到 d03.txt</span><br><span class="line">输入 :p后,切换到  d02.txt,继续输入:p后,切换到 d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_less/less.png" alt="less" title="less"></p><h2 id="命令-more"><a href="#命令-more" class="headerlink" title="命令 more"></a>命令 more</h2><p>more命令从前向后读取文件，因此在启动时就加载整个文件。 </p><h3 id="命令格式-1"><a href="#命令格式-1" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项-1"><a href="#选项-1" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+n      从笫n行开始显示</span><br><span class="line">-<span class="ruby">n       定义屏幕大小为n行</span></span><br><span class="line"><span class="ruby">+<span class="regexp">/pattern 在每个档案显示前搜寻该字串（pattern），然后从该字串前两行之后开始显示  </span></span></span><br><span class="line"><span class="ruby">-c       从顶部清屏，然后显示</span></span><br><span class="line"><span class="ruby">-d       提示“Press space to continue，<span class="string">'q'</span> to quit（按空格键继续，按q键退出）”，禁用响铃功能</span></span><br><span class="line"><span class="ruby">-l        忽略Ctrl+l（换页）字符</span></span><br><span class="line"><span class="ruby">-p       通过清除窗口而不是滚屏来对文件进行换页，与-c选项相似</span></span><br><span class="line"><span class="ruby">-s       把连续的多个空行显示为一行</span></span><br><span class="line"><span class="ruby">-u       把文件内容中的下画线去掉</span></span><br></pre></td></tr></table></figure><p>常用命令</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Enter    向下<span class="built_in">n</span>行，需要定义。默认为<span class="number">1</span>行</span><br><span class="line">Ctrl+F   向下滚动一屏</span><br><span class="line">空格键  向下滚动一屏</span><br><span class="line">Ctrl+B  返回上一屏</span><br><span class="line">=       输出当前行的行号</span><br><span class="line">：f     输出文件名和当前行的行号</span><br><span class="line">V      调用vi编辑器</span><br><span class="line">!命令   调用Shell，并执行命令 </span><br><span class="line">q       退出more</span><br></pre></td></tr></table></figure><h3 id="demo-1"><a href="#demo-1" class="headerlink" title="demo"></a>demo</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">more +<span class="number">1</span> d01.txt    #显示文件中从第<span class="number">1</span>行器内容</span><br><span class="line">more +<span class="number">2</span> d01.txt    #显示文件中从第<span class="number">2</span>行器内容</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_more/more_01.png" alt="more" title="more"></p><p>从文件中查找第一个出现 “d01” 字符串的行，并从该处前2行显示输出<br>从文件中查找第一个出现 “3” 字符串的行，并从该处前2行显示输出<br>从文件中查找第一个出现 “hello” 字符串的行，并从该处前2行显示输出</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more +/d01  d01.txt</span><br><span class="line">more +/<span class="number">3</span>  d01.txt</span><br><span class="line">more +/hello  d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_more/more_02.png" alt="more" title="more"></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">设定每屏显示行数</span><br><span class="line"><span class="keyword">more</span> -1 d01.txt</span><br><span class="line"><span class="keyword">more</span> -2 d01.txt</span><br><span class="line"></span><br><span class="line">列一个目录下的文件，由于内容太多，我们应该学会用<span class="keyword">more</span>来分页显示。这得和管道 | 结合起来</span><br><span class="line"><span class="keyword">ls</span> -<span class="keyword">l</span> | <span class="keyword">more</span> -1</span><br><span class="line"><span class="keyword">ls</span> -<span class="keyword">l</span> | <span class="keyword">more</span> -2</span><br><span class="line"></span><br><span class="line">q 键退出，enter向下</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_more/more_03.png" alt="more" title="more"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-mkdir  -rmdir 显示目录列表</title>
      <link href="/2018/05/28/ubuntu/linux_DDU_mkdir_rmdir/"/>
      <url>/2018/05/28/ubuntu/linux_DDU_mkdir_rmdir/</url>
      <content type="html"><![CDATA[<p>mkdir 不指定参数，创建文件默认权限 为 755  rwxr-xr-x</p><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir [选项] [参数]</span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">m&lt;目标属性&gt;或--mode&lt;目标属性&gt;建立目录的同时设置目录的权限；</span></span><br><span class="line"><span class="ruby">-p或--parents 若所要建立目录的上层目录目前尚未建立，则会一并建立上层目录；</span></span><br><span class="line"><span class="ruby">--version 显示版本信息。</span></span><br></pre></td></tr></table></figure><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>目录：指定要创建的目录列表，多个目录之间用空格隔开</p><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><h3 id="选项-m-创建目录并设置权限"><a href="#选项-m-创建目录并设置权限" class="headerlink" title="选项 -m 创建目录并设置权限"></a>选项 -m 创建目录并设置权限</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mkdir</span> -<span class="keyword">m</span> 700 /www/<span class="keyword">test</span>    #在 /www  目录下创建子目录<span class="keyword">test</span>，并设置 700 权限</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_mkdir/mkdir_m.png" alt="mkdir 创建目录并设置权限" title="mkdir 创建目录并设置权限"></p><h3 id="选项-m-创建-子目录"><a href="#选项-m-创建-子目录" class="headerlink" title="选项 -m 创建 子目录"></a>选项 -m 创建 子目录</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p aaa/bbb    #在当前目录创建<span class="built_in"> aaa </span>目录 和 aaa下的bbb目录</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_mkdir/mkdir_p.png" alt="mkdir 创建子目录" title="mkdir 创建子目录"></p><h2 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h2><p>只可以删除空目录</p><h3 id="命令格式-1"><a href="#命令格式-1" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmdir [选项] [参数]</span><br></pre></td></tr></table></figure><h3 id="选项-1"><a href="#选项-1" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">p或--parents：删除指定目录后，若该目录的上层目录已变成空目录，则将其一并删除；</span></span><br><span class="line"><span class="ruby">-v或-verboes：显示命令的详细执行过程；</span></span><br><span class="line"><span class="ruby">--help：显示命令的帮助信息；</span></span><br><span class="line"><span class="ruby">--version：显示命令的版本信息。</span></span><br></pre></td></tr></table></figure><h3 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h3><p>目录列表：要删除的空目录列表。当删除多个空目录时，目录名之间使用空格隔开。 </p><h3 id="选项-p-删除空目录"><a href="#选项-p-删除空目录" class="headerlink" title="选项 -p 删除空目录"></a>选项 -p 删除空目录</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">rmdir</span>    aaa/<span class="keyword">bbb </span>  #删除 <span class="keyword">bbb </span>目录</span><br><span class="line"><span class="symbol">rmdir</span> -p aaa/<span class="keyword">bbb </span>  #删除 <span class="keyword">bbb </span>目录，如果aa目录是空也一并删除</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_mkdir/rmdir.png" alt="rmdir 删除空目录" title="rmdir 删除空目录"></p><p><img src="/img/linux_command/linux_mkdir/rmdir_p.png" alt="rmdir 删除空目录和子目录" title="rmdir 删除空目录和子目录"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-sh  shell 脚本</title>
      <link href="/2018/05/28/ubuntu/linux_DDU_sh/"/>
      <url>/2018/05/28/ubuntu/linux_DDU_sh/</url>
      <content type="html"><![CDATA[<h3 id="简单shell，打印昨天时间，并输出到屏幕上，注意-反引号"><a href="#简单shell，打印昨天时间，并输出到屏幕上，注意-反引号" class="headerlink" title="简单shell，打印昨天时间，并输出到屏幕上，注意 反引号"></a>简单shell，打印昨天时间，并输出到屏幕上，注意 反引号</h3><p>echo  把执行命令的返回结果输出到屏幕上<br>运行脚本  sh test.sh ;  test.sh 内容如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'date -d yesterday +%Y%m%d'</span>  <span class="comment">#没有使用反引号</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> `date -d yesterday +%Y%m%d`  <span class="comment">#使用反引号，输出昨天时间</span></span><br><span class="line"><span class="built_in">echo</span> `ls /www`                    <span class="comment">#使用反引号，显示 www 目录下文件</span></span><br><span class="line">touch /www/test.txt               <span class="comment">#在 www 目录下创建 test.txt 文件</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_sh/sh_01.png" alt="demo shell" title="demo shell"></p><p>demo 2,创建文件，运行命令  sh testlog.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">BASEPATH=/data/$(date -d yesterday +%Y%m)</span><br><span class="line">bak=<span class="variable">$BASEPATH</span>/$(date -d yesterday +%Y%m%d%H%M).test.txt</span><br><span class="line">mkdir -p <span class="variable">$BASEPATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$BASEPATH</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_sh/sh_02.png" alt="demo shell" title="demo shell"></p><h3 id="demo3-运行-test-sh-文件使用-source-命令"><a href="#demo3-运行-test-sh-文件使用-source-命令" class="headerlink" title="demo3  运行 test.sh 文件使用 source 命令"></a>demo3  运行 test.sh 文件使用 source 命令</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source <span class="keyword">test</span>.<span class="keyword">sh</span> </span><br><span class="line"># 四个的区别区别, 执行权限; 脚本报错后是否继续执行</span><br><span class="line">1) ./<span class="keyword">test</span>.<span class="keyword">sh</span></span><br><span class="line">2) <span class="keyword">sh</span> <span class="keyword">test</span>.<span class="keyword">sh</span></span><br><span class="line">3) . <span class="keyword">test</span>.<span class="keyword">sh</span></span><br><span class="line">4) source <span class="keyword">test</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shells </span><br><span class="line">使用 <span class="comment">#sh test.sh  #dash test.sh #bash test.sh #rbash test.sh 都是可以执行的 </span></span><br><span class="line"></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/web</span><span class="comment"># cat /etc/shells </span></span><br><span class="line"><span class="comment"># /etc/shells: valid login shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/dash</span><br><span class="line">/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/home/fei/web</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-cat  连接文件并打印到标准输出设备上 -split 切割文件</title>
      <link href="/2018/05/28/ubuntu/linux_DDU_cat_split/"/>
      <url>/2018/05/28/ubuntu/linux_DDU_cat_split/</url>
      <content type="html"><![CDATA[<h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="string">[选项]</span> <span class="string">[参数]</span></span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">n或-number：有<span class="number">1</span>开始对所有输出的行数编号；</span></span><br><span class="line"><span class="ruby">-b或--number-nonblank：和-n相似，只不过对于空白行不编号；</span></span><br></pre></td></tr></table></figure><h3 id="参数-n-输出行数编号"><a href="#参数-n-输出行数编号" class="headerlink" title="参数  n  输出行数编号"></a>参数  n  输出行数编号</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cat</span> <span class="selector-tag">-n</span> <span class="selector-tag">d01</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/cat_n.png" alt="cat 输出行编号" title="输出行编号"></p><h3 id="参数-b-输出行数编号，忽略空白行"><a href="#参数-b-输出行数编号，忽略空白行" class="headerlink" title="参数 b  输出行数编号，忽略空白行"></a>参数 b  输出行数编号，忽略空白行</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat -<span class="selector-tag">b</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/cat_b.png" alt="cat 输出行编号,忽略空白行" title="输出行编号,忽略空白行"></p><h3 id="输出多个文件内容"><a href="#输出多个文件内容" class="headerlink" title="输出多个文件内容"></a>输出多个文件内容</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cat</span> <span class="selector-tag">d01</span><span class="selector-class">.txt</span> <span class="selector-tag">d02</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/cat_file.png" alt="cat 输出多个文件内容" title="输出多个文件内容"></p><h3 id="demo-2-把文件内容写入到新文件中"><a href="#demo-2-把文件内容写入到新文件中" class="headerlink" title="demo 2  把文件内容写入到新文件中"></a>demo 2  把文件内容写入到新文件中</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat d01<span class="selector-class">.txt</span> &gt; new<span class="selector-class">.txt</span>           #将文件 d01<span class="selector-class">.txt</span> 内容放入文件 new<span class="selector-class">.txt</span> 中</span><br><span class="line">cat d01<span class="selector-class">.txt</span> d02<span class="selector-class">.txt</span> &gt; new<span class="selector-class">.txt</span>   #将文件 d01<span class="selector-class">.txt</span> 和 d02<span class="selector-class">.txt</span> 内容放入文件 new<span class="selector-class">.txt</span> 中</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/cat_new_file.png" alt="cat 把文件内容写入到新文件中" title="把文件内容写入到新文件中"></p><p><img src="/img/linux_command/linux_cat/cat_new_file02.png" alt="cat 把文件内容写入到新文件中02" title="把文件内容写入到新文件中02"></p><h2 id="split-切割文件"><a href="#split-切割文件" class="headerlink" title="split 切割文件"></a>split 切割文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">参数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -a 指定长度</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d 指定数字</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -l 按行数切割文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -b 按大小切割文件</span></span><br><span class="line"></span><br><span class="line">split -l 7 test.txt  # l 选项根据文件行数切割,每7行切割为一个文件</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/split_l.png" alt="split -l 按行数切割文件" title="按行数切割文件"></p><h3 id="指定为数字后缀切割"><a href="#指定为数字后缀切割" class="headerlink" title="指定为数字后缀切割"></a>指定为数字后缀切割</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#-d 指定为数字后缀, -<span class="selector-tag">a</span> 指定数字长度</span><br><span class="line">split -l <span class="number">7</span> test<span class="selector-class">.txt</span> -d -<span class="selector-tag">a</span> <span class="number">4</span></span><br><span class="line">#-<span class="selector-tag">a</span> 指定长度  </span><br><span class="line">split -l <span class="number">7</span> -<span class="selector-tag">a</span> <span class="number">4</span> test.txt</span><br><span class="line">#前缀为fei_</span><br><span class="line">split -l <span class="number">7</span> -<span class="selector-tag">a</span> <span class="number">4</span> test<span class="selector-class">.txt</span> fei_</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/split_lda.png" alt="split -lda" title="lda"></p><p><img src="/img/linux_command/linux_cat/split_la.png" alt="split -la" title="la"></p><p><img src="/img/linux_command/linux_cat/split_pre.png" alt="split 前缀" title="前缀"></p><h3 id="按大小切割文件"><a href="#按大小切割文件" class="headerlink" title="按大小切割文件"></a>按大小切割文件</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">split -<span class="selector-tag">b</span> <span class="number">100</span> test<span class="selector-class">.txt</span>  #每<span class="number">100</span>kb切割文件</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/split_b.png" alt="split -b 按大小切割文件" title="按大小切割文件"></p><h3 id="当用split-分割好文件后-使用cat可以把文件合并为原来的文件"><a href="#当用split-分割好文件后-使用cat可以把文件合并为原来的文件" class="headerlink" title="当用split 分割好文件后,使用cat可以把文件合并为原来的文件"></a>当用split 分割好文件后,使用cat可以把文件合并为原来的文件</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">split</span> -l <span class="number">7</span> -<span class="keyword">a</span> <span class="number">4</span> test.txt fei_   <span class="comment">#分割文件</span></span><br><span class="line">cat fei_a* &gt; bbb.txt            <span class="comment">#合并文件</span></span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_cat/split_cat.png" alt="分割文件&amp;&amp;合并文件" title="分割文件&amp;&amp;合并文件"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-sed 自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序</title>
      <link href="/2018/05/04/ubuntu/linux_DDU_sed/"/>
      <url>/2018/05/04/ubuntu/linux_DDU_sed/</url>
      <content type="html"><![CDATA[<p>介绍：</p><p>sed 是实现对流的编辑。要修改原文件记得用参数 i 。</p><h3 id="sed命令格式"><a href="#sed命令格式" class="headerlink" title="sed命令格式"></a>sed命令格式</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed [<span class="keyword">options</span>] <span class="string">'command'</span> <span class="keyword">file</span>(s)</span><br><span class="line">sed [<span class="keyword">options</span>] -f scriptfile <span class="keyword">file</span>(s)</span><br><span class="line"></span><br><span class="line">sed 选项 <span class="string">'参数/文本中内容/新内容'</span> <span class="keyword">file</span>(s)</span><br></pre></td></tr></table></figure><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">e&lt;script&gt;或--expression=&lt;script&gt;：以选项中的指定的script来处理输入的文本文件；</span></span><br><span class="line"><span class="ruby">-h或--help：显示帮助；</span></span><br><span class="line"><span class="ruby">-n或--quiet或——silent：仅显示script处理后的结果；</span></span><br><span class="line"><span class="ruby">-V或--version：显示版本信息。</span></span><br></pre></td></tr></table></figure><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a\ 在当前行下面插入文本。  没有特殊字符直接写 <span class="selector-tag">a</span> 即可</span><br><span class="line">i\ 在当前行上面插入文本。  没有特殊字符直接写 <span class="selector-tag">i</span> 即可</span><br><span class="line">d 删除，删除选择的行。</span><br><span class="line">D 删除模板块的第一行。</span><br><span class="line">s 替换指定字符</span><br><span class="line">n 读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。</span><br><span class="line"><span class="selector-tag">p</span> 打印模板块的行。</span><br><span class="line"><span class="selector-tag">q</span> 退出Sed。</span><br></pre></td></tr></table></figure><h3 id="sed-替换标记"><a href="#sed-替换标记" class="headerlink" title="sed 替换标记"></a>sed 替换标记</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">g 表示行内全面替换。  </span><br><span class="line"><span class="selector-tag">p</span> 表示打印行。    </span><br><span class="line">\<span class="number">1</span> 子串匹配标记</span><br><span class="line">&amp; 已匹配字符串标记</span><br></pre></td></tr></table></figure><h3 id="sed-元字符集"><a href="#sed-元字符集" class="headerlink" title="sed 元字符集"></a>sed 元字符集</h3><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">^ 匹配行开始，如：/^sed/匹配所有以sed开头的行。</span><br><span class="line">$ 匹配行结束，如：/sed$/匹配所有以sed结尾的行。</span><br><span class="line">. 匹配一个非换行符的任意字符，如：/s.d/匹配s后接一个任意字符，最后是d。</span><br><span class="line">* 匹配0个或多个字符，如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。</span><br><span class="line">[] 匹配一个指定范围内的字符，如/[ss]ed/匹配sed和Sed。  </span><br><span class="line">[^] 匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。</span><br><span class="line"><span class="symbol">\(</span>..<span class="symbol">\)</span> 匹配子串，保存匹配的字符，如s/<span class="symbol">\(</span>love<span class="symbol">\)</span>able/<span class="symbol">\1</span>rs，loveable被替换成lovers。</span><br><span class="line">&amp; 保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love这成**love**。</span><br><span class="line"><span class="symbol">\&lt;</span> 匹配单词的开始，如:/<span class="symbol">\&lt;</span>love/匹配包含以love开头的单词的行。</span><br><span class="line"><span class="symbol">\&gt;</span> 匹配单词的结束，如/love<span class="symbol">\&gt;</span>/匹配包含以love结尾的单词的行。</span><br><span class="line">x<span class="symbol">\&#123;</span>m<span class="symbol">\&#125;</span> 重复字符x，m次，如：/0<span class="symbol">\&#123;</span>5<span class="symbol">\&#125;</span>/匹配包含5个0的行。</span><br><span class="line">x<span class="symbol">\&#123;</span>m,<span class="symbol">\&#125;</span> 重复字符x，至少m次，如：/0<span class="symbol">\&#123;</span>5,<span class="symbol">\&#125;</span>/匹配至少有5个0的行。</span><br><span class="line">x<span class="symbol">\&#123;</span>m,n<span class="symbol">\&#125;</span> 重复字符x，至少m次，不多于n次，如：/0<span class="symbol">\&#123;</span>5,10<span class="symbol">\&#125;</span>/匹配5~10个0的行。</span><br></pre></td></tr></table></figure><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><h3 id="选项-i-、n-s-，-p-替换文本中指定字符串"><a href="#选项-i-、n-s-，-p-替换文本中指定字符串" class="headerlink" title="选项  i 、n ,    s  ， p 替换文本中指定字符串"></a>选项  i 、n ,    s  ， p 替换文本中指定字符串</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sed -i 's/原内容/新内容/g' 文件</span><br><span class="line">注意这个参数并没有实际修改文件的内容</span><br><span class="line">sed 's/d01.txt/dd<span class="number">0011</span>.txt/' d01.txt      <span class="meta">#对流的修改，没有真实修改文件内容</span></span><br><span class="line">sed -i 's/d01.txt/dd<span class="number">0011</span>.txt/' d01.txt    <span class="meta"># 真实修改文件内容</span></span><br><span class="line"></span><br><span class="line">选项 n 仅显示script处理后的结果 , p 打印模板块的行</span><br><span class="line">sed -n 's/d01.txt/dd<span class="number">0011</span>.txt/p' d01.txt    <span class="meta">#打印发生修改的行，没有真实修改文件</span></span><br><span class="line"></span><br><span class="line">sed 's/d01.txt/dd<span class="number">0011</span>.txt/' d01.txt &gt; d01.txt.tmp   <span class="meta">#保存为临时文件</span></span><br><span class="line">mv d01.txt.tmp d01.txt   <span class="meta">#确认临时文件修改内容争取后替换原文件</span></span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_s.png" alt="sed 参数s" title="sed 参数s"></p><p><img src="/img/linux_command/linux_sed/sed_s.png" alt="sed 参数n" title="sed 参数n"></p><h3 id="定界符"><a href="#定界符" class="headerlink" title="定界符"></a>定界符</h3><p>以上命令字符串中使用 / 在 sed 中作为定界符使用，也可以使用任意的定界符</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'s:d01.txt:dd0011.txt:'</span> d01<span class="selector-class">.txt</span>      #对流的修改，没有真实修改文件内容</span><br><span class="line"></span><br><span class="line">在对文本中含有特殊字符的时候可以考虑使用其他定界符，比如，原内容或者新内容中包含（<span class="string">"/"</span> <span class="string">"#"</span>）</span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'s:原内容:新内容:g'</span> 文件名字  sed <span class="string">'s:d01.txt:dd0011.txt:'</span> d01.txt</span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'s,原内容,新内容,g'</span> 文件名字  sed <span class="string">'s,d01.txt,dd0011.txt,'</span> d01.txt</span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'s#原内容#新内容#g'</span> 文件名字  sed <span class="string">'s#d01.txt#dd0011.txt#'</span> d01.txt</span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'s~原内容~新内容~g'</span> 文件名字  sed <span class="string">'s~d01.txt~dd0011.txt~'</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_01.png" alt="sed 定界符" title="sed 定界符"></p><h3 id="命令-d-删除操作"><a href="#命令-d-删除操作" class="headerlink" title="命令 d  删除操作"></a>命令 d  删除操作</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">删除空白行</span><br><span class="line">sed <span class="string">'/^$/d'</span> d01<span class="selector-class">.txt</span>     [ 对流的删除 ]</span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'/^$/d'</span> d01<span class="selector-class">.txt</span>  [ 真实删除空白行后，保存 ]</span><br><span class="line"></span><br><span class="line">删除文件的第<span class="number">2</span>行</span><br><span class="line">sed <span class="string">'2d'</span> d01.txt</span><br><span class="line"></span><br><span class="line">删除文件的第<span class="number">2</span>行到末尾所有行：</span><br><span class="line">sed <span class="string">'2,$d'</span> d01<span class="selector-class">.txt</span> </span><br><span class="line"></span><br><span class="line">删除文件的最后一行</span><br><span class="line">sed <span class="string">'$d'</span> d01.txt</span><br><span class="line"></span><br><span class="line">删除文件中所有开头是 hello  的行</span><br><span class="line">sed <span class="string">'/^hello/d'</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_d.png" alt="sed 删除" title="sed 删除"></p><h3 id="已匹配字符串标记-amp-，注意这个符号"><a href="#已匹配字符串标记-amp-，注意这个符号" class="headerlink" title="已匹配字符串标记  &amp; ，注意这个符号"></a>已匹配字符串标记  &amp; ，注意这个符号</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">正则表达式 \w\+ 匹配每一个单词，使用 [&amp;] 替换它，&amp; 对应于之前所匹配到的单词</span><br><span class="line">sed <span class="string">'s/\w\+/[&amp;]/g'</span> d01<span class="selector-class">.txt</span>   [ 使用 &amp; 替换]</span><br><span class="line">sed <span class="string">'s/\w\+/[]/g'</span> d01<span class="selector-class">.txt</span>    [ 空白 ]</span><br><span class="line"></span><br><span class="line">sed -<span class="selector-tag">i</span> <span class="string">'s/\w\+/[&amp;]/g'</span> d01<span class="selector-class">.txt</span>    [真是替换，并保存]</span><br><span class="line"></span><br><span class="line">所有以 hello 开头的行都会被替换成他自己加 hi </span><br><span class="line">sed <span class="string">'s/^hello/&amp;hi/'</span> d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_&amp;.png" alt="sed 替换" title="sed 替换"></p><p><img src="/img/linux_command/linux_sed/sed_&amp;02.png" alt="sed 替换" title="sed 替换"></p><h3 id="字符串匹配标记-1"><a href="#字符串匹配标记-1" class="headerlink" title="字符串匹配标记   \1"></a>字符串匹配标记   \1</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="keyword">this</span> <span class="keyword">is</span> digit <span class="number">6</span> <span class="keyword">in</span> a number | sed <span class="string">'s/digit \([0-9]\)/\1/'</span></span><br><span class="line">echo <span class="keyword">this</span> <span class="keyword">is</span> digit <span class="number">6</span> <span class="keyword">in</span> a number | sed <span class="string">'s/digit \([0-9]\)/\1test/'</span></span><br><span class="line"></span><br><span class="line">echo <span class="keyword">this</span> <span class="keyword">is</span> test <span class="number">6</span> | sed <span class="string">'s/test \([0-9]\)/\1/'</span></span><br><span class="line">echo <span class="keyword">this</span> <span class="keyword">is</span> test <span class="number">6</span> | sed <span class="string">'s/test \([0-9]\)/\1test/'</span></span><br></pre></td></tr></table></figure><p>命令中 digit 6，被替换成了 6。样式匹配到的子串是 7，(..) 用于匹配子串，对于匹配到的第一个子串就标记为 \1，依此类推匹配到的第二个结果就是 \2，例如：</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo aaa BBB | sed 's/<span class="symbol">\(</span>[a-z]<span class="symbol">\+</span><span class="symbol">\)</span> <span class="symbol">\(</span>[A-Z]<span class="symbol">\+</span><span class="symbol">\)</span>/<span class="symbol">\2</span> <span class="symbol">\1</span>/'</span><br><span class="line">echo aaa BBB | sed 's/<span class="symbol">\(</span>[a-z]<span class="symbol">\+</span><span class="symbol">\)</span> <span class="symbol">\(</span>[A-Z]<span class="symbol">\+</span><span class="symbol">\)</span>/<span class="symbol">\1</span> <span class="symbol">\2</span>/'</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_str_mark.png" alt="sed 字符串标记" title="sed 字符串标记"></p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hi 被标记为 1 ,所有 hiLinux 会被替换成 hiUbuntu, 并打印出来</span><br><span class="line">sed -n 's/<span class="symbol">\(</span>hi<span class="symbol">\)</span>Linux/<span class="symbol">\1</span>Ubuntu/p' d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_str_mark02.png" alt="sed 字符串标记" title="sed 字符串标记"></p><h3 id="选项-e-允许在同一行里执行多条命令"><a href="#选项-e-允许在同一行里执行多条命令" class="headerlink" title="选项 e 允许在同一行里执行多条命令"></a>选项 e 允许在同一行里执行多条命令</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -e <span class="string">'1,2d'</span> -e <span class="string">'s/d01.txt/dd0011.txt/'</span>  d01<span class="selector-class">.txt</span>   </span><br><span class="line"></span><br><span class="line">第一条命令，删除<span class="number">1</span>到<span class="number">2</span>行，第二条命令用 dd0011<span class="selector-class">.txt</span> 替换 d01.txt。 这两条命令的前后顺序有影响，如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_e.png" alt="sed 多条命令执行" title="sed 多条命令执行"></p><h3 id="退出-命令：-q"><a href="#退出-命令：-q" class="headerlink" title="退出  命令： q"></a>退出  命令： q</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">打印挖第<span class="number">3</span>行后，退出sed</span><br><span class="line">sed '<span class="number">3</span>q' d01.txt</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_q.png" alt="sed 退出" title="sed 退出"></p><h3 id="打印奇数行或偶数行"><a href="#打印奇数行或偶数行" class="headerlink" title="打印奇数行或偶数行"></a>打印奇数行或偶数行</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">'p;n'</span> d01<span class="selector-class">.txt</span>  #奇数行</span><br><span class="line">sed -n <span class="string">'n;p'</span> d01<span class="selector-class">.txt</span>  #偶数行</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line">sed -n <span class="string">'1~2p'</span> d01<span class="selector-class">.txt</span>  #奇数行</span><br><span class="line">sed -n <span class="string">'2~2p'</span> d01<span class="selector-class">.txt</span>  #偶数行</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_pn.png" alt="sed 奇数偶数行" title="sed 奇数偶数行"></p><h3 id="插入新一行内容"><a href="#插入新一行内容" class="headerlink" title="插入新一行内容"></a>插入新一行内容</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'4a\我是新添加行内容'</span> d01<span class="selector-class">.txt</span>    #在第<span class="number">4</span>行后插入下一行</span><br><span class="line">sed <span class="string">'4a我是新添加行内容'</span> d01<span class="selector-class">.txt</span>     #在第<span class="number">4</span>行后插入下一行,[没有特殊字符不用加 \ 也行]</span><br><span class="line">sed <span class="string">'/hello/a\我是新添加行内容'</span> d01<span class="selector-class">.txt</span>  #在所有包含 hello 行后面插入下一行</span><br><span class="line"></span><br><span class="line">sed <span class="string">'4i\我是新添加行内容'</span> d01<span class="selector-class">.txt</span>    #在第<span class="number">4</span>行前插入下一行</span><br><span class="line">sed <span class="string">'4i我是新添加行内容'</span> d01<span class="selector-class">.txt</span>     #在第<span class="number">4</span>行前插入下一行,[没有特殊字符不用加 \ 也行]</span><br><span class="line">sed <span class="string">'/hello/i\我是新添加行内容'</span> d01<span class="selector-class">.txt</span>  #在所有包含 hello 行前面面插入下一行</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_insert.png" alt="sed 插入下一行" title="sed 插入下一行"></p><h3 id="替换某一行内容"><a href="#替换某一行内容" class="headerlink" title="替换某一行内容"></a>替换某一行内容</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed  <span class="string">"1s/.*/第一行全部替换新内容/"</span> d01<span class="selector-class">.txt</span>    #把第一行内容全部替换</span><br><span class="line">sed  <span class="string">"2s/.*/第二行全部替换新内容/"</span> d01<span class="selector-class">.txt</span>    #把第二行内容全部替换</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command/linux_sed/sed_line_replace.png" alt="sed 替换具体的某一行" title="sed 替换具体的某一行"></p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'s/d01.txt/dd0011.txt/'</span> d01.txt    <span class="comment"># 真实修改文件内容 用参数 i</span></span><br><span class="line"></span><br><span class="line">某些转义符</span><br><span class="line"><span class="string">\n</span>  表示新的一行</span><br><span class="line"><span class="string">\r</span>  表示回车</span><br><span class="line"><span class="string">\t</span>  表示水平制表符</span><br><span class="line"><span class="string">\v</span>  表示垂直制表符</span><br><span class="line"><span class="string">\b</span>  表示后退符</span><br><span class="line"><span class="string">\a</span>  表示<span class="string">"alert"</span>(蜂鸣或者闪烁)</span><br><span class="line"><span class="string">\0xx</span> 转换为八进制的ASCII码</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-grep  查找文件里符合条件的字符串</title>
      <link href="/2018/05/02/ubuntu/linux_DDU_grep/"/>
      <url>/2018/05/02/ubuntu/linux_DDU_grep/</url>
      <content type="html"><![CDATA[<h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep  <span class="string">[选项]</span>  <span class="string">[文件]</span></span><br></pre></td></tr></table></figure><h3 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">a 不要忽略二进制数据。</span></span><br><span class="line"><span class="ruby">-A&lt;显示列数&gt; 除了显示符合范本样式的那一行之外，并显示该行之后的内容。</span></span><br><span class="line"><span class="ruby">-b 在显示符合范本样式的那一行之外，并显示该行之前的内容。</span></span><br><span class="line"><span class="ruby">-c 计算符合范本样式的列数。</span></span><br><span class="line"><span class="ruby">-C&lt;显示列数&gt;或-&lt;显示列数&gt;  除了显示符合范本样式的那一列之外，并显示该列之前后的内容。</span></span><br><span class="line"><span class="ruby">-d&lt;进行动作&gt; 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作。</span></span><br><span class="line"><span class="ruby">-e&lt;范本样式&gt; 指定字符串作为查找文件内容的范本样式。</span></span><br><span class="line"><span class="ruby">-E 将范本样式为延伸的普通表示法来使用，意味着使用能使用扩展正则表达式。</span></span><br><span class="line"><span class="ruby">-f&lt;范本文件&gt; 指定范本文件，其内容有一个或多个范本样式，让grep查找符合范本条件的文件内容，格式为每一列的范本样式。</span></span><br><span class="line"><span class="ruby">-F 将范本样式视为固定字符串的列表。</span></span><br><span class="line"><span class="ruby">-G 将范本样式视为普通的表示法来使用。</span></span><br><span class="line"><span class="ruby">-h 在显示符合范本样式的那一列之前，不标示该列所属的文件名称。</span></span><br><span class="line"><span class="ruby">-H 在显示符合范本样式的那一列之前，标示该列的文件名称。</span></span><br><span class="line"><span class="ruby">-i 忽略字符大小写的差别。</span></span><br><span class="line"><span class="ruby">-l 列出文件内容符合指定的范本样式的文件名称。</span></span><br><span class="line"><span class="ruby">-L 列出文件内容不符合指定的范本样式的文件名称。</span></span><br><span class="line"><span class="ruby">-n 在显示符合范本样式的那一列之前，标示出该列的编号。</span></span><br><span class="line"><span class="ruby">-q 不显示任何信息。</span></span><br><span class="line"><span class="ruby">-R/-r 此参数的效果和指定“-d recurse”参数相同。</span></span><br><span class="line"><span class="ruby">-s 不显示错误信息。</span></span><br><span class="line"><span class="ruby">-v 反转查找。</span></span><br><span class="line"><span class="ruby">-w 只显示全字符合的列。</span></span><br><span class="line"><span class="ruby">-x 只显示全列符合的列。</span></span><br><span class="line"><span class="ruby">-y 此参数效果跟“-i”相同。</span></span><br><span class="line"><span class="ruby">-o 只输出文件中匹配到的部分。</span></span><br></pre></td></tr></table></figure><h3 id="在文件中搜索一个单词，命令会返回一个包含-PHP-的文本【行或者段落】"><a href="#在文件中搜索一个单词，命令会返回一个包含-PHP-的文本【行或者段落】" class="headerlink" title="在文件中搜索一个单词，命令会返回一个包含 PHP 的文本【行或者段落】"></a>在文件中搜索一个单词，命令会返回一个包含 PHP 的文本【行或者段落】</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">PHP</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">php</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep.png" alt="grep 文件中搜索单词" title="grep 搜索"></p><h3 id="多个文件中搜索，命令会返回一个包含-PHP-的文本【行或者段落】"><a href="#多个文件中搜索，命令会返回一个包含-PHP-的文本【行或者段落】" class="headerlink" title="多个文件中搜索，命令会返回一个包含 PHP 的文本【行或者段落】"></a>多个文件中搜索，命令会返回一个包含 PHP 的文本【行或者段落】</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">php</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span> <span class="selector-tag">bbb</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_02.png" alt="grep 文件中搜索单词" title="grep 搜索"></p><h3 id="选项-v-输出除-xxxxxx-之外的所有行或者段落"><a href="#选项-v-输出除-xxxxxx-之外的所有行或者段落" class="headerlink" title="选项 -v 输出除 xxxxxx  之外的所有行或者段落"></a>选项 -v 输出除 xxxxxx  之外的所有行或者段落</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">-v</span> <span class="selector-tag">php</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_03.png" alt="grep 文件中搜索单词" title="grep 搜索"></p><h3 id="选项-E-使用正则表达式"><a href="#选项-E-使用正则表达式" class="headerlink" title="选项 -E  使用正则表达式"></a>选项 -E  使用正则表达式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">-E</span> "<span class="selector-attr">[1-9]</span>+" <span class="selector-tag">aaa</span><span class="selector-class">.txt</span>  或者</span><br><span class="line"><span class="selector-tag">egrep</span> "<span class="selector-attr">[1-9]</span>+" <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_E.png" alt="grep 正则" title="grep 正则"></p><h3 id="选项-o-只输出文件中匹配到的部分"><a href="#选项-o-只输出文件中匹配到的部分" class="headerlink" title="选项  -o 只输出文件中匹配到的部分"></a>选项  -o 只输出文件中匹配到的部分</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">-o</span> <span class="selector-tag">php</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">-o</span> <span class="selector-tag">PHP</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_o.png" alt="grep 输出匹配部分" title="grep 输出匹配部分"></p><h3 id="选项-c-统计文本或者文本中包含匹配字符串的行数-选项-n"><a href="#选项-c-统计文本或者文本中包含匹配字符串的行数-选项-n" class="headerlink" title="选项  -c  统计文本或者文本中包含匹配字符串的行数[  选项 -n   ]"></a>选项  -c  统计文本或者文本中包含匹配字符串的行数[  选项 -n   ]</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">统计</span><br><span class="line">grep -c <span class="string">"PHP"</span> aaa.txt</span><br><span class="line"></span><br><span class="line">选项 -n 输出包含匹配字符串的行数</span><br><span class="line">grep -n <span class="string">"PHP"</span> aaa.txt</span><br><span class="line">grep -n <span class="string">"php"</span> aaa.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_c.png" alt="grep 统计匹配行数" title="grep 统计匹配行数"></p><p><img src="/img/ubuntu/linux_command/linux_grep/grep_n.png" alt="grep 输出匹配行数" title="grep 输出匹配行数"></p><h3 id="选项-l-搜索多个文件并查找匹配文本在那个文件中"><a href="#选项-l-搜索多个文件并查找匹配文本在那个文件中" class="headerlink" title="选项 -l  搜索多个文件并查找匹配文本在那个文件中"></a>选项 -l  搜索多个文件并查找匹配文本在那个文件中</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep -l php aaa<span class="selector-class">.txt</span> bbb.txt</span><br><span class="line">grep -l php *.txt</span><br><span class="line">grep -l PHP *.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_l.png" alt="grep 文件中搜索" title="grep 文件中搜索"></p><h3 id="选项-r-递归搜索文件"><a href="#选项-r-递归搜索文件" class="headerlink" title="选项  -r 递归搜索文件"></a>选项  -r 递归搜索文件</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grep</span> PHP . -r         [ . 表示当前目录]</span><br><span class="line"><span class="keyword">grep</span> PHP . -r -n</span><br><span class="line"><span class="keyword">grep</span> PHP <span class="regexp">/home/</span>www<span class="regexp">/test -r -n     [ 指定目录 ]</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_r.png" alt="grep 递归搜索" title="grep 递归搜索"></p><h3 id="选项-i-忽略大小写搜索文件"><a href="#选项-i-忽略大小写搜索文件" class="headerlink" title="选项 -i 忽略大小写搜索文件"></a>选项 -i 忽略大小写搜索文件</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -<span class="selector-tag">i</span> php  aaa.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_i.png" alt="grep 忽略大小写搜索" title="grep 忽略大小写搜索"></p><h3 id="选项-e-扩展多个匹配样式"><a href="#选项-e-扩展多个匹配样式" class="headerlink" title="选项 -e 扩展多个匹配样式"></a>选项 -e 扩展多个匹配样式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">-e</span> <span class="selector-tag">php</span> <span class="selector-tag">-e</span> <span class="selector-tag">The</span> <span class="selector-tag">aaa</span><span class="selector-class">.txt</span>  <span class="selector-attr">[ 搜索 PHP、搜索 The ]</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_e.png" alt="grep 忽略大小写搜索" title="grep 忽略大小写搜索"></p><h3 id="选项-q-静默输出，一般配合-if-逻辑判断"><a href="#选项-q-静默输出，一般配合-if-逻辑判断" class="headerlink" title="选项 -q  静默输出，一般配合 if  逻辑判断"></a>选项 -q  静默输出，一般配合 if  逻辑判断</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>  grep -q hello aaa.txt ; <span class="keyword">then</span> <span class="built_in">echo</span> yes;<span class="keyword">else</span> <span class="built_in">echo</span> no; <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span>  grep -q php aaa.txt ; <span class="keyword">then</span> <span class="built_in">echo</span> yes;<span class="keyword">else</span> <span class="built_in">echo</span> no; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">grep -q php aaa.php</span><br><span class="line">grep -q hello aaa.php</span><br><span class="line"></span><br><span class="line">不会输出任何内容，命令运行成功返回 0 ，失败返回非 0 值，一般配合逻辑判断使用</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_q.png" alt="grep 一般配合逻辑判断" title="grep 一般配合逻辑判断"></p><h3 id="选项-A-B-C-显示匹配结果之后行、之前行、之前之后行"><a href="#选项-A-B-C-显示匹配结果之后行、之前行、之前之后行" class="headerlink" title="选项   -A   -B   -C   显示匹配结果之后行、之前行、之前之后行"></a>选项   -A   -B   -C   显示匹配结果之后行、之前行、之前之后行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">测试文件 aaa.php 内容如下，注意看行号：</span><br><span class="line">  <span class="number">1</span> I am aaa.php</span><br><span class="line">  <span class="number">2</span> <span class="number">222</span></span><br><span class="line">  <span class="number">3</span> hello world <span class="number">3</span> line</span><br><span class="line">  <span class="number">4</span> <span class="number">444</span></span><br><span class="line">  <span class="number">5</span> hello  php  grep_test</span><br><span class="line">  <span class="number">6</span> <span class="number">666</span></span><br><span class="line">  <span class="number">7</span> hello world <span class="number">7</span> line</span><br><span class="line">  <span class="number">8</span> <span class="number">888</span></span><br><span class="line">  <span class="number">9</span> hello world</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">grep -A1 -n  php aaa.php   [ <span class="number">1</span>代表显示多少行，-n 表示显示行号]</span><br><span class="line">显示匹配结果之后 <span class="number">1</span> 行</span><br><span class="line">grep -A1 -n  php aaa.php   [ 匹配结果之后的<span class="number">1</span>行 ]</span><br><span class="line">grep -B1 -n  php aaa.php   [ 匹配结果之前的<span class="number">1</span>行 ]</span><br><span class="line">grep -C1 -n  php aaa.php   [ 匹配结果之前的<span class="number">1</span>行和之后一行]</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_grep/grep_ABC.png" alt="grep 前后" title="grep 前后"></p><p>其他：</p><p>grep家族总共有三个：grep，egrep，fgrep。</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-ls 显示目录列表</title>
      <link href="/2018/05/02/ubuntu/linux_DDU_ls/"/>
      <url>/2018/05/02/ubuntu/linux_DDU_ls/</url>
      <content type="html"><![CDATA[<h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls[选项][文件][目录]</span><br></pre></td></tr></table></figure><h3 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">a：显示所有档案及目录（ls内定将档案名或目录名称为“.”的视为影藏，不会列出）；</span></span><br><span class="line"><span class="ruby">-A：显示除影藏文件“.”和“..”以外的所有文件列表；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-c：与“-lt”选项连用时，按照文件状态时间排序输出目录内容，排序的依据是文件的索引节点中的ctime字段。与“-l”选项连用时，则排序的一句是文件的状态改变时间；</span></span><br><span class="line"><span class="ruby">-C：多列显示输出结果。这是默认选项；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-l：与“-C”选项功能相反，所有输出信息用单列格式输出，不输出为多列；以长格式显示目录下的内容列表。输出的信息从     左到右依次包括文件名，文件类型、权限模式、硬连接数、所有者、组、文件大小和文件的最后修改时间等；</span></span><br><span class="line"><span class="ruby">-L：如果遇到性质为符号链接的文件或目录，直接列出该链接所指向的原始文件或目录；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-f：此参数的效果和同时指定“aU”参数相同，并关闭“lst”参数的效果；</span></span><br><span class="line"><span class="ruby">-F：在每个输出项后追加文件的类型标识符，具体含义：“*”表示具有可执行权限的普通文件，“/”表示目录，“@”表示符号链接，“<span class="params">|”表示命令管道FIFO，“=”表示sockets套接字。当文件为普通文件时，不输出任何标识符；</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-r：以文件名反序排列并输出目录内容列表；</span></span><br><span class="line"><span class="ruby">-R：递归处理，将指定目录下的所有文件及子目录一并处理；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">--full-time：列出完整的日期与时间；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">/<span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">/  以下不经常用到  /</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">/</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-b：将文件中的不可输出的字符以反斜线“”加字符编码的方式输出；</span></span><br><span class="line"><span class="ruby">-d：仅显示目录名，而不显示目录下的内容列表。显示符号链接文件本身，而不显示其所指向的目录列表；</span></span><br><span class="line"><span class="ruby">-i：显示文件索引节点号（inode）。一个索引节点代表一个文件；</span></span><br><span class="line"><span class="ruby">-k：以KB（千字节）为单位显示文件大小；</span></span><br><span class="line"><span class="ruby">-m：用“,”号区隔每个文件和目录的名称；</span></span><br><span class="line"><span class="ruby">-n：以用户识别码和群组识别码替代其名称；</span></span><br><span class="line"><span class="ruby">-s：显示文件和目录的大小，以区块为单位；</span></span><br><span class="line"><span class="ruby">-t：用文件和目录的更改时间排序；</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">--color[=WHEN]：使用不同的颜色高亮显示不同类型的。</span></span><br></pre></td></tr></table></figure><h3 id="选项-a-、c-、-l-显示目录"><a href="#选项-a-、c-、-l-显示目录" class="headerlink" title="选项  a  、c 、 l  显示目录"></a>选项  a  、c 、 l  显示目录</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> -a</span><br><span class="line"><span class="keyword">ls</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> -c</span><br><span class="line"><span class="keyword">ls</span> -C  [ 大写 ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> -l  [常用这个]</span><br><span class="line"><span class="keyword">ls</span> -L</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ls/ls_acl.png" alt="linux ls acl" title="linux ls acl"></p><h3 id="选项-full-time"><a href="#选项-full-time" class="headerlink" title="选项  full-time"></a>选项  full-time</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> <span class="params">--full-time</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ls/ls_full-time.png" alt="linux ls 显示详细时间" title="linux ls full-time"></p><h3 id="排除某些文件显示"><a href="#排除某些文件显示" class="headerlink" title="排除某些文件显示"></a>排除某些文件显示</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> *<span class="string">.txt</span>|egrep -v '<span class="params">(*.md)</span>'</span><br><span class="line"><span class="keyword">ls</span> *<span class="string">.txt</span>|egrep -v *<span class="string">.md</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> | grep -v aaa.txt</span><br><span class="line"><span class="keyword">ls</span> *<span class="string">.txt</span> | grep -v aaa.txt</span><br><span class="line"><span class="keyword">ls</span> *<span class="string">.txt</span> | egrep -v aaa.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ls/ls_other_01.png" alt="linux rm 排除指定文件显示" title="linux ls 排除指定文件显示"></p><p><img src="/img/ubuntu/linux_command/linux_ls/ls_other_02.png" alt="linux rm 排除指定文件显示" title="linux ls 排除指定文件显示"></p><h3 id="显示某一目录下文件，显示-www-目录下文件"><a href="#显示某一目录下文件，显示-www-目录下文件" class="headerlink" title="显示某一目录下文件，显示  www 目录下文件"></a>显示某一目录下文件，显示  www 目录下文件</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> -l <span class="string">/www</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_ls/ls_other_03.png" alt="显示 www目录下文件" title="显示 www目录下文件"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-rm  删除文件或目录</title>
      <link href="/2018/04/29/ubuntu/linux_DDU_rm/"/>
      <url>/2018/04/29/ubuntu/linux_DDU_rm/</url>
      <content type="html"><![CDATA[<h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm <span class="string">[选项]</span> 文件…</span><br></pre></td></tr></table></figure><h3 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h3><p>​    -d：   直接把欲删除的目录的硬连接数据删除成0，删除该目录；<br>​    -f, –force       忽略不存在的文件，从不给出提示。<br>​    -i, –interactive    进行交互式删除<br>​    -r, -R, –recursive       指示rm将参数中列出的全部目录和子目录均递归地删除。<br>​    -v, –verbose        详细显示进行的步骤<br>​       –help               显示此帮助信息并退出<br>​       –version          输出版本信息并退出</p><h3 id="选项-i-交互式删除"><a href="#选项-i-交互式删除" class="headerlink" title="选项  i  交互式删除"></a>选项  i  交互式删除</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -<span class="selector-tag">i</span> aaa<span class="selector-class">.txt</span> baa.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_i.png" alt="linux rm 交互式删除" title="linux rm 交互式删除"></p><h3 id="选项-r-递归删除目录及子目录中文件"><a href="#选项-r-递归删除目录及子目录中文件" class="headerlink" title="选项  r  递归删除目录及子目录中文件"></a>选项  r  递归删除目录及子目录中文件</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rm</span> -r aaa/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_r.png" alt="linux rm 递归删除" title="linux rm 递归删除"></p><h3 id="选项-f-直接删除没有任何提示"><a href="#选项-f-直接删除没有任何提示" class="headerlink" title="选项  f  直接删除没有任何提示"></a>选项  f  直接删除没有任何提示</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rm</span> <span class="selector-tag">-f</span> <span class="selector-tag">bbaa</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_f.png" alt="linux rm 直接删除" title="linux rm 直接删除"></p><h3 id="选项-v-详细显示进行的步骤"><a href="#选项-v-详细显示进行的步骤" class="headerlink" title="选项  v  详细显示进行的步骤"></a>选项  v  详细显示进行的步骤</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rm</span> <span class="selector-tag">-v</span> <span class="selector-tag">bbb</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_v.png" alt="linux rm  详细显示进行的步骤" title="linux rm  详细显示进行的步骤"></p><h3 id="选项-i-交互式删除，某一类文件"><a href="#选项-i-交互式删除，某一类文件" class="headerlink" title="选项  i  交互式删除，某一类文件"></a>选项  i  交互式删除，某一类文件</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -<span class="selector-tag">i</span> *aa.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_i_regex01.png" alt="linux rm 交互式删除" title="linux rm 交互式删除"></p><h3 id="排除指定文件删除"><a href="#排除指定文件删除" class="headerlink" title="排除指定文件删除"></a>排除指定文件删除</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">删除所有 txt 结尾的文件，除了 aaa.txt </span><br><span class="line"></span><br><span class="line">rm `ls *.txt|egrep -v aaa.txt`</span><br><span class="line"></span><br><span class="line">rm `ls *.txt|egrep -v <span class="string">'(aaa.txt|bbb.txt|ccc.txt)'</span>`</span><br><span class="line"></span><br><span class="line">rm `ls *.txt|egrep -v <span class="string">'(aaa.*)'</span>`</span><br><span class="line"></span><br><span class="line">rm `ls *.txt|egrep -v <span class="string">'(*.md)'</span>`</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/rm_other_01.png" alt="linux rm 排除指定文件删除" title="linux rm 排除指定文件删除"></p><p><img src="/img/ubuntu/linux_command/linux_rm/rm_other_02.png" alt="linux rm 排除指定文件删除" title="linux rm 排除指定文件删除"></p><p><img src="/img/ubuntu/linux_command/linux_rm/rm_other_04.png" alt="linux rm 排除指定文件删除" title="linux rm 排除指定文件删除"></p><p>rm命令可以用 -i 选项，这个选项在使用文件扩展名字符删除多个文件时特别有用</p><p>………………………………unlink 命令删除文件，不能删除目录…………………………</p><p>demo: 删除文件 test02.txt </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">unlink</span> <span class="selector-tag">test02</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_rm/unlink.png" alt="unlink 删除文件" title="unlink 删除文件"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu16 -php7 extension imagick</title>
      <link href="/2018/04/20/ubuntu/php_extension_imagick/"/>
      <url>/2018/04/20/ubuntu/php_extension_imagick/</url>
      <content type="html"><![CDATA[<h3 id="Extension-之-imagick"><a href="#Extension-之-imagick" class="headerlink" title="Extension 之 imagick"></a>Extension 之 imagick</h3><p>温馨提示: 在安装过程中出现错误，一般是由于缺少编译工具包导致，可根据提示参照第一步安装相应的工具包即可</p><h3 id="安装-ImageMagick"><a href="#安装-ImageMagick" class="headerlink" title="安装 ImageMagick"></a>安装 ImageMagick</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">http:</span>/<span class="regexp">/www.imagemagick.org/download</span><span class="regexp">/ImageMagick.tar.gz</span></span><br><span class="line"><span class="regexp">解压到指定目录【我这里是 /data</span><span class="regexp">/server/other</span>_component/】</span><br><span class="line">tar -zxvf ImageMagick.tar.gz -C /data/server/other_component/</span><br><span class="line">cd ImageMagick-<span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span>/</span><br><span class="line">./configure --prefix=<span class="regexp">/data/server</span><span class="regexp">/other_component/</span>ImageMagick-<span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span> </span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">export PKG_CONFIG_PATH=<span class="regexp">/data/server</span><span class="regexp">/other_component/</span>ImageMagick-<span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">pkgconfig</span>/  <span class="comment">#设置环境变量 【重启电脑执行下一步】</span></span></span><br></pre></td></tr></table></figure><h3 id="安装-imagick"><a href="#安装-imagick" class="headerlink" title="安装 imagick"></a>安装 imagick</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">http:</span>/<span class="regexp">/pecl.php.net/get</span><span class="regexp">/imagick-3.4.3.tgz</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">解压到指定目录【我这里是 /data</span><span class="regexp">/server/other</span>_component/】</span><br><span class="line">tar -zxvf imagick-<span class="number">3.4</span>.<span class="number">3</span>.tgz -C /data/server/other_component/</span><br><span class="line">cd imagick-<span class="number">3.4</span>.<span class="number">3</span>/</span><br><span class="line"></span><br><span class="line">/data/server/php7/bin/phpize   <span class="comment">#用phpize生成configure配置文件，[找到你PHP安装位置中的phpsize]</span></span><br><span class="line"></span><br><span class="line">./configure \</span><br><span class="line">--<span class="keyword">with</span>-php-config=<span class="regexp">/data/server</span><span class="regexp">/php7/bin</span><span class="regexp">/php-config \</span></span><br><span class="line"><span class="regexp">--with-imagick=/data</span><span class="regexp">/server/other</span>_component/ImageMagick-<span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span> </span><br><span class="line"></span><br><span class="line">make &amp; make install</span><br><span class="line"></span><br><span class="line">安装完成后提示如下，表示安装成功：</span><br><span class="line">root@<span class="symbol">www:</span>/data/server/other_component/phpredis-<span class="number">4.0</span>.<span class="number">0</span><span class="comment"># make install</span></span><br><span class="line">Installing shared <span class="symbol">extensions:</span>     /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/</span></span><br><span class="line">root@<span class="symbol">www:</span>/data/server/other_component/phpredis-<span class="number">4.0</span>.<span class="number">0</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">安装完成后配置【找到 php.ini 的位置添加扩展】：</span><br><span class="line">vi /etc/php/<span class="number">7.0</span>/cli/php.ini</span><br><span class="line">vi  /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>.<span class="title">ini</span>  </span></span><br><span class="line">这两个里面都要写上一以下内容：</span><br><span class="line">extension=imagick.so</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拷贝扩展，否则 在 【cli   PHP -m】 模式中看不到扩展：</span><br><span class="line">cp /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/<span class="title">imagick</span>.<span class="title">so</span>  /<span class="title">usr</span>/<span class="title">lib</span>/<span class="title">php</span>/20151012/</span></span><br></pre></td></tr></table></figure><h3 id="重启php-fpm"><a href="#重启php-fpm" class="headerlink" title="重启php-fpm"></a>重启php-fpm</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">重启php-fpm</span><br><span class="line">查找PHP服务 ps aux | <span class="keyword">grep</span> php-fpm</span><br><span class="line">pkill -<span class="number">9</span> php</span><br><span class="line">php启动命令</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/php7/</span>sbin<span class="regexp">/php-fpm</span></span><br></pre></td></tr></table></figure><h3 id="查看扩展"><a href="#查看扩展" class="headerlink" title="查看扩展"></a>查看扩展</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">php -m | grep imagick</span><br><span class="line">提示如下</span><br><span class="line">root<span class="variable">@www</span><span class="symbol">:/data/server/other_component/ImageMagick-</span><span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span><span class="comment"># php -m | grep redis</span></span><br><span class="line">imagick</span><br><span class="line">root<span class="variable">@www</span><span class="symbol">:/data/server/other_component/ImageMagick-</span><span class="number">7.0</span>.<span class="number">7</span>-<span class="number">28</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/extension/e_imagick.png" alt="imagick 扩展" title="redis imagick"></p><p><img src="/img/ubuntu/php/extension/e_imagick2.png" alt="imagick 扩展" title="redis imagick"></p><p><a href="http://pecl.php.net/package/imagick" title="PHP扩展imagick下载网址" target="_blank" rel="noopener">PHP扩展imagick下载网址</a></p><p> <a href="http://pecl.php.net/package-stats.php" title="PHP扩展下载网址" target="_blank" rel="noopener">PHP扩展下载网址</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu16 -php7 extension redis</title>
      <link href="/2018/04/20/ubuntu/php_extension_redis/"/>
      <url>/2018/04/20/ubuntu/php_extension_redis/</url>
      <content type="html"><![CDATA[<h3 id="Extension-之-redis"><a href="#Extension-之-redis" class="headerlink" title="Extension 之 redis"></a>Extension 之 redis</h3><h3 id="下载-redis-包"><a href="#下载-redis-包" class="headerlink" title="下载 redis 包"></a>下载 redis 包</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//gi</span>thub.com<span class="regexp">/nicolasff/</span>phpredis<span class="regexp">/archive/</span><span class="number">4.0</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">wget http:<span class="regexp">//</span>pecl.php.net<span class="regexp">/get/</span>redis-<span class="number">4.0</span>.<span class="number">0</span>.tgz</span><br></pre></td></tr></table></figure><h3 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">解压到指定目录【我这里是 /data/server/other_component/】</span><br><span class="line">tar -zxvf <span class="number">4.0</span>.<span class="number">0</span>.tar.gz -C /data/server/other_component/</span><br><span class="line">cd phpredis-<span class="number">4.0</span>.<span class="number">0</span>/</span><br><span class="line"></span><br><span class="line">/data/server/php7/bin/phpize   <span class="comment">#用phpize生成configure配置文件，[找到你PHP安装位置中的phpsize]</span></span><br><span class="line">./configure --<span class="keyword">with</span>-php-config=<span class="regexp">/data/server</span><span class="regexp">/php7/bin</span><span class="regexp">/php-config   #配置</span></span><br><span class="line"><span class="regexp">make</span></span><br><span class="line"><span class="regexp">make install</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">安装完成后提示如下，表示安装成功：</span></span><br><span class="line"><span class="regexp">root@www:/data</span><span class="regexp">/server/other</span>_component/phpredis-<span class="number">4.0</span>.<span class="number">0</span><span class="comment"># make install</span></span><br><span class="line">Installing shared <span class="symbol">extensions:</span>     /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/</span></span><br><span class="line">root@<span class="symbol">www:</span>/data/server/other_component/phpredis-<span class="number">4.0</span>.<span class="number">0</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="配置-redis"><a href="#配置-redis" class="headerlink" title="配置 redis"></a>配置 redis</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">安装完成后配置【找到 php.ini 的位置添加扩展】：</span><br><span class="line">vi /etc/php/<span class="number">7.0</span>/cli/php.ini</span><br><span class="line">vi  /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>.<span class="title">ini</span>  </span></span><br><span class="line">这两个里面都要写上一以下内容：</span><br><span class="line">extension=redis.so</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拷贝扩展，否则 在 【cli   PHP -m】 模式中看不到扩展：</span><br><span class="line">cp /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/<span class="title">opcache</span>.<span class="title">a</span>  /<span class="title">usr</span>/<span class="title">lib</span>/<span class="title">php</span>/20151012/</span></span><br><span class="line">cp /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/<span class="title">opcache</span>.<span class="title">so</span>  /<span class="title">usr</span>/<span class="title">lib</span>/<span class="title">php</span>/20151012/</span></span><br><span class="line">cp /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/<span class="title">redis</span>.<span class="title">so</span>  /<span class="title">usr</span>/<span class="title">lib</span>/<span class="title">php</span>/20151012/</span></span><br></pre></td></tr></table></figure><h3 id="重启php-fpm-并查看扩展"><a href="#重启php-fpm-并查看扩展" class="headerlink" title="重启php-fpm  并查看扩展"></a>重启php-fpm  并查看扩展</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">重启php-fpm</span><br><span class="line">查找PHP服务 ps aux <span class="params">| grep php-fpm</span></span><br><span class="line"><span class="params">pkill -9 php</span></span><br><span class="line"><span class="params">php启动命令</span></span><br><span class="line"><span class="params">/data/server/php7/sbin/php-fpm</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">查看扩展</span></span><br><span class="line"><span class="params">php -m |</span> grep redis</span><br><span class="line">提示如下</span><br><span class="line">root@www<span class="symbol">:/data/server/other_component/phpredis-</span><span class="number">4.0</span>.<span class="number">0</span><span class="comment"># php -m | grep redis</span></span><br><span class="line">redis</span><br><span class="line">root@www<span class="symbol">:/data/server/other_component/phpredis-</span><span class="number">4.0</span>.<span class="number">0</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/extension/e_redis.png" alt="redis 扩展" title="redis 扩展"></p><p> <a href="https://github.com/phpredis/phpredis/releases" title="历史版本" target="_blank" rel="noopener">历史版本</a></p><p> <a href="http://pecl.php.net/package/redis" title="历史版本2" target="_blank" rel="noopener">历史版本2</a></p><p> <a href="http://pecl.php.net/package-stats.php" title="PHP扩展下载网址" target="_blank" rel="noopener">PHP扩展下载网址</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-vim  编辑文件</title>
      <link href="/2018/04/19/ubuntu/linux_DDU_vim/"/>
      <url>/2018/04/19/ubuntu/linux_DDU_vim/</url>
      <content type="html"><![CDATA[<h3 id="跳转到指定行"><a href="#跳转到指定行" class="headerlink" title="跳转到指定行"></a>跳转到指定行</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:5</span>  回车</span><br><span class="line"><span class="selector-pseudo">:10</span>  回车</span><br><span class="line"><span class="selector-pseudo">:15</span>  回车</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_vim/vim_01.gif" alt="vim" title="vim"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>centos -PHP7</title>
      <link href="/2018/04/18/centos/php/"/>
      <url>/2018/04/18/centos/php/</url>
      <content type="html"><![CDATA[<h3 id="centos-PHP7-安装"><a href="#centos-PHP7-安装" class="headerlink" title="centos  PHP7 安装"></a>centos  PHP7 安装</h3><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install</span> libxml2 libxml2-devel curl-devel libjpeg-devel libpng-devel freetype-devel  libmcrypt-devel</span><br><span class="line"></span><br><span class="line">yum <span class="keyword">install</span> openssl openssl-devel</span><br></pre></td></tr></table></figure><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">安装php</span><br><span class="line">wget http:<span class="comment">//cn2.php.net/get/php-7.0.28.tar.gz/from/this/mirror</span></span><br><span class="line">mv mirror php-<span class="number">7.0</span>.<span class="number">28</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br><span class="line"></span><br><span class="line">解压到你指定的目录，我这里选择  /data/server/ 目录</span><br><span class="line">tar -zxvf php-<span class="number">7.0</span>.<span class="number">28</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /data/server/</span><br><span class="line">mv php-<span class="number">7.0</span>.<span class="number">28</span> php7</span><br><span class="line">cd php7/</span><br></pre></td></tr></table></figure><h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/data/server/php7 \</span><br><span class="line"> -<span class="ruby">-with-curl \</span></span><br><span class="line"><span class="ruby"> --with-freetype-dir \</span></span><br><span class="line"><span class="ruby"> --with-gd \</span></span><br><span class="line"><span class="ruby"> --with-gettext \</span></span><br><span class="line"><span class="ruby"> --with-iconv-dir \</span></span><br><span class="line"><span class="ruby"> --with-kerberos \</span></span><br><span class="line"><span class="ruby"> --with-libdir=lib64 \</span></span><br><span class="line"><span class="ruby"> --with-libxml-dir \</span></span><br><span class="line"><span class="ruby"> --with-mysqli \</span></span><br><span class="line"><span class="ruby"> --with-openssl \</span></span><br><span class="line"><span class="ruby"> --with-pcre-regex \</span></span><br><span class="line"><span class="ruby"> --with-pdo-mysql \</span></span><br><span class="line"><span class="ruby"> --with-pdo-sqlite \</span></span><br><span class="line"><span class="ruby"> --with-pear \</span></span><br><span class="line"><span class="ruby"> --with-png-dir \</span></span><br><span class="line"><span class="ruby"> --with-xmlrpc \</span></span><br><span class="line"><span class="ruby"> --with-xsl \</span></span><br><span class="line"><span class="ruby"> --with-zlib \</span></span><br><span class="line"><span class="ruby"> --enable-fpm \</span></span><br><span class="line"><span class="ruby"> --enable-bcmath \</span></span><br><span class="line"><span class="ruby"> --enable-libxml \</span></span><br><span class="line"><span class="ruby"> --enable-inline-optimization \</span></span><br><span class="line"><span class="ruby"> --enable-gd-native-ttf \</span></span><br><span class="line"><span class="ruby"> --enable-mbregex \</span></span><br><span class="line"><span class="ruby"> --enable-mbstring \</span></span><br><span class="line"><span class="ruby"> --enable-opcache \</span></span><br><span class="line"><span class="ruby"> --enable-pcntl \</span></span><br><span class="line"><span class="ruby"> --enable-shmop \</span></span><br><span class="line"><span class="ruby"> --enable-soap \</span></span><br><span class="line"><span class="ruby"> --enable-sockets \</span></span><br><span class="line"><span class="ruby"> --enable-sysvsem \</span></span><br><span class="line"><span class="ruby"> --enable-xml \</span></span><br><span class="line"><span class="ruby"> --enable-zip \</span></span><br><span class="line"><span class="ruby"> --enable-mysqlnd \</span></span><br><span class="line"><span class="ruby"> --with-pdo-mysql=mysqlnd \</span></span><br><span class="line"><span class="ruby"> --with-mcrypt</span></span><br></pre></td></tr></table></figure><p><img src="/img/centos/php/configure.png" alt="PHP 编译" title="PHP 编译"></p><h3 id="预处理ok后，make-编译"><a href="#预处理ok后，make-编译" class="headerlink" title="预处理ok后，make 编译"></a>预处理ok后，make 编译</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp;  <span class="built_in">make</span> install</span><br><span class="line"></span><br><span class="line">最后用 <span class="built_in">make</span> test 测试一下【这个过程时间比较长】</span><br></pre></td></tr></table></figure><h3 id="安装完毕"><a href="#安装完毕" class="headerlink" title="安装完毕"></a>安装完毕</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查看 php 版本</span><br><span class="line">/<span class="meta">data</span>/server/php7/<span class="keyword">bin/php </span>-v</span><br><span class="line">这时候在命令窗口执行 php -v ,会提示命令找不到,需要配置环境变量,详情看下文</span><br></pre></td></tr></table></figure><h3 id="配置PHP"><a href="#配置PHP" class="headerlink" title="配置PHP"></a>配置PHP</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>php.ini-development   <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>lib/php.ini</span><br><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.conf.default /</span>data<span class="regexp">/server/</span>php7<span class="regexp">/etc/</span>php-fpm.conf</span><br><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.d/</span>www.conf.<span class="keyword">default</span> <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.d/</span>www.conf</span><br><span class="line"></span><br><span class="line">官方这里拷贝文件有点不一样，注意一下</span><br></pre></td></tr></table></figure><h3 id="添加-PHP-启动用户"><a href="#添加-PHP-启动用户" class="headerlink" title="添加 PHP 启动用户"></a>添加 PHP 启动用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">groupadd www</span><br><span class="line">useradd -r -g www -s /bin/<span class="literal">false</span> www</span><br><span class="line"></span><br><span class="line">设置 PHP 启动用户</span><br><span class="line">cd /data/server/php7/etc/php-fpm.d</span><br><span class="line">vi www.conf  修改23、24行，内容如下：</span><br><span class="line"><span class="built_in"> user </span>= 启动fpm的用户名</span><br><span class="line"><span class="built_in"> group </span>= 启动fpm的用户所在组</span><br><span class="line"> </span><br><span class="line"><span class="built_in"> user </span>= www</span><br><span class="line"><span class="built_in"> group </span>= www</span><br><span class="line"></span><br><span class="line">修改完启动 PHP-fpm</span><br></pre></td></tr></table></figure><h3 id="php-启动命令"><a href="#php-启动命令" class="headerlink" title="php 启动命令"></a>php 启动命令</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/php7/</span>sbin<span class="regexp">/php-fpm</span></span><br></pre></td></tr></table></figure><h3 id="配置虚拟主机测试一下"><a href="#配置虚拟主机测试一下" class="headerlink" title="配置虚拟主机测试一下"></a>配置虚拟主机测试一下</h3><p>在 /data/www/ 目录下创建 index.php 内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> phpinfo();</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>在 nginx 中配置虚拟主机</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  <span class="number">127.0.0.1</span> <span class="number">192.168.1.230</span>;</span><br><span class="line">    <span class="attribute">client_max_body_size</span> <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line">    <span class="comment">#access_log /data/server/tengine/logs/127.0.0.1_access.log;</span></span><br><span class="line">    <span class="comment">#error_log  /data/server/tengine/logs/127.0.0.1_error.log;</span></span><br><span class="line">    <span class="attribute">root</span>  /data/www/;</span><br><span class="line">   <span class="comment"># index index.html;</span></span><br><span class="line">    <span class="attribute">index</span> index.php;</span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ .+\.php($|/)</span> &#123;</span><br><span class="line">        <span class="attribute">fastcgi_pass</span> <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">        <span class="attribute">fastcgi_index</span> index.php;</span><br><span class="line">        <span class="attribute">include</span> fastcgi.conf;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/centos/php/php7_test.png" alt="PHP7 测试" title="PHP7 测试"></p><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这时候在命令窗口执行 php -v ,会提示命令找不到,需要配置环境变量,详情看下文</span><br><span class="line">修改 /etc<span class="built_in">/profile </span>配置环境变量</span><br><span class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:/data/server/php/bin</span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br><span class="line">然后执行source /etc<span class="built_in">/profile </span>或者 .<span class="built_in">/profile </span>使其生效; 执行完后可以通过 echo <span class="variable">$PATH</span>  命令查看环境变量,</span><br><span class="line">在次执行 PHP -v 就看到PHP信息</span><br></pre></td></tr></table></figure><p><img src="/img/centos/php/php_env.png" alt="PHP7 环境变量" title="PHP7 环境变量"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -mysql others</title>
      <link href="/2018/04/18/ubuntu/linux_ubuntu_mysql_others/"/>
      <url>/2018/04/18/ubuntu/linux_ubuntu_mysql_others/</url>
      <content type="html"><![CDATA[<h3 id="mysql-5-6-其他"><a href="#mysql-5-6-其他" class="headerlink" title="mysql 5.6 其他"></a>mysql 5.6 其他</h3><h3 id="查看-MySQL-配置"><a href="#查看-MySQL-配置" class="headerlink" title="查看 MySQL 配置;"></a>查看 MySQL 配置;</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">windows下是my.ini</span><br><span class="line">linux下是my.cnf</span><br><span class="line"></span><br><span class="line">linux 中 locate my<span class="selector-class">.cnf</span> 就出来了（没有的话先updatedb）</span><br></pre></td></tr></table></figure><h3 id="MySQL-忘记密码"><a href="#MySQL-忘记密码" class="headerlink" title="MySQL 忘记密码"></a>MySQL 忘记密码</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、查找 my.cnf 配置文件位置，在文件最后添加 skip-grant-tables  保存退出，修改完密码记得删掉</span><br><span class="line"><span class="number">2</span>、修改密码，命令</span><br><span class="line">MySQL&gt; UPDATE mysql.user SET Password=PASSWORD(<span class="string">'你的密码'</span>) where USER=<span class="string">'root'</span>;</span><br><span class="line">MySQL&gt; flush privileges; </span><br><span class="line">MySQL&gt; <span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure><h3 id="确定-MySQL-中文件位置"><a href="#确定-MySQL-中文件位置" class="headerlink" title="确定 MySQL 中文件位置"></a>确定 MySQL 中文件位置</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1、locate mysql.server 找到后启动 mysql</span><br><span class="line">./mysql.server start</span><br><span class="line">2、 ps -aux  | grep mysql  看到信息如下（我自己的）：</span><br><span class="line">root     19312  0.0  0.0 113256  1596 pts/2    S    14:09   0:00 </span><br><span class="line"><span class="comment">/bin/sh /usr/bin/mysqld_safe             #数据库登录运行路径</span></span><br><span class="line">-<span class="ruby">-datadir=<span class="regexp">/var/lib</span><span class="regexp">/mysql                 #数据库文件的存放路径</span></span></span><br><span class="line"><span class="ruby">--pid-file=<span class="regexp">/var/lib</span><span class="regexp">/mysql/i</span>Z2ze8dugwavcbouiggqoeZ.pid</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">mysql    <span class="number">19413</span>  <span class="number">0</span>.<span class="number">1</span>  <span class="number">5.8</span> <span class="number">1236108</span> <span class="number">465644</span> pts/<span class="number">2</span>  Sl   <span class="number">14</span><span class="symbol">:</span>09   <span class="number">0</span><span class="symbol">:</span><span class="number">01</span> </span></span><br><span class="line"><span class="ruby">/usr/sbin/mysqld </span></span><br><span class="line"><span class="ruby">--basedir=<span class="regexp">/usr </span></span></span><br><span class="line"><span class="ruby">--datadir=<span class="regexp">/var/lib</span><span class="regexp">/mysql                 #数据库文件的存放路径</span></span></span><br><span class="line"><span class="ruby">--plugin-dir=<span class="regexp">/usr/lib</span>64/mysql/plugin </span></span><br><span class="line"><span class="ruby">--user=mysql </span></span><br><span class="line"><span class="ruby">--log-error=<span class="regexp">/var/lib</span><span class="regexp">/mysql/i</span>Z2ze8dugwavcbouiggqoeZ.err  <span class="comment">#错误日志</span></span></span><br><span class="line"><span class="ruby">--pid-file=<span class="regexp">/var/lib</span><span class="regexp">/mysql/i</span>Z2ze8dugwavcbouiggqoeZ.pid</span></span><br></pre></td></tr></table></figure><h3 id="创建行用户并授权给指定数据库权限【以下命令在服务器-MySQL-中运行】"><a href="#创建行用户并授权给指定数据库权限【以下命令在服务器-MySQL-中运行】" class="headerlink" title="创建行用户并授权给指定数据库权限【以下命令在服务器 MySQL 中运行】"></a>创建行用户并授权给指定数据库权限【以下命令在服务器 MySQL 中运行】</h3><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、登录MySQL</span><br><span class="line">mysql -u root -p</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、创建新用户</span><br><span class="line"><span class="keyword">CREATE</span> USER <span class="string">'用户名'</span>@<span class="string">'ip地址'</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">'密码'</span>; </span><br><span class="line">%                 代表所有ip都能访问</span><br><span class="line">localhost         代表本机才能访问</span><br><span class="line"><span class="number">123.123</span>.<span class="number">123.123</span>   代表指定ip才能访问</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、验证账号是否创建成功</span><br><span class="line"><span class="keyword">SELECT</span> host, user, password <span class="keyword">FROM</span> mysql.user <span class="keyword">WHERE</span> user=<span class="string">'用户'</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、给新建用户授权指定数据库</span><br><span class="line">GRANT &lt;privileges&gt; <span class="keyword">ON</span> &lt;database&gt;.&lt;table&gt; <span class="keyword">TO</span> <span class="string">'myuser'</span>@<span class="string">'localhost'</span>;</span><br><span class="line"></span><br><span class="line">命令中 </span><br><span class="line">&lt;privileges&gt;         代表着用逗号分隔权限列表</span><br><span class="line">&lt;database&gt;.&lt;table&gt;   代表数据库.表</span><br><span class="line"></span><br><span class="line">demo：</span><br><span class="line">GRANT ALL <span class="keyword">ON</span> &lt;database&gt;.&lt;table&gt; <span class="keyword">TO</span> <span class="string">'myuser'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">GRANT <span class="keyword">CREATE</span>,INSERT <span class="keyword">ON</span> &lt;database&gt;.&lt;table&gt; <span class="keyword">TO</span> <span class="string">'myuser'</span>@<span class="string">'localhost'</span>;</span><br><span class="line"></span><br><span class="line">以下是一些可用权限&lt;privileges&gt;：</span><br><span class="line">ALL: 所有可用的权限</span><br><span class="line"><span class="keyword">CREATE</span>: 创建库、表和索引</span><br><span class="line">LOCK_TABLES: 锁定表</span><br><span class="line">ALTER: 修改表</span><br><span class="line">DELETE: 删除表</span><br><span class="line">INSERT: 插入表或列</span><br><span class="line"><span class="keyword">SELECT</span>: 检索表或列的数据</span><br><span class="line">CREATE_VIEW: 创建视图</span><br><span class="line">SHOW_DATABASES: 列出数据库</span><br><span class="line">DROP: 删除库、表和视图</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>、验证给用户的权限</span><br><span class="line">SHOW GRANTS <span class="keyword">FOR</span> <span class="string">'用户名'</span>@<span class="string">'ip地址'</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、移除权限</span><br><span class="line">REVOKE &lt;privileges&gt; <span class="keyword">ON</span> &lt;database&gt;.&lt;table&gt; <span class="keyword">FROM</span> <span class="string">'用户名'</span>@<span class="string">'ip地址'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">demo：</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE afei_db;</span><br><span class="line"><span class="keyword">CREATE</span> USER <span class="string">'afei'</span>@<span class="string">'%'</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">'123456'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> host, user, password <span class="keyword">FROM</span> mysql.user <span class="keyword">WHERE</span> user=<span class="string">'afei'</span>;</span><br><span class="line">grant all privileges <span class="keyword">on</span> afei_db.* <span class="keyword">to</span> <span class="string">'afei'</span>@<span class="string">'%'</span>;            #没有指定密码授权</span><br><span class="line">SHOW GRANTS <span class="keyword">FOR</span> <span class="string">'afei'</span>@<span class="string">'%'</span>;</span><br><span class="line">flush privileges;    #刷新</span><br><span class="line"></span><br><span class="line">扩展命令</span><br><span class="line">grant all privileges <span class="keyword">on</span> afei.* <span class="keyword">to</span> afei@l% identified <span class="keyword">by</span> <span class="string">'123456'</span>;  #指定命令授权</span><br><span class="line">drop user <span class="string">'afei'</span>@<span class="string">'%'</span>;     #删除用户</span><br></pre></td></tr></table></figure><p><img src="/img/mysql/mysql_others/01.png" alt="mysql 创建行用户并授权给指定数据库权限01" title="mysql 创建行用户并授权给指定数据库权限01"></p><p><img src="/img/mysql/mysql_others/01.png" alt="mysql 创建行用户并授权给指定数据库权限02" title="mysql 创建行用户并授权给指定数据库权限02"></p><h3 id="linux-查看-MySQL-版本"><a href="#linux-查看-MySQL-版本" class="headerlink" title="linux 查看 MySQL 版本"></a>linux 查看 MySQL 版本</h3><p>1、在help中查找 mysql –help |grep Distrib<br>2、在help中查找 mysql –help |grep Distrib</p><p><img src="/img/mysql/mysql_others/03.png" alt="mysql 版本" title="mysql 版本"></p><h3 id="Mysql-常用性能分析方法"><a href="#Mysql-常用性能分析方法" class="headerlink" title="Mysql 常用性能分析方法??"></a>Mysql 常用性能分析方法??</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">select</span> version();  <span class="meta">#查版本号</span></span><br><span class="line"><span class="keyword">show</span> processlist;  <span class="meta">#查看那些线程正在运行</span></span><br><span class="line"><span class="keyword">show</span> profiles; </span><br><span class="line"><span class="keyword">show</span> profiles <span class="keyword">for</span> query <span class="number">3</span>;  <span class="meta">#更具query_id 查看某个查询的详细时间耗费</span></span><br><span class="line">explian + sql <span class="meta"># 分析执行计划和最左前缀原理</span></span><br><span class="line">reset query cache;   <span class="meta">#清除缓存</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>computer install ubuntu16</title>
      <link href="/2018/04/17/ubuntu/ubuntu_install/"/>
      <url>/2018/04/17/ubuntu/ubuntu_install/</url>
      <content type="html"><![CDATA[<h3 id="电脑安装ubuntu系统"><a href="#电脑安装ubuntu系统" class="headerlink" title="电脑安装ubuntu系统"></a>电脑安装ubuntu系统</h3><h3 id="下载：-ubuntu下载"><a href="#下载：-ubuntu下载" class="headerlink" title="下载： ubuntu下载"></a>下载： <a href="https://www.ubuntu.com/download/desktop" title="ubuntu下载" target="_blank" rel="noopener">ubuntu下载</a></h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//</span>www.ubuntu.com<span class="regexp">/download/</span>desktop</span><br></pre></td></tr></table></figure><p>安装好 UltraISO 软碟通 ，安装完软件后，打开软件，点击文件打开，找到刚才下载的 ubuntu 的 ISO 文件，点击开开，完成 ISO 文件的加载。接着插入 u 盘，点击 UltraISO 启动选项，然后找到写入硬盘选项，点击它进入将要操作的界面，最后点击写入;</p><p><img src="/img/ubuntu/ubuntu_install/make1.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/make2.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/make3.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/make4.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/make5.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p>install</p><p><img src="/img/ubuntu/ubuntu_install/01.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/02.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/03.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/04.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/05.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/06.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/07.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/08.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/09.png" alt="ubuntu 安装" title="ubuntu 安装"></p><p><img src="/img/ubuntu/ubuntu_install/10.png" alt="ubuntu 安装" title="ubuntu 安装"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu16 Redmine</title>
      <link href="/2018/04/13/ubuntu/Redmine/"/>
      <url>/2018/04/13/ubuntu/Redmine/</url>
      <content type="html"><![CDATA[<h3 id="Rvm-Ruby-Rails-【具体细节效果以后版本修改……】"><a href="#Rvm-Ruby-Rails-【具体细节效果以后版本修改……】" class="headerlink" title="Rvm+Ruby+Rails  【具体细节效果以后版本修改……】"></a>Rvm+Ruby+Rails  【具体细节效果以后版本修改……】</h3><p>rvm是用于管理多个ruby版本的一个管理器</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span> </span><br><span class="line">sudo apt-<span class="built_in">get</span> upgrade</span><br><span class="line"></span><br><span class="line">gpg --keyserver hkp://<span class="built_in">keys</span>.gnupg.net --recv-<span class="built_in">keys</span> <span class="number">409</span>B6B1796C275462A1703113804BB82D39DC0E3</span><br><span class="line">curl -sSL http<span class="variable">s:</span>//<span class="built_in">get</span>.rvm.io | bash -s stable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//如果上面的连接失败，可以尝试:</span><br><span class="line">curl -L http<span class="variable">s:</span>//raw.githubusercontent.<span class="keyword">com</span>/wayneeseguin/rvm/master/binscripts/rvm-installer | bash -s stable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">载入 Rvm  环境[ 根据提示操作 ]</span><br><span class="line"> <span class="keyword">source</span> /etc/<span class="keyword">profile</span>.d/rvm.<span class="keyword">sh</span></span><br><span class="line">检查Rvm是否安装成功</span><br><span class="line"> rvm -v</span><br><span class="line">用 RVM 安装 Ruby 环境(同时把RubyGems也安装）</span><br><span class="line"> rvm requirements</span><br><span class="line"> rvm install <span class="number">2.5</span>.<span class="number">1</span> #可以到 Ruby(http<span class="variable">s:</span>//www.<span class="keyword">ruby</span>-lang.org/<span class="keyword">en</span>/downloads/)官网查看最新版本号，时间比较长</span><br><span class="line">RVM装好后，可以执行以下命令将刚才安装的Ruby版本，设置系统<span class="keyword">ruby</span>默认版本</span><br><span class="line"> rvm use <span class="number">2.5</span>.<span class="number">1</span> --default</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/rvm01.png" alt="root passwd" title="rvm01"></p><p>由于某些原因，调整gem安装目录至国内镜像，有且仅有一个就好！</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">检查下Ruby和RubyGems的版本</span><br><span class="line"> ruby -v</span><br><span class="line"> gem -v</span><br><span class="line">gem update <span class="params">--system</span> </span><br><span class="line">gem -v </span><br><span class="line"></span><br><span class="line">换源</span><br><span class="line"> gem sources <span class="params">--add</span> https:<span class="string">//gems.ruby-china.org/</span> <span class="params">--remove</span> https:<span class="string">//rubygems.org</span></span><br><span class="line"> gem sources <span class="params">--add</span> https:<span class="string">//ruby.taobao.org/</span> <span class="params">--remove</span> https:<span class="string">//rubygems.org</span></span><br><span class="line"> gem sources -l<span class="string">//</span>查看在用的gem源</span><br><span class="line"> </span><br><span class="line"> 显示如下：</span><br><span class="line">root@ubuntu:<span class="string">/data/server</span><span class="comment"># gem sources -l</span></span><br><span class="line">*** CURRENT SOURCES ***</span><br><span class="line"></span><br><span class="line">https:<span class="string">//rubygems.org/</span></span><br><span class="line">https:<span class="string">//gems.ruby-china.org/</span></span><br><span class="line">root@ubuntu:<span class="string">/data/server</span><span class="comment"># </span></span><br><span class="line"></span><br><span class="line">安装bundlers</span><br><span class="line"> gem install bundler</span><br><span class="line">安装Rails</span><br><span class="line"> gem install rails  5.2.0             <span class="comment"># 可以到rails官网查看最新版本号</span></span><br><span class="line"> 或者使用： gem install rails          <span class="comment">#自己默认选择最新版</span></span><br><span class="line">查看版本</span><br><span class="line"> rails -v </span><br><span class="line"> </span><br><span class="line"> 最后检查一下所有版本</span><br><span class="line"> rvm -v</span><br><span class="line"> ruby -v</span><br><span class="line"> rails -v</span><br><span class="line"> bundler -v</span><br><span class="line"></span><br><span class="line">适当升级</span><br><span class="line">gem update <span class="params">--system</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/rvm02.png" alt="root passwd" title="rvm02"></p><h3 id="Redmine"><a href="#Redmine" class="headerlink" title="Redmine"></a>Redmine</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//www.redmine.org/releases/redmine-3.4.5.tar.gz</span></span><br><span class="line">tar -zxvf  redmine-<span class="number">3.4</span>.<span class="number">5</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /data/server</span><br><span class="line">mv redmine-<span class="number">3.4</span>.<span class="number">5</span> redmine</span><br><span class="line">cd redmine</span><br></pre></td></tr></table></figure><h3 id="设置数据库连接"><a href="#设置数据库连接" class="headerlink" title="设置数据库连接"></a>设置数据库连接</h3><p>Redmine 需要 nginx 和 MySQL  自行安装这里不再安装</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp config/database<span class="selector-class">.yml</span><span class="selector-class">.example</span>  config/database<span class="selector-class">.yml</span> </span><br><span class="line">vim config/database.yml</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/Redmine_database.png" alt="Redmine database" title="Redmine database"></p><h3 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看缺少依赖包，安装完依赖后执行一次这个命令,直到到出现 Bundle complete!</span></span><br><span class="line"><span class="keyword">bundle </span><span class="keyword">install </span>--without development test   </span><br><span class="line"></span><br><span class="line">我的值缺少依赖包如下：</span><br><span class="line">apt-get <span class="keyword">install </span>libmysqlclient-dev</span><br><span class="line"></span><br><span class="line">不在缺少依赖，显示如下：</span><br><span class="line"><span class="keyword">Bundle </span>complete! <span class="number">31</span> Gemfile dependencies, <span class="number">55</span> gems now <span class="keyword">installed.</span></span><br><span class="line"><span class="keyword">Gems </span>in the groups development <span class="keyword">and </span>test were not <span class="keyword">installed.</span></span><br><span class="line"><span class="keyword">Use </span>`<span class="keyword">bundle </span>info [gemname]` to see where a <span class="keyword">bundled </span>gem is <span class="keyword">installed.</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/Redmine_depend.png" alt="Redmine depend" title="Redmine depend"></p><h3 id="Session-存储秘钥"><a href="#Session-存储秘钥" class="headerlink" title="Session 存储秘钥"></a>Session 存储秘钥</h3><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="keyword">ge</span><span class="symbol">nerate_secret_token</span></span><br></pre></td></tr></table></figure><h3 id="生成redmine的数据库表结构和初始化数据"><a href="#生成redmine的数据库表结构和初始化数据" class="headerlink" title="生成redmine的数据库表结构和初始化数据"></a>生成redmine的数据库表结构和初始化数据</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RAILS_ENV=production rake <span class="string">db:</span>migrate    <span class="comment">//生成表结构</span></span><br><span class="line">RAILS_ENV=production rake <span class="string">redmine:</span>load_default_data <span class="comment">//初始化数据</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/Redmine_database2.png" alt="Redmine database" title="Redmine database"></p><h3 id="创建上传文件的目录，设置文件夹的权限"><a href="#创建上传文件的目录，设置文件夹的权限" class="headerlink" title="创建上传文件的目录，设置文件夹的权限"></a>创建上传文件的目录，设置文件夹的权限</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useradd redmine</span><br><span class="line">passwd redmine  <span class="comment">//设置redmine账户的密码</span></span><br><span class="line"></span><br><span class="line">这里先不做</span><br><span class="line">mkdir -p tmp tmp/pdf <span class="keyword">public</span>/plugin_assets/</span><br><span class="line">chown -R redmine:redmine files <span class="built_in">log</span> tmp <span class="keyword">public</span>/plugin_assets</span><br><span class="line">chmod -R <span class="number">755</span> files <span class="built_in">log</span> tmp <span class="keyword">public</span>/plugin_assets/</span><br></pre></td></tr></table></figure><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ruby bin/rails<span class="built_in"> server </span>webrick -e production</span><br><span class="line">ruby bin/rails<span class="built_in"> server </span>webrick -e production -b 0.0.0.0 -p3000  #允许远程访问</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/Redmine_test.png" alt="Redmine test" title="Redmine test"></p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>默认账户 admin/admin 初次登录需要修改密码，</p><p><img src="/img/ubuntu/Redmine_ok.png" alt="Redmine ok" title="Redmine ok"></p><p>关机重启后，需要再次运行 source /etc/profile.d/rvm.sh  载入环境</p><p>网站：</p><p><a href="https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/" target="_blank" rel="noopener">https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/</a></p><p><a href="https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/" target="_blank" rel="noopener">https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/</a></p><p>下载地址：</p><p><a href="https://www.phusionpassenger.com/latest_stable_tarball" target="_blank" rel="noopener">https://www.phusionpassenger.com/latest_stable_tarball</a></p><p><a href="https://www.phusionpassenger.com/latest_stable_tarball" target="_blank" rel="noopener">https://www.phusionpassenger.com/latest_stable_tarball</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget  https:<span class="comment">//www.phusionpassenger.com/latest_stable_tarball</span></span><br><span class="line">tar -xzvf passenger-X<span class="selector-class">.X</span><span class="selector-class">.X</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /somewhere-permanent</span><br></pre></td></tr></table></figure><p>rootroot</p><p>内容start</p><p>代码分为行内代码和代码块</p><p>行内代码使用<code>&lt;p&gt;这里使用代码块&lt;/p&gt;</code>    </p><p>这里没有代码块</p><p></p><p>代码语法高亮</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">"dddddd"</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abc = <span class="string">"123"</span>;</span><br><span class="line">alert(abc);</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/Redmine.png" alt="root passwd" title="fdfdsfd"></p><p> <a href="http://example.com/" title="这里是title" target="_blank" rel="noopener">我是a里面的内容</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Markdown语法</title>
      <link href="/2018/04/11/hexo/Markdown%E8%AF%AD%E6%B3%95/"/>
      <url>/2018/04/11/hexo/Markdown%E8%AF%AD%E6%B3%95/</url>
      <content type="html"><![CDATA[<h3 id="这里是标题"><a href="#这里是标题" class="headerlink" title="这里是标题"></a>这里是标题</h3><p>内容start<br>代码分为行内代码和代码块</p><p>行内代码使用<code>&lt;p&gt;这里使用代码块&lt;/p&gt;</code>    </p><p>这里没有代码块</p><p></p><p>代码语法高亮</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">"dddddd"</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abc = <span class="string">"123"</span>;</span><br><span class="line">alert(abc);</span><br></pre></td></tr></table></figure><p><img src="/img/linux_command01_2017_1224/linux_00/root_passwd.png" alt="root passwd" title="fdfdsfd"></p><p> <a href="http://example.com/" title="这里是title" target="_blank" rel="noopener">我是a里面的内容</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -mysql5.6.39</title>
      <link href="/2018/04/08/ubuntu/linux_ubuntu_mysql_02/"/>
      <url>/2018/04/08/ubuntu/linux_ubuntu_mysql_02/</url>
      <content type="html"><![CDATA[<h3 id="mysql5-6-39"><a href="#mysql5-6-39" class="headerlink" title="mysql5.6.39"></a>mysql5.6.39</h3><h3 id="编译环境"><a href="#编译环境" class="headerlink" title="编译环境"></a>编译环境</h3><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install make cmake gcc g++ perl bison libaio-<span class="built_in">dev</span> libncurses5 libncurses5-<span class="built_in">dev</span> libnuma-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">安装版本<span class="number">5.6</span>.<span class="number">39</span></span><br><span class="line"></span><br><span class="line">wget http<span class="variable">s:</span>//dev.mysql.<span class="keyword">com</span>/<span class="built_in">get</span>/Downloads/MySQL-<span class="number">5.6</span>/mysql-<span class="number">5.6</span>.<span class="number">39</span>.tar.gz</span><br><span class="line">wget http<span class="variable">s:</span>//dev.mysql.<span class="keyword">com</span>/<span class="built_in">get</span>/Downloads/MySQL-<span class="number">5.6</span>/mysql-<span class="number">5.6</span>.<span class="number">39</span>.tar.gz</span><br><span class="line">【解压到你指定的目录，我这里选择 /data/server/ 】</span><br><span class="line">tar zxvf mysql-<span class="number">5.6</span>.<span class="number">39</span>.tar.gz -C  /data/server/</span><br><span class="line">mv mysql-<span class="number">5.6</span>.<span class="number">39</span> mysql</span><br><span class="line"><span class="keyword">cd</span> mysql</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/mysql_download.png" alt="root mysql download" title="mysql download"></p><h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">cmake \</span><br><span class="line">-<span class="ruby">DCMAKE_INSTALL_PREFIX=<span class="regexp">/data/server</span><span class="regexp">/mysql \</span></span></span><br><span class="line"><span class="ruby">-DMYSQL_DATADIR=<span class="regexp">/data/server</span><span class="regexp">/mysql/data</span> \</span></span><br><span class="line"><span class="ruby">-DSYSCONFDIR=<span class="regexp">/data/server</span><span class="regexp">/mysql/etc</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_MYISAM_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_INNOBASE_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_MEMORY_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_READLINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DMYSQL_UNIX_ADDR=<span class="regexp">/data/server</span><span class="regexp">/mysql/mysql</span>.sock \</span></span><br><span class="line"><span class="ruby">-DMYSQL_TCP_PORT=<span class="number">3306</span> \</span></span><br><span class="line"><span class="ruby">-DENABLED_LOCAL_INFILE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_PARTITION_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DEXTRA_CHARSETS=all \</span></span><br><span class="line"><span class="ruby">-DDEFAULT_CHARSET=utf8 \</span></span><br><span class="line"><span class="ruby">-DDEFAULT_COLLATION=utf8_general_ci</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">make &amp;&amp; make install</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">注意事项：</span></span><br><span class="line"><span class="ruby">重新编译时，需要清除旧的对象文件和缓存信息</span></span><br><span class="line"><span class="ruby"><span class="comment"># make clean</span></span></span><br><span class="line"><span class="ruby"><span class="comment"># rm -f CMakeCache.txt</span></span></span><br><span class="line"><span class="ruby"><span class="comment"># rm -rf /data/server/etc/my.cnf</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">编译参数： <span class="symbol">https:</span>/<span class="regexp">/dev.mysql.com/doc</span><span class="regexp">/refman/</span><span class="number">5.6</span>/en/source-configuration-options.html</span></span><br><span class="line"><span class="ruby">编译参数： <span class="symbol">https:</span>/<span class="regexp">/dev.mysql.com/doc</span><span class="regexp">/refman/</span><span class="number">5.6</span>/en/source-configuration-options.html</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">cmake \</span></span><br><span class="line"><span class="ruby">-DCMAKE_INSTALL_PREFIX=<span class="regexp">/data/server</span><span class="regexp">/mysql \   安装路径</span></span></span><br><span class="line"><span class="ruby">-DMYSQL_DATADIR=<span class="regexp">/data/server</span><span class="regexp">/mysql/data</span> \         文件存放路径</span></span><br><span class="line"><span class="ruby">-DSYSCONFDIR=<span class="regexp">/etc \</span></span></span><br><span class="line"><span class="ruby">-DWITH_MYISAM_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_INNOBASE_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_MEMORY_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_READLINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DMYSQL_UNIX_ADDR=<span class="regexp">/tmp/mysql</span><span class="regexp">/mysql.sock \</span></span></span><br><span class="line"><span class="ruby">-DMYSQL_TCP_PORT=<span class="number">3306</span> \</span></span><br><span class="line"><span class="ruby">-DENABLED_LOCAL_INFILE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_PARTITION_STORAGE_ENGINE=<span class="number">1</span> \</span></span><br><span class="line"><span class="ruby">-DEXTRA_CHARSETS=all \</span></span><br><span class="line"><span class="ruby">-DDEFAULT_CHARSET=utf8 \</span></span><br><span class="line"><span class="ruby">-DDEFAULT_COLLATION=utf8_general_ci</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/mysql_make.png" alt="mysql make" title="mysql make"></p><h3 id="创建-mysql-组跟用户"><a href="#创建-mysql-组跟用户" class="headerlink" title="创建 mysql 组跟用户"></a>创建 mysql 组跟用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">检查系统中是否已经存在 mysql 用户，如果没有则创建</span><br><span class="line">cat /etc/passwd | grep mysql</span><br><span class="line">cat /etc<span class="built_in">/group </span>| grep mysql</span><br><span class="line"></span><br><span class="line">创建 mysql 用户</span><br><span class="line">sudo groupadd mysql</span><br><span class="line">sudo useradd -r -g mysql -s /bin/<span class="literal">false</span> mysql</span><br></pre></td></tr></table></figure><h4 id="更改-mysql-目录权限"><a href="#更改-mysql-目录权限" class="headerlink" title="更改 mysql 目录权限"></a>更改 mysql 目录权限</h4><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /data/server/mysql</span><br><span class="line">sudo chown -R mysql .</span><br><span class="line">sudo chgrp -R mysql .</span><br></pre></td></tr></table></figure><h3 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">chmod +x mysql_install_db 或者  chmod +x scripts/mysql_install_db</span><br><span class="line"></span><br><span class="line">./scripts/mysql_install_db <span class="comment">--basedir=/data/server/mysql --datadir=/data/server/mysql/data --user=mysql</span></span><br><span class="line"></span><br><span class="line">初始化后提示：</span><br><span class="line"></span><br><span class="line">To <span class="keyword">start</span> mysqld <span class="keyword">at</span> boot <span class="keyword">time</span> you have <span class="keyword">to</span> copy</span><br><span class="line">support-files/mysql.server <span class="keyword">to</span> the <span class="keyword">right</span> place <span class="keyword">for</span> your <span class="keyword">system</span></span><br><span class="line"></span><br><span class="line">PLEASE REMEMBER <span class="keyword">TO</span> <span class="keyword">SET</span> A <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> THE MySQL root <span class="keyword">USER</span> !</span><br><span class="line"><span class="keyword">To</span> <span class="keyword">do</span> so, <span class="keyword">start</span> the <span class="keyword">server</span>, <span class="keyword">then</span> issue the <span class="keyword">following</span> commands:</span><br><span class="line"></span><br><span class="line">  /<span class="keyword">data</span>/<span class="keyword">server</span>/mysql/<span class="keyword">bin</span>/mysqladmin -u root <span class="keyword">password</span> <span class="string">'new-password'</span></span><br><span class="line">  /<span class="keyword">data</span>/<span class="keyword">server</span>/mysql/<span class="keyword">bin</span>/mysqladmin -u root -h ubuntu <span class="keyword">password</span> <span class="string">'new-password'</span></span><br><span class="line"></span><br><span class="line">Alternatively you can run:</span><br><span class="line"></span><br><span class="line">  /<span class="keyword">data</span>/<span class="keyword">server</span>/mysql/<span class="keyword">bin</span>/mysql_secure_installation</span><br><span class="line"></span><br><span class="line">which will also give you the <span class="keyword">option</span> <span class="keyword">of</span> removing the <span class="keyword">test</span></span><br><span class="line"><span class="keyword">databases</span> <span class="keyword">and</span> anonymous <span class="keyword">user</span> created <span class="keyword">by</span> default.  This <span class="keyword">is</span></span><br><span class="line">strongly recommended <span class="keyword">for</span> production servers.</span><br><span class="line">See the <span class="keyword">manual</span> <span class="keyword">for</span> more instructions.</span><br><span class="line">You can <span class="keyword">start</span> the MySQL daemon <span class="keyword">with</span>:</span><br><span class="line"></span><br><span class="line">  cd . ; /data/server/mysql/bin/mysqld_safe &amp;</span><br><span class="line"></span><br><span class="line">You can test the MySQL daemon with mysql-test-run.pl</span><br><span class="line">  cd mysql-test ; perl mysql-test-run.pl</span><br><span class="line">Please report any problems at http://bugs.mysql.com/</span><br><span class="line">The latest information about MySQL is available on the web at</span><br><span class="line">  http://www.mysql.com</span><br><span class="line">Support MySQL by buying support/licenses at http://shop.mysql.com</span><br><span class="line">New default config file was created as /data/server/mysql/my.cnf and</span><br><span class="line">will be used by default by the server when you <span class="keyword">start</span> it.</span><br><span class="line">You may edit this <span class="keyword">file</span> <span class="keyword">to</span> <span class="keyword">change</span> <span class="keyword">server</span> <span class="keyword">settings</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/mysql_init.png" alt="mysql init" title="mysql init"></p><h3 id="启动数据库"><a href="#启动数据库" class="headerlink" title="启动数据库"></a>启动数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chmod +x mysql.server 或者 chmod +x support-files/mysql.server</span><br><span class="line"> ./support-files/mysql.server <span class="keyword">start</span></span><br><span class="line"> </span><br><span class="line">初始化密码，我这里设置密码： <span class="number">123456</span> 做测试，实际中设置你认为安全的密码</span><br><span class="line">  /<span class="keyword">data</span>/<span class="keyword">server</span>/mysql/<span class="keyword">bin</span>/mysqladmin -u root <span class="keyword">password</span> <span class="string">'123456'</span></span><br><span class="line">  </span><br><span class="line">登录MySQL</span><br><span class="line">  <span class="keyword">bin</span>/mysql -u root -p</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/mysql_pwd.png" alt="mysql 启动" title="mysql 启动"></p><h3 id="创建新用户，并允许远程连接"><a href="#创建新用户，并允许远程连接" class="headerlink" title="创建新用户，并允许远程连接"></a>创建新用户，并允许远程连接</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">命令: </span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'username'</span>@<span class="string">'host'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'new_password'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>; </span><br><span class="line"></span><br><span class="line">. 点代表所有表</span><br><span class="line">username 代表你创建的用户名</span><br><span class="line">host 代表你指定在那台机器可以登录，本地登录就是 localhost ，允许所有远程登录就是 % ；</span><br><span class="line">new_password 代表该用户的登录密码，密码可以为空，如果是空则改用户可以不需要密码登录</span><br><span class="line"></span><br><span class="line">demo:</span><br><span class="line">新增超级权限并允许远程访问：</span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'afei2'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'123456'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;   </span><br><span class="line"><span class="keyword">FLUSH</span>   <span class="keyword">PRIVILEGES</span>;</span><br><span class="line"></span><br><span class="line">查看创建的新用户信息：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">`Host`</span>,<span class="string">`User`</span>,<span class="string">`Password`</span>,authentication_string,password_expired <span class="keyword">FROM</span> <span class="string">`user`</span>;</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/mysql_remote_connect.png" alt="mysql 连接" title="mysql 远程连接"></p><h3 id="MySQL-命令"><a href="#MySQL-命令" class="headerlink" title="MySQL 命令"></a>MySQL 命令</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">support-files/mysql<span class="selector-class">.server</span> start</span><br><span class="line">support-files/mysql<span class="selector-class">.server</span> stop</span><br><span class="line">/data/server/mysql/bin/mysql -u root -p</span><br><span class="line"></span><br><span class="line">mysql -h 你登录的ip -u username -P <span class="number">3306</span> -<span class="selector-tag">p</span> 【远程登录】</span><br><span class="line">demo： mysql -h <span class="number">192.168</span>.<span class="number">1.230</span> -u afei2 -p</span><br></pre></td></tr></table></figure><h3 id="查看-mysql-默认读取-my-cnf-的目录"><a href="#查看-mysql-默认读取-my-cnf-的目录" class="headerlink" title="查看 mysql 默认读取 my.cnf 的目录"></a>查看 mysql 默认读取 my.cnf 的目录</h3><p>如果没有设置使用指定目录的my.cnf，mysql启动时会读取安装目录根目录及默认目录下的my.cnf文件。查看mysql启动时读取配置文件的默认目录</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql --<span class="keyword">help</span>|<span class="keyword">grep</span> <span class="string">'my.cnf'</span></span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">root@ubuntu:/data/server/mysql/bin# mysql --<span class="keyword">help</span>|<span class="keyword">grep</span> <span class="string">'my.cnf'</span></span><br><span class="line">/etc/my.<span class="keyword">cnf</span> /etc/mysql/my.<span class="keyword">cnf</span> ~/.my.<span class="keyword">cnf</span> </span><br><span class="line">                      order of preference, my.<span class="keyword">cnf</span>, $MYSQL_TCP_PORT,</span><br><span class="line">root@ubuntu:/data/server/mysql/bin# </span><br><span class="line"></span><br><span class="line">//////////////////或者/////////////////</span><br><span class="line">./bin/mysqld --<span class="keyword">verbose</span> --<span class="keyword">help</span> |<span class="keyword">grep</span> -A <span class="number">1</span> <span class="string">'Default options'</span></span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">root@ubuntu:/data/server/mysql# ./bin/mysqld --<span class="keyword">verbose</span> --<span class="keyword">help</span> |<span class="keyword">grep</span> -A <span class="number">1</span> <span class="string">'Default options'</span></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">0</span> [Note] --secure-<span class="keyword">file</span>-priv <span class="keyword">is</span> <span class="keyword">set</span> <span class="keyword">to</span> NULL. Operations related <span class="keyword">to</span> importing <span class="built_in">and</span> exporting data are disabled</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">0</span> [Note] ./bin/mysqld (mysqld <span class="number">5.6</span>.<span class="number">39</span>) starting <span class="keyword">as</span> process <span class="number">34387</span> ...</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">34387</span> [Note] Plugin <span class="string">'FEDERATED'</span> <span class="keyword">is</span> disabled.</span><br><span class="line">Default <span class="keyword">options</span> are <span class="keyword">read</span> from the following <span class="keyword">files</span> in the given order:</span><br><span class="line">/etc/my.<span class="keyword">cnf</span> /etc/mysql/my.<span class="keyword">cnf</span> /data/server/mysql/etc/my.<span class="keyword">cnf</span> ~/.my.<span class="keyword">cnf</span> </span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">34387</span> [Note] Binlog end</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">34387</span> [Note] Shutting down plugin <span class="string">'CSV'</span></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">01</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">34387</span> [Note] Shutting down plugin <span class="string">'MyISAM'</span></span><br><span class="line">root@ubuntu:/data/server/mysql# </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/etc/my.<span class="keyword">cnf</span>, /etc/mysql/my.<span class="keyword">cnf</span>, /usr/local/etc/my.<span class="keyword">cnf</span>, ~/.my.<span class="keyword">cnf</span> 这些就是mysql默认会搜寻my.<span class="keyword">cnf</span>的目录，顺序排前的优先</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/5.6/my_cnf.png" alt="mysql 配置文件" title="mysql 配置文件"></p><h3 id="查看错误日志位置"><a href="#查看错误日志位置" class="headerlink" title="查看错误日志位置"></a>查看错误日志位置</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">修改 my.cnf 文件指定错误日志位置</span><br><span class="line">log<span class="emphasis">_error=/data/mysql.log</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">错误日志默认存放位置为数据目录下，你也可以用下面命令查看:</span></span><br><span class="line"><span class="emphasis">SHOW  GLOBAL VARIABLES LIKE '%log_</span>error%<span class="emphasis">';</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; SHOW  GLOBAL VARIABLES LIKE '</span>%log<span class="emphasis">_error%';</span></span><br><span class="line"><span class="emphasis">+---------------------+-----------------+</span></span><br><span class="line"><span class="emphasis">| Variable_</span>name       | Value           |</span><br><span class="line"><span class="code">+---------------------+</span>-----------------+</span><br><span class="line">| binlog<span class="emphasis">_error_</span>action | IGNORE<span class="emphasis">_ERROR    |</span></span><br><span class="line"><span class="emphasis">| log_</span>error           | /data/mysql.log |</span><br><span class="line"><span class="code">+---------------------+</span>-----------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p> <a href="https://dev.mysql.com/doc/refman/5.6/en/source-configuration-options.html" title="mysql官方预编译配置参数" target="_blank" rel="noopener">mysql官方预编译配置参数</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>BlueLake 主题配置</title>
      <link href="/2018/03/26/hexo/hexo-BlueLake/"/>
      <url>/2018/03/26/hexo/hexo-BlueLake/</url>
      <content type="html"><![CDATA[<h3 id="添加本地搜索"><a href="#添加本地搜索" class="headerlink" title="添加本地搜索"></a>添加本地搜索</h3><p>安装插件<a href="https://github.com/alexbruno/hexo-generator-json-content" target="_blank" rel="noopener">hexo-generator-json-content</a>来创建JSON数据文件</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-generator-<span class="keyword">json</span>-<span class="keyword">content</span>@<span class="number">2.2</span><span class="number">.0</span> <span class="comment">--save</span></span><br></pre></td></tr></table></figure><p>在根配置  _config.yml  添加配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jsonContent:</span></span><br><span class="line"><span class="attr">  meta:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  pages:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  posts:</span></span><br><span class="line"><span class="attr">    title:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    date:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    path:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    text:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    raw:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    content:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    slug:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    updated:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    comments:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    permalink:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    excerpt:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    categories:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    tags:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>在主题 _config.yml 中添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">local_search:</span> <span class="literal">true</span>      <span class="comment">#安装好 BlueLake主题后，会有这个配置</span></span><br></pre></td></tr></table></figure><p><img src="/img/hexo/BlueLake_config/search_01.png" alt="站内搜索" title="站内搜索"></p><p><img src="/img/hexo/BlueLake_config/search_02.png" alt="站内搜索" title="站内搜索"></p><p><img src="/img/hexo/BlueLake_config/search_03.png" alt="站内搜索" title="站内搜索"></p><p> <a href="http://example.com/" title="这里是title" target="_blank" rel="noopener">我是a里面的内容</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu16 -swoole</title>
      <link href="/2018/03/21/ubuntu/linux_ubuntu_swoole/"/>
      <url>/2018/03/21/ubuntu/linux_ubuntu_swoole/</url>
      <content type="html"><![CDATA[<h3 id="swoole"><a href="#swoole" class="headerlink" title="swoole"></a>swoole</h3><p>php7 中安装swoole1.9.1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">安装依赖</span><br><span class="line">apt-get <span class="keyword">install</span> libpcre3 libpcre3-dev  </span><br><span class="line"></span><br><span class="line">*********************************************</span><br><span class="line"></span><br><span class="line">cd  /<span class="keyword">data</span>/<span class="keyword">server</span>/</span><br><span class="line">wget https://github.com/swoole/swoole-src/<span class="keyword">archive</span>/v1<span class="number">.9</span><span class="number">.1</span>-stable.tar.gz</span><br><span class="line">tar zxvf v1<span class="number">.9</span><span class="number">.1</span>-stable.tar.gz -C /<span class="keyword">data</span>/<span class="keyword">server</span>/</span><br><span class="line">cd swoole-src<span class="number">-1.9</span><span class="number">.1</span>-stable</span><br><span class="line"></span><br><span class="line">/<span class="keyword">data</span>/<span class="keyword">server</span>/php7/<span class="keyword">bin</span>/phpize</span><br><span class="line">【</span><br><span class="line">这一步很少出问题： 我的报错如下：</span><br><span class="line">错误一：</span><br><span class="line">root@ubuntu:/<span class="keyword">data</span>/<span class="keyword">server</span>/swoole-src<span class="number">-1.9</span><span class="number">.1</span>-stable# /<span class="keyword">data</span>/<span class="keyword">server</span>/php7/<span class="keyword">bin</span>/phpize</span><br><span class="line">Configuring <span class="keyword">for</span>:</span><br><span class="line">PHP Api <span class="keyword">Version</span>:         <span class="number">20151012</span></span><br><span class="line">Zend <span class="keyword">Module</span> Api <span class="keyword">No</span>:      <span class="number">20151012</span></span><br><span class="line">Zend Extension Api <span class="keyword">No</span>:   <span class="number">320151012</span></span><br><span class="line">Cannot find autoconf. Please <span class="keyword">check</span> your autoconf installation <span class="keyword">and</span> the</span><br><span class="line">$PHP_AUTOCONF environment variable. <span class="keyword">Then</span>, rerun this script.</span><br><span class="line">错误二:</span><br><span class="line">Cannot find config.m4. </span><br><span class="line">Make sure that you run <span class="string">'/data/server/php7/bin/phpize'</span> <span class="keyword">in</span> the top <span class="keyword">level</span> <span class="keyword">source</span> <span class="keyword">directory</span> <span class="keyword">of</span> the <span class="keyword">module</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">解决方法：</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> m4</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> autoconf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">】</span><br><span class="line">./configure <span class="comment">--with-php-config=/data/server/php7/bin/php-config</span></span><br><span class="line">make</span><br><span class="line">make <span class="keyword">install</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">最后安装成功后显示：</span><br><span class="line">root@ubuntu:/<span class="keyword">data</span>/<span class="keyword">server</span>/swoole-src<span class="number">-1.9</span><span class="number">.1</span>-stable# make <span class="keyword">install</span></span><br><span class="line">Installing <span class="keyword">shared</span> extensions:     /<span class="keyword">data</span>/<span class="keyword">server</span>/php7/lib/php/extensions/<span class="keyword">no</span>-debug-non-zts<span class="number">-20151012</span>/</span><br><span class="line">root@ubuntu:/<span class="keyword">data</span>/<span class="keyword">server</span>/swoole-src<span class="number">-1.9</span><span class="number">.1</span>-stable#</span><br></pre></td></tr></table></figure><h3 id="配置php支持swoole"><a href="#配置php支持swoole" class="headerlink" title="配置php支持swoole"></a>配置php支持swoole</h3><p>vi  /data/server/php7/lib/php.ini   #######编辑配置文件，在最后一行添加以下内容(查找php.ini最好的方法就是phpinfo)</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/php/<span class="number">7.0</span>/cli/php.ini</span><br><span class="line">vi  /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>.<span class="title">ini</span>  </span></span><br><span class="line">这两个里面都要写上一以下内容：</span><br><span class="line"></span><br><span class="line">extension=swoole.so</span><br></pre></td></tr></table></figure><h3 id="重启php-fpm"><a href="#重启php-fpm" class="headerlink" title="重启php-fpm"></a>重启php-fpm</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查找PHP服务 ps aux | <span class="keyword">grep</span> php-fpm</span><br><span class="line">pkill -<span class="number">9</span> php</span><br><span class="line">php启动命令</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/php7/</span>sbin<span class="regexp">/php-fpm</span></span><br></pre></td></tr></table></figure><p>先用 php -m 看一下,没有 swoole ，扩展，检索一下  locate php.ini   ,发现在  /etc/php/7.0/cli/php.ini  这里还有一个，这里也加上  extension=swoole.so   ，在看看有没有，如果还是没有，   php -ini|grep ‘extesion_dir’  看一下，发现如下错误：</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@<span class="symbol">ubuntu:</span>/home/afei<span class="comment"># php -ini|grep 'extesion_dir'</span></span><br><span class="line">PHP <span class="symbol">Warning:</span>  PHP <span class="symbol">Startup:</span> Unable to load dynamic library <span class="string">'/usr/lib/php/20151012/swoole.so'</span> - <span class="regexp">/usr/lib</span><span class="regexp">/php/</span><span class="number">20151012</span>/swoole.<span class="symbol">so:</span> cannot open shared object <span class="symbol">file:</span> No such file or directory in Unknown on line <span class="number">0</span></span><br><span class="line">root@<span class="symbol">ubuntu:</span>/home/afei<span class="comment"># cd  /usr/lib/php/20151012</span></span><br><span class="line">root@<span class="symbol">ubuntu:</span>/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/20151012<span class="comment"># ls -l</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">解决办法， 拷贝一份过去： </span><br><span class="line">cp /data/server/php7/<span class="class"><span class="keyword">lib</span>/<span class="title">php</span>/<span class="title">extensions</span>/<span class="title">no</span>-<span class="title">debug</span>-<span class="title">non</span>-<span class="title">zts</span>-20151012/<span class="title">swoole</span>.<span class="title">so</span>  /<span class="title">usr</span>/<span class="title">lib</span>/<span class="title">php</span>/20151012/</span></span><br></pre></td></tr></table></figure><p>在phpinfo页面可以看到关于swoole的选项，说明安装成功</p><p><img src="/img/ubuntu/swoole/swoole_success.png" alt="swoole 安装成功" title="swoole 安装成功"></p><p> <a href="https://wiki.swoole.com/wiki/page/6.html" title="swoole官方文档" target="_blank" rel="noopener">swoole官方文档</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu15 -mysql5.7</title>
      <link href="/2018/03/17/ubuntu/linux_ubuntu_mysql/"/>
      <url>/2018/03/17/ubuntu/linux_ubuntu_mysql/</url>
      <content type="html"><![CDATA[<h3 id="mysql-5-7安装"><a href="#mysql-5-7安装" class="headerlink" title="mysql 5.7安装"></a>mysql 5.7安装</h3><h3 id="在终端执行-以下命令"><a href="#在终端执行-以下命令" class="headerlink" title="在终端执行 以下命令"></a>在终端执行 以下命令</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get <span class="keyword">install</span> mysql-<span class="keyword">server</span></span><br><span class="line">sudo apt <span class="keyword">install</span> mysql-<span class="keyword">client</span></span><br><span class="line">sudo apt <span class="keyword">install</span> libmysqlclient-dev</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/fast_mysql_install.png" alt="mysql install" title="mysql install"></p><p>安装完用以下命测试,出现图中说明 OK</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -tap <span class="string">| grep mysql</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/fast_mysql_check.png" alt="mysql check" title="mysql check"></p><h3 id="进入-mysql"><a href="#进入-mysql" class="headerlink" title="进入 mysql"></a>进入 mysql</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -<span class="selector-tag">p</span>   然后回车输入密码</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/fast_show_databases.png" alt="show databases" title="show databases"></p><h3 id="设置-mysql-运行远程访问"><a href="#设置-mysql-运行远程访问" class="headerlink" title="设置 mysql 运行远程访问"></a>设置 mysql 运行远程访问</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/mysql/mysql<span class="selector-class">.conf</span><span class="selector-class">.d</span>/mysqld.cnf</span><br></pre></td></tr></table></figure><p>1、注释掉  bind-address  = 127.0.0.1  保存退出【在43行】<br>2、grant all on <em>.</em> to root@’%’ identified by ‘你的密码’ with grant option;<br>3、flush privileges;<br>4、exit; 退出 mysql服务<br>5、重启服务： service mysql restart</p><p><img src="/img/ubuntu/mysql/fast_remote_connection.png" alt="remote connection" title="remote connection"></p><h3 id="卸载mysql"><a href="#卸载mysql" class="headerlink" title="卸载mysql"></a>卸载mysql</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> mysql-server</span><br><span class="line">sudo apt-<span class="built_in">get</span> autoremove mysql-server</span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> mysql-common <span class="comment">//这个很重要</span></span><br><span class="line"></span><br><span class="line">清理残留数据；</span><br><span class="line">dpkg -l |grep ^rc|awk <span class="string">'&#123;print $2&#125;'</span> |sudo xargs dpkg -P</span><br></pre></td></tr></table></figure><h2 id="mysql-手动安装"><a href="#mysql-手动安装" class="headerlink" title="mysql 手动安装"></a>mysql 手动安装</h2><h3 id="编译环境"><a href="#编译环境" class="headerlink" title="编译环境"></a>编译环境</h3><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install make cmake gcc g++ perl bison libaio-<span class="built_in">dev</span> libncurses5 libncurses5-<span class="built_in">dev</span> libnuma-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure><h3 id="下载【注意版本】"><a href="#下载【注意版本】" class="headerlink" title="下载【注意版本】"></a>下载【注意版本】</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">安装版本 <span class="number">5</span>.<span class="number">7</span>.<span class="number">21</span>；如果是虚拟机建议内容 <span class="number">4</span>G <span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">wget</span> https://dev.mysql.com/<span class="meta">get</span>/Downloads/MySQL-<span class="number">5</span>.<span class="number">7</span>/mysql-<span class="keyword">boost-5.7.21.tar.gz</span></span><br><span class="line"><span class="keyword">【解压到你指定的目录，我这里选择 </span>/<span class="meta">data</span>/server/ 】</span><br><span class="line"><span class="symbol">tar</span> zxvf mysql-<span class="keyword">boost-5.7.21.tar.gz </span>-C /<span class="meta">data</span>/server/</span><br><span class="line"><span class="symbol">mv</span> mysql-<span class="number">5</span>.<span class="number">7</span>.<span class="number">21</span> mysql</span><br><span class="line"><span class="symbol">cd</span> mysql</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/mysql_download.png" alt="mysql download" title="mysql download"></p><h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cmake . -DBUILD_CONFIG=mysql_release \</span><br><span class="line">-<span class="ruby">DCPACK_MONOLITHIC_INSTALL=ON \</span></span><br><span class="line"><span class="ruby">-DCMAKE_INSTALL_PREFIX=<span class="regexp">/data/server</span><span class="regexp">/mysql \</span></span></span><br><span class="line"><span class="ruby">-DDEFAULT_CHARSET=utf8 \</span></span><br><span class="line"><span class="ruby">-DDEFAULT_COLLATION=utf8_general_ci \</span></span><br><span class="line"><span class="ruby">-DMYSQL_UNIX_ADDR=<span class="regexp">/data/server</span><span class="regexp">/mysql/mysql</span>.sock \</span></span><br><span class="line"><span class="ruby">-DMYSQL_TCP_PORT=<span class="number">3306</span> \</span></span><br><span class="line"><span class="ruby">-DMYSQLX_UNIX_ADDR=<span class="regexp">/data/server</span><span class="regexp">/mysql/mysqlx</span>.sock \</span></span><br><span class="line"><span class="ruby">-DMYSQL_DATADIR=<span class="regexp">/data/server</span><span class="regexp">/mysql/data</span> \</span></span><br><span class="line"><span class="ruby">-DSYSCONFDIR=<span class="regexp">/data/server</span><span class="regexp">/mysql/etc</span> \</span></span><br><span class="line"><span class="ruby">-DWITH_BOOST=<span class="regexp">/data/server</span><span class="regexp">/mysql/boost</span><span class="regexp">/boost_1_59_0</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">make &amp;&amp; make install</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">注意这一项：这个是你 boost 下载好的目录，我的这个版本的 MySQL 解压后对应的目录中有这个</span></span><br><span class="line"><span class="ruby">-DWITH_BOOST=<span class="regexp">/data/server</span><span class="regexp">/mysql/boost</span><span class="regexp">/boost_1_59_0</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">make 的过程比较耗时；耐心等待，make install 就很快啦</span></span><br><span class="line"><span class="ruby">官方预编译配置参数：</span></span><br><span class="line"><span class="ruby"><span class="symbol">https:</span>/<span class="regexp">/dev.mysql.com/doc</span><span class="regexp">/refman/</span><span class="number">5.7</span>/en/source-configuration-options.html<span class="comment">#cmake-general-options</span></span></span><br><span class="line"><span class="ruby"><span class="symbol">https:</span>/<span class="regexp">/dev.mysql.com/doc</span><span class="regexp">/refman/</span><span class="number">5.7</span>/en/source-configuration-options.html<span class="comment">#cmake-general-options</span></span></span><br></pre></td></tr></table></figure><p>这个过程时间比较长…………</p><p><img src="/img/ubuntu/mysql/mysql_make.png" alt="mysql make install" title="mysql make install"></p><p><img src="/img/ubuntu/mysql/exception_01.png" alt="mysql exception_01" title="mysql exception_01"></p><h3 id="初始化设置-mysql"><a href="#初始化设置-mysql" class="headerlink" title="初始化设置 mysql"></a>初始化设置 mysql</h3><h4 id="创建-MySQL-组跟用户"><a href="#创建-MySQL-组跟用户" class="headerlink" title="创建 MySQL 组跟用户"></a>创建 MySQL 组跟用户</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd mysql</span><br><span class="line">sudo useradd -r -g mysql -s <span class="regexp">/bin/</span><span class="keyword">false</span> mysql</span><br></pre></td></tr></table></figure><h4 id="更改-mysql-目录权限"><a href="#更改-mysql-目录权限" class="headerlink" title="更改 mysql 目录权限"></a>更改 mysql 目录权限</h4><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /data/server/mysql</span><br><span class="line">sudo chown -R mysql .</span><br><span class="line">sudo chgrp -R mysql .</span><br></pre></td></tr></table></figure><h4 id="初始化-mysql-，-生成-root-用户临时密码，"><a href="#初始化-mysql-，-生成-root-用户临时密码，" class="headerlink" title="初始化 mysql ， 生成 root 用户临时密码，"></a>初始化 mysql ， 生成 root 用户临时密码，</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo bin/mysqld --initialize --user=mysql</span><br><span class="line"></span><br><span class="line">通过mysqld初始化data目录时，如果使用--initialize选项，则会为'root'@'localhost'用户创建一个随机密码。该密码会打印在控制台，如下所示行中末尾就是临时密码：</span><br><span class="line"></span><br><span class="line">2018-03-29T01:10:08.161779Z 1 [Note] A temporary password is generated for root@localhost: xJB.L-TJ)2wB</span><br><span class="line"></span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">**初始化一个空密码，使用initialize-insecure **</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">***</span>*</span><br><span class="line">sudo bin/mysqld --initialize-insecure --user=mysql</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/mysql_init.png" alt="mysql init" title="mysql init"></p><h3 id="启动-mysql"><a href="#启动-mysql" class="headerlink" title="启动 mysql"></a>启动 mysql</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">support-<span class="keyword">files</span>/mysql.server start</span><br><span class="line">bin/mysql -u root -p</span><br><span class="line">alter user <span class="string">'root'</span>@<span class="string">'localhost'</span> identified by <span class="string">'new_password'</span>;</span><br><span class="line">修改完重启mysql 或者 刷新</span><br><span class="line">support-<span class="keyword">files</span>/mysql.server stop   或者</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line"><span class="comment">*************************************************************</span></span><br><span class="line">我这里设置密码： <span class="number">123456</span> 做测试，实际中设置你认为安全的密码</span><br><span class="line">方法<span class="number">1</span>：alter user <span class="string">'root'</span>@<span class="string">'localhost'</span> identified by <span class="string">'123456'</span>;</span><br><span class="line">方法<span class="number">2</span>：update user <span class="keyword">set</span> authentication_string=password(<span class="string">'123456'</span>) where <span class="comment">user=</span><span class="comment">'root'</span>;</span><br><span class="line">方法<span class="number">3</span>：<span class="keyword">set</span> password=password(<span class="string">'123456'</span>);</span><br><span class="line"></span><br><span class="line">这里如果不重新设置密码，系统会一直提示：</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">ERROR <span class="number">1820</span> (HY000): You must reset your password <span class="keyword">using</span> ALTER USER statement before executing this statement.</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/mysql_pwd.png" alt="mysql 启动" title="mysql 启动"></p><h3 id="设为系统服务"><a href="#设为系统服务" class="headerlink" title="设为系统服务"></a>设为系统服务</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cp /data/server/mysql/support-files/mysql.server /etc/init.d/mysqld</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload  [重新加载<span class="built_in"> service </span>文件]</span><br><span class="line">systemctl start mysqld</span><br><span class="line">systemctl stop  mysqld</span><br><span class="line">systemctl restart mysqld</span><br></pre></td></tr></table></figure><h3 id="创建新用户，并允许远程连接"><a href="#创建新用户，并允许远程连接" class="headerlink" title="创建新用户，并允许远程连接"></a>创建新用户，并允许远程连接</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令: </span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'username'</span>@<span class="string">'host'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'new_password'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>; </span><br><span class="line"></span><br><span class="line">. 点代表所有表</span><br><span class="line">username 代表你创建的用户名</span><br><span class="line">host 代表你指定在那台机器可以登录，本地登录就是 localhost ，允许所有远程登录就是 % ；</span><br><span class="line">new_password 代表该用户的登录密码，密码可以为空，如果是空则改用户可以不需要密码登录</span><br><span class="line"></span><br><span class="line">demo:</span><br><span class="line">新增超级权限并允许远程访问：</span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'afei2'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'123456'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;   </span><br><span class="line"><span class="keyword">FLUSH</span>   <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/mysql/mysql_remote_connect.png" alt="mysql 远程连接" title="mysql 远程连接"></p><h3 id="MySQL-命令"><a href="#MySQL-命令" class="headerlink" title="MySQL 命令"></a>MySQL 命令</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">support-files/mysql<span class="selector-class">.server</span> start</span><br><span class="line">support-files/mysql<span class="selector-class">.server</span> stop</span><br><span class="line">/data/server/mysql/bin/mysql -u root -p</span><br><span class="line"></span><br><span class="line">mysql -h 你登录的ip -u username -P <span class="number">3306</span> -<span class="selector-tag">p</span> 【远程登录】</span><br><span class="line">demo： mysql -h <span class="number">192.168</span>.<span class="number">1.230</span> -u afei2 -p</span><br></pre></td></tr></table></figure><h3 id="mysql-命令行工具中-c-取消之前的输入-重新开始输入"><a href="#mysql-命令行工具中-c-取消之前的输入-重新开始输入" class="headerlink" title="mysql  命令行工具中 \c  取消之前的输入,重新开始输入"></a>mysql  命令行工具中 \c  取消之前的输入,重新开始输入</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> fdfds \c</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show tables ddjfkldjfdklsf \c</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show tables;</span></span><br></pre></td></tr></table></figure><p>mysql  命令行工具中 \G 竖向显示内容</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">show </span>tables \G<span class="comment">;</span></span><br><span class="line">mysql&gt; <span class="keyword">show </span>table status \G<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>mysql  命令行工具中 \q 退出终端</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> \q;</span></span><br></pre></td></tr></table></figure><p> <a href="https://dev.mysql.com/downloads/mysql/" title="mysql官方下载地址" target="_blank" rel="noopener">mysql官方下载地址</a></p><p> <a href="http://ftp.ntu.edu.tw/MySQL/Downloads/" title="mysql官方下载地址" target="_blank" rel="noopener">mysql官方下载地址</a></p><p> <a href="https://dev.mysql.com/doc/refman/5.7/en/source-configuration-options.html#cmake-general-options" title="mysql官方预编译配置参数" target="_blank" rel="noopener">mysql官方预编译配置参数</a></p><p> <a href="https://dev.mysql.com/doc/refman/5.7/en/faqs.html" title="mysql官方手册" target="_blank" rel="noopener">mysql官方手册</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu15 -tengine</title>
      <link href="/2018/03/17/ubuntu/linux_ubuntu_tengine/"/>
      <url>/2018/03/17/ubuntu/linux_ubuntu_tengine/</url>
      <content type="html"><![CDATA[<p>Tengine 官网安装相当简略，这里详细安装一次（ubuntu15 安装 tengine）</p><h3 id="安装必要的编译环境"><a href="#安装必要的编译环境" class="headerlink" title="安装必要的编译环境"></a>安装必要的编译环境</h3><p>Tengine 安装需要使用源代码自行编译，所以安装前需要安装必要的编译工具</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> update</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install g++</span><br><span class="line">apt-<span class="builtin-name">get</span> install libgd-dev</span><br></pre></td></tr></table></figure><h3 id="安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径"><a href="#安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径" class="headerlink" title="安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径"></a>安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径</h3><h4 id="PCRE"><a href="#PCRE" class="headerlink" title="PCRE"></a>PCRE</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">ftp:</span>/<span class="regexp">/ftp.csx.cam.ac.uk/pub</span><span class="regexp">/software/programming</span><span class="regexp">/pcre/pcre</span>-<span class="number">8.38</span>.tar.gz</span><br><span class="line">解压到你指定的目录</span><br><span class="line">tar -zxvf pcre-<span class="number">8.38</span>.tar.gz -C /data/server/tengine_component</span><br><span class="line">mv pcre-<span class="number">8.38</span> pcre</span><br><span class="line">cd pcre/</span><br><span class="line">./configure --prefix=<span class="regexp">/data/server</span><span class="regexp">/tengine_component/pcre</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tengine/component_pcre.png" alt="pcre 组件" title="pcre 组件"></p><h3 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">http:</span>/<span class="regexp">/www.openssl.org/source</span><span class="regexp">/openssl-1.0.2.tar.gz</span></span><br><span class="line"><span class="regexp">解压到你指定的目录</span></span><br><span class="line"><span class="regexp">tar -zxvf openssl-1.0.2.tar.gz -C /data</span><span class="regexp">/server/tengine</span>_component</span><br><span class="line">mv openssl-<span class="number">1.0</span>.<span class="number">2</span> openssl</span><br><span class="line">cd openssl/</span><br><span class="line">./config --prefix=<span class="regexp">/data/server</span><span class="regexp">/tengine_component/openssl</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>这个执行时间稍微长一点  </p><p><img src="/img/ubuntu/tengine/component_openssl.png" alt="OpenSSL  组件" title="OpenSSL 组件"></p><h3 id="Zlib"><a href="#Zlib" class="headerlink" title="Zlib"></a>Zlib</h3><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://<span class="literal">zlib</span>.net/<span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span>.tar.gz</span><br><span class="line">解压到你指定的目录</span><br><span class="line">tar -zxvf <span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span>.tar.gz -C /data/server/tengine_component</span><br><span class="line">mv <span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span> <span class="literal">zlib</span></span><br><span class="line">cd <span class="literal">zlib</span>/</span><br><span class="line">./configure --prefix=/data/server/tengine_component/<span class="literal">zlib</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tengine/component_Zlib.png" alt="Zlib  组件" title="Zlib 组件"></p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###有空试试这个不添加应该也是可以的，安装完有2个报错，不用理会，手动创建 logs 目录，修改权限；###</span></span><br><span class="line">groupadd www</span><br><span class="line">useradd -s /sbin/nologin -g www www</span><br><span class="line"><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">////</span><span class="regexp">///</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">wget http://</span>tengine.taobao.org/download/tengine-<span class="number">2.1</span>.<span class="number">2.tar</span>.gz</span><br><span class="line">解压到你指定的目录</span><br><span class="line">tar -zxvf tengine-<span class="number">2.1</span>.<span class="number">2.tar</span>.gz -C <span class="regexp">/data/server/</span></span><br><span class="line">mv tengine-<span class="number">2.1</span>.<span class="number">2</span> tengine</span><br><span class="line">cd tengine</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">./configure --prefix=/data/server/tengine <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-pcre=/data/server/tengine_component/pcre <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-openssl=/data/server/tengine_component/openssl <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-http_gzip_static_module <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-http_realip_module <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-http_stub_status_module <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-http_concat_module <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-zlib=/data/server/tengine_component/zlib</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>注意配置的时候 –with-pcre 、–with-openssl、–with-zlib的路径为源文件的路径</p><p><img src="/img/ubuntu/tengine/tengine_install.png" alt="tengine install" title="tengine install"></p><h3 id="检测是否可用"><a href="#检测是否可用" class="headerlink" title="检测是否可用"></a>检测是否可用</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta-keyword">/data/</span>server<span class="meta-keyword">/tengine/</span>sbin/nginx -t</span><br><span class="line"></span><br><span class="line">没有logs目录，那就创建一个logs目录： mkdir logs</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tengine/tengine_check.png" alt="tengine check" title="tengine check"></p><p><img src="/img/ubuntu/tengine/tengine_ok.png" alt="tengine ok" title="tengine ok"></p><h3 id="启动关闭命令"><a href="#启动关闭命令" class="headerlink" title="启动关闭命令"></a>启动关闭命令</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/tengine/</span>sbin/nginx -t</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/tengine/</span>sbin/nginx -s start</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/tengine/</span>sbin/nginx -s stop</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/tengine/</span>sbin/nginx -s reload</span><br><span class="line"></span><br><span class="line">pid出错时，可以使用这个：</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/tengine/</span>sbin<span class="regexp">/nginx  -c /</span>data<span class="regexp">/server/</span>tengine<span class="regexp">/conf/</span>nginx.conf</span><br></pre></td></tr></table></figure><p>扩展：有时候，我们有好多域名，为了方便我们修改一下 nginx.conf  ,修改内容如下，主要是最后一句 include servers/*;然后在nginx.conf 当前位置创建 servers 目录；【修改之前记得把原来的备份  cp nginx.conf nginx.conf_backups  】</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">user  nobody;</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"><span class="meta">#</span><span class="bash">error_log  logs/error.log;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">error_log  logs/error.log  info;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">pid        logs/nginx.pid;</span></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> load modules compiled as Dynamic Shared Object (DSO)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">dso &#123;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    load ngx_http_fastcgi_module.so;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    load ngx_http_rewrite_module.so;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&#125;</span></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    charset utf-8;</span><br><span class="line"><span class="meta">#</span><span class="bash">    server_tokens off;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    server_names_hash_bucket_size 128;</span></span><br><span class="line"><span class="meta"> #</span><span class="bash">   client_header_buffer_size 32k;</span></span><br><span class="line"><span class="meta"> #</span><span class="bash">   large_client_header_buffers 4 32k;</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">  client_max_body_size 20m;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> client_body_buffer_size  128k;</span></span><br><span class="line">    client_header_timeout 30m;</span><br><span class="line">    client_body_timeout 30m;</span><br><span class="line"><span class="meta">   #</span><span class="bash"> client_body_temp_path /dev/shm/client_body_temp_path 1 2;</span></span><br><span class="line">    send_timeout 30m;</span><br><span class="line">    #sendfile on;</span><br><span class="line"><span class="meta">   #</span><span class="bash"> tcp_nopush on;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> tcp_nodelay on;</span></span><br><span class="line">    keepalive_timeout 60;</span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_connect_timeout 300;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_send_timeout 300;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_read_timeout 300;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_buffer_size 256k;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_buffers 4 256k;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_busy_buffers_size 512k;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_temp_file_write_size 512k;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_temp_path /dev/shm/factcgi_temp_path 1 2;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_cache_path   /dev/shm/fastcgi_cache  levels=1:2  keys_zone=PHPCACHE:1024m inactive=15m;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_cache_key <span class="string">"<span class="variable">$scheme</span><span class="variable">$request_method</span><span class="variable">$host</span><span class="variable">$request_uri</span>"</span>;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_cache_use_stale error  timeout invalid_header http_500;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> fastcgi_intercept_errors on;    <span class="comment">#开启后支持4XX 和 5XX 错误自定义</span></span></span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_min_length  10k;</span><br><span class="line">    gzip_buffers     4 16k;</span><br><span class="line">    gzip_http_version 1.0;</span><br><span class="line">    gzip_comp_level 2;</span><br><span class="line">    gzip_types   text/plain text/css text/xml text/javascript application/x-javascript application/xml application/javascript;</span><br><span class="line">    gzip_disable  "MSIE [1-6]\.";</span><br><span class="line">    include servers/*;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>demo 测试，在新建的 servers 目录下创建 文件 127.0.0.1</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">80</span>;</span><br><span class="line">    server_name  <span class="number">127.0.</span><span class="number">0.1</span>;</span><br><span class="line">    client_max_body_size 0m;</span><br><span class="line">    charset utf-<span class="number">8</span>;</span><br><span class="line">    #access_log /<span class="keyword">data</span>/server/tengine/logs/<span class="number">127.0.</span><span class="number">0.</span>_access.<span class="built_in">log</span>;</span><br><span class="line">    #error_log  /<span class="keyword">data</span>/server/tengine/logs/<span class="number">127.0.</span><span class="number">0.</span>_error.<span class="built_in">log</span>;</span><br><span class="line">    root  /<span class="keyword">data</span>/www/;</span><br><span class="line">    <span class="built_in">index</span> <span class="built_in">index</span>.html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">或者：</span><br><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">80</span>;</span><br><span class="line">    server_name  <span class="number">127.0.</span><span class="number">0.1</span> <span class="number">192.168.</span><span class="number">1.232</span>;</span><br><span class="line">    client_max_body_size 0m;</span><br><span class="line">    charset utf-<span class="number">8</span>;</span><br><span class="line">    #access_log /<span class="keyword">data</span>/server/tengine/logs/<span class="number">127.0.</span><span class="number">0.</span>_access.<span class="built_in">log</span>;</span><br><span class="line">    #error_log  /<span class="keyword">data</span>/server/tengine/logs/<span class="number">127.0.</span><span class="number">0.</span>_error.<span class="built_in">log</span>;</span><br><span class="line">    root  /<span class="keyword">data</span>/www/;</span><br><span class="line">    <span class="built_in">index</span> <span class="built_in">index</span>.html <span class="built_in">index</span>.php;</span><br><span class="line">    </span><br><span class="line">    location ~ .+\.php($|/) &#123;</span><br><span class="line">        fastcgi_pass <span class="number">127.0.</span><span class="number">0.1</span>:<span class="number">9000</span>;</span><br><span class="line">        fastcgi_index <span class="built_in">index</span>.php;</span><br><span class="line">        <span class="keyword">include</span> fastcgi.conf;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tengine/demo_test01.png" alt="demo_test01" title="demo_test01"></p><p><img src="/img/ubuntu/tengine/demo_test01.png" alt="demo_test02" title="demo_test02"></p><p><a href="http://tengine.taobao.org/document_cn/install_cn.html" title="Tengine 官网安装" target="_blank" rel="noopener">Tengine 官网安装</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu16 -php7.0.28</title>
      <link href="/2018/03/17/ubuntu/linux_ubuntu_php/"/>
      <url>/2018/03/17/ubuntu/linux_ubuntu_php/</url>
      <content type="html"><![CDATA[<p>源码编译安装php7.0</p><h3 id="依赖安装，安装依赖"><a href="#依赖安装，安装依赖" class="headerlink" title="依赖安装，安装依赖"></a>依赖安装，安装依赖</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">install</span> libxml2 libxml2-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> openssl</span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libssl-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> curl</span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libcurl4-gnutls-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libxslt-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libpng-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libfreetype6-dev</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// RetHat CentOS <span class="keyword">or</span> Fedora 使用下面安装命令</span><br><span class="line">yum <span class="keyword">install</span> curl curl-devel</span><br><span class="line"></span><br><span class="line">****************一般使用的依赖都是以下这些***************************</span><br><span class="line">安装相关依赖库</span><br><span class="line"></span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libxml2-dev</span><br><span class="line">#安装gcc</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> <span class="keyword">build</span>-essential</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> openssl </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libssl-dev </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> make</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> curl</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libcurl4-gnutls-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libjpeg-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libpng-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libmcrypt-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libreadline6 libreadline6-dev</span><br><span class="line">apt-<span class="keyword">get</span> -y <span class="keyword">install</span> libfreetype6-dev  </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libxslt1-dev</span><br></pre></td></tr></table></figure><h3 id="下载-PHP-源码"><a href="#下载-PHP-源码" class="headerlink" title="下载 PHP 源码"></a>下载 PHP 源码</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//cn2.php.net/get/php-7.0.28.tar.gz/from/this/mirror</span></span><br><span class="line">mv mirror php-<span class="number">7.0</span>.<span class="number">28</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br><span class="line"></span><br><span class="line">解压到你指定的目录，我这里选择  /data/server/ 目录</span><br><span class="line">tar -zxvf php-<span class="number">7.0</span>.<span class="number">28</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /data/server/</span><br><span class="line">mv php-<span class="number">7.0</span>.<span class="number">28</span> php7</span><br><span class="line">cd php7/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_download.png" alt="PHP7.0.28 下载" title="PHP7.0.28 下载"></p><h3 id="查看安装帮助，执行配置脚本进行配置"><a href="#查看安装帮助，执行配置脚本进行配置" class="headerlink" title="查看安装帮助，执行配置脚本进行配置"></a>查看安装帮助，执行配置脚本进行配置</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># ./configure   --help</span><br><span class="line"># ./configure --prefix=/data/server/php7 \</span><br><span class="line"> -<span class="ruby">-with-curl \</span></span><br><span class="line"><span class="ruby"> --with-freetype-dir \</span></span><br><span class="line"><span class="ruby"> --with-gd \</span></span><br><span class="line"><span class="ruby"> --with-gettext \</span></span><br><span class="line"><span class="ruby"> --with-iconv-dir \</span></span><br><span class="line"><span class="ruby"> --with-kerberos \</span></span><br><span class="line"><span class="ruby"> --with-libdir=lib64 \</span></span><br><span class="line"><span class="ruby"> --with-libxml-dir \</span></span><br><span class="line"><span class="ruby"> --with-mysqli \</span></span><br><span class="line"><span class="ruby"> --with-openssl \</span></span><br><span class="line"><span class="ruby"> --with-pcre-regex \</span></span><br><span class="line"><span class="ruby"> --with-pdo-mysql \</span></span><br><span class="line"><span class="ruby"> --with-pdo-sqlite \</span></span><br><span class="line"><span class="ruby"> --with-pear \</span></span><br><span class="line"><span class="ruby"> --with-png-dir \</span></span><br><span class="line"><span class="ruby"> --with-xmlrpc \</span></span><br><span class="line"><span class="ruby"> --with-xsl \</span></span><br><span class="line"><span class="ruby"> --with-zlib \</span></span><br><span class="line"><span class="ruby"> --enable-fpm \</span></span><br><span class="line"><span class="ruby"> --enable-bcmath \</span></span><br><span class="line"><span class="ruby"> --enable-libxml \</span></span><br><span class="line"><span class="ruby"> --enable-inline-optimization \</span></span><br><span class="line"><span class="ruby"> --enable-gd-native-ttf \</span></span><br><span class="line"><span class="ruby"> --enable-mbregex \</span></span><br><span class="line"><span class="ruby"> --enable-mbstring \</span></span><br><span class="line"><span class="ruby"> --enable-opcache \</span></span><br><span class="line"><span class="ruby"> --enable-pcntl \</span></span><br><span class="line"><span class="ruby"> --enable-shmop \</span></span><br><span class="line"><span class="ruby"> --enable-soap \</span></span><br><span class="line"><span class="ruby"> --enable-sockets \</span></span><br><span class="line"><span class="ruby"> --enable-sysvsem \</span></span><br><span class="line"><span class="ruby"> --enable-xml \</span></span><br><span class="line"><span class="ruby"> --enable-zip \</span></span><br><span class="line"><span class="ruby"> --enable-mysqlnd \</span></span><br><span class="line"><span class="ruby"> --with-pdo-mysql=mysqlnd \</span></span><br><span class="line"><span class="ruby"> --with-mcrypt</span></span><br></pre></td></tr></table></figure><p>我的错误</p><table><thead><tr><th>Configure Command</th><th>‘./configure’ ‘–prefix=/data/server/php7’ ‘–with-gd’ ‘–with-freetype-dir’ ‘–enable-gd-native-ttf’ ‘–enable-mysqlnd’ ‘–with-pdo-mysql=mysqlnd’ ‘–with-openssl’ ‘–with-mcrypt’ ‘–enable-mbstring’ ‘–enable-zip’ ‘–enable-fpm’</th></tr></thead><tbody><tr><td>Server API</td><td>FPM/FastCGI</td></tr><tr><td>Virtual Directory Support</td><td>disabled</td></tr><tr><td>Configuration File (php.ini) Path</td><td>/data/server/php7/lib</td></tr><tr><td>Loaded Configuration File</td><td>(none)        【正常情况这里不应该没有值的，还是之前的编译有问题，请仔细查看<br>                     正常应该是这个值   /data/server/php7/lib/php.ini】</td></tr><tr><td>Scan this dir for additional .ini files</td><td>(none)</td></tr><tr><td>Additional .ini files parsed</td><td>(none)</td></tr></tbody></table><p>之前安装过依赖这里就可以不用装，然后会提示部分依赖没有安装，安装依赖</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">install</span> libxml2 libxml2-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> openssl</span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libssl-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> curl</span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libcurl4-gnutls-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libxslt-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libpng-dev</span><br><span class="line"></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">install</span> libfreetype6-dev</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// RetHat CentOS <span class="keyword">or</span> Fedora 使用下面安装命令</span><br><span class="line">yum <span class="keyword">install</span> curl curl-devel</span><br><span class="line"></span><br><span class="line">****************一般使用的依赖都是以下这些***************************</span><br><span class="line">安装相关依赖库</span><br><span class="line"></span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libxml2-dev</span><br><span class="line">#安装gcc</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> <span class="keyword">build</span>-essential</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> openssl </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libssl-dev </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> make</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> curl</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libcurl4-gnutls-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libjpeg-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libpng-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libmcrypt-dev</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libreadline6 libreadline6-dev</span><br><span class="line">apt-<span class="keyword">get</span> -y <span class="keyword">install</span> libfreetype6-dev  </span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libxslt1-dev</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_configure01.png" alt="php configure" title="php configure"></p><h3 id="预处理ok后，make-编译"><a href="#预处理ok后，make-编译" class="headerlink" title="预处理ok后，make 编译"></a>预处理ok后，make 编译</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp;  <span class="built_in">make</span> install</span><br><span class="line"></span><br><span class="line">最后用 <span class="built_in">make</span> test 测试一下【这个过程时间比较长】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_configure01.png" alt="php make" title="php make"></p><p><img src="/img/ubuntu/php/php7_make_install.png" alt="php make install" title="php make install"></p><h3 id="安装完毕"><a href="#安装完毕" class="headerlink" title="安装完毕"></a>安装完毕</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#查看 php 版本 ,这个时候没有环境变量,全局还不能使用 php -v,下问有介绍</span></span><br><span class="line">/<span class="class"><span class="keyword">data</span>/server/php7/bin/php -v  </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#查看配置文件,没有加载,需要自己复制一份 php.ini</span></span><br><span class="line">/<span class="class"><span class="keyword">data</span>/server/php7/bin/php <span class="comment">--ini</span></span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_version.png" alt="php version" title="php version"></p><h3 id="配置PHP"><a href="#配置PHP" class="headerlink" title="配置PHP"></a>配置PHP</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>php.ini-development   <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>lib/php.ini</span><br><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.conf.default /</span>data<span class="regexp">/server/</span>php7<span class="regexp">/etc/</span>php-fpm.conf</span><br><span class="line">cp <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.d/</span>www.conf.<span class="keyword">default</span> <span class="regexp">/data/</span>server<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.d/</span>www.conf</span><br><span class="line"></span><br><span class="line">官方这里拷贝文件有点不一样，注意一下</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_php_ini.png" alt="php7 php.ini" title="php7 php.ini"></p><h3 id="添加-PHP-启动用户"><a href="#添加-PHP-启动用户" class="headerlink" title="添加 PHP 启动用户"></a>添加 PHP 启动用户</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PHP 安装默认使用 www 用户，这里根据自己情况添加用户</span><br><span class="line">groupadd managers</span><br><span class="line">useradd -r -g managers -s /bin/<span class="literal">false</span> managers</span><br><span class="line"></span><br><span class="line">设置 PHP 启动用户</span><br><span class="line">cd /data/server/php7/etc/php-fpm.d</span><br><span class="line">vi www.conf  修改23、24行，内容如下：</span><br><span class="line"><span class="built_in"> user </span>= 启动fpm的用户名</span><br><span class="line"><span class="built_in"> group </span>= 启动fpm的用户所在组</span><br><span class="line"> </span><br><span class="line"><span class="built_in"> user </span>= managers</span><br><span class="line"><span class="built_in"> group </span>= managers</span><br><span class="line"></span><br><span class="line">修改完启动 PHP-fpm</span><br></pre></td></tr></table></figure><h3 id="php-启动命令"><a href="#php-启动命令" class="headerlink" title="php 启动命令"></a>php 启动命令</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/php7/</span>sbin<span class="regexp">/php-fpm</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_user.png" alt="php7 启动用户" title="php7 启动用户"></p><h3 id="配置虚拟主机测试一下"><a href="#配置虚拟主机测试一下" class="headerlink" title="配置虚拟主机测试一下"></a>配置虚拟主机测试一下</h3><p>在 /data/www/ 目录下创建 index.php 内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> phpinfo();</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>在 nginx 中配置虚拟主机</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  <span class="number">127.0.0.1</span> <span class="number">192.168.1.230</span>;</span><br><span class="line">    <span class="attribute">client_max_body_size</span> <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line">    <span class="comment">#access_log /data/server/tengine/logs/127.0.0.1_access.log;</span></span><br><span class="line">    <span class="comment">#error_log  /data/server/tengine/logs/127.0.0.1_error.log;</span></span><br><span class="line">    <span class="attribute">root</span>  /data/www/;</span><br><span class="line">   <span class="comment"># index index.html;</span></span><br><span class="line">    <span class="attribute">index</span> index.php;</span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ .+\.php($|/)</span> &#123;</span><br><span class="line">        <span class="attribute">fastcgi_pass</span> <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">        <span class="attribute">fastcgi_index</span> index.php;</span><br><span class="line">        <span class="attribute">include</span> fastcgi.conf;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/php/php7_test.jpg" alt="php7 测试" title="php7 测试"></p><p>扩展： 使用 php -m  查看扩展,提示如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/php7/bin</span><span class="comment"># php -m</span></span><br><span class="line">The program <span class="string">'php'</span> can be found <span class="keyword">in</span> the following <span class="symbol">packages:</span></span><br><span class="line"> * php7.<span class="number">0</span>-cli</span><br><span class="line"> * hhvm</span><br><span class="line"><span class="symbol">Try:</span> apt install &lt;selected package&gt;</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/php7/bin</span><span class="comment"># apt install php7.0-cli</span></span><br><span class="line"></span><br><span class="line">安装：  apt install php7.<span class="number">0</span>-cli</span><br></pre></td></tr></table></figure><p>PHP命令</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">php</span> <span class="comment">--ini</span></span><br><span class="line"></span><br><span class="line">查询 <span class="type">PHP</span> 服务 ps aux | grep php-fpm</span><br><span class="line"><span class="title">pkill</span> <span class="number">-9</span> php</span><br><span class="line"><span class="title">php</span>启动命令</span><br><span class="line">/<span class="class"><span class="keyword">data</span>/server/php7/sbin/php-fpm</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#查看PHP的编译参数</span></span><br><span class="line">/<span class="class"><span class="keyword">data</span>/server/php7/bin/php -i | grep configure</span></span><br><span class="line">此命令使用场景:</span><br><span class="line">编译web服务器由nginx换为<span class="type">Apache</span>的时候需要在<span class="type">Apache</span>中添加<span class="type">PHP</span>模块,  <span class="type">PHP</span>需要添加 <span class="comment">--with-apxs2 后重新编译</span></span><br></pre></td></tr></table></figure><h3 id="配置-php-全局变量"><a href="#配置-php-全局变量" class="headerlink" title="配置 php 全局变量"></a>配置 php 全局变量</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PHP编译安装后的目录:  /data/server/php7/bin</span><br><span class="line">vim  /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#centos中配置PHP环境变量:</span></span><br><span class="line">修改 /etc<span class="built_in">/profile </span>配置环境变量</span><br><span class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:/data/server/php7/bin</span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br><span class="line">然后执行source /etc<span class="built_in">/profile </span>或者 .<span class="built_in">/profile </span>使其生效; 执行完后可以通过 echo <span class="variable">$PATH</span>  命令查看环境变量</span><br><span class="line"></span><br><span class="line"><span class="comment">###PATH=$PATH:/data/server/php/bin  意思加入环境变量</span></span><br><span class="line"><span class="comment">###export PATH          意思使环境变量生效</span></span><br></pre></td></tr></table></figure><p> <a href="http://www.php.net/downloads.php" target="_blank" rel="noopener">PHP官网下载地址</a></p><p><a href="http://php.net/manual/zh/install.unix.nginx.php" title="PHP 官方安装文档" target="_blank" rel="noopener">PHP官方安装文档</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>win server 2008 部署php</title>
      <link href="/2018/03/15/win/win_server_2008_IIS/"/>
      <url>/2018/03/15/win/win_server_2008_IIS/</url>
      <content type="html"><![CDATA[<h3 id="配置IIS-（安装好-PHPstudy-后测试php）"><a href="#配置IIS-（安装好-PHPstudy-后测试php）" class="headerlink" title="配置IIS （安装好 PHPstudy 后测试php）"></a>配置IIS （安装好 PHPstudy 后测试php）</h3><p>在计算机右击,选择管理，出现服务器管理界面；或者打开“开始”菜单→“服务器管理”，出现服务器管理界面</p><p><img src="/img/win_server2008/IIS_01.png" alt="IIS"></p><p>添加角色，下一步，选择 web 服务器（IIS）,下一步 选择 CGI,一直下一步</p><p><img src="/img/win_server2008/IIS_02.png" alt="IIS"></p><p><img src="/img/win_server2008/IIS_03.png" alt="IIS"></p><p><img src="/img/win_server2008/IIS_04.png" alt="IIS"></p><p>安装好IIS后，需要测试一下，在浏览器中输入 localhost ，如果出现 IIS7 欢迎界面说明正常；</p><p><img src="/img/win_server2008/IIS_05.png" alt="IIS"></p><p>配置一个新网站，打开 IIS 管理器（“开始”→“所有程序”→“管理工具”→“internet 信息服务（IIS）管理器”）；<br>备注：使用 PHPstudy 打开 IIS 管理器，需要提前安装好 PHPstudy；</p><p><img src="/img/win_server2008/IIS_06.png" alt="IIS"></p><p><img src="/img/win_server2008/IIS_07.png" alt="IIS"></p><p>添加好后，在 IIS 管理器中，在刚才添加的网站 “网站名称” 上右键，点击 “编辑权限” ，进入后点击“安全”选项卡，再点击其中的“编辑” 。打开“编辑”窗口后点击“添加”按钮。添加一个“用户”到权限用户列表中，然后为其勾选除了“完全控制”之外的权限。然后点击“确定” “应用”。</p><p><img src="/img/win_server2008/IIS_08.png" alt="IIS"></p><p>结束后，在刚才选择的物理路径下创建 index.html ,然后用记事本打开，输入 ”hello world“ 测试；</p><p>如果是做 PHP 开发，安装好 PHPstudy 后，可出在刚才选择的物理路径下创建 index.php ,然后用记事本打开，输入 如下做测试</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> phpinfo();</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="/img/win_server2008/IIS_09.png" alt="IIS"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -lnmp环境</title>
      <link href="/2018/03/13/ubuntu/linux_ubuntu_lnmp/"/>
      <url>/2018/03/13/ubuntu/linux_ubuntu_lnmp/</url>
      <content type="html"><![CDATA[<h3 id="LNMP环境搭建"><a href="#LNMP环境搭建" class="headerlink" title="LNMP环境搭建"></a>LNMP环境搭建</h3><p>使用命令下载 nginx 安装包</p><p><img src="/img/ubuntu/linux_command/linux_00/root_passwd.png" alt="root passwd"></p><p> <a href="http://nginx.org/" title="nginx官网" target="_blank" rel="noopener">nginx官网</a><br> <a href="http://nginx.org/" title="nginx官网" target="_blank" rel="noopener">nginx官网</a><br> <a href="http://nginx.org/" title="nginx官网" target="_blank" rel="noopener">nginx官网</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -shipyard</title>
      <link href="/2018/03/09/ubuntu/linux_ubuntu_shipyard/"/>
      <url>/2018/03/09/ubuntu/linux_ubuntu_shipyard/</url>
      <content type="html"><![CDATA[<h3 id="Shipyard简介"><a href="#Shipyard简介" class="headerlink" title="Shipyard简介"></a>Shipyard简介</h3><p>待完善。。。。。。。</p><p>Shipyard 是一个基于 Web 的 Docker 管理工具，支持多 host，可以把多个 Docker host 上的 containers 统一管理；可以查看 images，甚至 build images；并提供 RESTful API 等</p><h3 id="安装-shipyard"><a href="#安装-shipyard" class="headerlink" title="安装 shipyard"></a>安装 shipyard</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span> --<span class="keyword">rm</span> -v /<span class="keyword">var</span>/<span class="keyword">run</span>/docker.sock:/<span class="keyword">var</span>/<span class="keyword">run</span>/docker.sock shipyard/deploy start</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/shipyard/shipyard_install.png" alt="root passwd"></p><p> <a href="http://shipyard-project.com/&quot;shipyard官网 最近官网不能访问&quot;" target="_blank" rel="noopener">Shipyard官网最近官网不能访问</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-scp  Linux之间复制文件和目录</title>
      <link href="/2018/03/08/ubuntu/linux_DDU_scp/"/>
      <url>/2018/03/08/ubuntu/linux_DDU_scp/</url>
      <content type="html"><![CDATA[<h3 id="scp-简介"><a href="#scp-简介" class="headerlink" title="scp 简介"></a>scp 简介</h3><p>scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，<font color="red">不过cp只是在本机进行拷贝不能跨服务器</font>，而且scp传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。另外，scp还非常不占资源，不会提高多少系统负荷，在这一点上，rsync就远远不及它了。虽然 rsync比scp会快一点，但当小文件众多的情况下，rsync会导致硬盘I/O非常高，而scp基本不影响系统正常使用</p><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><p>scp [参数]  [原路径]  [目标路径]</p><h3 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h3><p>-1 强制scp命令使用协议ssh1<br>-2 强制scp命令使用协议ssh2<br>-4 强制scp命令只使用IPv4寻址<br>-6 强制scp命令只使用IPv6寻址<br>-B 使用批处理模式（传输过程中不询问传输口令或短语）<br>-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）<br>-p 保留原文件的修改时间，访问时间和访问权限。<br>-q 不显示传输进度条。<br>-r 递归复制整个目录。<br>-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。<br>-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。<br>-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。<br>-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。<br>-l limit 限定用户所能使用的带宽，以Kbit/s为单位。<br>-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，<br>-P port 注意是大写的P, port是指定数据传输用到的端口号<br>-S program 指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项</p><h3 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h3><p>使用scp前提：两台服务器必须都安装 ssh</p><h4 id="从本地服务器复制到远程服务器"><a href="#从本地服务器复制到远程服务器" class="headerlink" title="从本地服务器复制到远程服务器"></a>从本地服务器复制到远程服务器</h4><h4 id="复制文件"><a href="#复制文件" class="headerlink" title="复制文件"></a>复制文件</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">注意目标文件的权限<span class="symbol">:</span></span><br><span class="line">scp local_file remote_username<span class="variable">@remote_ip</span><span class="symbol">:remote_folder</span></span><br><span class="line">或者</span><br><span class="line">scp local_file remote_username<span class="variable">@remote_ip</span><span class="symbol">:remote_file</span></span><br><span class="line">或者</span><br><span class="line">scp local_file <span class="symbol">remote_ip:</span>remote_folder</span><br><span class="line">或者</span><br><span class="line">scp local_file <span class="symbol">remote_ip:</span>remote_file</span><br><span class="line"></span><br><span class="line">demo：</span><br><span class="line">scp test2_01.test dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">113</span><span class="symbol">:/data/www/test/</span></span><br></pre></td></tr></table></figure><p>第1,2个指定了用户名，命令执行后需要输入用户密码，<br>第1个仅指定了远程的目录，文件名字不变，<br>第2个指定了文件名<br>第3,4个没有指定用户名，命令执行后需要输入用户名和密码（默认使用root），<br>第3个仅指定了远程的目录，文件名字不变，<br>第4个指定了文件名</p><p><img src="/img/ubuntu/linux_command/linux_scp/scp_local_remote01.png" alt="scp 本地拷贝到远程复制文件" title="本地拷贝到远程复制文件"></p><h4 id="复制目录"><a href="#复制目录" class="headerlink" title="复制目录"></a>复制目录</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-r参数不要遗漏：【否则报错： <span class="keyword">not</span> a regular file】</span><br><span class="line">scp -r local_folder remote_username<span class="variable">@remote_ip</span><span class="symbol">:remote_folder</span></span><br><span class="line">或者</span><br><span class="line">scp -r local_folder <span class="symbol">remote_ip:</span>remote_folder </span><br><span class="line"></span><br><span class="line"><span class="symbol">demo:</span></span><br><span class="line">scp -r test2 dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">113</span><span class="symbol">:/data/www/test/</span></span><br></pre></td></tr></table></figure><p>第1个指定了用户名，命令执行后需要输入用户密码；<br>第2个没有指定用户名，命令执行后需要输入用户名和密码(默认使用root)；</p><p><img src="/img/ubuntu/linux_command/linux_scp/scp_local_remote02.png" alt="scp 本地拷贝到远程复制目录" title="scp 本地拷贝到远程复制目录"></p><h4 id="从远程服务器复制到本地服务器"><a href="#从远程服务器复制到本地服务器" class="headerlink" title="从远程服务器复制到本地服务器"></a>从远程服务器复制到本地服务器</h4><p>从远程复制到本地的scp命令与上面的命令雷同，只要将从本地复制到远程的命令后面2个参数互换顺序就行了</p><p>从远程拷贝文件到本地目录</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp root<span class="variable">@remote_ip</span><span class="symbol">:remote_file</span> local_folder</span><br><span class="line">demo：</span><br><span class="line">scp dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">87</span><span class="symbol">:/data/www/test2/test2_01</span>.test  /data/www/test/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_scp/scp_remote_locat01.png" alt="scp 远程拷贝文件到本地" title="scp 远程拷贝文件到本地"></p><h4 id="从远处复制目录到本地"><a href="#从远处复制目录到本地" class="headerlink" title="从远处复制目录到本地"></a>从远处复制目录到本地</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp -r root<span class="variable">@remote_ip</span><span class="symbol">:remote_folder</span> local_folder</span><br><span class="line"><span class="symbol">demo:</span></span><br><span class="line">scp -r dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">87</span><span class="symbol">:/data/www/test2</span> /data/www/test/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_scp/scp_remote_locat02.png" alt="scp 远程拷贝目录到本地" title="scp 远程拷贝目录到本地"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -tomact</title>
      <link href="/2018/03/01/ubuntu/linux_ubuntu_tomact/"/>
      <url>/2018/03/01/ubuntu/linux_ubuntu_tomact/</url>
      <content type="html"><![CDATA[<h4 id="官网下载-Tomact-包上传到服务器"><a href="#官网下载-Tomact-包上传到服务器" class="headerlink" title="官网下载 Tomact 包上传到服务器"></a>官网下载 Tomact 包上传到服务器</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">然后解压：</span><br><span class="line"><span class="selector-tag">sudo</span> <span class="selector-tag">tar</span> <span class="selector-tag">-zxvf</span> <span class="selector-tag">apache-tomcat-9</span><span class="selector-class">.0</span><span class="selector-class">.5</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_tar.png" alt="tomact 解压" title="tomact 解压"></p><p>在 /data/server 目录创建 tomcat 目录；然后将文件夹 apache-tomcat-9.0.5 移动到   /data/server/tomcat 下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir tomcat</span><br><span class="line">sudo mv  apache-tomcat-<span class="number">9.0</span>.<span class="number">5</span> <span class="regexp">/data/</span>server<span class="regexp">/tomcat/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_position.png" alt="tomact 位置" title="tomact 位置"></p><h4 id="进入-data-server-tomcat-apache-tomcat-9-0-5-bin，编辑-startup-sh"><a href="#进入-data-server-tomcat-apache-tomcat-9-0-5-bin，编辑-startup-sh" class="headerlink" title="进入/data/server/tomcat/apache-tomcat-9.0.5/bin，编辑 startup.sh"></a>进入/data/server/tomcat/apache-tomcat-9.0.5/bin，编辑 startup.sh</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在最后一行加入下信息;</span><br><span class="line"></span><br><span class="line"><span class="comment">#set java environment</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jvm/jdk1.8.0_161    ## 这里要注意要换成自己解压的 jdk 目录</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:%&#123;JAVA_HOME&#125;/lib:%&#123;JRE_HOME&#125;/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:$PATH</span><br><span class="line"></span><br><span class="line"><span class="comment">#tomcat</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">TOMCAT_HOME</span>=/data/server/tomcat/apache-tomcat-9.0.5  ## 这里要注意要换成自己解压的 tomcat 目录</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_environment.png" alt="tomact 环境变量" title="tomact 环境变量"></p><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="string">./startup.sh</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_start.png" alt="tomact 启动成功" title="tomact 启动成功"></p><h4 id="关闭-tomcat-，需要在-shutdown-sh-对应的位置添加信息"><a href="#关闭-tomcat-，需要在-shutdown-sh-对应的位置添加信息" class="headerlink" title="关闭 tomcat ，需要在 shutdown.sh 对应的位置添加信息"></a>关闭 tomcat ，需要在 shutdown.sh 对应的位置添加信息</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在最后一行加入下信息;</span><br><span class="line"></span><br><span class="line"><span class="comment">#set java environment</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jvm/jdk1.8.0_161      ## 这里要注意要换成自己解压的 jdk 目录</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:%&#123;JAVA_HOME&#125;/lib:%&#123;JRE_HOME&#125;/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:$PATH</span><br><span class="line"></span><br><span class="line"><span class="comment">#tomcat</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">TOMCAT_HOME</span>=/data/server/tomcat/apache-tomcat-9.0.5  ## 这里要注意要换成自己解压的 tomcat 目录</span><br></pre></td></tr></table></figure><h4 id="停止"><a href="#停止" class="headerlink" title="停止"></a>停止</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./<span class="built_in">shutdown</span>.sh</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_stop.png" alt="tomact 停止" title="tomact 停止"></p><h4 id="加入开机启动："><a href="#加入开机启动：" class="headerlink" title="加入开机启动："></a>加入开机启动：</h4><h4 id="把catalina-sh文件复制到-etc-init-d"><a href="#把catalina-sh文件复制到-etc-init-d" class="headerlink" title="把catalina.sh文件复制到/etc/init.d"></a>把catalina.sh文件复制到/etc/init.d</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sudo cp -p /data/server/tomcat/apache-tomcat-9.0.5/bin/catalina.sh /etc/init.d/tomcat  </span><br><span class="line"></span><br><span class="line">编辑tomcat文件： </span><br><span class="line">sudo vim /etc/init.d/tomcat </span><br><span class="line"></span><br><span class="line">在开头写如下内容：【提醒：这里一定要注意书写格式，不能有空格，有#的注释部分也要写全，不要遗漏】</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## BEGIN INIT INFO  </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Provides:          tomcat  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Required-Start:    <span class="variable">$local_fs</span> <span class="variable">$network</span>  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Required-Stop:     <span class="variable">$local_fs</span>  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default-Start:     2 3 4 5  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default-Stop:      0 1 6  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Short-Description: tomcat service  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Description:       tomcat service daemon  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## END INIT INFO  </span></span></span><br><span class="line">CATALINA_HOME=/data/server/tomcat/apache-tomcat-9.0.5  </span><br><span class="line">JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/tomact/tomcat_edit_content.png" alt="tomact 开机自启编辑内容" title="tomact 开机自启编辑内容"></p><h4 id="添加自启动服务"><a href="#添加自启动服务" class="headerlink" title="添加自启动服务"></a>添加自启动服务</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span>-rc.d tomcat <span class="keyword">defaults</span></span><br></pre></td></tr></table></figure><h4 id="测试，关机重启访问-localhost-8080-或者-192-168-1-113-8080"><a href="#测试，关机重启访问-localhost-8080-或者-192-168-1-113-8080" class="headerlink" title="测试，关机重启访问 localhost:8080  或者 192.168.1.113:8080"></a>测试，关机重启访问 localhost:8080  或者 192.168.1.113:8080</h4><p><img src="/img/ubuntu/tomact/tomcat_start2.png" alt="tomact 开机自启成功" title="tomact 开机自启成功"></p><h4 id="tomact-命令"><a href="#tomact-命令" class="headerlink" title="tomact 命令"></a>tomact 命令</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">service tomcat &#123;start|stop|restart&#125;</span><br><span class="line">service tomcat stop</span><br><span class="line">service tomcat start</span><br><span class="line">service tomcat restart</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Ubuntu -jdk</title>
      <link href="/2018/02/28/ubuntu/linux_ubuntu_jdk/"/>
      <url>/2018/02/28/ubuntu/linux_ubuntu_jdk/</url>
      <content type="html"><![CDATA[<h2 id="Ubuntu-安装-jdk-2-种方式"><a href="#Ubuntu-安装-jdk-2-种方式" class="headerlink" title="Ubuntu 安装 jdk 2 种方式"></a>Ubuntu 安装 jdk 2 种方式</h2><p>1、 通过 ppa 源方式安装 jdk8<br>2、通过官网下载安装包安装 jdk8</p><p>检测linux多少位： getconf LONG_BIT    我的系统是64位</p><h2 id="使用-ppa-源方式安装"><a href="#使用-ppa-源方式安装" class="headerlink" title="使用 ppa 源方式安装"></a>使用 ppa 源方式安装</h2><h3 id="添加ppa"><a href="#添加ppa" class="headerlink" title="添加ppa"></a>添加ppa</h3><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:webupd8team/java</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h3 id="安装oracle-java-installer"><a href="#安装oracle-java-installer" class="headerlink" title="安装oracle-java-installer"></a>安装oracle-java-installer</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install oracle-java8-installer</span><br></pre></td></tr></table></figure><p>接下来会出现连个界面，选择ok、yes 即可</p><p><img src="/img/ubuntu/jdk/installer.png" alt="jdk1.8 install" title="jdk1.8 install"></p><p><img src="/img/ubuntu/jdk/installer.png" alt="jdk1.8 install" title="jdk1.8 install02"></p><h4 id="查看java版本"><a href="#查看java版本" class="headerlink" title="查看java版本"></a>查看java版本</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -<span class="built_in">version</span></span><br></pre></td></tr></table></figure><h3 id="卸载jdk"><a href="#卸载jdk" class="headerlink" title="卸载jdk"></a>卸载jdk</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> <span class="builtin-name">remove</span> openjdk*</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/jdk/uninstall.png" alt="uninstall" title="uninstall"></p><h3 id="直接下载-jdk-压缩包方式安装"><a href="#直接下载-jdk-压缩包方式安装" class="headerlink" title="直接下载 jdk 压缩包方式安装"></a>直接下载 jdk 压缩包方式安装</h3><h4 id="官网下载-jdk"><a href="#官网下载-jdk" class="headerlink" title="官网下载 jdk"></a>官网下载 jdk</h4><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" title="jdk1.8 官网地址" target="_blank" rel="noopener">jdk1.8 官网地址</a>    选择相应的系统 .tar.gz 包，然后用ssh上传到服务器【提醒：不要在服务器直接下载，否则解压会出错】</p><p><img src="/img/ubuntu/jdk/tar_download_error.png" alt="tar Download error" title="tar Download error"></p><h4 id="解压缩，放到指定目录"><a href="#解压缩，放到指定目录" class="headerlink" title="解压缩，放到指定目录"></a>解压缩，放到指定目录</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf jdk-<span class="number">8</span>u161-linux-x64.tar.gz -C /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span></span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/jdk/tar_jdk.png" alt="tar jdk" title="tar jdk"></p><h4 id="修改环境变量"><a href="#修改环境变量" class="headerlink" title="修改环境变量"></a>修改环境变量</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim ~<span class="string">/.bashrc</span></span><br></pre></td></tr></table></figure><p>文件的末尾追加下面内容</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#set oracle jdk environment</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jvm/jdk1.8.0_161  ## 这里要注意目录要换成自己解压的jdk 目录</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre  </span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:$&#123;JAVA_HOME&#125;/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib  </span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:$PATH</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/jdk/jdk_environment.png" alt="jdk environment" title="jdk environment"></p><h4 id="设置系统默认-jdk-版本"><a href="#设置系统默认-jdk-版本" class="headerlink" title="设置系统默认 jdk 版本"></a>设置系统默认 jdk 版本</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span>/<span class="title">jdk1</span>.8.0<span class="title">_161</span>/<span class="title">bin</span>/<span class="title">java</span> 300  </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span>/<span class="title">jdk1</span>.8.0<span class="title">_161</span>/<span class="title">bin</span>/<span class="title">javac</span> 300  </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/jar jar /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span>/<span class="title">jdk1</span>.8.0<span class="title">_161</span>/<span class="title">bin</span>/<span class="title">jar</span> 300   </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javah javah /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span>/<span class="title">jdk1</span>.8.0<span class="title">_161</span>/<span class="title">bin</span>/<span class="title">javah</span> 300   </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javap javap /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">jvm</span>/<span class="title">jdk1</span>.8.0<span class="title">_161</span>/<span class="title">bin</span>/<span class="title">javap</span> 300  </span></span><br><span class="line"></span><br><span class="line">然后执行</span><br><span class="line">sudo update-alternatives --config java</span><br></pre></td></tr></table></figure><h4 id="测试-jdk"><a href="#测试-jdk" class="headerlink" title="测试 jdk"></a>测试 jdk</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -<span class="built_in">version</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/jdk/java_version.png" alt="java version" title="java version"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Ubuntu -nginx</title>
      <link href="/2018/02/26/ubuntu/linux_ubuntu_nginx/"/>
      <url>/2018/02/26/ubuntu/linux_ubuntu_nginx/</url>
      <content type="html"><![CDATA[<h2 id="安装nginx-01"><a href="#安装nginx-01" class="headerlink" title="安装nginx 01"></a>安装nginx 01</h2><h3 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install nginx</span><br><span class="line"></span><br><span class="line">启动 ngnnx:  </span><br><span class="line">sudo<span class="built_in"> service </span>nginx start</span><br><span class="line"></span><br><span class="line">扩展centos nginx 重启</span><br><span class="line">service nginx restart</span><br><span class="line">/etc/init.d/nginx stop</span><br><span class="line">/etc/init.d/nginx start</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx_start.png" alt="ubuntu nginx start" title="ubuntu nginx start"></p><h3 id="查看nginx配置文件目录"><a href="#查看nginx配置文件目录" class="headerlink" title="查看nginx配置文件目录"></a>查看nginx配置文件目录</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> -aux | <span class="keyword">grep</span> nginx   【返回结果包含安装目录】</span><br><span class="line">nginx -t               【返回结果包含配置文件目录】</span><br><span class="line"><span class="keyword">cat</span> /etc/nginx/nginx.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure><p> <img src="/img/ubuntu/nginx/nginx_server.png" alt="nginx 安装位置" title="nginx 安装位置"></p><h2 id="编译安装02"><a href="#编译安装02" class="headerlink" title="编译安装02"></a>编译安装02</h2><h3 id="安装必要的编译环境"><a href="#安装必要的编译环境" class="headerlink" title="安装必要的编译环境"></a>安装必要的编译环境</h3><p>Tengine 安装需要使用源代码自行编译，所以安装前需要安装必要的编译工具</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get <span class="keyword">install</span> <span class="keyword">build</span>-essential</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> libtool</span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> g++</span><br><span class="line"></span><br><span class="line">centos 平台编译环境命令：</span><br><span class="line">yum -y <span class="keyword">install</span> gcc automake autoconf libtool make</span><br><span class="line">yum <span class="keyword">install</span> gcc gcc-c++</span><br></pre></td></tr></table></figure><p>安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径</p><h3 id="PCRE"><a href="#PCRE" class="headerlink" title="PCRE"></a>PCRE</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">ftp:</span>/<span class="regexp">/ftp.csx.cam.ac.uk/pub</span><span class="regexp">/software/programming</span><span class="regexp">/pcre/pcre</span>-<span class="number">8.38</span>.tar.gz</span><br><span class="line">解压到你指定的目录</span><br><span class="line">tar -zxvf pcre-<span class="number">8.38</span>.tar.gz -C /data/server/nginx_component</span><br><span class="line">mv pcre-<span class="number">8.38</span> pcre</span><br><span class="line">cd pcre/</span><br><span class="line">./configure --prefix=<span class="regexp">/data/server</span><span class="regexp">/nginx_component/pcre</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/component_pcre.png" alt="component pcre" title="component pcre"></p><h3 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">http:</span>/<span class="regexp">/www.openssl.org/source</span><span class="regexp">/openssl-1.0.2.tar.gz</span></span><br><span class="line"><span class="regexp">解压到你指定的目录</span></span><br><span class="line"><span class="regexp">tar -zxvf openssl-1.0.2.tar.gz -C /data</span><span class="regexp">/server/nginx</span>_component</span><br><span class="line">mv openssl-<span class="number">1.0</span>.<span class="number">2</span> openssl</span><br><span class="line">cd openssl/</span><br><span class="line">./config --prefix=<span class="regexp">/data/server</span><span class="regexp">/nginx_component/openssl</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/component_openssl.png" alt="component openssl" title="component openssl"></p><h3 id="Zlib"><a href="#Zlib" class="headerlink" title="Zlib"></a>Zlib</h3><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://<span class="literal">zlib</span>.net/<span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span>.tar.gz</span><br><span class="line">解压到你指定的目录</span><br><span class="line">tar -zxvf <span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span>.tar.gz -C /data/server/nginx_component</span><br><span class="line">mv <span class="literal">zlib</span>-<span class="number">1.2</span>.<span class="number">11</span> <span class="literal">zlib</span></span><br><span class="line">cd <span class="literal">zlib</span>/</span><br><span class="line">./configure --prefix=/data/server/nginx_component/<span class="literal">zlib</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/component_zlip.png" alt="component pcre" title="component pcre"></p><h3 id="下载nginx安装包，我选择的是-1-4-2"><a href="#下载nginx安装包，我选择的是-1-4-2" class="headerlink" title="下载nginx安装包，我选择的是 1.4.2"></a>下载nginx安装包，我选择的是 1.4.2</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">wget http://nginx.org/download/nginx<span class="string">-1</span>.4.2.tar.gz</span><br><span class="line"></span><br><span class="line">解压到 /data/server/nginx 目录（可以根据实际情况选择目录）：</span><br><span class="line">tar -zxvf nginx<span class="string">-1</span>.4.2.tar.gz -C /data/server/</span><br><span class="line">mv nginx<span class="string">-1</span>.4.2 nginx</span><br><span class="line">cd nginx</span><br><span class="line"></span><br><span class="line">##注意路径</span><br><span class="line"> ./configure --sbin-path=/data/server/nginx \</span><br><span class="line">--conf-path=/data/server/nginx/nginx.conf \</span><br><span class="line">--pid-path=/data/server/nginx/nginx.pid \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-pcre=/data/server/nginx_component/pcre \</span><br><span class="line">--with-zlib=/data/server/nginx_component/zlib \</span><br><span class="line">--with-openssl=/data/server/nginx_component/openssl</span><br><span class="line"></span><br><span class="line"> make &amp; make install</span><br><span class="line"> </span><br><span class="line">安装完的提示：</span><br><span class="line">.........</span><br><span class="line"><span class="keyword">test </span>-f '/data/server/nginx/nginx.conf' || cp conf/nginx.conf '/data/server/nginx/nginx.conf'</span><br><span class="line">cp conf/nginx.conf '/data/server/nginx/nginx.conf.default'</span><br><span class="line"><span class="keyword">test </span>-d '/data/server/nginx' || mkdir -p '/data/server/nginx'</span><br><span class="line"><span class="keyword">test </span>-d '/usr/local/nginx/logs' || mkdir -p '/usr/local/nginx/logs'</span><br><span class="line"><span class="keyword">test </span>-d '/usr/local/nginx/html' || cp -R html '/usr/local/nginx'</span><br><span class="line"><span class="keyword">test </span>-d '/usr/local/nginx/logs' || mkdir -p '/usr/local/nginx/logs'</span><br><span class="line">make[1]: Leaving directory '/data/server/nginx'</span><br><span class="line">[1]+  Exit 2</span><br></pre></td></tr></table></figure><p>注意配置的时候 –with-pcre 、–with-openssl、–with-zlib的路径为源文件的路径</p><p><img src="/img/ubuntu/nginx/nginx_end.png" alt="nginx 安装结束" title="nginx 安装结束"></p><h3 id="检测是否可用"><a href="#检测是否可用" class="headerlink" title="检测是否可用"></a>检测是否可用</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -t</span><br><span class="line">.<span class="regexp">/nginx -t</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx_check.png" alt="nginx 检测" title="nginx 检测"></p><p><img src="/img/ubuntu/nginx/nginx_ok.jpg" alt="nginx 检测成功" title="nginx 检测成功"></p><h3 id="报错："><a href="#报错：" class="headerlink" title="报错："></a>报错：</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">安装完会有异常,没有 pid 文件，那就创建一个 pid  文件</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/nginx</span><span class="comment"># /data/server/nginx/nginx -s reload</span></span><br><span class="line"><span class="symbol">nginx:</span> [error] open() <span class="string">"/data/server/nginx/nginx.pid"</span> failed (<span class="number">2</span>: No such file <span class="keyword">or</span> directory)</span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/nginx</span><span class="comment"># touch nginx.pid</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/nginx</span><span class="comment"># /data/server/nginx/nginx -s reload</span></span><br><span class="line"><span class="symbol">nginx:</span> [error] invalid PID number <span class="string">""</span> <span class="keyword">in</span> <span class="string">"/data/server/nginx/nginx.pid"</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/nginx</span><span class="comment"># /data/server/nginx/nginx  -c /data/server/nginx/conf/nginx.conf</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:/data/server/nginx</span><span class="comment"># /data/server/nginx/nginx -s reload</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx_error.png" alt="nginx 异常" title="nginx 异常"></p><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -t          【检查配置】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx             【启动命令】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -s stop     【停止命令】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -s reload   【重启命令：】</span><br><span class="line"></span><br><span class="line">pid出错时，可以使用这个：</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx  -c <span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>conf<span class="regexp">/nginx.conf</span></span><br></pre></td></tr></table></figure><h2 id="编译安装03"><a href="#编译安装03" class="headerlink" title="编译安装03"></a>编译安装03</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">当前操作目录位置：  <span class="regexp">/home/</span>fei/server</span><br><span class="line">wget <span class="string">http:</span><span class="comment">//nginx.org/download/nginx-1.4.2.tar.gz</span></span><br><span class="line">tar -zxvf nginx<span class="number">-1.4</span><span class="number">.2</span>.tar.gz  -C <span class="regexp">/home/</span>fei/server</span><br><span class="line">cd nginx<span class="number">-1.4</span><span class="number">.2</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx03_install.png" alt="nginx 安装" title="安装"></p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="attribute">--prefix</span>=/data/server/nginx-1.4.2</span><br><span class="line">发现少包，安装缺少的包</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install libpcre3 libpcre3-dev </span><br><span class="line">再次配置【 一直到不在缺少包 】</span><br><span class="line">./configure <span class="attribute">--prefix</span>=/data/server/nginx-1.4.2</span><br><span class="line"></span><br><span class="line">【 常见缺少少包： pcre、openssl、zlib，安装这三个包命令如下】</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install libpcre3 libpcre3-dev </span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install openssl libssl-dev  </span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install zlib1g-dev  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">配置 OK 后，继续操作</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx03_packet1.png" alt="nginx 安装缺少包" title="安装缺少包"></p><p><img src="/img/ubuntu/nginx/nginx03_packet2.png" alt="nginx 安装缺少包" title="安装缺少包"></p><h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp; <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx03_make.png" alt="nginx 安装" title="安装"></p><h3 id="检测是否可用-1"><a href="#检测是否可用-1" class="headerlink" title="检测是否可用"></a>检测是否可用</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx-1.4.2/</span>sbin<span class="regexp">/nginx -t</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/nginx03_test.png" alt="nginx 检测是否可用" title="检测是否可用"></p><h3 id="安装完成后，原文件就没有用了"><a href="#安装完成后，原文件就没有用了" class="headerlink" title="安装完成后，原文件就没有用了"></a>安装完成后，原文件就没有用了</h3><p><img src="/img/ubuntu/nginx/remove_useless.png" alt="nginx 删除没有用文件" title="删除没有用文件"></p><h3 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -t          【检查配置】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx             【启动命令】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -s stop     【停止命令】</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx -s reload   【重启命令：】</span><br><span class="line"></span><br><span class="line">pid出错时，可以使用这个：</span><br><span class="line"><span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>nginx  -c <span class="regexp">/data/</span>server<span class="regexp">/nginx/</span>conf<span class="regexp">/nginx.conf</span></span><br></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="让普通用户可以启动nginx"><a href="#让普通用户可以启动nginx" class="headerlink" title="让普通用户可以启动nginx"></a>让普通用户可以启动nginx</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用root用户进入....nginx/sbin</span><br><span class="line">然后chown root nginx</span><br><span class="line">chmod u+s nginx</span><br><span class="line">然后通过普通用户就可以启动了。</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/nginx/common_star.png" alt="nginx 普通用户启动nginx" title="普通用户启动nginx"></p><p><a href="http://nginx.org/" target="_blank" rel="noopener">nginx 官网</a>   </p><p><a href="http://nginx.org/download/" target="_blank" rel="noopener">nginx 官网下载</a>      </p><p><a href="http://nginx.org/en/docs/configure.html" target="_blank" rel="noopener">nginx 官网linux安装</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -jenkins</title>
      <link href="/2018/02/17/ubuntu/linux_ubuntu_jenkins/"/>
      <url>/2018/02/17/ubuntu/linux_ubuntu_jenkins/</url>
      <content type="html"><![CDATA[<h3 id="下载war-包"><a href="#下载war-包" class="headerlink" title="下载war 包"></a>下载war 包</h3><h4 id="第一种安装方式："><a href="#第一种安装方式：" class="headerlink" title="第一种安装方式："></a>第一种安装方式：</h4><p>前提：系统中必须安装好jdk，我的 jdk 是1.8</p><p>将下载好的war包放到linux中；切换到 jenkins.war　存放目录，输入命令： java -jar jenkins.war　<br>然后在浏览器中输入localhost:8080,就可以打开Jenkins</p><p><img src="/img/ubuntu/jenkins/01_install01" alt="Jenkins 安装" title="Jenkins 安装"></p><p><img src="/img/ubuntu/jenkins/01_install02" alt="Jenkins 安装" title="Jenkins 安装"></p><p>这种方式安装好后命令窗口会一直保持打开状态，不太实用；</p><h4 id="第二种安装方式，在-tomcat-中启动"><a href="#第二种安装方式，在-tomcat-中启动" class="headerlink" title="第二种安装方式，在 tomcat 中启动"></a>第二种安装方式，在 tomcat 中启动</h4><p><img src="/img/ubuntu/jenkins/01.png" alt="Jenkins war包" title="Jenkins war包"></p><p><img src="/img/ubuntu/jenkins/02.png" alt="Jenkins" title="Jenkins"></p><p><img src="/img/ubuntu/jenkins/03.png" alt="Jenkins" title="Jenkins"></p><p><img src="/img/ubuntu/jenkins/04.png" alt="Jenkins" title="Jenkins"></p><p><img src="/img/ubuntu/jenkins/05.png" alt="Jenkins" title="Jenkins"></p><p><img src="/img/ubuntu/jenkins/windows.png" alt="Jenkins" title="Jenkins"></p><p>不管用那种方法，安装后登录时空白，现在没有时间弄了，有知道的请留言</p><p><img src="/img/ubuntu/jenkins/06_error.png" alt="Jenkins error" title="Jenkins error"></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget -q -O - http<span class="variable">s:</span>//pkg.jenkins.io/debian/jenkins-ci.org.key | sudo apt-key <span class="built_in">add</span> -</span><br><span class="line">sudo <span class="keyword">sh</span> -<span class="keyword">c</span> <span class="string">'echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list'</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install jenkins</span><br><span class="line"></span><br><span class="line">如果是升级，直接使用一下命令</span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install jenkins</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/jenkins/jenkins_user.png" alt="jenkins 用户" title="Jenkins 用户"></p><h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> jenkins</span><br><span class="line"></span><br><span class="line"><span class="comment">//安装包，注意这里如果不是ubuntu那就yum</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> --<span class="keyword">auto</span>-<span class="built_in">remove</span> jenkins</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置和数据</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> purge jenkins</span><br><span class="line"></span><br><span class="line">sudo apt-<span class="built_in">get</span> purge --<span class="keyword">auto</span>-<span class="built_in">remove</span> jenkins</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Ubuntu -git</title>
      <link href="/2018/02/13/ubuntu/linux_ubuntu_git/"/>
      <url>/2018/02/13/ubuntu/linux_ubuntu_git/</url>
      <content type="html"><![CDATA[<h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><p>本地:  windows7   ip: 192.168.1.105<br>服务器Ubuntu ： Ubuntu 15.10     ip: 192.168.1.113  【cat /etc/issue】 </p><h3 id="Ubuntu中git安装"><a href="#Ubuntu中git安装" class="headerlink" title="Ubuntu中git安装"></a>Ubuntu中git安装</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="comment">--version  【检测当前环境是否安装git】</span></span><br><span class="line"></span><br><span class="line">sudo apt-<span class="keyword">get</span> install git  【安装git】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_install.png" alt="git install" title="git install"></p><h3 id="新增用户"><a href="#新增用户" class="headerlink" title="新增用户"></a>新增用户</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">新增用户(用户名为git_dafei),用于运行git服务，回车后输入密码</span><br><span class="line"><span class="keyword">adduser </span>git_dafei</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_adduser.png" alt="git adduser" title="git adduser"></p><h3 id="初始git仓库，"><a href="#初始git仓库，" class="headerlink" title="初始git仓库，"></a>初始git仓库，</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">我在 /home/git_dafei/<span class="selector-tag">code</span> ( mkdir -<span class="selector-tag">p</span> /home/git_dafei/<span class="selector-tag">code</span> 注意创建这个目录后的所有者，权限)</span><br><span class="line">这个目录下，使用 git init 这个--bare 选项为它设置一个空的存储库，</span><br><span class="line">一般服务器上的 Git 仓库是以 <span class="selector-class">.git</span> 结尾的空仓库</span><br><span class="line"></span><br><span class="line">git init --bare test.git</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_init.png" alt="git init" title="git init"></p><p><img src="/img/ubuntu/git/git_init02.png" alt="git init02" title="git init02"></p><p>开始本地(windows)操作</p><h3 id="本地生成公钥-位置-C-Users-Administrator-ssh-或者-ssh"><a href="#本地生成公钥-位置-C-Users-Administrator-ssh-或者-ssh" class="headerlink" title="本地生成公钥,位置  C:\Users\Administrator\.ssh 或者  ~/.ssh"></a>本地生成公钥,位置  C:\Users\Administrator\.ssh 或者  ~/.ssh</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa <span class="keyword">ls</span> ~<span class="string">/.ssh/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_win_ssh.png" alt="git win ssh" title="git win ssh"></p><h3 id="将win用户的公钥-即-id-rsa-pub-添加到服务器上"><a href="#将win用户的公钥-即-id-rsa-pub-添加到服务器上" class="headerlink" title="将win用户的公钥(即 id_rsa.pub )添加到服务器上"></a>将win用户的公钥(即 id_rsa.pub )添加到服务器上</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> scp ~<span class="regexp">/.ssh/id</span>_rsa.pub git_dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">113</span><span class="symbol">:/home/git_dafei/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">[扩展<span class="symbol">:</span>使用ssh端口 ] scp -P <span class="number">22</span> ~<span class="regexp">/.ssh/id</span>_rsa.pub git_dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">113</span><span class="symbol">:/home/git_dafei/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_win_scp.png" alt="git win scp" title="git win scp"></p><h3 id="将本地用户的公钥添加到认证文件中"><a href="#将本地用户的公钥添加到认证文件中" class="headerlink" title="将本地用户的公钥添加到认证文件中"></a>将本地用户的公钥添加到认证文件中</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/home/git_dafei</span></span><br><span class="line">mkdir <span class="string">.ssh</span></span><br><span class="line">touch authorized_keys    【在 <span class="string">.ssh</span>中创建 】</span><br><span class="line">cat id_rsa.pub &gt;&gt; <span class="string">.ssh/authorized_keys</span>   [如果没有 authorized_keys 请创建 touch authorized_keys</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_ssh.png" alt="git ssh" title="git ssh"></p><p><img src="/img/ubuntu/git/git_id_rs.png" alt="git id_rs" title="git id_rs"></p><h3 id="修改文件所有者为-git-dafei-用户"><a href="#修改文件所有者为-git-dafei-用户" class="headerlink" title="修改文件所有者为 git_dafei 用户"></a>修改文件所有者为 git_dafei 用户</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">chown -R git_dafei:git_dafei /home/git_dafei</span><br><span class="line"></span><br><span class="line">chmod<span class="number"> 755 </span>/home/git_dafei/                       <span class="comment"># 1. 用户git_dafei目录755权限</span></span><br><span class="line">chmod<span class="number"> 700 </span>/home/git_dafei/.ssh                   <span class="comment"># 2. .ssh目录700权限</span></span><br><span class="line">chmod<span class="number"> 600 </span>/home/git_dafei/.ssh/authorized_keys   <span class="comment"># 3. authorized_keys 600权限 </span></span><br><span class="line"></span><br><span class="line">////////////////////效果//////////////////////////</span><br><span class="line">drwxr-xr-x<span class="number"> 2 </span>git_dafei git_dafei<span class="number"> 4096 </span>Feb<span class="number"> 14 </span>19:39 .ssh  【修改前权限】</span><br><span class="line">chmod<span class="number"> 700 </span>/home/git_dafei/.ssh</span><br><span class="line">drwx------<span class="number"> 2 </span>git_dafei git_dafei<span class="number"> 4096 </span>Feb<span class="number"> 14 </span>19:39 .ssh  【修改后权限】</span><br><span class="line"></span><br><span class="line">【修改前权限】：</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>git_dafei git_dafei<span class="number"> 401 </span>Feb<span class="number"> 14 </span>19:40 /home/git_dafei/.ssh/authorized_keys </span><br><span class="line"></span><br><span class="line">chmod<span class="number"> 600 </span>/home/git_dafei/.ssh/authorized_keys</span><br><span class="line"></span><br><span class="line">【修改后权限】</span><br><span class="line">-rw-------<span class="number"> 1 </span>git_dafei git_dafei<span class="number"> 401 </span>Feb<span class="number"> 14 </span>19:40 /home/git_dafei/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_chmod.png" alt="git chmod" title="git chmod"></p><h3 id="修改ssh配置文件"><a href="#修改ssh配置文件" class="headerlink" title="修改ssh配置文件"></a>修改ssh配置文件</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">修改ssh配置文件/etc/ssh/sshd_config，取消这行(33行) AuthorizedKeysFile    %h/.ssh/authorized_keys 前面的注释</span><br><span class="line">修改完重启ssh: <span class="built_in"> service </span>ssh restart</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_sshd_config.png" alt="git sshd_config" title="git sshd_config"></p><h3 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">为例安全，禁止 git_dafei 用户 shell登录，需要修改 /etc/passwd</span><br><span class="line">将    <span class="symbol">git_dafei:</span><span class="symbol">x:</span><span class="number">1002</span><span class="symbol">:</span><span class="number">1002</span><span class="symbol">:</span>,,,<span class="symbol">:/home/git_dafei</span><span class="symbol">:/bin/bash</span></span><br><span class="line">改为  <span class="symbol">git_dafei:</span><span class="symbol">x:</span><span class="number">1002</span><span class="symbol">:</span><span class="number">1002</span><span class="symbol">:</span>,,,<span class="symbol">:/home/git_dafei</span><span class="symbol">:/usr/bin/git-shell</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_passwd.png" alt="git passwd" title="git passwd"></p><h3 id="在win中clone刚才创建的test-git"><a href="#在win中clone刚才创建的test-git" class="headerlink" title="在win中clone刚才创建的test.git"></a>在win中clone刚才创建的test.git</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">克隆的用户有错</span><br><span class="line">git clone git_dafei<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">113</span><span class="symbol">:/home/git_dafei/code/test</span>.git</span><br><span class="line"></span><br><span class="line">git clone 上面设置的用户名@服务器<span class="symbol">ip:</span>/home/git_dafei/code/test.git</span><br><span class="line">git clone <span class="symbol">ssh:</span>/<span class="regexp">/git_dafei@192.168.1.113:22 /home</span><span class="regexp">/git_dafei/code</span><span class="regexp">/test.git  [指定ssh端口克隆]</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/git/git_win_clone.png" alt="git win clone" title="git win clone"></p><p><img src="/img/ubuntu/git/git_win_user.png" alt="git win use" title="git win use"></p><p><img src="/img/ubuntu/git/git_ubuntu_clone.png" alt="git ubuntu clone" title="git ubuntu clone"></p><p><a href="https://help.ubuntu.com/lts/serverguide/git.html" title="Ubuntu git官方文档" target="_blank" rel="noopener">Ubuntu git官方文档</a><br><a href="https://git-scm.com/book/en/v2/Git-on-the-Server-Setting-Up-the-Server&quot;git官方文档&quot;" target="_blank" rel="noopener">git官方文档</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu15 -redis安装</title>
      <link href="/2018/02/12/ubuntu/linux_ubuntu_redis/"/>
      <url>/2018/02/12/ubuntu/linux_ubuntu_redis/</url>
      <content type="html"><![CDATA[<p>redis2种安装方式</p><h3 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get <span class="keyword">install</span> redis-<span class="keyword">server</span>  </span><br><span class="line"></span><br><span class="line">启动redis</span><br><span class="line">redis-<span class="keyword">server</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis_install.png" alt="redis install" title="redis install"></p><h3 id="检查redis-进程"><a href="#检查redis-进程" class="headerlink" title="检查redis 进程"></a>检查redis 进程</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> -aux|<span class="keyword">grep</span> redis</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/reids_server.png" alt="redis server" title="redis server"></p><h3 id="终端输入：redis-cli-测试redis是否成功"><a href="#终端输入：redis-cli-测试redis是否成功" class="headerlink" title="终端输入：redis-cli 测试redis是否成功"></a>终端输入：redis-cli 测试redis是否成功</h3><p><img src="/img/ubuntu/redis/redis_cli.png" alt="redis-cli" title="redis-cli"></p><h3 id="redis-设置密码"><a href="#redis-设置密码" class="headerlink" title="redis 设置密码"></a>redis 设置密码</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">reids默认是不需要密码的，设置密码</span><br><span class="line">sudo vi /etc/redis/redis.conf  </span><br><span class="line"></span><br><span class="line">在<span class="number">397</span>行：   </span><br><span class="line">取消 注释      # requirepass foobared  </span><br><span class="line">设置新密码：   requirepass redis_pwd_123456  </span><br><span class="line">让 reids 远程登录  </span><br><span class="line">注释bind，在<span class="number">69</span>行  </span><br><span class="line"># bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><p> <img src="/img/ubuntu/redis/redis_pwd_remote.png" alt="redis pwd remote" title="redis pwd remote"></p><h3 id="修改后重启redis"><a href="#修改后重启redis" class="headerlink" title="修改后重启redis"></a>修改后重启redis</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="regexp">/etc/i</span>nit.d<span class="regexp">/redis-server restart</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis_restart.png" alt="redis restart" title="redis restart"></p><h3 id="记得使用密码登录奥！！！"><a href="#记得使用密码登录奥！！！" class="headerlink" title="记得使用密码登录奥！！！"></a>记得使用密码登录奥！！！</h3><p><img src="/img/ubuntu/redis/redis_login.png" alt="redis login" title="redis login"></p><h3 id="卸载redis"><a href="#卸载redis" class="headerlink" title="卸载redis"></a>卸载redis</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> purge --auto-<span class="builtin-name">remove</span> redis-server</span><br></pre></td></tr></table></figure><h2 id="2、编译安装"><a href="#2、编译安装" class="headerlink" title="2、编译安装"></a>2、编译安装</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//download.redis.io/releases/redis-4.0.8.tar.gz</span></span><br><span class="line">tar -xzvf redis-<span class="number">4.0</span>.<span class="number">8</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span>  -C /data/server/</span><br><span class="line">cd redis-<span class="number">4.0</span>.<span class="number">8</span>/</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis02_install.png" alt="redis02 install" title="redis02 install"></p><h3 id="启动redis"><a href="#启动redis" class="headerlink" title="启动redis"></a>启动redis</h3><p>make完后 redis-4.0.8目录下会出现编译后的redis服务程序redis-server,还有用于测试的客户端程序redis-cli,两个程序位于安装目录 src 目录下，下面启动redis服务.</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> src/</span><br><span class="line"><span class="string">./redis-server</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis02_start.png" alt="redis02 start" title="redis02 start"></p><h3 id="redis设置密码"><a href="#redis设置密码" class="headerlink" title="redis设置密码"></a>redis设置密码</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">reids默认是不需要密码的，设置密码</span><br><span class="line">vi redis.conf  </span><br><span class="line"></span><br><span class="line">在<span class="number">500</span>行：   </span><br><span class="line">取消 注释      # requirepass foobared  </span><br><span class="line">设置新密码：   requirepass redis_pwd_123456</span><br><span class="line">让 reids 远程登录  </span><br><span class="line">注释bind，在<span class="number">69</span>行  </span><br><span class="line"># bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><p> <img src="/img/ubuntu/redis/redis_pwd_remote.png" alt="redis02 pwd remote" title="redis02 pwd remote"></p><h3 id="修改后启动redis"><a href="#修改后启动redis" class="headerlink" title="修改后启动redis"></a>修改后启动redis</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src/redis-server ./redis<span class="selector-class">.conf</span>   【指定配置文件启动】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis02_login.png" alt="redis02 pwd login" title="redis02 pwd login"></p><h3 id="设置-reids-后台启动"><a href="#设置-reids-后台启动" class="headerlink" title="设置 reids 后台启动"></a>设置 reids 后台启动</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vi redis<span class="selector-class">.conf</span>  </span><br><span class="line"></span><br><span class="line">在<span class="number">136</span>行</span><br><span class="line">把 daemonize no 改成 daemonize yes</span><br><span class="line"></span><br><span class="line">修改完重启redis：</span><br><span class="line">src/redis-server ./redis<span class="selector-class">.conf</span>   【指定配置文件启动】</span><br><span class="line">/data/server/redis-<span class="number">4.0</span>.<span class="number">8</span>/src/redis-server ./redis<span class="selector-class">.conf</span>   【指定配置文件启动】</span><br><span class="line">/data/server/redis-<span class="number">4.0</span>.<span class="number">8</span>/src/redis-server /data/server/redis-<span class="number">4.0</span>.<span class="number">8</span>/redis<span class="selector-class">.conf</span>   【指定配置文件启动】</span><br><span class="line">后台启动后关闭命令：</span><br><span class="line">./redis-cli -h <span class="number">127.0</span>.<span class="number">0.1</span> -<span class="selector-tag">a</span> redis_pwd_123456 -<span class="selector-tag">p</span> <span class="number">6379</span> shutdown</span><br><span class="line">/data/server/redis-<span class="number">4.0</span>.<span class="number">8</span>/src/redis-cli -h <span class="number">127.0</span>.<span class="number">0.1</span> -<span class="selector-tag">a</span> redis_pwd_123456 -<span class="selector-tag">p</span> <span class="number">6379</span> shutdown</span><br><span class="line"></span><br><span class="line">指定密码登录：</span><br><span class="line">/data/server/redis-<span class="number">4.0</span>.<span class="number">8</span>/src/redis-cli -<span class="selector-tag">a</span> redis_pwd_123456</span><br><span class="line">./redis-cli -<span class="selector-tag">a</span> redis_pwd_123456</span><br><span class="line">./redis-cli   回车后,输入 auth  密码</span><br><span class="line">测试数据：</span><br><span class="line">set key1 <span class="string">"hello world"</span></span><br><span class="line">get key1</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/redis/redis02_backend_start.png" alt="redis02 backend start" title="redis02 backend start"></p><p> <a href="http://download.redis.io/releases/" target="_blank" rel="noopener">redis官网下载地址</a></p><p> <a href="http://www.redis.net.cn/tutorial/3503.html" target="_blank" rel="noopener">redis官网安装</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Ubuntu -ssh</title>
      <link href="/2018/02/12/ubuntu/linux_ubuntu_ssh/"/>
      <url>/2018/02/12/ubuntu/linux_ubuntu_ssh/</url>
      <content type="html"><![CDATA[<h3 id="安装客户端"><a href="#安装客户端" class="headerlink" title="安装客户端"></a>安装客户端</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt <span class="keyword">install</span> openssh-<span class="keyword">client</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/ssh/ssh_client.png" alt="ssh client" title="ssh client"></p><h3 id="安装服务端"><a href="#安装服务端" class="headerlink" title="安装服务端"></a>安装服务端</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt <span class="keyword">install</span> openssh-<span class="keyword">server</span></span><br></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看手册   <span class="keyword">man</span> sshd_config</span><br></pre></td></tr></table></figure><p>在编辑配置文件之前，您应该生成一个原始文件的拷贝并对其写保护，以便您可以参考原始文件并在必要时重用它。拷贝 /etc/ssh/sshd_config 文件并对其写保护可以通过在终端提示符后运行下列命令</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp <span class="regexp">/etc/</span>ssh<span class="regexp">/sshd_config /</span>etc<span class="regexp">/ssh/</span>sshd_config.original</span><br><span class="line">sudo chmod a-w <span class="regexp">/etc/</span>ssh<span class="regexp">/sshd_config.original</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/ssh/ssh_sshd_config.png" alt="ssh sshd_config" title="ssh sshd_config"></p><ul><li><p>要设置您 OpenSSH 在 TCP 2222 端口而不是缺省的 TCP 20 端口监听，可以如下使用改变 Port 语句：</p><p>Port 2222</p></li><li><p>要让 sshd 允许基于公钥登录证书，可以简单添加或修改该行语句：</p><p>PubkeyAuthentication yes</p><p>If the line is already present, then ensure it is not commented out.</p></li><li><p>要使您的 OpenSSH 服务器显示 /etc/issue.net 文件的内容以作为预登录 Banner，只需简单地将下行添加或修改：</p><p>Banner /etc/issue.net</p><p>在 /etc/ssh/sshd_config 文件中。</p></li></ul><p>在修改 /etc/ssh/sshd_config 文件之后，保存该文件并重启 sshd 服务器应用程序以使之生效。可以在终端提示符后使用下列命令：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sudo</span> <span class="selector-tag">systemctl</span> <span class="selector-tag">restart</span> <span class="selector-tag">sshd</span><span class="selector-class">.service</span></span><br></pre></td></tr></table></figure><h3 id="SSH服务器命令"><a href="#SSH服务器命令" class="headerlink" title="SSH服务器命令"></a>SSH服务器命令</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">停止服务：sudo /etc/init.d/ssh stop</span><br><span class="line">启动服务：sudo /etc/init.d/ssh start</span><br><span class="line">重启服务：sudo /etc/init.d/ssh restart</span><br><span class="line">登录： ssh 用户名@远程ip</span><br><span class="line">demo： ssh dafei@<span class="number">192.168</span><span class="number">.1</span><span class="number">.82</span></span><br><span class="line">  ssh -p <span class="number">22</span> dafei@<span class="number">192.168</span><span class="number">.1</span><span class="number">.82</span>   [指定端口登录]</span><br><span class="line">断开连接：exit;</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/ssh/ssh_remote_login.png" alt="ssh remote_login" title="ssh remote_login"></p><p>如果细心，可能发现远程登录不能用root登录，解决办法： 修改 /etc/ssh/sshd_config 配置文件</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">26 </span># Authentication:</span><br><span class="line"><span class="symbol">27 </span>LoginGraceTime <span class="number">120</span></span><br><span class="line"><span class="symbol">28 </span># PermitRootLogin prohibit-password    【找到这一行注释掉】</span><br><span class="line"><span class="symbol">29 </span>PermitRootLogin yes                    【改为yes】</span><br><span class="line"><span class="symbol">30 </span>StrictModes yes</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/ssh/ssh_remote_login_root.png" alt="ssh remote_login_root" title="ssh remote_login_root"></p><p><img src="/img/ubuntu/ssh/ssh_remote_login_ok.png" alt="ssh remote_login_root_ok" title="ssh remote_login_root_ok"></p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>证书登录、无密码登录这里不在写，有需要的自己网上找资料；这个也是修改 sshd_config 文件</p><p>扩展：<br> <a href="https://help.ubuntu.com/lts/serverguide/openssh-server.html&quot;Ubuntu ssh&quot;" target="_blank" rel="noopener">Ubuntu ssh</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu -docker</title>
      <link href="/2018/02/08/ubuntu/linux_ubuntu_docker/"/>
      <url>/2018/02/08/ubuntu/linux_ubuntu_docker/</url>
      <content type="html"><![CDATA[<h3 id="Linux-ubuntu-docker"><a href="#Linux-ubuntu-docker" class="headerlink" title="Linux ubuntu docker"></a>Linux ubuntu docker</h3><p>前提条件 Docker要求Ubuntu系统内核版本高于3.10，查看内核版本</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname -r</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_get_error.png" alt="获取docker安装包报错"></p><p>系统版本没有问题，docker安装一直包这错。试一下docker命令，检查镜像信息</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">现在Ubuntu系统提示安装docker命令，我们执行</span><br><span class="line">apt-<span class="builtin-name">get</span> install docker.io</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_instal.png" alt="根据系统提示安装docker"></p><h3 id="查看docker版本"><a href="#查看docker版本" class="headerlink" title="查看docker版本"></a>查看docker版本</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">version</span></span><br><span class="line"></span><br><span class="line">sudo docker <span class="built_in">run</span> hello-world    【确认docker是否安装成功】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_v.png" alt="却docker是否安装成功"></p><p>———————–到这里docker已经安装完成————————</p><h3 id="安装docker-compose"><a href="#安装docker-compose" class="headerlink" title="安装docker-compose"></a>安装docker-compose</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L <span class="keyword">https</span>://github.com/docker/compose/releases/download/<span class="number">1.17</span><span class="number">.1</span>/docker-compose-`uname -s`-`uname -m` &gt; /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">curl -L <span class="keyword">https</span>://raw.githubusercontent.com/docker/compose/<span class="number">1.8</span><span class="number">.0</span>/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose    【bash 补全命令】</span><br><span class="line"><span class="comment">////////如果出现超时，加上2个参数： ///////////</span></span><br><span class="line"><span class="comment">--connect-timeout 100000 -m 1000000</span></span><br><span class="line">-m为数据最大传输时间</span><br><span class="line">curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.9.0/docker-compose-$(uname -s)-$(uname -m)"</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose <span class="comment">--connect-timeout 100000 -m 1000000 </span></span><br><span class="line"><span class="comment">////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">docker-compose -<span class="built_in">version</span>    【检测 docker-compose 版本】</span><br><span class="line"></span><br><span class="line">sudo rm /usr/<span class="built_in">local</span>/bin/docker-compose    【卸载docker-compose】</span><br><span class="line"></span><br><span class="line"><span class="comment">-----------------------------------------------</span></span><br><span class="line"></span><br><span class="line">docker-compose 命令</span><br><span class="line">docker-compose ps   查看容器运行状态</span><br><span class="line">docker-compose restart <span class="comment">#重启所有容器</span></span><br><span class="line">docker-compose restart App1  <span class="comment">#重启App1</span></span><br><span class="line">docker-compose <span class="built_in">stop</span> <span class="comment">#停止所有容器</span></span><br><span class="line">docker-compose rm   <span class="comment">#删除所有容器</span></span><br><span class="line">docker-compose <span class="built_in">stop</span> App1  <span class="comment">#停止App1</span></span><br><span class="line">docker-compose -f docker-compose.yml down    停止并删除容器、网络、镜像、数据卷</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose.png" alt="docker-compose"></p><p>———————–到这里docker-compose已经安装完成————————</p><h3 id="Docker-Compose-搭建-Rails"><a href="#Docker-Compose-搭建-Rails" class="headerlink" title="Docker Compose 搭建 Rails"></a>Docker Compose 搭建 Rails</h3><p>温馨提示： 复制粘贴命令的时候注意别丢信息</p><h4 id="创建项目目录"><a href="#创建项目目录" class="headerlink" title="创建项目目录"></a>创建项目目录</h4><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> myapp</span><br><span class="line"><span class="built_in">cd</span> myapp</span><br></pre></td></tr></table></figure><h4 id="创建-Dockerfile文件，包含以下内容"><a href="#创建-Dockerfile文件，包含以下内容" class="headerlink" title="创建 Dockerfile文件，包含以下内容"></a>创建 Dockerfile文件，包含以下内容</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ruby:<span class="number">2.3</span>.<span class="number">3</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update -qq &amp;&amp; apt-get install -y build-essential libpq-dev nodejs</span></span><br><span class="line"><span class="bash">RUN mkdir /myapp</span></span><br><span class="line"><span class="bash">WORKDIR /myapp</span></span><br><span class="line"><span class="bash">COPY Gemfile /myapp/Gemfile</span></span><br><span class="line"><span class="bash">COPY Gemfile.lock /myapp/Gemfile.lock</span></span><br><span class="line"><span class="bash">RUN bundle install</span></span><br><span class="line"><span class="bash">COPY . /myapp</span></span><br></pre></td></tr></table></figure><h4 id="创建-Gemfile-文件，包含以下内容"><a href="#创建-Gemfile-文件，包含以下内容" class="headerlink" title="创建 Gemfile 文件，包含以下内容"></a>创建 Gemfile 文件，包含以下内容</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> <span class="string">'https://rubygems.org'</span></span><br><span class="line">gem <span class="string">'rails'</span>, <span class="string">'5.0.0.1'</span></span><br></pre></td></tr></table></figure><h4 id="创建空的-Gemfile-lock-文件"><a href="#创建空的-Gemfile-lock-文件" class="headerlink" title="创建空的 Gemfile.lock 文件"></a>创建空的 Gemfile.lock 文件</h4><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch Gemfile.<span class="keyword">lock</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose_Rails02.png" alt="docker-compose Rails02"></p><h4 id="创建一个-docker-compose-yml-，包含以下内容"><a href="#创建一个-docker-compose-yml-，包含以下内容" class="headerlink" title="创建一个 docker-compose.yml ，包含以下内容"></a>创建一个 docker-compose.yml ，包含以下内容</h4><p>温馨提示：<br>docker-compose.yml  中 version: ‘3’ 改为 version: ‘2’</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">version</span>: <span class="string">'2'</span></span><br><span class="line"><span class="attribute">services</span>:</span><br><span class="line">  <span class="attribute">db</span>:</span><br><span class="line">    <span class="attribute">image</span>: postgres</span><br><span class="line">  <span class="attribute">web</span>:</span><br><span class="line">    <span class="attribute">build</span>: .</span><br><span class="line">    <span class="attribute">command</span>: bundle exec rails s -p <span class="number">3000</span> -b <span class="string">'0.0.0.0'</span></span><br><span class="line">    <span class="attribute">volumes</span>:</span><br><span class="line">      - .:/myapp</span><br><span class="line">    <span class="attribute">ports</span>:</span><br><span class="line">      - <span class="string">"3000:3000"</span></span><br><span class="line">    <span class="attribute">depends_on</span>:</span><br><span class="line">      - db</span><br></pre></td></tr></table></figure><h4 id="接下来执行"><a href="#接下来执行" class="headerlink" title="接下来执行"></a>接下来执行</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="builtin-name">run</span> web rails new . --force <span class="attribute">--database</span>=postgresql</span><br></pre></td></tr></table></figure><p>查看现在的目录：  ls -l   </p><p><img src="/img/ubuntu/docker/docker_compose_Rails03.png" alt="docker-compose Rails"></p><h4 id="修改权限，重建-Docker-镜像"><a href="#修改权限，重建-Docker-镜像" class="headerlink" title="修改权限，重建 Docker 镜像"></a>修改权限，重建 Docker 镜像</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R $USER:$<span class="keyword">USER</span> <span class="title">.</span></span><br><span class="line"><span class="title">docker-compose</span> build</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose_Rails04.png" alt="docker-compose Rails"></p><h4 id="修改-config-database-yml-文件"><a href="#修改-config-database-yml-文件" class="headerlink" title="修改 config/database.yml 文件"></a>修改 config/database.yml 文件</h4><p>如果担心修改错误，可以先备份原文件： cp database.yml database.yml_backup</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">清空</span> <span class="string">database.yml</span> <span class="string">文件</span></span><br><span class="line"><span class="string">echo</span> <span class="string">" "</span><span class="string">&gt;database.yml</span></span><br><span class="line"></span><br><span class="line"><span class="string">database.yml</span> <span class="string">文件写入以下内容</span></span><br><span class="line"></span><br><span class="line"><span class="attr">default:</span> <span class="meta">&amp;default</span></span><br><span class="line"><span class="attr">  adapter:</span> <span class="string">postgresql</span></span><br><span class="line"><span class="attr">  encoding:</span> <span class="string">unicode</span></span><br><span class="line"><span class="attr">  host:</span> <span class="string">db</span></span><br><span class="line"><span class="attr">  username:</span> <span class="string">postgres</span></span><br><span class="line"><span class="attr">  password:</span></span><br><span class="line"><span class="attr">  pool:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">development:</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*default</span></span><br><span class="line"><span class="attr">  database:</span> <span class="string">myapp_development</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*default</span></span><br><span class="line"><span class="attr">  database:</span> <span class="string">myapp_test</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose_Rails05.png" alt="docker-compose Rails"></p><h4 id="启动应用"><a href="#启动应用" class="headerlink" title="启动应用"></a>启动应用</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose_Rails06.png" alt="docker-compose Rails"></p><h4 id="创建数据库，在另一个终端中，执行"><a href="#创建数据库，在另一个终端中，执行" class="headerlink" title="创建数据库，在另一个终端中，执行"></a>创建数据库，在另一个终端中，执行</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="keyword">run</span><span class="bash"> web rake db:create</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/docker/docker_compose_Rails07.png" alt="docker-compose Rails"></p><p>用浏览器访问 <a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000</a> ，你会看到 Rails 的欢迎信息：</p><p><img src="/img/ubuntu/docker/docker_compose_Rails.png" alt="docker-compose Rails"></p><h4 id="If-you-are-using-Docker-Machine-then-docker-machine-ip-MACHINE-VM-returns-the-Docker-host-IP-address-to-which-you-can-append-the-port-lt-Docker-Host-IP-gt-3000"><a href="#If-you-are-using-Docker-Machine-then-docker-machine-ip-MACHINE-VM-returns-the-Docker-host-IP-address-to-which-you-can-append-the-port-lt-Docker-Host-IP-gt-3000" class="headerlink" title="If you are using Docker Machine, then docker-machine ip MACHINE_VM returns the Docker host IP address, to which you can append the port (&lt;Docker-Host-IP&gt;:3000)."></a>If you are using <a href="https://docs.docker.com/machine/overview/" target="_blank" rel="noopener">Docker Machine</a>, then <code>docker-machine ip MACHINE_VM</code> returns the Docker host IP address, to which you can append the port (<code>&lt;Docker-Host-IP&gt;:3000</code>).</h4><p><img src="/img/ubuntu/docker/docker_compose_Rails08.png" alt="docker-compose Rails"></p><p><a href="https://docs.docker.com/compose/rails/#rebuild-the-application" title="docker-compose 安装Rails官方文档" target="_blank" rel="noopener">Compose and Rail 官方文档</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>ubuntu系统</title>
      <link href="/2018/02/07/ubuntu/linux_ubuntu_centos/"/>
      <url>/2018/02/07/ubuntu/linux_ubuntu_centos/</url>
      <content type="html"><![CDATA[<h3 id="虚拟机安装完ubuntu后root没有密码"><a href="#虚拟机安装完ubuntu后root没有密码" class="headerlink" title="虚拟机安装完ubuntu后root没有密码"></a>虚拟机安装完ubuntu后root没有密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">设置root密码</span><br><span class="line">sudo passwd</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_00/root_passwd.png" alt="root passwd"></p><h3 id="虚拟机安装完centos后重新设置root密码"><a href="#虚拟机安装完centos后重新设置root密码" class="headerlink" title="虚拟机安装完centos后重新设置root密码"></a>虚拟机安装完centos后重新设置root密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">设置root密码</span><br><span class="line">passwd</span><br></pre></td></tr></table></figure><hr><h3 id="用户切换："><a href="#用户切换：" class="headerlink" title="用户切换："></a>用户切换：</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">su</span> (切换到root用户)；    </span><br><span class="line"><span class="keyword">su</span> user（user是你自己安装时候的用户名；切换到普通用户）</span><br><span class="line"></span><br><span class="line">其他命令：</span><br><span class="line">修改文件权限：</span><br><span class="line">    sudo chmod -R 777 文件名</span><br><span class="line">安装文件命令：</span><br><span class="line">    sudo apt-get install 文件名</span><br><span class="line">   清空某个文件</span><br><span class="line">   echo <span class="string">""</span> &gt;<span class="keyword">log</span>.<span class="built_in">log</span></span><br><span class="line">   动态查看内容</span><br><span class="line">   tail -f api_v1.<span class="built_in">log</span></span><br><span class="line">   修改文件权限</span><br><span class="line">    sudo chmod -R 777 文件名</span><br></pre></td></tr></table></figure><h3 id="安装好系统后，vi不能正常使用方向键和退格键"><a href="#安装好系统后，vi不能正常使用方向键和退格键" class="headerlink" title="安装好系统后，vi不能正常使用方向键和退格键"></a>安装好系统后，vi不能正常使用方向键和退格键</h3><p>ubuntu中vi在编辑状态下方向键不能用，还有回格键不能删除等我们平时习惯的一些键都不能使用。解决办法：可以安装vim full版本，在full版本下键盘正常，安装好后同样使用vi命令。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-----------（1）-----一般安装步骤------------------</span></span><br><span class="line">   sudo apt-get remove vim-common</span><br><span class="line">   sudo apt-get <span class="keyword">install</span> vim</span><br><span class="line"><span class="comment">-----------（2）------直接安装vim 报错 packet 不存在、找不到  请换源，参考下面-----------</span></span><br><span class="line">进入/etc/apt/</span><br><span class="line">cd /etc/apt</span><br><span class="line">对 sources.list文件进行备份</span><br><span class="line">sudo cp sources.list sources.list.bak</span><br><span class="line">删除掉 sources.list 中的内容【命令 echo <span class="string">""</span>&gt;sources.list  】，选择阿里云源</span><br><span class="line"></span><br><span class="line">deb <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-<span class="keyword">security</span> <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-updates <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-proposed <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-backports <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb-src <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb-src <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-<span class="keyword">security</span> <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb-src <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-updates <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb-src <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-proposed <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line">deb-src <span class="keyword">http</span>://mirrors.aliyun.com/ubuntu/ xenial-backports <span class="keyword">main</span> <span class="keyword">restricted</span> universe multiverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">------------（3）换源结束-------------------------------</span></span><br><span class="line">apt-<span class="keyword">get</span> <span class="keyword">update</span>   先更新一下</span><br><span class="line"></span><br><span class="line">现在可以安装vim</span><br><span class="line"> sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> vim</span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>数据库账号管理</title>
      <link href="/2018/02/01/mysql_DDU_%E6%95%B0%E6%8D%AE%E5%BA%93%E8%B4%A6%E5%8F%B7/"/>
      <url>/2018/02/01/mysql_DDU_%E6%95%B0%E6%8D%AE%E5%BA%93%E8%B4%A6%E5%8F%B7/</url>
      <content type="html"><![CDATA[<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>分配数据库账号权限时，请按最小权限原则和业务角色创建账号，并合理分配只读和读写权限。必要时可以把数据库账号和数据库拆分成更小粒度，使每个数据库账号只能访问其业务之内的数据。如果不需要数据库写入操作，请分配只读权限</li><li>为保障数据库的安全，请将数据库账号的密码设置为强密码，并定期更换。</li></ul>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-cp  创建文件和目录的副本</title>
      <link href="/2018/01/29/ubuntu/linux_DDU_cp/"/>
      <url>/2018/01/29/ubuntu/linux_DDU_cp/</url>
      <content type="html"><![CDATA[<h3 id="不带任何参数-运行cp"><a href="#不带任何参数-运行cp" class="headerlink" title="不带任何参数,运行cp"></a>不带任何参数,运行cp</h3><p>cp最基本命令，拷贝file_3.txt 从一个位置复制到另一个位置</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ls -all     【递归展示目录本文中会多次用到】</span><br><span class="line">----------------------------</span><br><span class="line">cp file<span class="emphasis">_3.txt /home/destination_</span>file</span><br><span class="line">或者</span><br><span class="line">cp /home/soruce<span class="emphasis">_file2/file_</span>3.txt /home/destination<span class="emphasis">_file</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp.png" alt="cp" title="cp"></p><h3 id="拷贝多个文件"><a href="#拷贝多个文件" class="headerlink" title="拷贝多个文件"></a>拷贝多个文件</h3><p>拷贝多个文件，我们只需将文件名字用空格隔开。或者使用*拷贝所有文件</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp file_3.txt file_4.txt /<span class="built_in">home</span>/destination_file</span><br><span class="line">cp *  /<span class="built_in">home</span>/destination_file       【拷贝所有文件，注意观察截图，aaa目录没有拷贝成功，稍后解决】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_02.png" alt="cp 多个文件" title="cp 多个文件"></p><h3 id="拷贝一个目录"><a href="#拷贝一个目录" class="headerlink" title="拷贝一个目录"></a>拷贝一个目录</h3><p>-r 或者 -R ，不论目录是否为空都会拷贝</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -r <span class="keyword">aaa</span>/ /home/destination_file     【这就解决上次没有拷贝<span class="keyword">aaa</span>目录】</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_r.png" alt="cp 递归拷贝目录" title="cp 递归拷贝目录"></p><h3 id="创建文件硬链接，而不是拷贝他们"><a href="#创建文件硬链接，而不是拷贝他们" class="headerlink" title="创建文件硬链接，而不是拷贝他们"></a>创建文件硬链接，而不是拷贝他们</h3><p>拷贝文件意味着你必须使用一些存储空间来储存拷贝的文件。有时候出于某种原因，你可能想要创建“快捷方式”或者链接到文件，而不是拷贝它们。要做到这一点，我们可以使用-l选项。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -l file_3<span class="selector-class">.txt</span> /home/destination_file</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_l.png" alt="cp 拷贝硬链接" title="cp 拷贝硬链接"></p><h3 id="创建文件的软连接【符号链接、快捷方式…-】"><a href="#创建文件的软连接【符号链接、快捷方式…-】" class="headerlink" title="创建文件的软连接【符号链接、快捷方式…..】"></a>创建文件的软连接【符号链接、快捷方式…..】</h3><p>软连接（符号链接）用 -s实现</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cp</span> <span class="selector-tag">-s</span> <span class="selector-tag">file_3</span><span class="selector-class">.txt</span> <span class="selector-tag">file_44</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_s.png" alt="cp 拷贝软链接" title="cp 软链接"></p><h3 id="文件归档"><a href="#文件归档" class="headerlink" title="文件归档"></a>文件归档</h3><p>使用 -a 选项来归档文件。保留链接和文件属性，递归拷贝目录，相当于下面的d、p、r三个选项组合。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -a  * /<span class="built_in">home</span>/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_a.png" alt="cp a" title="cp a"></p><h4 id="只拷贝文件属性"><a href="#只拷贝文件属性" class="headerlink" title="只拷贝文件属性"></a>只拷贝文件属性</h4><p>只拷贝文件属性，不拷贝文件内容，使用 –attributes-only 选项</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="params">--attributes-only</span> file_3.txt <span class="string">/home/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_attributes_only.png" alt="cp --attributes-only" title="cp 拷贝文件属性，不拷贝内容"></p><h3 id="显示正在做什么"><a href="#显示正在做什么" class="headerlink" title="显示正在做什么"></a>显示正在做什么</h3><p>默认情况下，拷贝是不会显示拷贝时发生了什么，我们可以使用 -v选项</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -v  * /<span class="built_in">home</span>/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_v.png" alt="cp v" title="cp v显示信息"></p><h3 id="目标文件时间是最新更改，源文件时间老"><a href="#目标文件时间是最新更改，源文件时间老" class="headerlink" title="目标文件时间是最新更改，源文件时间老"></a>目标文件时间是最新更改，源文件时间老</h3><p>拷贝时，目标文件先存着和源文件同名文件，切目标文件时间是最新更改，使用 -u,不会覆盖最新文件</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -vu file_3<span class="selector-class">.txt</span> file_4<span class="selector-class">.txt</span> /home/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_u.png" alt="cp u" title="cp 跳过目标最新文件"></p><h3 id="使用交互模式"><a href="#使用交互模式" class="headerlink" title="使用交互模式"></a>使用交互模式</h3><p>交互模式下会询问是否覆盖目标目录下的文件。使用 -i 选项</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -<span class="selector-tag">i</span> file_3<span class="selector-class">.txt</span> file_4<span class="selector-class">.txt</span> /home/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_i.png" alt="cp i" title="cp 交互模式"></p><h3 id="创建备份文件"><a href="#创建备份文件" class="headerlink" title="创建备份文件"></a>创建备份文件</h3><p>目标文件中存在与源文件同名文件，使用 -b 选项，备份目标文件，拷贝新文件</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -bv * /<span class="built_in">home</span>/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_b.png" alt="cp b" title="cp 拷贝备份"></p><h3 id="强制拷贝"><a href="#强制拷贝" class="headerlink" title="强制拷贝"></a>强制拷贝</h3><p>使用 -f 强制拷贝文件。如果目标文件不能打开，可以用 -f 尝试一下。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -f * /<span class="built_in">home</span>/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_f.png" alt="cp f" title="cp 强制拷贝"></p><h4 id="在拷贝之前先删除目标"><a href="#在拷贝之前先删除目标" class="headerlink" title="在拷贝之前先删除目标"></a>在拷贝之前先删除目标</h4><p>可以用，–remove-destination 选项 实现。这个选项与上面的-f选项形成对照。如果 cp 命令在目标目录下发现同名文件， cp 命令会先删除目标文件，然后再拷贝一份新的。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp --<span class="built_in">remove</span>-destination -v * /<span class="built_in">home</span>/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_cp/cp_remove_destination.png" alt="cp cp_remove_destination.png" title="cp 拷贝前删除目标"></p><p>其他：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">一般情况下用这个命令 【参数avr】</span><br><span class="line"><span class="keyword">cd</span> <span class="string">/home/www/Downloads</span></span><br><span class="line">cp -avr * <span class="string">/data/www/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>阿里云CDN上实现https</title>
      <link href="/2018/01/18/%E9%98%BF%E9%87%8C%E4%BA%91CDN%E4%B8%8A%E5%AE%9E%E7%8E%B0https/"/>
      <url>/2018/01/18/%E9%98%BF%E9%87%8C%E4%BA%91CDN%E4%B8%8A%E5%AE%9E%E7%8E%B0https/</url>
      <content type="html"><![CDATA[<h3 id="SSL证书管理"><a href="#SSL证书管理" class="headerlink" title="SSL证书管理"></a>SSL证书管理</h3><p>对于静态资源的请求，由于存储在阿里OSS上，并在前端使用了阿里云CDN,因此将相关SSL证书的信息在阿里云CDN上配置一下就ok。</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">客户端</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">请求（js</span><span class="string">,</span><span class="comment">img，css）</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">CDN</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">云存储OSS</span></span><br></pre></td></tr></table></figure><h3 id="从阿里云CA证书服务下载证书"><a href="#从阿里云CA证书服务下载证书" class="headerlink" title="从阿里云CA证书服务下载证书"></a>从阿里云CA证书服务下载证书</h3><p><img src="/img/ali/ali_CDN_https/CA.png" alt="ali CA"></p><p>下载解压后得到2个文件：  xxx.pem   xxx.key</p><h3 id="在阿里云CDN管理控制台找到-HTTPS设置"><a href="#在阿里云CDN管理控制台找到-HTTPS设置" class="headerlink" title="在阿里云CDN管理控制台找到 HTTPS设置"></a>在阿里云CDN管理控制台找到 HTTPS设置</h3><p>点击域名中的配置,然后找到HTTPS设置，修改配置</p><p><img src="/img/ali/ali_CDN_https/HTTPS_config_01.png" alt="ali https1"></p><p>打开之前下载好的xxx.pem 和 xxx.key ,将里面的内容分别复制到证书对应位置,建议跳转类型设置为默认，保存之后用HTTPS访问你的静态资源，测试一下</p><p><img src="/img/ali/ali_CDN_https/HTTPS_config_02.png" alt="ali https2"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>计算两点之间的距离</title>
      <link href="/2017/12/30/mysql_DDU_%E8%AE%A1%E7%AE%97%E4%B8%A4%E7%82%B9%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B7%9D%E7%A6%BB/"/>
      <url>/2017/12/30/mysql_DDU_%E8%AE%A1%E7%AE%97%E4%B8%A4%E7%82%B9%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B7%9D%E7%A6%BB/</url>
      <content type="html"><![CDATA[<h3 id="MySql查询执行流程图"><a href="#MySql查询执行流程图" class="headerlink" title="MySql查询执行流程图"></a>MySql查询执行流程图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">发送语句</span><br><span class="line">查询缓存</span><br><span class="line">查询优化</span><br><span class="line">执行查询</span><br><span class="line">返回结果</span><br></pre></td></tr></table></figure><p><img src="/img/mysql/MySql_query_execution_flow_chart.png" alt="mysql查询执行流程图"></p><h3 id="计算两点之间的距离"><a href="#计算两点之间的距离" class="headerlink" title="计算两点之间的距离"></a>计算两点之间的距离</h3><p>一个典型的例子是计算以某个点为中心，一定半径内的所有点。典型的实际案例可能是查找某个附近所有可以出租的房子，或者社交网站中“匹配”附近的用户，等等。假设我们有如下表：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `locations` (</span><br><span class="line">  `id` int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(30)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `lat` float <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  `lon` float <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=MyISAM<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=latin1;</span><br><span class="line"></span><br><span class="line">INSERT INTO locations(name,lat,lon)VALUES(<span class="string">"Charlottesville,Virginia"</span>,38.03,-78.48),(<span class="string">"Chicago,Illinois"</span>,41.85,-87.65),(<span class="string">"Mashington,DC"</span>,38.89,-77.04)</span><br></pre></td></tr></table></figure></p><p>这里经度和纬度的单位是“度”，通常我们假设地球是圆的，然后使用两点所在最大圆（半正矢）公式来计算两点之间的距离。现在有坐标latA和lonA、latB和lonB，那么点A和点B的距离计算公式如下：</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AcOS(</span><br><span class="line">COS(<span class="name">latA</span>)*COS(latB)*COS(<span class="name">lonA-lonB</span>)</span><br><span class="line">+SIN(<span class="number">1</span>atA)*SIN(LatB)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>计算出的结果是一个弧度，如果要将结果的单位转换成英里或者千米，则需要乘以地球的半径，也就是3959英里或者6371千米。假设我们需要找出所有距离Baron所居住的地方Charlottesville100英里以内的点，那么我们需要将经纬度带入上面的计算公式：</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM locations </span><br><span class="line">WHERE </span><br><span class="line">3979*ACOS(</span><br><span class="line">COS(radians(lat))<span class="strong">*COS(radians(38.03))*</span>COS(radians(lon)-radians(-78.48))+</span><br><span class="line">SIN(radians(lat))<span class="strong">*SIN(radians(38.03))</span></span><br><span class="line"><span class="strong">)&lt;=100;</span></span><br><span class="line"><span class="strong"></span></span><br><span class="line"><span class="strong">+----+--------------------------+-------+--------+</span></span><br><span class="line"><span class="strong">| id | name                     | lat   | lon    |</span></span><br><span class="line"><span class="strong">+----+--------------------------+-------+--------+</span></span><br><span class="line"><span class="strong">|  1 | Charlottesville,Virginia | 38.03 | -78.48 |</span></span><br><span class="line"><span class="strong">|  3 | Mashington,DC            | 38.89 | -77.04 |</span></span><br><span class="line"><span class="strong">+----+--------------------------+-------+--------+</span></span><br></pre></td></tr></table></figure><p>这类查询不仅无法使用索引，而且还会非常消耗CPU时间，给服务器带来很大的压力，而且我们还得反复计算这个。那要怎样优化呢?这个设计中有几个地方可以微优化。第一，看看是否真的需要这么精确的计算。其实这种算法已经有很多不精确的地方了，如下所示：两个地方之间的直线距离可能是100英里，但实际上它们之间的行走距离很可能不是这个值。无论你们在哪两个地方，要到达彼此位置的行走距离多半都不是直线距离，路上可能需要绕很多的弯，比如说如果有一条河，需要绕远走到一个有桥的地方。所以，这里计算的绝对距离只是一个参考值。</p><p>如果我们根据邮政编码来确定某个人所在的地区，再根据这个地区的中心位置计算他和别人的距离，那么这本身就是一个估算。Baron 住在Charlottesville，不过不是在中心地区，他对华盛顿物理位置的中心也不感兴趣。所以，通常并不需要精确计算，很多应用如果这样计算，多半是认真过头了。这类似于有效数字的估算：计算结果的精度永远都不会比测量的值更高。（换句话说，“错进，错出”。）</p><p>如果不需要太高的精度，那么我们认为地球是圆的应该也没什么问题，其实准确的说应该是椭圆。根据毕达哥拉斯定理，做些三角函数变换，我们可以把上面的公式转换得更简单，只需要做些求和、乘积以及平方根运算，就可以得出一个点是否在另一个点多少英里之内。益习等等，为什么就到这为止？我们是否真需要计算一个圆周呢？为什么不直接使用一个正方形代替?边长为200英里的正方形，一个顶点到中心的距离大概是141英里，这和实际计算的100英里相差得并不是那么远。那我们根据正方形公式来计算弧度为0.0253（100英里）的中心到边长的距离：</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM locations </span><br><span class="line">WHERE lat BETWEEN 38.03 - DEGREES(0.0253) AND 38.03 + DEGREES(0.0253)</span><br><span class="line">AND   lon BETWEEN -78.48 - DEGREES(0.0253) AND -78.48 + DEGREES(0.0253);</span><br><span class="line"></span><br><span class="line"><span class="code">+----+</span>--------------------------<span class="code">+-------+</span>--------+</span><br><span class="line">| id | name                     | lat   | lon    |</span><br><span class="line"><span class="code">+----+</span>--------------------------<span class="code">+-------+</span>--------+</span><br><span class="line">|  1 | Charlottesville,Virginia | 38.03 | -78.48 |</span><br><span class="line">|  3 | Mashington,DC            | 38.89 | -77.04 |</span><br><span class="line"><span class="code">+----+</span>--------------------------<span class="code">+-------+</span>--------+</span><br></pre></td></tr></table></figure><p>现在我们看看如何使用索引来优化这个查询。简单地，我们可以增加索引（lat,lon)或者（lon,lat)。不过这样做效果并不会很好。正如我们所知，MySQL5.5和之前的版本，如果第一列是范围查询的话，就无法使用素引后面的列了。因为两个列都是范围的，所以这里只能使用索引的一个列（BETMEEN等效于一个大于和一个小于）。我们再次想起了通常使用的IN（）优化。我们先新增两个列，用来存储坐标的近似值FLOOR()，然后在查询中使用IN（）将所有点的整数值都放到列表中。下面是我们需要新增的列和索引：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE locations <span class="builtin-name">ADD</span> lat_floor INT <span class="keyword">NOT</span> <span class="literal">NULL</span><span class="built_in"> DEFAULT </span>0, </span><br><span class="line"><span class="builtin-name">ADD</span> lon_floor INT <span class="keyword">NOT</span> <span class="literal">NULL</span><span class="built_in"> DEFAULT </span>0, </span><br><span class="line"><span class="builtin-name">ADD</span> KEY (lat_floor,lon_floor);</span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line"></span><br><span class="line">UPDATE locations</span><br><span class="line"><span class="builtin-name">SET</span> lat_floor = FLOOR(lat),<span class="attribute">lon_floor</span>=FLOOR(lon);</span><br></pre></td></tr></table></figure><p>现在我们可以根据坐标的一定范围的近似值来搜索了，这个近似值包括最小值和最大值，地理上分别对应的是南北。下面的查询为我们只展示了如何查某个范围的所有点：数值需要在应用程序中计算而不是MySQL中：</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT  FLOOR(38.03 - DEGREES(0.0253))AS lat<span class="emphasis">_1b,</span></span><br><span class="line"><span class="emphasis">CEILING( 38.03 + DEGREES(0.0253))AS lat_</span>lub,</span><br><span class="line">FLOOR(-78.48 - DEGREES(0.0253))AS 1on<span class="emphasis">_1b,</span></span><br><span class="line"><span class="emphasis">CEILING(-78.48 + DEGREES(0.0253))AS 1on_</span>ub;</span><br><span class="line">------------------------------------------------------</span><br><span class="line"><span class="code">+--------+</span>---------<span class="code">+--------+</span>--------+</span><br><span class="line">| lat<span class="emphasis">_1b | lat_</span>lub | 1on<span class="emphasis">_1b | 1on_</span>ub |</span><br><span class="line"><span class="code">+--------+</span>---------<span class="code">+--------+</span>--------+</span><br><span class="line">|     36 |      40 |    -80 |    -77 |</span><br><span class="line"><span class="code">+--------+</span>---------<span class="code">+--------+</span>--------+</span><br></pre></td></tr></table></figure><p>现在我们就可以生成IN（）列表中的整数了，也就是前面计算的地板和天花板数值之间的数字。下面是加上WHERE条件的完整查询：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">现在我们就可以生成IN（）列表中的整数了，也就是前面计算的地板和天花板数值之间的数字。下面是加上WHERE条件的完整查询：</span><br><span class="line"></span><br><span class="line">SELECT * FROM locations</span><br><span class="line">WHERE lat BETWEEN <span class="number">38.03</span>-DEGREES(<span class="number">0.0253</span>)AND <span class="number">38.03</span> + DEGREES(<span class="number">0.0253</span>)</span><br><span class="line">AND lon BETWEEN<span class="number">-78.48</span>-DEGREES(<span class="number">0.0253</span>)AND<span class="number">-78.48</span> +DEGREES(<span class="number">0.0253</span>)</span><br><span class="line">AND lat_floor IN(<span class="number">36</span>,<span class="number">37</span>,<span class="number">38</span>,<span class="number">39</span>,<span class="number">40</span>)AND lon_floor IN(<span class="number">-80</span>,<span class="number">-79</span>,<span class="number">-78</span>,<span class="number">-77</span>);</span><br><span class="line"></span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br><span class="line">| id | name                     | lat   | lon    | lat_floor | lon_floor |</span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br><span class="line">|  <span class="number">1</span> | Charlottesville,Virginia | <span class="number">38.03</span> | <span class="number">-78.48</span> |        <span class="number">38</span> |       <span class="number">-79</span> |</span><br><span class="line">|  <span class="number">3</span> | Mashington,DC            | <span class="number">38.89</span> | <span class="number">-77.04</span> |        <span class="number">38</span> |       <span class="number">-78</span> |</span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br></pre></td></tr></table></figure></p><p>使用近似值会让我们的计算结果有些偏差，所以我们还需要一些额外的条件剔除在正方形之外的点。这和前面使用CRC32做哈希索引类似：先建一个索引帮我们过滤出近似值，再使用精确条件匹配所有的记录并移除不满足条件的记录。事实上，到这时我们就无须根据正方形的近似来过滤数据了，我们可以使用最大圆公式或者毕达哥拉斯定理来计算：</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM locations</span><br><span class="line">WHERE lat_floor IN(<span class="number">36</span>,<span class="number">37</span>,<span class="number">38</span>,<span class="number">39</span>,<span class="number">40</span>)</span><br><span class="line">AND lon_floor IN(<span class="number">-80</span>,<span class="number">-79</span>,<span class="number">-78</span>,<span class="number">-77</span>)</span><br><span class="line">AND <span class="number">3979</span>*ACOS(</span><br><span class="line">COS(radians(lat))*COS(radians(<span class="number">38.03</span>))*COS(radians(lon)-radians(<span class="number">-78.48</span>))+SIN(radians(lat))*SIN(radians(<span class="number">38.03</span>))</span><br><span class="line">)&lt;=<span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">----------------------------------------------</span><br><span class="line"></span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br><span class="line">| id | name                     | lat   | lon    | lat_floor | lon_floor |</span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br><span class="line">|  <span class="number">1</span> | Charlottesville,Virginia | <span class="number">38.03</span> | <span class="number">-78.48</span> |        <span class="number">38</span> |       <span class="number">-79</span> |</span><br><span class="line">|  <span class="number">3</span> | Mashington,DC            | <span class="number">38.89</span> | <span class="number">-77.04</span> |        <span class="number">38</span> |       <span class="number">-78</span> |</span><br><span class="line">+----+--------------------------+-------+--------+-----------+-----------+</span><br></pre></td></tr></table></figure><p>这时计算精度再次回到前面——使用一个精确的圆周——不过，现在的做法更快。只要能够高效地过滤掉大部分的点，例如使用近似整数和索引，之后再做精确数学计算的代价并不大。只是不要直接使用大圆周的算法，否则速度会很慢。</p><p>Sphinx有很多内置的地理信息搜索功能，比MySQL实现要好很多。如果正在考虑使用MyISAM的GIS函数，并使用上面的技巧来计算，那么你需要记住：这样做效果并不会很好，MyISAM本身也并不适合大数据量、高并发的应用，另外MyISAM本身还有一些弱点，如数据文件崩溃、表级锁等。</p><h3 id="回顾一下上面的案例，我们采用了下面这些常用的优化策略："><a href="#回顾一下上面的案例，我们采用了下面这些常用的优化策略：" class="headerlink" title="回顾一下上面的案例，我们采用了下面这些常用的优化策略："></a>回顾一下上面的案例，我们采用了下面这些常用的优化策略：</h3><p>·尽量少做事，可能的话尽量不做事。这个案例中就不要对所有的点计算大圆周公式；先使用简单的方案过滤大多数数据，然后再到过滤出来的更小的集合上使用复杂的公式运算。</p><p>快速地完成事情。确保在你的设计中尽可能地让查询都用上合适的索引，使用近似计算（例如本案例中，认为地球是平的，使用一个正方形来近似圆周）来避免复杂的计算。</p><p>需要的时候，尽可能让应用程序完成一些计算。例如本案例中，在应用程序中计算所有的三角函数。</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>-mv   移动或重命名文件/目录</title>
      <link href="/2017/12/19/ubuntu/linux_DDU_mv/"/>
      <url>/2017/12/19/ubuntu/linux_DDU_mv/</url>
      <content type="html"><![CDATA[<h3 id="移动文件"><a href="#移动文件" class="headerlink" title="移动文件"></a>移动文件</h3><p>移动文件时需要注意的是文件的源地址和目标地址必须不同。这里有个例子，想要将file_1.txt文件从当前目录移动到其它目录，以/home/destination_file为例，语法应该如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv file_1<span class="selector-class">.txt</span> /home/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv.png" alt="linux mv"></p><h3 id="移动多个文件"><a href="#移动多个文件" class="headerlink" title="移动多个文件"></a>移动多个文件</h3><p>如果想一次移动多个文件，我们可以将他们放在一行并用空格分开。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv file_2<span class="selector-class">.txt</span> file_3<span class="selector-class">.txt</span> file_4<span class="selector-class">.txt</span> /home/destination_file/</span><br><span class="line">或者</span><br><span class="line">mv file_&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;<span class="selector-class">.txt</span> /home/destination_file/</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_much.png" alt="linux mv 移动多个文件夹"></p><p>如果你的文件夹有规律可循那么你就可以使用通配符，比如，为了移除所有以.txt为扩展名的文件夹，我们可以使用下面的命令：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv *<span class="string">.txt</span> <span class="string">/home/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_much02.png" alt="linux mv 移动多个文件夹"></p><h3 id="移动目录"><a href="#移动目录" class="headerlink" title="移动目录"></a>移动目录</h3><p>不同于复制命令，用mv命令移动目录相当于直接。移动目录你可以使用不带选项的mv命令。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv <span class="regexp">/soruce_file/</span> <span class="regexp">/home/</span>destination_file<span class="regexp">/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_directory.png" alt="linux mv 移动目录"></p><h3 id="重命名文件或目录"><a href="#重命名文件或目录" class="headerlink" title="重命名文件或目录"></a>重命名文件或目录</h3><p>我们也用mv命令来重命名文件或目录，不过目标位置必须相同才可以。然后文件名字必须不同。假定我们当前做所在目录为/home/soruce_file</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv file_1<span class="selector-class">.txt</span> file_new1.txt</span><br><span class="line">如果是绝对路径，应该像下面这样：</span><br><span class="line">mv /home/soruce_file/file_2<span class="selector-class">.txt</span> /home/soruce_file/file_new2.txt</span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_re_directory.png" alt="linux mv 重命名文件或目录"></p><h3 id="重命名目录"><a href="#重命名目录" class="headerlink" title="重命名目录"></a>重命名目录</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">上一段的规则同样适用于目录。</span><br><span class="line">mv <span class="regexp">/home/</span>soruce_file<span class="regexp">/ /</span>home<span class="regexp">/soruce_file2/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_re_directory02.png" alt="linux mv 重命名文目录"></p><h3 id="打印移动信息"><a href="#打印移动信息" class="headerlink" title="打印移动信息"></a>打印移动信息</h3><p>当你移动或重命名一大堆文件或目录时，你可能会想在不去目标位置去查看的情况下知道自己的命令是否成功地执行了。这就用到-v选项了。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -v  <span class="regexp">/home/</span>soruce_file2<span class="regexp">/*.txt /</span>home<span class="regexp">/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_v.png" alt="linux mv 打印移动信息"></p><h3 id="使用交互模式"><a href="#使用交互模式" class="headerlink" title="使用交互模式"></a>使用交互模式</h3><p>当你将文件移动到其他位置，而那个位置恰好有同样的文件，这时mv命令会覆盖掉原来的文件，对于mv的这一行为一般不会有什么提示。如果想产生一个关于覆盖文件的提示，我们可以使用-i选项。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -<span class="selector-tag">i</span> /home/soruce_file2/file_3<span class="selector-class">.txt</span> /home/destination_file/</span><br></pre></td></tr></table></figure><p>这个提示会让我们知道目标位置处file_3.txt的存在。如果我们按y键，那么那个文件将会被删除，否则不会</p><p><img src="/img/ubuntu/linux_command/linux_mv/mv_i.png" alt="linux mv 移动文件是否覆盖"></p><h3 id="使用更新选项"><a href="#使用更新选项" class="headerlink" title="使用更新选项"></a>使用更新选项</h3><p>-i 选项会提示我们关于覆盖文件的提示，而 -u 则只在源文件比目标文件新时才执行更新，如果目标文件比源文件新，则不会执行。让我们看一看下面的例子：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -uv <span class="regexp">/home/</span>soruce_file2<span class="regexp">/*.txt /</span>home<span class="regexp">/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_u.png" alt="linux mv 移动文件最新是否覆盖"></p><h3 id="不要覆盖任何已存在的文件"><a href="#不要覆盖任何已存在的文件" class="headerlink" title="不要覆盖任何已存在的文件"></a>不要覆盖任何已存在的文件</h3><p>如果-i选项询问我们是否覆盖文件，那么-n选项将不会允许我么覆盖任何已存在的文件，</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -vn <span class="regexp">/home/</span>soruce_file2<span class="regexp">/file_new_time2.txt  /</span>home<span class="regexp">/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/rm_n.png" alt="linux mv 移动文件最新是否覆盖"></p><h3 id="复制时创建备份"><a href="#复制时创建备份" class="headerlink" title="复制时创建备份"></a>复制时创建备份</h3><p>默认情况下，移动文件将会覆盖已存在的目标文件。但是如果我们移动错了文件而目标文件已经被新的文件覆盖了，这时应该怎么办才好呢？-b选项可以办到，该选项会在新文件覆盖旧文件时将旧文件做备份。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -bv <span class="regexp">/home/</span>soruce_file2<span class="regexp">/file_new_time2.txt  /</span>home<span class="regexp">/destination_file/</span></span><br></pre></td></tr></table></figure><p><img src="/img/ubuntu/linux_command/linux_mv/mv_b.png" alt="linux mv 移动文件并备份"></p><h3 id="无条件覆盖已经存在的文件"><a href="#无条件覆盖已经存在的文件" class="headerlink" title="无条件覆盖已经存在的文件"></a>无条件覆盖已经存在的文件</h3><p>覆盖已经存在的文件或目录，使用-f选项。如果同时指定了 -f 选项和 -i 或 -n 选项，则 -f 选项会覆盖它们——即不进行任何提示而覆盖。所以在使用此参数的时候，你要保持头脑清醒，知道自己在做什么。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv -f <span class="regexp">/home/</span>soruce_file2<span class="regexp">/file_new_time2.txt  /</span>home<span class="regexp">/destination_file/</span></span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>移动文件和目录命令是Linux系统的基本命令。通常你可以通过man mv 或者 mv –help显示mv的手册页以了解更多详细信息。</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>YII2搭建后台并实现rbac权限控制</title>
      <link href="/2017/12/08/Yii2%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0%E5%B9%B6%E5%AE%9E%E7%8E%B0rbac%E6%9D%83%E9%99%90%E6%8E%A7/"/>
      <url>/2017/12/08/Yii2%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0%E5%B9%B6%E5%AE%9E%E7%8E%B0rbac%E6%9D%83%E9%99%90%E6%8E%A7/</url>
      <content type="html"><![CDATA[<h3 id="安装Yii2"><a href="#安装Yii2" class="headerlink" title="安装Yii2"></a>安装Yii2</h3><p>参考官网安装文档<br><a href="http://www.yiiframework.com/download" target="_blank" rel="noopener"><font color="red">yiiframework</font></a><br><a href="http://www.yiichina.com/download" target="_blank" rel="noopener"><font color="red">yiichina</font></a></p><h3 id="配置数据库"><a href="#配置数据库" class="headerlink" title="配置数据库"></a>配置数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">创建数据库： create database yii2advanced default charset utf8;</span><br><span class="line"></span><br><span class="line">修改common/config/main-local.php数据库配置</span><br><span class="line"></span><br><span class="line">        <span class="string">'db'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\db\Connection'</span>,</span><br><span class="line">            <span class="string">'dsn'</span> =&gt; <span class="string">'mysql:host=localhost;dbname=yii2advanced'</span>,</span><br><span class="line">            <span class="string">'username'</span> =&gt; <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'password'</span> =&gt; <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'charset'</span> =&gt; <span class="string">'utf8'</span>,</span><br><span class="line">        ],</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/mysql_config.png" alt="数据配置"></p><h3 id="使用composer安装yii2-admin"><a href="#使用composer安装yii2-admin" class="headerlink" title="使用composer安装yii2-admin"></a>使用composer安装yii2-admin</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">composer require mdmsoft/yii2-admin <span class="string">"~2.0"</span></span><br><span class="line"></span><br><span class="line">!!!温馨提示：建议安装 <span class="number">1.0</span> 版本不安装 <span class="number">2.0</span> 版本!!!</span><br><span class="line">composer require mdmsoft/yii2-admin <span class="string">"~1.0"</span></span><br></pre></td></tr></table></figure><h3 id="配置yii2-admin运行环境"><a href="#配置yii2-admin运行环境" class="headerlink" title="配置yii2-admin运行环境"></a>配置yii2-admin运行环境</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">权限控制在后台，所以在 backend/config/main.php 中配置以下内容：</span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="string">'modules'</span> =&gt; [</span><br><span class="line">        <span class="string">'admin'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\Module'</span>,</span><br><span class="line">             <span class="string">'layout'</span> =&gt; <span class="string">'left-menu'</span>,<span class="comment">//yii2-admin的导航菜单</span></span><br><span class="line">        ]</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'components'</span> =&gt; [</span><br><span class="line">        ...</span><br><span class="line">        <span class="string">'authManager'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\rbac\DbManager'</span>, <span class="comment">// 使用数据库管理配置文件</span></span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'as access'</span> =&gt; [</span><br><span class="line">        <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\components\AccessControl'</span>,</span><br><span class="line">        <span class="string">'allowActions'</span> =&gt; [</span><br><span class="line">            <span class="string">'site/*'</span>,<span class="comment">//允许访问的节点，可自行添加</span></span><br><span class="line">            <span class="string">'admin/*'</span>,<span class="comment">//允许所有人访问admin节点及其子节点</span></span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="创建数据表"><a href="#创建数据表" class="headerlink" title="创建数据表"></a>创建数据表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">php yii migrate --migrationPath=@mdm/admin/migrations</span><br><span class="line"></span><br><span class="line">执行sql：（自带的rbac）  </span><br><span class="line">修改配置文件console/config/main-local.php</span><br><span class="line"><span class="built_in">return</span> [</span><br><span class="line">    <span class="string">'bootstrap'</span> =&gt; [<span class="string">'gii'</span>],</span><br><span class="line">    <span class="string">'modules'</span> =&gt; [</span><br><span class="line">        <span class="string">'gii'</span> =&gt; <span class="string">'yii\gii\Module'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'components'</span> =&gt; [</span><br><span class="line">        <span class="string">"authManager"</span> =&gt; [</span><br><span class="line">            <span class="string">"class"</span> =&gt; <span class="string">'yii\rbac\DbManager'</span>,</span><br><span class="line">            <span class="string">"defaultRoles"</span> =&gt; [<span class="string">"guest"</span>],</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">];</span><br><span class="line"><span class="built_in">cd</span>到advance目录下面执行</span><br><span class="line">yii migrate --migrationPath=@yii/rbac/migrations</span><br></pre></td></tr></table></figure><h3 id="中文显示"><a href="#中文显示" class="headerlink" title="中文显示"></a>中文显示</h3><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">在 common\config\main.php 中配置</span><br><span class="line"></span><br><span class="line">return [</span><br><span class="line">    <span class="string">'language'</span> =&gt; <span class="string">'zh-CN'</span>, <span class="comment">//中文显示</span></span><br><span class="line">    <span class="string">'aliases'</span> =&gt; [</span><br><span class="line">        <span class="string">'@bower'</span> =&gt; <span class="string">'@vendor/bower-asset'</span>,</span><br><span class="line">        <span class="string">'@npm'</span>   =&gt; <span class="string">'@vendor/npm-asset'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'vendorPath'</span> =&gt; dirname(dirname(__DIR__)) . <span class="string">'/vendor'</span>,</span><br><span class="line">    <span class="string">'components'</span> =&gt; [</span><br><span class="line">        <span class="string">'cache'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\caching\FileCache'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">现在可以查看后台：</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/user</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/route</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/permission</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/menu</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/role</span><br><span class="line">&lt;Your domain <span class="keyword">name</span>&gt;/<span class="keyword">index</span>.php?r=admin/assignment</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/yii2_admin_install_end.png" alt="yii2-admin 安装完成"></p><h3 id="配置授权demo"><a href="#配置授权demo" class="headerlink" title="配置授权demo"></a>配置授权demo</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">以一个自定义的节点books为例，节点books下共有index 图书列表，view 查看图书，<span class="keyword">create</span>创建图书，<span class="keyword">update</span> 更新图书，<span class="keyword">delete</span> 删除图书这个<span class="number">5</span>个节点，，可以通过gii生成这些代码。</span><br><span class="line"></span><br><span class="line">配置目标：</span><br><span class="line">未登录用户仅能访问<span class="keyword">index</span>节点</span><br><span class="line">一般用户能访问<span class="keyword">index</span>，<span class="keyword">view</span>，<span class="keyword">create</span>三个节点</span><br><span class="line">管理员能访问所有节点</span><br><span class="line"><span class="comment">---------------------------</span></span><br><span class="line">在 backend/config/main.php 中修改配置以下内容：</span><br><span class="line">    <span class="string">'as access'</span> =&gt; [</span><br><span class="line">        <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\components\AccessControl'</span>,</span><br><span class="line">        <span class="string">'allowActions'</span> =&gt; [</span><br><span class="line">            //<span class="string">'site/*'</span>,//允许访问的节点，可自行添加</span><br><span class="line">            //<span class="string">'admin/*'</span>,//允许所有人访问<span class="keyword">admin</span>节点及其子节点</span><br><span class="line">            <span class="string">"*"</span>//不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure><h3 id="添加可分配权限列表"><a href="#添加可分配权限列表" class="headerlink" title="添加可分配权限列表"></a>添加可分配权限列表</h3><p>在路由列表中，添加book各个节点路由由表添加至右侧可分配路由列表中，如下:</p><p><img src="/img/Yii2/book_route.png" alt="路由列表 图书"></p><p>在权限列表=》新增权限，填好后提交，然后填的路由规则即可，如下：</p><p><img src="/img/Yii2/authority_add_01.png" alt="权限列表 新增权限"></p><p><img src="/img/Yii2/authority_add_03.png" alt="权限列表 新增权限的对应路由"></p><p><img src="/img/Yii2/authority_add_04.png" alt="权限列表"></p><h3 id="添加角色并分配权限"><a href="#添加角色并分配权限" class="headerlink" title="添加角色并分配权限"></a>添加角色并分配权限</h3><p><img src="/img/Yii2/role_add_01.png" alt="角色列表 新增角色"></p><p><img src="/img/Yii2/role_add_02.png" alt="角色列表 新增角色对应的权限"></p><p><img src="/img/Yii2/role_add_03.png" alt="角色列表"></p><h3 id="分配角色"><a href="#分配角色" class="headerlink" title="分配角色"></a>分配角色</h3><p>手动注册用户，我这里注册admin和test进行测试。其中admin为管理员，test为一般用户</p><p><img src="/img/Yii2/register_user.png" alt="分配列表 00"></p><p><img src="/img/Yii2/assignments_list_01.png" alt="分配列表 list 01"></p><p><img src="/img/Yii2/assignments_list_02.png" alt="分配列表 add 02"></p><p><img src="/img/Yii2/assignments_list_03.png" alt="分配列表 add 03"></p><h2 id="！！！测试权限之前"><a href="#！！！测试权限之前" class="headerlink" title="！！！测试权限之前"></a><font color="red">！！！测试权限之前</font></h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">！！！ 测试权限之前，把这里注释掉</span><br><span class="line">在 backend<span class="regexp">/config/m</span>ain.php 中修改配置以下内容：</span><br><span class="line">    <span class="string">'as access'</span> =&gt; [</span><br><span class="line">        <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\components\AccessControl'</span>,</span><br><span class="line">        <span class="string">'allowActions'</span> =&gt; [</span><br><span class="line">            <span class="regexp">//</span><span class="string">'site/*'</span>,<span class="regexp">//</span>允许访问的节点，可自行添加</span><br><span class="line">            <span class="regexp">//</span><span class="string">'admin/*'</span>,<span class="regexp">//</span>允许所有人访问admin节点及其子节点</span><br><span class="line">            <span class="regexp">//</span><span class="string">"*"</span><span class="regexp">//</span>把这个注释掉！！！</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure><h3 id="开始测试"><a href="#开始测试" class="headerlink" title="开始测试"></a>开始测试</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、以管理员身份登录时，可以进行所有操作。ok</span><br><span class="line"><span class="number">2</span>、如果不登录，在访问book首页的时候会跳转到登录页面。预期结果是未登录时能访问book首页，就是说当前系统默认不认可我们配置给未登录用户的权限。</span><br><span class="line">有<span class="number">2</span>中办法</span><br><span class="line">第一种 在 backend<span class="regexp">/config/m</span>ain.php 中加一行指定默认规则的代码即可，如下：</span><br><span class="line"></span><br><span class="line"><span class="string">'authManager'</span>=&gt; [</span><br><span class="line">    <span class="string">'class'</span> =&gt; <span class="string">'yii\rbac\DbManager'</span>,</span><br><span class="line">    <span class="string">'defaultRoles'</span> =&gt; [<span class="string">'未登录用户'</span>],<span class="regexp">//</span>添加此行代码，指定默认规则为 <span class="string">'未登录用户'</span></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">或者在 backend<span class="regexp">/config/m</span>ain.php 修改为：</span><br><span class="line">    <span class="string">'as access'</span> =&gt; [</span><br><span class="line">        <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\components\AccessControl'</span>,</span><br><span class="line">        <span class="string">'allowActions'</span> =&gt; [</span><br><span class="line">            <span class="regexp">//</span><span class="string">'site/*'</span>,<span class="regexp">//</span>允许访问的节点，可自行添加</span><br><span class="line">            <span class="regexp">//</span><span class="string">'admin/*'</span>,<span class="regexp">//</span>允许所有人访问admin节点及其子节点</span><br><span class="line">            <span class="regexp">//</span><span class="string">"*"</span><span class="regexp">//</span>不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题</span><br><span class="line">            <span class="string">"book/index"</span>,<span class="regexp">//</span>未登录用户也可以访问图书列表</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure><h3 id="……"><a href="#……" class="headerlink" title="……"></a>……</h3><hr><h3 id="安装yii2-AdminLTE后台主题"><a href="#安装yii2-AdminLTE后台主题" class="headerlink" title="安装yii2 AdminLTE后台主题"></a>安装yii2 AdminLTE后台主题</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> dmstr/yii2-adminlte-asset <span class="string">"^2.1"</span></span><br><span class="line"></span><br><span class="line">安装过程中可能需要输入github的<span class="keyword">token</span></span><br></pre></td></tr></table></figure><h3 id="引入主题"><a href="#引入主题" class="headerlink" title="引入主题"></a>引入主题</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">方式一：(建议使用这种方式)</span><br><span class="line">复制整个vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app目录下的layouts目录和site目录到backend/views，覆盖原始文件。</span><br><span class="line"></span><br><span class="line">方式二：</span><br><span class="line"><span class="string">'components'</span> =&gt; [</span><br><span class="line">    <span class="string">'view'</span> =&gt; [</span><br><span class="line">         <span class="string">'theme'</span> =&gt; [</span><br><span class="line">             <span class="string">'pathMap'</span> =&gt; [</span><br><span class="line">                <span class="string">'@app/views'</span> =&gt; <span class="string">'@vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app'</span></span><br><span class="line">             ],</span><br><span class="line">         ],</span><br><span class="line">    ],</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">现在可以查看后台：</span><br><span class="line">&lt;Your domain name&gt;/index.php?r=admin%<span class="number">2</span>Fuser</span><br><span class="line">！！！如果访问权限相关的路径，如/admin/route/index并不是上面看到的样式，请将配置文件中的modules数组中配置的layouts的值删掉即可。如下：</span><br><span class="line">        <span class="string">'admin'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\Module'</span>,</span><br><span class="line">            <span class="comment">//'layout' =&gt; 'left-menu',//yii2-admin的导航菜单</span></span><br><span class="line">        ]</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/yii2_adminlte_install_end.png" alt="yii2-adminlte 安装完成"></p><h3 id="配置数据库，登录"><a href="#配置数据库，登录" class="headerlink" title="配置数据库，登录"></a>配置数据库，登录</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、修改common/config/main-local.php数据库配置</span><br><span class="line"></span><br><span class="line">        <span class="string">'db'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\db\Connection'</span>,</span><br><span class="line">            <span class="string">'dsn'</span> =&gt; <span class="string">'mysql:host=localhost;dbname=yii2advanced'</span>,</span><br><span class="line">            <span class="string">'username'</span> =&gt; <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'password'</span> =&gt; <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'charset'</span> =&gt; <span class="string">'utf8'</span>,</span><br><span class="line">        ],</span><br><span class="line"><span class="number">2</span>、注册后台账户，登录     </span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、在 common\config\main.php 中配置</span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="string">'language'</span> =&gt; <span class="string">'zh-CN'</span>, <span class="comment">//中文显示</span></span><br><span class="line">    <span class="string">'aliases'</span> =&gt; [</span><br><span class="line">        <span class="string">'@bower'</span> =&gt; <span class="string">'@vendor/bower-asset'</span>,</span><br><span class="line">        <span class="string">'@npm'</span>   =&gt; <span class="string">'@vendor/npm-asset'</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'vendorPath'</span> =&gt; dirname(dirname(<span class="keyword">__DIR__</span>)) . <span class="string">'/vendor'</span>,</span><br><span class="line">    <span class="string">'components'</span> =&gt; [</span><br><span class="line">        <span class="string">'cache'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\caching\FileCache'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="配置简短路由"><a href="#配置简短路由" class="headerlink" title="配置简短路由"></a>配置简短路由</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">在 backend/config/main.php文件的compontents加上下面的配置</span><br><span class="line"><span class="string">"urlManager"</span> =&gt; [    </span><br><span class="line">    <span class="comment">//用于表明urlManager是否启用URL美化功能，在Yii1.1中称为path格式URL，    </span></span><br><span class="line">    <span class="comment">// Yii2.0中改称美化。   </span></span><br><span class="line">    <span class="comment">// 默认不启用。但实际使用中，特别是产品环境，一般都会启用。   </span></span><br><span class="line">    <span class="string">"enablePrettyUrl"</span> =&gt; <span class="keyword">true</span>,    </span><br><span class="line">    <span class="comment">// 是否启用严格解析，如启用严格解析，要求当前请求应至少匹配1个路由规则，    </span></span><br><span class="line">    <span class="comment">// 否则认为是无效路由。    </span></span><br><span class="line">    <span class="comment">// 这个选项仅在 enablePrettyUrl 启用后才有效。    </span></span><br><span class="line">    <span class="string">"enableStrictParsing"</span> =&gt; <span class="keyword">false</span>,    </span><br><span class="line">    <span class="comment">// 是否在URL中显示入口脚本。是对美化功能的进一步补充。    </span></span><br><span class="line">    <span class="string">"showScriptName"</span> =&gt; <span class="keyword">false</span>,    </span><br><span class="line">    <span class="comment">// 指定续接在URL后面的一个后缀，如 .html 之类的。仅在 enablePrettyUrl 启用时有效。    </span></span><br><span class="line">    <span class="string">"suffix"</span> =&gt; <span class="string">""</span>,    </span><br><span class="line">    <span class="string">"rules"</span> =&gt; [        </span><br><span class="line">        <span class="string">"&lt;controller:\w+&gt;/&lt;id:\d+&gt;"</span>=&gt;<span class="string">"&lt;controller&gt;/view"</span>,  </span><br><span class="line">        <span class="string">"&lt;controller:\w+&gt;/&lt;action:\w+&gt;"</span>=&gt;<span class="string">"&lt;controller&gt;/&lt;action&gt;"</span>    </span><br><span class="line">    ],</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">配置web server</span><br><span class="line">Apache作为服务器，在应用的目录 backend/web下面创建.htaccess文件并添加如下内容：</span><br><span class="line">Options +FollowSymLinks</span><br><span class="line">IndexIgnore  *<span class="comment">/*</span></span><br><span class="line"><span class="comment">RewriteEngine on</span></span><br><span class="line"><span class="comment"># if a directory or a file exists, use it directly</span></span><br><span class="line"><span class="comment">RewriteCond  %&#123;REQUEST_FILENAME&#125; !-f</span></span><br><span class="line"><span class="comment">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span></span><br><span class="line"><span class="comment"># otherwise forward it to index.php</span></span><br><span class="line"><span class="comment">RewriteRule . index.php</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">nginx用户，修改server部分，如下：</span></span><br><span class="line"><span class="comment">server &#123;</span></span><br><span class="line"><span class="comment">    listen       80;</span></span><br><span class="line"><span class="comment">    server_name  yourdomain;</span></span><br><span class="line"><span class="comment">    root yourdirectory/backend/web;</span></span><br><span class="line"><span class="comment">    index  index.php index.html;</span></span><br><span class="line"><span class="comment">    charset utf-8;</span></span><br><span class="line"><span class="comment">    location / &#123;</span></span><br><span class="line"><span class="comment">        index  index.php;</span></span><br><span class="line"><span class="comment">        if (!-e $request_filename) &#123;</span></span><br><span class="line"><span class="comment">            rewrite  ^(.*)$  /index.php/$1  last;</span></span><br><span class="line"><span class="comment">            break;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    location ~ .+\.php($|/) &#123;</span></span><br><span class="line"><span class="comment">        fastcgi_pass 127.0.0.1:9000;</span></span><br><span class="line"><span class="comment">        fastcgi_index index.php;</span></span><br><span class="line"><span class="comment">        include fastcgi.conf;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="启动更多分配路由"><a href="#启动更多分配路由" class="headerlink" title="启动更多分配路由"></a>启动更多分配路由</h3><p>我们先访问路由页面 /admin/route ，尽可能的把左侧的全部选中，然后移动到右侧，并记得给当前用户分配相关的可访问权限。</p><p><img src="/img/Yii2/adminLTE_route_all.png" alt="yii2-adminlte 所有路由"></p><h3 id="添加菜单"><a href="#添加菜单" class="headerlink" title="添加菜单"></a>添加菜单</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">访问菜单列表 admin/menu 点击添加菜单admin/menu/create按钮。</span><br><span class="line">&gt; 如果这个时候你没有权限访问了，需要在配置文件（backend/config/main.php）的 <span class="keyword">as</span> access数组暂时允许当前用户访问任意权限，并在我们添加完权限的时候去掉<span class="keyword">as</span> access的设置，切记。</span><br><span class="line">    <span class="string">'as access'</span> =&gt; [</span><br><span class="line">        <span class="string">'class'</span> =&gt; <span class="string">'mdm\admin\components\AccessControl'</span>,</span><br><span class="line">        <span class="string">'allowActions'</span> =&gt; [</span><br><span class="line">            <span class="comment">//'site/*',//允许访问的节点，可自行添加</span></span><br><span class="line">            <span class="comment">//'admin/*',//允许所有人访问admin节点及其子节点</span></span><br><span class="line">            <span class="string">"*"</span><span class="comment">//不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题</span></span><br><span class="line">            <span class="comment">//"book/index",//未登录用户也可以访问图书列表</span></span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">？？？？？？？？？父级一直添加不上？？？先手动修改数据库？？？？最后解决这个问题？？？？    </span><br><span class="line">添加界面如下：</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/adminLTE_menu_add_01.png" alt="yii2-adminlte 添加菜单01"></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">一、例如添加一级菜单<span class="string">"权限管理"</span>，按照如下填写：</span><br><span class="line">名称：权限管理</span><br><span class="line">父级名称：不填</span><br><span class="line">路由：/admin/<span class="keyword">default</span>/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">1</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">二、添加一个二级菜单<span class="string">"角色列表"</span>，如下：</span><br><span class="line">名称：角色列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/role/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">2</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">三、添加一个二级菜单<span class="string">"权限列表"</span>，如下：</span><br><span class="line">名称：权限列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/permission/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">3</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">四、添加一个二级菜单<span class="string">"路由列表"</span>，如下：</span><br><span class="line">名称：路由列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/route/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">4</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">五、添加一个二级菜单<span class="string">"规则管理"</span>，如下：</span><br><span class="line">名称：规则管理</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/rule/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">5</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">六、添加一个二级菜单<span class="string">"分配用户到角色"</span>，如下：</span><br><span class="line">名称：分配用户到角色</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/assignment/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">6</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">七、添加一个二级菜单<span class="string">"菜单列表"</span>，如下：</span><br><span class="line">名称：菜单列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/menu/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">7</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">八、添加一个二级菜单<span class="string">"用户列表"</span>，如下：</span><br><span class="line">名称：用户列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/admin/user/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">8</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">九、添加一个二级菜单<span class="string">"图书列表"</span>，如下：</span><br><span class="line">名称：图书列表</span><br><span class="line">父级名称：权限管理</span><br><span class="line">路由：/book/<span class="keyword">index</span></span><br><span class="line">排序：<span class="number">9</span></span><br><span class="line">数据：暂不填写</span><br><span class="line"></span><br><span class="line">具体如下</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/adminLTE_menu_add_02.png" alt="yii2-adminlte 添加菜单02"></p><h3 id="左侧菜单展示"><a href="#左侧菜单展示" class="headerlink" title="左侧菜单展示"></a>左侧菜单展示</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">修改</span><br><span class="line">&lt;project&gt;/backend/views/layouts/left.php</span><br><span class="line">文件（保证这个文件是从</span><br><span class="line">&lt;project&gt;/vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app/views/layouts/left.php</span><br><span class="line">地方复制过来的，否则去修改源文件），添加如下代码：</span><br><span class="line">侧菜单上把权限的栏目加上,代码可直接复制，放置于 &lt;section class=<span class="string">"sidebar"</span>&gt;&lt;/section&gt;标签内即可</span><br><span class="line"></span><br><span class="line">        //第一种显示方式</span><br><span class="line">        <span class="variable">$callback</span> = <span class="keyword">function</span>(<span class="variable">$menu</span>)&#123;</span><br><span class="line">            <span class="built_in">return</span> [</span><br><span class="line">                <span class="string">'label'</span> =&gt; <span class="variable">$menu</span>[<span class="string">'name'</span>],</span><br><span class="line">                <span class="string">'url'</span> =&gt; [<span class="variable">$menu</span>[<span class="string">'route'</span>]],</span><br><span class="line">                <span class="string">'icon'</span> =&gt; <span class="variable">$menu</span>[<span class="string">'data'</span>],</span><br><span class="line">                <span class="string">'items'</span> =&gt; <span class="variable">$menu</span>[<span class="string">'children'</span>]</span><br><span class="line">            ];</span><br><span class="line">        &#125;;</span><br><span class="line">        use mdm\admin\components\MenuHelper;</span><br><span class="line">        <span class="variable">$items</span> = MenuHelper::getAssignedMenu(Yii::<span class="variable">$app</span>-&gt;user-&gt;id, null, <span class="variable">$callback</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">echo</span> dmstr\widgets\Menu::widget([</span><br><span class="line">            <span class="string">'options'</span> =&gt; [<span class="string">'class'</span> =&gt; <span class="string">'sidebar-menu'</span>, <span class="string">'data-widget'</span>=&gt; <span class="string">'tree'</span>],</span><br><span class="line">            <span class="string">'items'</span> =&gt; <span class="variable">$items</span></span><br><span class="line">        ]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //第二种显示方式</span><br><span class="line">        //use mdm\admin\components\MenuHelper;</span><br><span class="line">        use yii\bootstrap\Nav;</span><br><span class="line">        <span class="built_in">echo</span> Nav::widget(</span><br><span class="line">            [</span><br><span class="line">                //<span class="string">"encodeLabels"</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">"options"</span> =&gt; [<span class="string">"class"</span> =&gt; <span class="string">"sidebar-menu"</span>, <span class="string">'data-widget'</span>=&gt; <span class="string">'tree'</span>],</span><br><span class="line">                <span class="string">"items"</span> =&gt; MenuHelper::getAssignedMenu(Yii::<span class="variable">$app</span>-&gt;user-&gt;id),</span><br><span class="line">            ]</span><br><span class="line">        );</span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/adminLTE_left.png" alt="yii2-adminlte 左侧菜单"></p><h3 id="整合完毕后存在问题（原因是-yii2-admin-2-0版本）"><a href="#整合完毕后存在问题（原因是-yii2-admin-2-0版本）" class="headerlink" title="整合完毕后存在问题（原因是 yii2-admin 2.0版本）"></a>整合完毕后存在问题（原因是 yii2-admin 2.0版本）</h3><p>一、菜单小图标并控制菜单显示：<br>我们在创建菜单的时候，没填写的”数据”一栏，我们填写 <a href="http://www.runoob.com/font-awesome/fontawesome-tutorial.html" target="_blank" rel="noopener"><font color="red">Font Awesome</font></a> 从这里面选择图标，例如在品牌图标中 使用这个是    fa fa-android  ；我们在 菜单“数据”一栏应该写 android，如图：<br><img src="/img/Yii2/bug_menu_icon.png" alt="bug 图标填写错误"></p><p>二、菜单列表中父级一直添加不上 ，父级名意图提示样式会跑到最左侧，路由意图样式会跑到最左侧（yii2-admin 版本1.0没有此问题）<br><img src="/img/Yii2/bug_menu_add_menu.png" alt="bug 新增菜单样式错误"></p><p>解决办法：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">一、解决父级添加不上：</span><br><span class="line">修改&lt;project&gt;/vendor/mdmsoft/yii2-admin/models/Menu.php中</span><br><span class="line">原来：</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            [[<span class="string">'name'</span>], <span class="string">'required'</span>],</span><br><span class="line">            [[<span class="string">'parent_name'</span>], <span class="string">'in'</span>,</span><br><span class="line">                <span class="string">'range'</span> =&gt; <span class="keyword">static</span>::find()-&gt;select([<span class="string">'name'</span>])-&gt;column(),</span><br><span class="line">                <span class="string">'message'</span> =&gt; <span class="string">'Menu "&#123;value&#125;" not found.'</span>],</span><br><span class="line">            [[<span class="string">'parent'</span>, <span class="string">'route'</span>, <span class="string">'data'</span>, <span class="string">'order'</span>], <span class="string">'default'</span>],</span><br><span class="line">            [[<span class="string">'parent'</span>], <span class="string">'filterParent'</span>, <span class="string">'when'</span> =&gt; <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;isNewRecord;</span><br><span class="line">            &#125;], </span><br><span class="line">            [[<span class="string">'order'</span>], <span class="string">'integer'</span>],</span><br><span class="line">            [[<span class="string">'route'</span>], <span class="string">'in'</span>,</span><br><span class="line">                <span class="string">'range'</span> =&gt; <span class="keyword">static</span>::getSavedRoutes(),</span><br><span class="line">                <span class="string">'message'</span> =&gt; <span class="string">'Route "&#123;value&#125;" not found.'</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    修改后：</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            [[<span class="string">'name'</span>], <span class="string">'required'</span>],</span><br><span class="line">            [[<span class="string">'parent_name'</span>], <span class="string">'in'</span>,</span><br><span class="line">                <span class="string">'range'</span> =&gt; <span class="keyword">static</span>::find()-&gt;select([<span class="string">'name'</span>])-&gt;column(),</span><br><span class="line">                <span class="string">'message'</span> =&gt; <span class="string">'Menu "&#123;value&#125;" not found.'</span>],</span><br><span class="line">            [[<span class="string">'parent'</span>, <span class="string">'route'</span>, <span class="string">'data'</span>, <span class="string">'order'</span>], <span class="string">'default'</span>],</span><br><span class="line">            <span class="comment">/*[['parent'], 'filterParent', 'when' =&gt; function() &#123;</span></span><br><span class="line"><span class="comment">                return !$this-&gt;isNewRecord;</span></span><br><span class="line"><span class="comment">            &#125;],*/</span></span><br><span class="line">            [[<span class="string">'parent_name'</span>], <span class="string">'filterParent'</span>],<span class="comment">//修改此方法</span></span><br><span class="line">            [[<span class="string">'order'</span>], <span class="string">'integer'</span>],</span><br><span class="line">            [[<span class="string">'route'</span>], <span class="string">'in'</span>,</span><br><span class="line">                <span class="string">'range'</span> =&gt; <span class="keyword">static</span>::getSavedRoutes(),</span><br><span class="line">                <span class="string">'message'</span> =&gt; <span class="string">'Route "&#123;value&#125;" not found.'</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    原来：</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filterParent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $parent = <span class="keyword">$this</span>-&gt;parent;</span><br><span class="line">        $db = <span class="keyword">static</span>::getDb();</span><br><span class="line">        $query = (<span class="keyword">new</span> Query)-&gt;select([<span class="string">'parent'</span>])</span><br><span class="line">            -&gt;from(<span class="keyword">static</span>::tableName())</span><br><span class="line">            -&gt;where(<span class="string">'[[id]]=:id'</span>);</span><br><span class="line">        <span class="keyword">while</span> ($parent) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;id == $parent) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;addError(<span class="string">'parent_name'</span>, <span class="string">'Loop detected.'</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $parent = $query-&gt;params([<span class="string">':id'</span> =&gt; $parent])-&gt;scalar($db);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    修改后：</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filterParent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//修改此方法</span></span><br><span class="line">        $value = <span class="keyword">$this</span>-&gt;parent_name;</span><br><span class="line">        $parent = <span class="keyword">self</span>::findOne([<span class="string">'name'</span> =&gt; $value]);</span><br><span class="line">        <span class="keyword">if</span> ($parent) &#123;</span><br><span class="line">            $id = <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">            $parent_id = $parent-&gt;id;</span><br><span class="line">            <span class="keyword">while</span> ($parent) &#123;</span><br><span class="line">                <span class="keyword">if</span> ($parent-&gt;id == $id) &#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;addError(<span class="string">'parent_name'</span>, <span class="string">'Loop detected.'</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                $parent = $parent-&gt;menuParent;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parent = $parent_id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">二、解决意图提示样式</span><br><span class="line">下载 yiisoft/yii2-jui</span><br><span class="line">php composer.phar <span class="keyword">require</span> --prefer-dist yiisoft/yii2-jui</span><br><span class="line"></span><br><span class="line">现在已经可以上试试效果，完全没有问题，如果不想用form中原来的书写方式可以按下面的办法；</span><br><span class="line">修改 &lt;project&gt;/vendor/mdmsoft/yii2-admin/views/menu/_form.php中parent_name和route表单：</span><br><span class="line">修改之前：</span><br><span class="line">            <span class="meta">&lt;?</span>= $form-&gt;field($model, <span class="string">'parent_name'</span>)-&gt;textInput([<span class="string">'id'</span> =&gt; <span class="string">'parent_name'</span>]) <span class="meta">?&gt;</span></span><br><span class="line">            <span class="meta">&lt;?</span>= $form-&gt;field($model, <span class="string">'route'</span>)-&gt;textInput([<span class="string">'id'</span> =&gt; <span class="string">'route'</span>]) <span class="meta">?&gt;</span></span><br><span class="line">修改之后：</span><br><span class="line">            <span class="meta">&lt;?</span>= $form-&gt;field($model, <span class="string">'parent_name'</span>)-&gt;widget(<span class="string">'yii\jui\AutoComplete'</span>,[</span><br><span class="line">                <span class="string">'options'</span>=&gt;[<span class="string">'class'</span>=&gt;<span class="string">'form-control'</span>],</span><br><span class="line">                <span class="string">'clientOptions'</span>=&gt;[</span><br><span class="line">                    <span class="string">'source'</span>=&gt;  Menu::find()-&gt;select([<span class="string">'name'</span>])-&gt;column()</span><br><span class="line">                ]</span><br><span class="line">            ]) <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="meta">&lt;?</span>= $form-&gt;field($model, <span class="string">'route'</span>)-&gt;widget(<span class="string">'yii\jui\AutoComplete'</span>,[</span><br><span class="line">                <span class="string">'options'</span>=&gt;[<span class="string">'class'</span>=&gt;<span class="string">'form-control'</span>],</span><br><span class="line">                <span class="string">'clientOptions'</span>=&gt;[</span><br><span class="line">                    <span class="string">'source'</span>=&gt; Menu::getSavedRoutes()</span><br><span class="line">                ]</span><br><span class="line">            ]) <span class="meta">?&gt;</span></span><br><span class="line">三、在 &lt;project&gt;/vendor/mdmsoft/yii2-admin/views/role/_form.php 同样会有样式问题，按照二的步骤修改即可</span><br><span class="line">   使用到的时候再改就可以。</span><br><span class="line">   修改后的：</span><br><span class="line">   <span class="meta">&lt;?</span>=</span><br><span class="line">    $form-&gt;field($model, <span class="string">'ruleName'</span>)-&gt;widget(<span class="string">'yii\jui\AutoComplete'</span>, [</span><br><span class="line">        <span class="string">'options'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'form-control'</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'clientOptions'</span> =&gt; [</span><br><span class="line">            <span class="string">'source'</span> =&gt; array_keys(Yii::$app-&gt;authManager-&gt;getRules()),</span><br><span class="line">        ]</span><br><span class="line">    ])</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/Yii2/bug_menu_add_menu_ok_01.png" alt="bug 新增菜单父级改好1"></p><p><img src="/img/Yii2/bug_menu_add_menu_ok_02.png" alt="bug 新增菜单父级改好2"></p><p><img src="/img/Yii2/bug_menu_add_menu_ok_03.png" alt="bug 新增菜单父级改好3"></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>hexo常用命令笔记</title>
      <link href="/2017/11/30/hexo/hexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AC%94%E8%AE%B0/"/>
      <url>/2017/11/30/hexo/hexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h3 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo -g <span class="comment">#安装  </span></span><br><span class="line">npm update hexo -g <span class="comment">#升级  </span></span><br><span class="line">hexo init <span class="comment">#初始化</span></span><br></pre></td></tr></table></figure><h3 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">"我的博客"</span> == hexo new <span class="string">"我的博客"</span> <span class="comment">#新建文章</span></span><br><span class="line">hexo p == hexo publish</span><br><span class="line">hexo g == hexo generate<span class="comment">#生成</span></span><br><span class="line">hexo s == hexo server <span class="comment">#启动服务预览</span></span><br><span class="line">hexo d == hexo deploy<span class="comment">#部署</span></span><br></pre></td></tr></table></figure><h3 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo server <span class="comment">#Hexo 会监视文件变动并自动更新，您无须重启服务器。</span></span><br><span class="line">hexo server -s <span class="comment">#静态模式</span></span><br><span class="line">hexo server -p 5000 <span class="comment">#更改端口</span></span><br><span class="line">hexo server -i 192.168.1.1 <span class="comment">#自定义 IP</span></span><br><span class="line">hexo clean <span class="comment">#清除缓存 网页正常情况下可以忽略此条命令</span></span><br><span class="line">hexo g <span class="comment">#生成静态网页</span></span><br><span class="line">hexo d <span class="comment">#开始部署</span></span><br></pre></td></tr></table></figure><h3 id="监视文件变动"><a href="#监视文件变动" class="headerlink" title="监视文件变动"></a>监视文件变动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo generate <span class="comment">#使用 Hexo 生成静态文件快速而且简单</span></span><br><span class="line">hexo generate --watch <span class="comment">#监视文件变动</span></span><br><span class="line"></span><br><span class="line">完成后部署</span><br><span class="line">两个命令的作用是相同的</span><br><span class="line">hexo generate --deploy</span><br><span class="line">hexo deploy --generate</span><br><span class="line">hexo deploy -g</span><br><span class="line">hexo server -g</span><br></pre></td></tr></table></figure><h3 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo publish [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure><h3 id="模版"><a href="#模版" class="headerlink" title="模版"></a>模版</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">"postName"</span> <span class="comment">#新建文章</span></span><br><span class="line">hexo new page <span class="string">"pageName"</span> <span class="comment">#新建页面</span></span><br><span class="line">hexo generate <span class="comment">#生成静态页面至public目录</span></span><br><span class="line">hexo server <span class="comment">#开启预览访问端口（默认端口4000，'ctrl + c'关闭server）</span></span><br><span class="line">hexo deploy <span class="comment">#将.deploy目录部署到GitHub</span></span><br><span class="line"></span><br><span class="line">hexo new [layout] &lt;title&gt;</span><br><span class="line">hexo new photo <span class="string">"My Gallery"</span></span><br><span class="line">hexo new <span class="string">"Hello World"</span> --lang tw</span><br></pre></td></tr></table></figure><table><thead><tr><th>变量</th><th style="text-align:right">描述</th></tr></thead><tbody><tr><td>layout</td><td style="text-align:right">布局</td></tr><tr><td>title</td><td style="text-align:right">标题</td></tr><tr><td>date</td><td style="text-align:right">建立</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">title: 使用Hexo搭建个人博客</span><br><span class="line">layout: post</span><br><span class="line">date: 2014-03-03 19:07:43</span><br><span class="line">comments: <span class="literal">true</span></span><br><span class="line">categories: Blog</span><br><span class="line">tags: [Hexo]</span><br><span class="line">keywords: Hexo, Blog</span><br><span class="line">description: 暮色匆匆去，音消尘也无</span><br><span class="line">模版（Scaffold）</span><br><span class="line">hexo new photo <span class="string">"My Gallery"</span></span><br></pre></td></tr></table></figure><h3 id="设置文章摘要"><a href="#设置文章摘要" class="headerlink" title="设置文章摘要"></a>设置文章摘要</h3><p>以上是文章摘要 以下是余下全文 </p><h3 id="写作"><a href="#写作" class="headerlink" title="写作"></a>写作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page &lt;title&gt;</span><br><span class="line">hexo new post &lt;title&gt;</span><br></pre></td></tr></table></figure><table><thead><tr><th>变量</th><th>描述</th></tr></thead><tbody><tr><td>:title</td><td>标题</td></tr><tr><td>:year</td><td>建立的年份（4 位数）</td></tr><tr><td>:month</td><td>建立的月份（2 位数）</td></tr><tr><td>:i_month</td><td>建立的月份（去掉开头的零）</td></tr><tr><td>:day</td><td>建立的日期（2 位数）</td></tr><tr><td>:i_day</td><td>建立的日期（去掉开头的零）</td></tr></tbody></table><h3 id="推送到服务器上"><a href="#推送到服务器上" class="headerlink" title="推送到服务器上"></a>推送到服务器上</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="comment">#写文章</span></span><br><span class="line">hexo g <span class="comment">#生成</span></span><br><span class="line">hexo d <span class="comment">#部署 #可与hexo g合并为 hexo d -g</span></span><br></pre></td></tr></table></figure><h3 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h3><p>1.找不到git部署</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR Deployer not found: git</span><br></pre></td></tr></table></figure><p>解决方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>3.部署类型设置git<br>hexo 3.0 部署类型不再是github，<code>_config.yml</code> 中修改</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: http://hexo.io/docs/deployment.html</span></span><br><span class="line">deploy:</span><br><span class="line"><span class="built_in">type</span>: git</span><br><span class="line">repository: git@***.github.com:***/***.github.io.git</span><br><span class="line">branch: master</span><br></pre></td></tr></table></figure><ol><li>xcodebuild</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xcode-select: error: tool <span class="string">'xcodebuild'</span> requires Xcode, but active developer directory <span class="string">'/Library/Developer/CommandLineTools'</span> is a <span class="built_in">command</span> line tools instance</span><br><span class="line"></span><br><span class="line">npm install bcrypt</span><br></pre></td></tr></table></figure><ol><li>RSS不显示<br>安装RSS插件</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><h3 id="开启RSS功能"><a href="#开启RSS功能" class="headerlink" title="开启RSS功能"></a>开启RSS功能</h3><p>编辑<code>hexo/_config.yml</code>，添加如下代码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rss: /atom.xml <span class="comment">#rss地址  默认即可</span></span><br></pre></td></tr></table></figure><h3 id="开启评论"><a href="#开启评论" class="headerlink" title="开启评论"></a>开启评论</h3><p>1.我使用多说代替自带的评论，在多说 网站注册 &gt; 后台管理 &gt; 添加新站点 &gt; 工具 === 复制通用代码 里面有 short_name</p><p>1 在根目录 <code>_config.yml</code> 添加一行 <code>disqus_shortname: jslite</code> 是在多说注册时产生的<br>复制到 <code>themes\landscape\layout\_partial\article.ejs</code><br>2 把</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (!index &amp;&amp; post.comments &amp;&amp; config.disqus_shortname)&#123; %&gt;</span><br><span class="line">&lt;section id=<span class="string">"comments"</span>&gt;</span><br><span class="line">&lt;div id=<span class="string">"disqus_thread"</span>&gt;</span><br><span class="line">  &lt;noscript&gt;Please <span class="built_in">enable</span> JavaScript to view the &lt;a href=<span class="string">"//disqus.com/?ref_noscript"</span>&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/section&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>改为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (!index &amp;&amp; post.comments &amp;&amp; config.disqus_shortname)&#123; %&gt;</span><br><span class="line">  &lt;section id=<span class="string">"comments"</span>&gt;</span><br><span class="line">    &lt;!-- 多说评论框 start --&gt;</span><br><span class="line">    &lt;div class=<span class="string">"ds-thread"</span> data-thread-key=<span class="string">"&lt;%= post.layout %&gt;-&lt;%= post.slug %&gt;"</span> data-title=<span class="string">"&lt;%= post.title %&gt;"</span> data-url=<span class="string">"&lt;%= page.permalink %&gt;"</span>&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- 多说评论框 end --&gt;</span><br><span class="line">    &lt;!-- 多说公共JS代码 start (一个网页只需插入一次) --&gt;</span><br><span class="line">    &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">    var duoshuoQuery = &#123;short_name:<span class="string">'&lt;%= config.disqus_shortname %&gt;'</span>&#125;;</span><br><span class="line">      (<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">        var ds = document.createElement(<span class="string">'script'</span>);</span><br><span class="line">        ds.type = <span class="string">'text/javascript'</span>;ds.async = <span class="literal">true</span>;</span><br><span class="line">        ds.src = (document.location.protocol == <span class="string">'https:'</span> ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) + <span class="string">'//static.duoshuo.com/embed.js'</span>;</span><br><span class="line">        ds.charset = <span class="string">'UTF-8'</span>;</span><br><span class="line">        (document.getElementsByTagName(<span class="string">'head'</span>)[0] </span><br><span class="line">         || document.getElementsByTagName(<span class="string">'body'</span>)[0]).appendChild(ds);</span><br><span class="line">      &#125;)();</span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">    &lt;!-- 多说公共JS代码 end --&gt;</span><br><span class="line">  &lt;/section&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><h3 id="hexo-git-backup"><a href="#hexo-git-backup" class="headerlink" title="hexo-git-backup"></a>hexo-git-backup</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">安装备份插件</span><br><span class="line">参考网址：  https://github.com/coneycode/hexo-git-backup</span><br><span class="line">Update</span><br><span class="line"><span class="keyword">if</span> you install with --save, you must remove firstly when you update it.</span><br><span class="line">$ npm remove hexo-git-backup</span><br><span class="line">$ npm install hexo-git-backup --save</span><br><span class="line">--------------------------------------</span><br><span class="line">安装主题</span><br><span class="line">参考网址：   https://github.com/chaooo/hexo-theme-BlueLake</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/chaooo/hexo-theme-BlueLake.git themes/BlueLake</span><br><span class="line">-------------------------------------</span><br><span class="line">生成、部署</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">hexo b</span><br><span class="line">hexo server -p 5000   【本地查看】</span><br></pre></td></tr></table></figure><h3 id="hexo-1"><a href="#hexo-1" class="headerlink" title="hexo"></a>hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/2017/11/30/hello-world/"/>
      <url>/2017/11/30/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
    </entry>
    
  
  
</search>
