[{"title":"-oracle 其他问题","date":"2019-10-11T08:22:31.727Z","path":"2019/10/11/oracle/oracle_其他问题/","text":"oracle 其他问题 Navicat 连接 oracle 报错123connection to server failed probale oracle net admin errorNavicat 客户端的oci需要与oracle 的版本一致 Navicat 连接 oracle 数据库账号错误123connection as SYS should be as SYSDBA or SYSOPER不能使用sys账号,要使用system账号登录 PL/SQL Developer 连接oracle#PL 和 oracle在通一个系统中安装完PL/SQL Developer 直接连接oracle数据库即可 PL 在windows系统, oracle在linux系统中 01) 需要下载 instantclient-basic-linux.zseries64-11.2.0.4.0.zip 和 instantclient-basic-windows.x64-11.2.0.4.0.zip,注意版本要和oracle数据库版本一致,这2个都需要,在后面配置PL/SQL 的时候会用到 02) 创建 tnsnames.ora 文件 ,向文件中添加如下内容 12345678910orcl = (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 10.168.69.199 )(PORT = 1521)) ) (CONNECT_DATA = (SERVICE_NAME = ehrv3 ) ) ) 03) 解压 instantclient-basic-linux.zseries64-11.2.0.4.0.zip 和 instantclient-basic-windows.x64-11.2.0.4.0.zip 解压后名字是 instantclient_11_2 ,然后把这2个解压文件合并,有重复的文件直接覆盖替换, 我把文件 放到 C:\\instantclient_11_2,然后把 tnsnames.ora 放到 C:\\instantclient_11_2 下面,(网上有的说把 tnsnames.ora 放到新建的目录 C:\\instantclient_11_2\\network\\admin 下面,其实不是必须的,只要后面配置的时候可以找到这个文件就可以) 03-02) !!! 下面这2个环境变量不配置也可以 ,( 我这里没有配置这2个环境变量 ) 变量名 变量 TNS_ADMIN C:\\instantclient_11_2 NLS_LANG AMERICAN_AMERICA.AL32UTF8 04) 配置 PL/SQL Developer , (汉化在后面会另加说明), 启动 PL/SQL 出现登录窗口,点击取消(calcel)按钮,这嗜好会进去软件界面 123oracle 主目录 C:\\instantclient_11_2OCI库 C:\\instantclient_11_2\\oci.dll 05) 重启 PL/SQl , 输入账号密码,注意数据库的哪一行要写(192.168.1.200:1521/fei [ IP 端口 数据库名称 ]) PL/SQL Developer - Registered Download 下载__操作oracle数据库工具 instantclient-basic-windows.x64-11.2.0.4.0.zip 下载地址 &amp;&amp; instantclient-basic-linux.zseries64-11.2.0.4.0.zip 下载 oracle教程","tags":[]},{"title":"linux-DDU  -git git-bash","date":"2019-09-29T05:49:29.344Z","path":"2019/09/29/win/git_02/","text":"git-bash 中添加 wget命令01) 下载weget二进制包02) 将下载好的 wget.exe 拷贝到 git 安装目录 …Git\\mingw64\\bin 下面03) 现在可议 wget -help 查看 中文无法显示12 在哪里可以下载Wget windwos 二进制文件由JernejSimončič提供","tags":[]},{"title":"linux-DDU  -git基本使用","date":"2019-09-29T05:42:43.378Z","path":"2019/09/29/win/git_01/","text":"git基本使用git常用分支：master主分支、dev开发分支、bug分支、feature临时功能分支 origin：默认远程分支； 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647初始化一个Git仓库，使用git init命令。git add &lt;file&gt; 注意，可反复多次使用，添加多个文件【 git add .】【git commit readme.md -m\"readme备注信息\"】git commit 完成。 git commit -m\"备注\"git status 掌握工作区的状态git diff 可以查看修改内容。git reset --hard commit_id 在版本的历史之间穿梭### git reset --hard 远程覆盖本地### git pull origin dev 从dev分支获取最新提交git log （git log --pretty=oneline）可以查看提交历史git reflog 查看命令历史git checkout -- file 把文件在工作区的修改全部撤销 命令中的--很重要git rm 用于删除一个文件git remote add origin git@server-name:path/repo-name.git 要关联一个远程库，使用命令git push -u origin master 关联后，使用命令git push -u origin master第一次推送master分支的所有内容git clone 克隆一个仓库git clone -b name(分支名称) 克隆一个分支仓库////////分支修改后，分支提交了，切换到master后才会看不到内容，分支不提交，master可以看到修改内容///////git branch 查看分支git branch &lt;name&gt; 创建分支git checkout &lt;name&gt; 切换分支git checkout -b &lt;name&gt; 创建+切换分支git merge &lt;name&gt; 合并某分支到当前分支 git branch -d &lt;name&gt; 删除分支git branch -D &lt;name&gt; 强行删除分支（不需要合并）git log --graph 看到分支合并图git merge --no-ff -m \"merge with no-ff\" dev 加上--no-ff参数就可以用普通模式合并git stash 储藏git stash list git stash pop 恢复储藏并删除储藏git fetch origin master 获取远程分支到本地git merge origin/master 合并到本地仓库git pull 获取最新提交【git pull = git fetch + git merge】git tag &lt;name&gt; 用于新建一个标签，默认为HEAD，也可以指定一个commit idgit tag &lt;name&gt; &lt;commit id&gt; 新建一个标签在commit id上git tag -a &lt;tagname&gt; -m \"blablabla...\" 可以指定标签信息git tag -s &lt;tagname&gt; -m \"blablabla...\" 可以用PGP签名标签git tag 可以查看所有标签git push origin &lt;tagname&gt; 可以推送一个本地标签git push origin --tags 可以推送全部未推送过的本地标签git tag -d &lt;tagname&gt; 可以删除一个本地标签git push origin :refs/tags/&lt;tagname&gt; 可以删除一个远程标签git ls-files 如何知道目录里的文件是否在git仓库里 ###","tags":[]},{"title":"-other -command 其他命令","date":"2019-08-06T06:36:28.221Z","path":"2019/08/06/other/other_command/","text":"explorer 直接打开可视化目录1234567#执行后可以打开弹出当前路径的目录#windows中start explorer . #注意这里有个点#linux 中nautilus . #注意这里有个点 tracert 路由跟踪命令123#路由跟踪命令,用于确定IP数据访问目标所经过的路径tracert www.baidu.comtracert php.net route 显示和操作IP路由表1234routeroute -nroute addroute del","tags":[]},{"title":"php -GD -imagettftext库制作图片","date":"2019-07-25T11:58:59.291Z","path":"2019/07/25/php/php_gd_imagettftext/","text":"php GD 用 STHUPO.TTF 字体向图像写入文本php GD 用 STHUPO.TTF 字体向图像写入文本 php GD 用 STHUPO.TTF 字体向图像写入文本 1234567891011121314151617181920212223242526272829303132333435363738394041424344// GD 和图像处理函数// https://php.net/manual/zh/function.imagettftext.php// https://php.net/manual/zh/function.imagettftext.php// !!!为 imagettftext() 这函数使用相对路径做准备----------------------putenv('GDFONTPATH=' . realpath('.'));//1. 绘制图像资源（创建一个画布）$image = imagecreatetruecolor(500, 300);//2. 先分配一个绿色$green = imagecolorallocate($image, 22, 153, 0);//3. 使用绿色填充画布// imagefill($image, 0, 0, $green);//03-02)使用抗锯齿（antialias）功能 ↓↓↓// imageantialias($image,true);// $red_aa = imagecolorallocate($image, 255, 0, 0);// $red_aa2 = imagecolorallocate($image, 255, 0, 0);// imageline($image, 0, 0, 300, 300, $red_aa);// imageline($image, 100, 0, 400, 300, $red_aa2);//使用抗锯齿（antialias）功能 ↑↑↑//4. 在画布中绘制图像$bai = imagecolorallocate($image, 255, 255, 255);//使用指定的字体文件绘制文字//参数2：字体大小//参数3：字体倾斜的角度//参数4、5：文字的x、y坐标//参数6：文字的颜色//参数7：字体文件//参数8：绘制的文字//------- !!! -------------- imagettftext() 这个函数中的路径使用绝对路径,要想使用相对路径请注意 第一行代码 putenv()imagettftext($image, 30, 30, 200, 250, $bai, './STHUPO.TTF', 'helloworld');// imagettftext($image, 30, 30, 200, 250, $bai, __DIR__.'/STHUPO.TTF', 'helloworld');// imagettftext($image, 30, 30, 200, 250, $bai, realpath('./').'/STHUPO.TTF', 'helloworld');// imagettftext($image, 30, 30, 200, 250, $bai, 'C:/Windows/Fonts/aparajbi.ttf', 'helloworld');// imagettftext($image, 30, 30, 200, 250, $bai, 'C:/Windows/Fonts/STHUPO.TTF', 'helloworld');//5. 在浏览器直接输出图像资源header(\"Content-Type:image/jpeg\");imagejpeg($image);//6. 销毁图像资源imagedestroy($image); GD 和图像处理 函数","tags":[]},{"title":"php -GD 库制作图片","date":"2019-07-25T01:47:09.745Z","path":"2019/07/25/php/php_gd/","text":"php GD 库制作图片使用 PHP GD 库制作一张图片,并在图片中输出文字 使用 PHP GD 库制作一张图片,并在图片中输出文字 1234567891011121314151617181920212223242526272829303132333435// GD 和图像处理函数// https://www.php.net/manual/zh/ref.image.php// https://www.php.net/manual/zh/ref.image.php$size = 300;$image=imagecreatetruecolor($size+200, $size+400);// 用黑色边框得到白色背景的东西$back = imagecolorallocate($image, 255, 255, 255);$border = imagecolorallocate($image, 0, 0, 0);imagefilledrectangle($image, 0, 0, $size + 150, $size + 100, $back);imagerectangle($image, 0, 0, $size +150, $size + 100, $border);$yellow_x = 200;$yellow_y = 175;$radius = 250;// 使用 alpha 值分配颜色$yellow = imagecolorallocatealpha($image, 255, 255, 0, 75);$text_color = imagecolorallocate($image, 233, 14, 91);// 画一个圆imagefilledellipse($image, $yellow_x, $yellow_y, $radius, $radius, $yellow);// 画一个矩形// imagefilledrectangle($image,$yellow_x-100, $yellow_y-100, $radius+50, $radius+40, $yellow);// 水平地画一行字符串imagestring($image, 5, 150, 150, \"hello world\", $text_color);// 垂直地画一行字符串// imagestringup ($image, 5, 150, 150, \"hello world\", $text_color);// 告诉浏览器输出 png 图片header('Content-type: image/png');// 输出结果imagepng($image);imagedestroy($image); GD 和图像处理 函数","tags":[]},{"title":"-虚拟机 -centos7 -扩容","date":"2019-07-22T13:42:59.527Z","path":"2019/07/22/centos/centos_扩容/","text":"在虚拟机VMware上增加磁盘空间使用了一段时间虚拟机后发现磁盘不够用了,需要扩容。在客户端操作扩容出现磁盘已成功扩展。您必须从客户机操作系统内部对磁盘重新进行分区和扩展文件系统。 然后进centos7系统进行操作 使用 df -h 查看磁盘空间大小12345678910### 挂载跟目录节点的 /dev/mapper/centos-root 只有23容量[root@localhost ~]# df -hFilesystem Size Used Avail Use% Mounted on/dev/mapper/centos-root 23G 23G 20K 100% /devtmpfs 20G 0 20G 0% /devtmpfs 20G 4.0K 20G 1% /dev/shmtmpfs 20G 8.5M 20G 1% /runtmpfs 20G 0 20G 0% /sys/fs/cgroup/dev/sda1 497M 120M 378M 25% /boot[root@localhost ~]# 使用 fdisk -l 命令查看磁盘信息12345678910111213141516171819202122232425262728### 第一行 Disk /dev/sda: 107.4 GB 与实际 df -好现实内容不符,说明增加磁盘成功[root@localhost ~]# fdisk -lDisk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectors ---与上面(df -h)不符,说明新增成功Units = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisk label type: dosDisk identifier: 0x0004148c Device Boot Start End Blocks Id System/dev/sda1 * 2048 1026047 512000 83 Linux/dev/sda2 1026048 41943039 20458496 8e Linux LVM/dev/sda3 41943040 52428799 5242880 8e Linux LVMDisk /dev/mapper/centos-root: 24.1 GB, 24121442304 bytes, 47112192 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisk /dev/mapper/centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytes[root@localhost ~]# 使用 fdisk /dev/sda 创建新的分区1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677### 注意：不同操作系统的磁盘命名方式不同，有些是/dev/vda。### 具体使用方式参考第三步中fdisk -l首行显示Disk。### 如笔者在该系统中首行显示为Disk /dev/sda: 107.4 GB, 107374182400 bytes ，故使用命令fdisk /dev/sda）[root@localhost ~]# fdisk /dev/sdaWelcome to fdisk (util-linux 2.23.2).Changes will remain in memory only, until you decide to write them.Be careful before using the write command.Command (m for help): m ---------#帮助命令Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition g create a new empty GPT partition table G create an IRIX (SGI) partition table l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition's system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only)Command (m for help): n -----------#创建新分区Partition type: p primary (3 primary, 0 extended, 1 free) e extendedSelect (default e): p -------#选择主分区Selected partition 4First sector (52428800-209715199, default 52428800): ---#回车使用默认Using default value 52428800Last sector, +sectors or +size&#123;K,M,G&#125; (52428800-209715199, default 209715199): ---#回车使用默认Using default value 209715199Partition 4 of type Linux and of size 75 GiB is setCommand (m for help): t --------------#修改分区类型Partition number (1-4, default 4): ----------#回车使用默认值Hex code (type L to list all codes): 8e -----#说明: 8e 是lvm磁盘类型Changed type of partition 'Linux' to 'Linux LVM'Command (m for help): p ------#打印分区表Disk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisk label type: dosDisk identifier: 0x0004148c Device Boot Start End Blocks Id System/dev/sda1 * 2048 1026047 512000 83 Linux/dev/sda2 1026048 41943039 20458496 8e Linux LVM/dev/sda3 41943040 52428799 5242880 8e Linux LVM/dev/sda4 52428800 209715199 78643200 8e Linux LVMCommand (m for help): w -------#保存退出The partition table has been altered!Calling ioctl() to re-read partition table.WARNING: Re-reading the partition table failed with error 16: Device or resource busy.The kernel still uses the old table. The new table will be used atthe next reboot or after you run partprobe(8) or kpartx(8) ---#这里提示重启系统Syncing disks. 重启系统1[root@localhost ~]# reboot 查看磁盘情况1234567891011121314151617181920212223242526272829### 核对刚才所做的分区操作是否保存成功[root@localhost ~]# fdisk -lDisk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisk label type: dosDisk identifier: 0x0004148c Device Boot Start End Blocks Id System/dev/sda1 * 2048 1026047 512000 83 Linux/dev/sda2 1026048 41943039 20458496 8e Linux LVM/dev/sda3 41943040 52428799 5242880 8e Linux LVM/dev/sda4 52428800 209715199 78643200 8e Linux LVM ----#这里多出一块,说明保存成功Disk /dev/mapper/centos-root: 24.1 GB, 24121442304 bytes, 47112192 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisk /dev/mapper/centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectorsUnits = sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytes[root@localhost ~]# 使用 pvcreate /dev/sda4 创建物理卷1234### /dev/sda4 这里的4是上面刚才新增的分区[root@localhost ~]# pvcreate /dev/sda4 Physical volume \"/dev/sda4\" successfully created[root@localhost ~]# 使用pvdisplay 查看新建的物理卷大小123456789101112131415161718192021222324252627282930313233343536[root@localhost ~]# pvdisplay --- Physical volume --- PV Name /dev/sda2 VG Name centos PV Size 19.51 GiB / not usable 3.00 MiB Allocatable yes (but full) PE Size 4.00 MiB Total PE 4994 Free PE 0 Allocated PE 4994 PV UUID 7q1DBZ-n5ZX-1OPX-IN9w-SdAp-qekM-BfpVbc --- Physical volume --- PV Name /dev/sda3 VG Name centos PV Size 5.00 GiB / not usable 4.00 MiB Allocatable yes PE Size 4.00 MiB Total PE 1279 Free PE 10 Allocated PE 1269 PV UUID eOLd2K-aXSx-cA1M-hwJc-zqdq-7U4Y-ZE8d2R \"/dev/sda4\" is a new physical volume of \"75.00 GiB\" ----------#可以看到新增的75G --- NEW Physical volume --- PV Name /dev/sda4 VG Name PV Size 75.00 GiB Allocatable NO PE Size 0 Total PE 0 Free PE 0 --------#现在这里看到的是0,在 lvextend 的时候还要重新查看 Allocated PE 0 PV UUID wyG3ZO-e1a0-3OHW-6afy-u90w-7Lc8-ddMnJL [root@localhost ~]# 使用 vgdisplay 查看 vg 状态1234567891011121314151617181920212223[root@localhost ~]# vgdisplay --- Volume group --- VG Name centos --------------#这个名字在下面会用到 System ID Format lvm2 Metadata Areas 2 Metadata Sequence No 5 VG Access read/write VG Status resizable MAX LV 0 Cur LV 2 Open LV 2 Max PV 0 Cur PV 2 Act PV 2 VG Size 24.50 GiB PE Size 4.00 MiB Total PE 6273 Alloc PE / Size 6263 / 24.46 GiB Free PE / Size 10 / 40.00 MiB VG UUID q6Omkk-sEkn-Ex9Y-gfSY-0URm-4z2E-0u9Euj [root@localhost ~]# 使用 vgextend centos /dev/sda4 将添加新的物理卷加载到 centos 卷组123456789101112131415161718192021### centos 是我的服务器vg名称,可以通过vgdisplay查看vg状态得到名称### /dev/sda4 是我刚刚新增的物理卷[root@localhost ~]# vgextend centos /dev/sda4 Volume group \"centos\" successfully extended[root@localhost ~]# ###---------- 注意这里可以由于系统空间不足出现报错 ------------###---------- 手动去删除些没有用的文件 ------------### 报错内容### [root@localhost ~]# vgextend centos /dev/sda4### Couldn't create temporary archive name.### Volume group \"centos\" metadata archive failed.### Internal error: Attempt to unlock unlocked VG #orphans.### [root@localhost ~]# ###[root@localhost ~]# vgextend centos /dev/sda4 Couldn't create temporary archive name. Volume group \"centos\" metadata archive failed. Internal error: Attempt to unlock unlocked VG #orphans.[root@localhost ~]# 使用 lvdisplay 查看 lv 状态123456789101112131415161718192021222324252627282930313233343536[root@localhost ~]# lvdisplay --- Logical volume --- LV Path /dev/centos/swap LV Name swap VG Name centos LV UUID d39rhF-bGNs-fWPE-ItwX-FNQe-QJ4h-taAm94 LV Write Access read/write LV Creation host, time localhost, 2019-05-09 03:42:09 -0400 LV Status available # open 2 LV Size 2.00 GiB Current LE 512 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 8192 Block device 253:1 --- Logical volume --- LV Path /dev/centos/root LV Name root VG Name centos LV UUID rvepaR-xSYs-hPOy-vPWA-Oiuh-A0Je-j29Gk1 LV Write Access read/write LV Creation host, time localhost, 2019-05-09 03:42:10 -0400 LV Status available # open 1 LV Size 22.46 GiB Current LE 5751 Segments 2 Allocation inherit Read ahead sectors auto - currently set to 8192 Block device 253:0 [root@localhost ~]# 使用 lvextend 增加容量123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960 ## 使用 df -h 可以看到 /dev/mapper/centos-root 的名字 ## 使用 pvdisplay 再次查看 free 的PE数量 [root@localhost data]# df -hFilesystem Size Used Avail Use% Mounted on/dev/mapper/centos-root 23G 23G 52K 100% / -------# /dev/mapper/centos-root 这个名字要用devtmpfs 20G 0 20G 0% /devtmpfs 20G 4.0K 20G 1% /dev/shmtmpfs 20G 8.5M 20G 1% /runtmpfs 20G 0 20G 0% /sys/fs/cgroup/dev/sda1 497M 120M 378M 25% /boot[root@localhost data]# [root@localhost data]# pvdisplay --- Physical volume --- PV Name /dev/sda2 VG Name centos PV Size 19.51 GiB / not usable 3.00 MiB Allocatable yes (but full) PE Size 4.00 MiB Total PE 4994 Free PE 0 Allocated PE 4994 PV UUID 7q1DBZ-n5ZX-1OPX-IN9w-SdAp-qekM-BfpVbc --- Physical volume --- PV Name /dev/sda3 VG Name centos PV Size 5.00 GiB / not usable 4.00 MiB Allocatable yes PE Size 4.00 MiB Total PE 1279 Free PE 10 Allocated PE 1269 PV UUID eOLd2K-aXSx-cA1M-hwJc-zqdq-7U4Y-ZE8d2R --- Physical volume --- PV Name /dev/sda4 VG Name centos PV Size 75.00 GiB / not usable 4.00 MiB Allocatable yes PE Size 4.00 MiB Total PE 19199 Free PE 19199 --------#这个大小要用 Allocated PE 0 PV UUID wyG3ZO-e1a0-3OHW-6afy-u90w-7Lc8-ddMnJL [root@localhost data]# ###---------- 注意这里可以由于系统空间不足出现报错 ------------###---------- 手动去删除些没有用的文件 ------------### 报错内容### [root@localhost ~]# lvextend -l +19199 /dev/mapper/centos-root ### Couldn't create temporary archive name.### Volume group \"centos\" metadata archive failed.### [root@localhost ~]# ###[root@localhost ~]# lvextend -l +19199 /dev/mapper/centos-root Size of logical volume centos/root changed from 22.46 GiB (5751 extents) to 97.46 GiB (24950 extents). Logical volume root successfully resized[root@localhost ~]# 查看当前分区类型(在下一步会用到)12345678910### 我的是 xfs 类型(centos7系统)[root@localhost ~]# df -T /dev/sda1Filesystem Type 1K-blocks Used Available Use% Mounted on/dev/sda1 xfs 508588 122080 386508 25% /boot[root@localhost ~]####-----------或者使用[root@localhost ~]# cat /etc/fstab | grep centos-root/dev/mapper/centos-root / xfs defaults 0 0[root@localhost ~]# 使用 xfs_growfs (centos7)重新调整文件系统大小(根据上一步类型使用不同命令)12345678910111213141516### centos7中用 xfs_growfs[root@localhost ~]# xfs_growfs /dev/mapper/centos-rootmeta-data=/dev/mapper/centos-root isize=256 agcount=6, agsize=1144832 blks = sectsz=512 attr=2, projid32bit=1 = crc=0 finobt=0data = bsize=4096 blocks=5889024, imaxpct=25 = sunit=0 swidth=0 blksnaming =version 2 bsize=4096 ascii-ci=0 ftype=0log =internal bsize=4096 blocks=2560, version=2 = sectsz=512 sunit=0 blks, lazy-count=1realtime =none extsz=4096 blocks=0, rtextents=0data blocks changed from 5889024 to 25548800[root@localhost ~]# ### centos6中用 resize2fs[root@localhost ~]# resize2fs /dev/mapper/centos-root 查看磁盘空间123456789[root@localhost ~]# df -hFilesystem Size Used Avail Use% Mounted on/dev/mapper/centos-root 98G 23G 75G 24% / ----#新增成功devtmpfs 20G 0 20G 0% /devtmpfs 20G 4.0K 20G 1% /dev/shmtmpfs 20G 8.5M 20G 1% /runtmpfs 20G 0 20G 0% /sys/fs/cgroup/dev/sda1 497M 120M 378M 25% /boot[root@localhost ~]#","tags":[]},{"title":"-算法02","date":"2019-07-15T09:50:30.576Z","path":"2019/07/15/面试/算法/算法_03/","text":"01). 输出 9*9 乘法口诀1234567for ($x = 1; $x &lt; 10; $x++) &#123; for ($y = 1; $y &lt;= $x; $y++) &#123; echo $y . \"*\" . $x . \"=\" . $y * $x; echo \"&amp;nbsp&amp;nbsp&amp;nbsp\"; &#125; echo \"&lt;br&gt;\";&#125; 02) 猴子吃桃123456789//题目：猴子吃桃问题：猴子第一天摘下若干个桃子，当即吃了一半，还不瘾，又多吃了一个 //第二天早上又将剩下的桃子吃掉一半，又多吃了一个。//以后每天早上都吃了前一天剩下 的一半零一个。到第10天早上想再吃时，见只剩下一个桃子了。求第一天共摘了多少。 $x = 1; //最后一天的桃子个数for ($i = 2; $i &lt;= 10; $i++) &#123; //天数循环 $x = ($x + 1) * 2;&#125;echo \"猴子第1天条摘了\" . $x . \"个桃子\";","tags":[]},{"title":"laravel 添加一个V1 接口模块 -api","date":"2019-07-13T19:33:31.609Z","path":"2019/07/14/laravel/添加接口模块API/","text":"app/Providers/RouteServiceProvider.php 中添加1234567891011121314151617181920212223242526public function map()&#123; $this-&gt;mapApiRoutes(); $this-&gt;mapWebRoutes(); $this-&gt;mapTestRoutes(); //新增接口模块&#125;//--------------------------------------protected function mapApiRoutes() //API 接口模块&#123; Route::prefix('api') //访问地址前缀 -&gt;middleware('api') //中间件 -&gt;namespace($this-&gt;namespace.'\\\\Api') //接口模块目录,命名空间 -&gt;group(base_path('routes/api.php')); //接口路由&#125;public function mapTestRoutes() //V1接口模块&#123; Route::prefix('test') //-&gt;middleware('fei') //自定义中间件 -&gt;namespace($this-&gt;namespace.'\\\\V1') -&gt;group(base_path('routes/test.php'));&#125; routes/test.php 路由1Route::get('foo', 'FooController@index'); app/Http/Controllers/V1/FooController.php 模块12345678910111213&lt;?phpnamespace App\\Http\\Controllers\\V1;use App\\Http\\Controllers\\Controller;class FooController extends Controller&#123; // 访问地址 http://demo.laravel.com/test/foo public function index() &#123; echo \"FooController foo\"; &#125;&#125; app/Http/Middleware/fei.php 自定义中间件 app/Http/Kernel.php 加载中间件1234567891011121314151617181920212223242526272829303132&lt;?php//---------- app/Http/Middleware/fei.php --------namespace App\\Http\\Middleware;use Closure;class fei&#123; public function handle($request, Closure $next) &#123; exit('使用自定义文件中间件'); return $next($request); &#125;&#125;//---------------- app/Http/Kernel.php -----protected $middlewareGroups = [ 'web' =&gt; [ \\App\\Http\\Middleware\\EncryptCookies::class, \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class, \\Illuminate\\Session\\Middleware\\StartSession::class, // \\Illuminate\\Session\\Middleware\\AuthenticateSession::class, \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class, \\App\\Http\\Middleware\\VerifyCsrfToken::class, \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, ], 'api' =&gt; [ 'throttle:60,1', 'bindings', ], 'fei'=&gt;[ fei::class ]];","tags":[]},{"title":"linux ubuntu 磁盘扩容","date":"2019-07-01T12:03:59.674Z","path":"2019/07/01/centos/ubuntu_虚拟机_磁盘扩容/","text":"在虚拟机VMware上增加磁盘空间使用了一段时间虚拟机后发现磁盘不够用了,需要扩容。在客户端操作扩容出现磁盘已成功扩展。您必须从客户机操作系统内部对磁盘重新进行分区和扩展文件系统。 然后进ubuntu系统进行操作 查看现有的磁盘空间12df -h #查看当前磁盘空间,没有看到变化fdisk -l #查看硬盘信息 创建新分区不同操作系统命名方式不一样, 我的是 /dev/sda , 有的可能是 /dev/vda,具体使用看 df -h 出来的信息 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677root@ubuntu:/# fdisk /dev/sdaWelcome to fdisk (util-linux 2.31.1).Changes will remain in memory only, until you decide to write them.Be careful before using the write command.Command (m for help): m ------------------获取帮助Help: DOS (MBR) a toggle a bootable flag b edit nested BSD disklabel c toggle the dos compatibility flag Generic d delete a partition F list free unpartitioned space l list known partition types n add a new partition p print the partition table t change a partition type v verify the partition table i print information about a partition Misc m print this menu u change display/entry units x extra functionality (experts only) Script I load disk layout from sfdisk script file O dump disk layout to sfdisk script file Save &amp; Exit w write table to disk and exit q quit without saving changes Create a new label g create a new empty GPT partition table G create a new empty SGI (IRIX) partition table o create a new empty DOS partition table s create a new empty Sun partition tableCommand (m for help): n ----------创建新分区 Partition type p primary (1 primary, 0 extended, 3 free) e extended (container for logical partitions)Select (default p): p --------------选择主分区Partition number (2-4, default 2): 2 -------------分区号,默认是2(系统不一样,默认值不一样)First sector (41940992-52428799, default 41940992): --------直接回城选择默认Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (41940992-52428799, default 52428799): ----直接回城选择默认Created a new partition 2 of type 'Linux' and of size 5 GiB.Command (m for help): t -----------修改分区格式Partition number (1,2, default 2): 2 ----------刚才选择的分区号(对应上面的2)Hex code (type L to list all codes): 8e --------8e是lvm磁盘类型Changed type of partition 'Linux' to 'Linux LVM'.Command (m for help): p ------打印分享信息(可以看到刚才选择的2,多出/dev/sda2,也就是要增加的5G空间)Disk /dev/sda: 25 GiB, 26843545600 bytes, 52428800 sectorsUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0x4a53929fDevice Boot Start End Sectors Size Id Type/dev/sda1 * 2048 41940991 41938944 20G 83 Linux/dev/sda2 41940992 52428799 10487808 5G 8e Linux LVMCommand (m for help): w -----------------保存The partition table has been altered.Syncing disks.root@ubuntu:/# reboot -----------重启系统 创建物理卷12df -h #查看当前磁盘空间,没有看到变化fdisk -l #查看硬盘信息,-------------------这时候这里会多出一个 /dev/sda2,说明上面的操作成功 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364------------------这里出现问题?????????????------------root@ubuntu:/# pvcreate /dev/sda2 --------------创建物理卷(pv组成vg，vg组成lv) Physical volume \"/dev/sda2\" successfully created.root@ubuntu:/# pvdisplay --------查看物理卷和大小 \"/dev/sda2\" is a new physical volume of \"5.00 GiB\" --- NEW Physical volume --- PV Name /dev/sda2 VG Name -----------这里没有VG name(如果这里有值怎下面不需要穿件) PV Size 5.00 GiB Allocatable NO PE Size 0 Total PE 0 Free PE 0 Allocated PE 0 PV UUID xVmELU-F8si-LN9g-t4Ur-TWvR-u2Hp-nemrbb -------- 由于我上面VG name 为空,所以创建------ root@ubuntu:/# vgcreate data_fei /dev/sda2 -----------创建vgroot@ubuntu:/# vgdisplay ----------------查看vg状态,查看卷组信息root@ubuntu:/# pvdisplay ------------(再次查看)查看物理卷和大小 --- Physical volume --- PV Name /dev/sda2 VG Name data_fei ------------现在这里有VG name 的值 PV Size 5.00 GiB / not usable 0 Allocatable yes PE Size 4.00 MiB Total PE 1280 ----------这个值在下面 lvextend 会用到 ↓↓↓ Free PE 1280 Allocated PE 0 PV UUID xVmELU-F8si-LN9g-t4Ur-TWvR-u2Hp-nemrbb root@ubuntu:/#-------------------------------------------------root@ubuntu:/# vgextend data_fei /dev/sda2 --------把创建的PV加入到相应的CG Physical volume '/dev/sda2' is already in volume group 'data_fei' Unable to add physical volume '/dev/sda2' to volume group 'data_fei' /dev/sda2: physical volume not initialized. ------------------------------- root@ubuntu:/# lvcreate -L100 -n data_001 data_fei -----我这里lvdisplay没有,所以创建一个 Logical volume \"data_001\" created.root@ubuntu:/# lvdisplay --- Logical volume --- LV Path /dev/data_fei/data_001 LV Name data_001 VG Name data_fei LV UUID dpmINm-4qE4-TX8G-wC72-Z4kO-XsVP-zhdKZs LV Write Access read/write LV Creation host, time ubuntu, 2019-07-01 06:29:51 -0700 LV Status available # open 0 LV Size 100.00 MiB Current LE 25 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device------------------------- root@ubuntu:/# lvresize -l +1280 /dev/mapper/data_fei-data_001 ---1280为上面pvdisplay中的free PE数量↑↑↑root@ubuntu:/# lvdisplay resize2fs /dev/mapper/data_fei-data_001 我是a里面的内容","tags":[]},{"title":"-vnc server","date":"2019-06-28T02:55:30.242Z","path":"2019/06/28/other/vnc/","text":"centos7 gnome桌面,安装vnc1234567891011121314####centos7 安装完没有修改配置文件01) 首先检查当前系统是桌面用的KED还是gnome或者其他ll /usr/bin/*session*ps -A | grep KEDps -A | grep gnomeps -A | egrep -i \"gnome|kde|mate|cinnamon|lx|xfce|jwm\"02)安装桌面(上面如果有桌面则这里不需要安装)yum grouplist #查看系统中以组安装的包yum groupinstall -y \"GNOME Desktop\"03 安装vncserrveryum install tigervnc-server -y #安装vncserver 服务端vncserver #启动服务,接下来输入密码即可 centos7的vcn中xstartup`配置文件(原来的配置,不需要修改)123456#!/bin/shunset SESSION_MANAGERunset DBUS_SESSION_BUS_ADDRESS/etc/X11/xinit/xinitrcvncserver -kill $DISPLAY ubuntu16 gnome安装 vnc server1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#### 安装完成后需要修改配置文件,否则出现灰屏和一个大大的x号01) 首先检查当前系统是桌面用的KED还是gnome或者其他,我的是gnome,所以这里不在安装桌面(需要的自行安装)ll /usr/bin/*session*ps -A | grep KEDps -A | grep gnomeps -A | egrep -i \"gnome|kde|mate|cinnamon|lx|xfce|jwm\"#---------------安装----------------------sudo apt-get updatesudo apt-get install tightvncserver #如果需要桌面自己安装合适的桌面vncserver#-----------------启动-------------------01) 如果你想启动root桌面,就用sudo vncserver,访问当前普通用户就用vncserversudo vncserver #root用户 设置密码,我这里用123456 测试vncserver #当前普通用户vncpasswd #修改密码#---------------------------------------------启动后会在 /root 目录下增加一个 .vnc 的目录访问前准备:修改 xstartup 文件02) 在 xstartup 中修改#/etc/X11/Xsession ---------注释这一行,添加下面内容unset DBUS_SESSION_BUS_ADDRESSgnome-panel &amp;gnome-settings-daemon &amp;metacity &amp;nautilus &amp;gnome-terminal &amp;#---------xstartup 文件中的所有内容如下---------#!/bin/shxrdb $HOME/.Xresourcesxsetroot -solid grey#x-terminal-emulator -geometry 80x24+10+10 -ls -title \"$VNCDESKTOP Desktop\" &amp;#x-window-manager &amp;# Fix to make GNOME workexport XKL_XMODMAP_DISABLE=1#/etc/X11/Xsessionunset DBUS_SESSION_BUS_ADDRESSgnome-panel &amp;gnome-settings-daemon &amp;metacity &amp;nautilus &amp;gnome-terminal &amp;#---------------------------------------------vncserver :1 #启动1桌面,重启vncserver #---------------------------------------------访问端口:vnc 默认端口是5900; 启动的时候注意有个空格[ vncserver :1 ]如果你启动的是 vncserver :1 那么访问就是 http://127.0.0.1:5901如果你启动的是 vncserver :2 那么访问就是 http://127.0.0.1:5902ps -aux | grep vnc 可以看到里面有端口的说明 -rfbauth /root/.vnc/passwd -rfbport 5901 ubuntu16 中 vnc的xstartup配置(修改后的)123456789101112131415#!/bin/shxrdb $HOME/.Xresourcesxsetroot -solid grey#x-terminal-emulator -geometry 80x24+10+10 -ls -title \"$VNCDESKTOP Desktop\" &amp;#x-window-manager &amp;# Fix to make GNOME workexport XKL_XMODMAP_DISABLE=1#/etc/X11/Xsessionunset DBUS_SESSION_BUS_ADDRESSgnome-panel &amp;gnome-settings-daemon &amp;metacity &amp;nautilus &amp;gnome-terminal &amp; 其他1234vncserver :1 #启动1桌面vncserver :2 #启动2桌面vncserver -kill :1 #停止1桌面vncserver -kill :2 #停止2桌面 下载视图工具: realvnc download","tags":[]},{"title":"-apache 三种工作模式","date":"2019-06-27T07:02:48.949Z","path":"2019/06/27/apache/apache三种工作模式/","text":"Apache2.0 支持插入式并行处理模块,成为多路处理模块( MPM) 下面以我使用的 Apache/2.4.33 为例子: 查看 apache 安装的那种模式12345678910111213141516171819202122./bin/apache -V ./bin/httpd -V./bin/apache -l./bin/httpd -l[root@localhost apache24]# ./bin/apachectl -VServer version: Apache/2.4.33 (Unix)Server built: May 9 2019 09:09:30Server's Module Magic Number: 20120211:76Server loaded: APR 1.6.3, APR-UTIL 1.6.1Compiled using: APR 1.6.3, APR-UTIL 1.6.1Architecture: 64-bitServer MPM: event[root@localhost apache24]# ./bin/httpd -lCompiled in modules: core.c mod_so.c http_core.c event.c ### 如果看到event.c 就是 mpm event 模式; 如果是 perfork.c 就是 perfork mp模式 mpm_prefork1234567&lt;IfModule mpm_prefork_module&gt; StartServers 5 MinSpareServers 5 MaxSpareServers 10 MaxRequestWorkers 250 MaxConnectionsPerChild 0&lt;/IfModule&gt; mpm_worker12345678&lt;IfModule mpm_worker_module&gt; StartServers 3 MinSpareThreads 75 MaxSpareThreads 250 ThreadsPerChild 25 MaxRequestWorkers 400 MaxConnectionsPerChild 0&lt;/IfModule&gt; mpm_event12345678&lt;IfModule mpm_event_module&gt; StartServers 3 MinSpareThreads 75 MaxSpareThreads 250 ThreadsPerChild 25 MaxRequestWorkers 400 MaxConnectionsPerChild 0&lt;/IfModule&gt; 配置1修改里面的参数,需要在 conf/httpd.conf 中去掉 Include conf/extra/httpd-mpm.conf 前面注释","tags":[]},{"title":"-ESX 基本使用","date":"2019-06-25T10:21:52.267Z","path":"2019/06/25/ESX/esxi/","text":"简单说明: esxi 中安装了多个vm,其中的某一台死机并且esxi控制台开始不能使用,这个时候就可以使用esxi的命令操作,重启其中某一台死机的机器,不影响其他机器。利用ssh登录esxi 使用 esxcli命令操作123456789esxcli vm process list #获取`正在`运行vm的信息esxcli vm process kill --type=hard --world-id=1190332 ##关闭指定world-id虚拟机Data_fei_200 World ID: 1190332 Process ID: 0 VMX Cartel ID: 35124 UUID: 56 4d 0b 4f d5 61 33 03-5e 41 43 d8 43 78 fb d8 Display Name: Data_fei_200 Config File: /vmfs/volumes/57518d68-cbf78024-3a0a-14187743ea91/Data_fei_200/Data_fei_200.vmx 使用vim-cmd 操作12345vim-cmd vmsvc/getallvms #获取`所有`vm的信息,格式如下图vim-cmd vmsvc/power.on 2 #打开虚拟机 (这里的2是下面的 Vimd)vim-cmd vmsvc/power.off 2 #关闭虚拟机 (这里的2是下面的 Vimd)vim-cmd vmsvc/power.reset 2 #重启虚拟机 (这里的2是下面的 Vimd)vim-cmd vmsvc/power.getstate 2 #查看虚拟机状态 Vimd Name File Guest OS Version 1 Data_fei_200 Data_fei_200/Data_fei_200.vmx centos64Guest vmx-08 2 Data_fei_220 Data_fei_200/Data_fei_220.vmx rhel7_64Guest vmx-10 常用命令12345678esxcli vm process list #获取正在运行vm的信息esxcli vm process kill --type=hard --world-id=你的world-id vim-cmd vmsvc/getallvms #获取`所有`vm的信息,格式如下图 vim-cmd vmsvc/power.on 2 #打开虚拟机 (这里的2是下面的 Vimd) vim-cmd vmsvc/power.off 2 #关闭虚拟机 (这里的2是下面的 Vimd) vim-cmd vmsvc/power.reset 2 #重启虚拟机 (这里的2是下面的 Vimd) vim-cmd vmsvc/power.getstate 2 #查看虚拟机状态","tags":[]},{"title":"linux-DDU  将进程挂起  -nohup","date":"2019-06-18T01:21:56.505Z","path":"2019/06/18/ubuntu/linux_DDU_nohup/","text":"nohup 命令可以将程序以忽略挂起信号的方式运行起来，被运行的程序的输出信息将不会显示到终端 经常和 &amp; 连用, 通俗理解: 后台运行,关闭当前窗口后命令也可以继续运行 常用命令1234567891011121314151617nohup command&gt;/dev/null 2&gt;&amp;1 &amp;# nohup 忽略挂起信号# &amp; 后台运行# command&gt;/dev/null 这条命令输出重定向到空设备# 2&gt;&amp;1 把标准输出错误重定向到标准输出, &amp;1对标准输出的引用# /dev/null 表示空设备文件# 0 表示stdin标准输入# 1 表示stdout标准输出# 2 表示stderr标准错误---- demo ---nohup php fei.php &gt; fei.log 2&gt;&amp;1 &amp;##关闭当前窗口改命令也可以继续在后台运行nohup php fei.php &gt;&gt; fei.log 2&gt;&amp;1 &amp; ### 把日志追加到 fei.log 文件中 其他1234567891011使用nohup命令提交作业，如果使用nohup命令提交作业，那么在缺省情况下该作业的所有输出都被重定向到一个名为nohup.out的文件中，除非另外指定了输出文件：nohup command &gt; myout.file 2&gt;&amp;1 &amp;# nohup 忽略挂起信号# &amp; 后台运行# command &gt; myout.file 这条命令输出重定向到myout.file中# 2&gt;&amp;1 把标准输出错误重定向到标准输出---- demo ---./test.sh &gt; fei.log 2&gt;&amp;1","tags":[]},{"title":"laravel -Command","date":"2019-06-17T06:22:37.371Z","path":"2019/06/17/laravel/常用操作_console/","text":"command 简单使用12345678910111213141516171819202122232425262728php artisan make:command foo //创建文件 protected $signature = 'foo'; //命令名字 protected $description = 'foo class Command description'; //描述php artisan foo //执行,可以调用到 public function handle() 方法php artisan list #这时候执行这个可以在Available commands 中看到 foo foo class Command description //--------- demo ----- &lt;?phpnamespace App\\Console\\Commands;use Illuminate\\Console\\Command;class foo extends Command&#123; protected $signature = 'foo'; protected $description = 'foo class Command description'; public function __construct() &#123; parent::__construct(); &#125; //php artisan foo 执行这条命令 public function handle() &#123; echo \"hello foo \"; &#125;&#125; 在一个 commands 文件中执行对应的方法12345678910111213141516171819202122232425262728293031323334353637383940protected $signature = 'command &#123;foo&#125;'; //注意这里写法即可php artisan command bar //执行命令 //--------- demo ----- &lt;?phpnamespace App\\Console\\Commands;use Illuminate\\Console\\Command;class foo extends Command&#123; // protected $signature = 'foo'; protected $signature = 'command &#123;foo&#125;'; protected $description = 'foo class Command description'; public function __construct() &#123; parent::__construct(); &#125; //php artisan foo public function handle() &#123; // echo \"hello foo \"; //sb 的laravel调用对应的方法,需要用判断写 $method = $this-&gt;argument('foo'); if (method_exists($this, $method)) &#123; $this-&gt;$method(); echo \"执行完成\\n\"; &#125;else&#123; echo \"$&#123;method&#125; is not exists\\n\"; &#125; &#125; //php artisan command bar public function bar() &#123; echo \"bar\"; &#125;&#125; confirm12345if ($this-&gt;confirm(\"确认要执行吗?\")) &#123; exit(\"开始执行\");&#125;else&#123; exit('停止执行');&#125; 官方commands","tags":[]},{"title":"-mysql-shell 工具使用(windows篇)","date":"2019-06-12T02:13:50.247Z","path":"2019/06/12/mysql/mysql_shell/","text":"mysql-shell123MySQL Shell是MySQL Server的高级客户端和代码编辑器。除了提供的SQL功能，类似于 mysql，MySQL Shell还提供了JavaScript和Python的脚本功能，并包含用于MySQL的API!!!! 以下暂时提供windows中demo,其他系统原理相同 !!! mysql-shell 文档 基本使用12345\\? &#123;command&#125; #查看命令的用法,也可以用\\help &#123;command&#125;\\py #python模式\\js #js模式\\sql #sql模式\\exit #退出 连接数据库01 mysqlsh12345678910#这种方式需要在mysql-shell的bin目录下面直接执行命令mysqlsh --uri 用户名@IP地址 #使用默认端口mysqlsh root@localhostmysqlsh --uri root@localhost #使用默认端口mysqlsh --uri root@localhost:3306 #指定端口\\sql #切换SQL模式show databases #正常SQL语句或者\\sql show databases #查看数据库 连接数据库02 \\connect12345678##这种连接方式,需要点击mysqlsh.exe,在弹出的窗口中执行下面的命令\\connect root@localhost:3306 #连接数据库\\sql #切换SQL模式show databases #正常SQL语句或者\\sql show databases #查看数据库 连接数据库03 shell.connect12345678##这种连接方式,需要点击mysqlsh.exe,在弹出的窗口中执行下面的命令shell.connect(&#123;'user':'root','host':'localhost','port':3306&#125; #连接数据库\\sql #切换SQL模式show databases #正常SQL语句或者\\sql show databases #查看数据库 mysql-shell 文档","tags":[]},{"title":"-oracle 简单使用","date":"2019-06-04T02:55:52.459Z","path":"2019/06/04/oracle/oracle_简单使用/","text":"oracle 简单SQL的使用……………. sql123456789101112131415161718192021222324252627282930313233343536373839#sqlSELECT * FROM USER_TAB_COMMENTSSELECT * FROM USER_TAB_COMMENTS T WHERE T.TABLE_NAME='表名' #查看表注释SELECT table_name FROM user_tables; //当前用户的表SELECT table_name FROM all_tables; //所有用户的表查看oracle 数据库版本select * from v$version;select * from product_component_version;#获取表字段：SELECT * FROM user_tab_columns WHERE Table_Name='用户表'; #获取表注释SELECT * FROM user_col_comments;SELECT * FROM user_col_comments WHERE Table_Name='用户表' #EMPI_ADDRESS#查询一行SELECT * FROM 表名 WHERE ROWNUM=1 #查询2行SELECT * FROM (SELECT * FROM 表名 order by CFG_ORGANIZATION_UNID) WHERE ROWNUM &lt; 3;SELECT * FROM 表名 WHERE ROWNUM&lt;3 #这里最好不要用#查询5条数据SELECT * FROM (SELECT 表名.*,ROWNUM as num FROM 表名) WHERE num between 0 and 5;SELECT * FROM 表名 WHERE ROWNUM &lt;= 5 minus SELECT * FROM 表名 WHERE ROWNUM &lt; 0;#WHERE 条件查询SELECT * FROM 表名 WHERE 表名.id&lt;=200 #id小于200#查询最后一条条数据SELECT p.* FROM (SELECT * FROM 表名 t order by t.id desc) p WHERE ROWNUM = 1#between andSELECT * FROM 表名 WHERE 时间字段 BETWEEN TO_DATE('2000-01-01 02:00:00', 'yyyy-MM-dd HH24:MI:SS') AND TO_DATE('2000-02-01 08:00:59', 'yyyy-MM-dd HH24:MI:SS')#时间字段 TO_CHARSELECT UNID,NAME,NAME_XML FROM TABLE_NAME WHERE UNID=10 PHP 操作 oracle123456789101112### PHP 使用 pdo 操作oracle数据库 报错## SELECT UNID,NAME,NAME_XML WHERE UNID&gt;=10 AND UNID&lt;=15 ## 在10到15这5条数据中不为空数据php: symbol lookup error: ...php/lib/php/extensions/no-debug-non-zts-20170718/pdo_oci.so: undefined symbol: GC_ADDREF原因: oracle数据库中字段类型有 CLOB 和 SYS.XMLTYPE 这2中类型解决办法:我的字段 NAME 是 CLOB 类型; NAME_XML 是 SYS.XMLTYPE 类型SELECT UNID,NAME,NAME_XML FROM TABLE_NAME WHERE UNID&gt;=10 AND UNID&lt;=15SELECT UNID,TO_CHAR(a.NAME_XML.getclobval()) as NAME_XML FROM TABLE_NAME WHERE UNID&gt;=10 AND UNID&lt;=15SELECT UNID,TO_CHAR(a.NAME),TO_CHAR(a.NAME_XML.getclobval()) as NAME_XML FROM TABLE_NAME WHERE UNID&gt;=10 AND UNID&lt;=15","tags":[]},{"title":"linux php -PDO_OCI 扩展","date":"2019-06-03T09:33:27.772Z","path":"2019/06/03/php/php连接oracle_pdoOci扩展安装/","text":"PHP连接到oracle数据库需要pdo_oci 扩展 下载文件12345678910https://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.htmlhttps://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html下载下面2个文件,上传到服务器:instantclient-basic-linux.x64-12.1.0.2.0.zipinstantclient-sdk-linux.x64-12.1.0.2.0下载 oracle 数据库的扩展 oci8https://pecl.php.net/package/oci8oci8-2.2.0.tgz下载 php-src ,主要使用 pdo_oci 目录https://github.com/php/php-src 安装 instantclient1234567891011121314151617进入linux:unzip instantclient-basic-linux.x64-12.1.0.2.0.zipunzip instantclient-sdk-linux.x64-12.1.0.2.0.zipcd /data/server/oracle_phpcp -avr instantclient-basic-linux.x64-12.1.0.2.0.zip /data/server/oracle_php/cp -avr instantclient-sdk-linux.x64-12.1.0.2.0.zip /data/server/oracle_php/#这里解压后会放再一个目录中unzip instantclient-basic-linux.x64-12.1.0.2.0.zipunzip instantclient-sdk-linux.x64-12.1.0.2.0.zipmv instantclient_12_1 instantclient cd instantclientln -s libnnz12.so libnnz.soln -s libclntsh.so.12.1 libclntsh.soln -s libocci.so.12.1 libocci.so 安装 oci8 扩展1234567891011121314cd /data/server/oracle_phptar -zxvf oci8-2.2.0.tgzcd oci8-2.2.0/data/server/php72/bin/phpize./configure \\--with-oci8=instantclient,/data/server/oracle_php/instantclient \\--with-php-config=/data/server/php72/bin/php-configmakemake install## 最后安装成功[www@localhost oci8-2.2.0]$ make installInstalling shared extensions: /data/server/php72/lib/php/extensions/no-debug-non-zts-20170718/[www@localhost oci8-2.2.0]$ 安装 pdo_oci 扩展123456789101112131415161718192021https://pecl.php.net/package/PDO_OCI这里的 PDO_OCI-1.0.tgz 已经不在维护,从github 上php/php-src 中下载使用 pdo_oci 目录改从这里下载https://github.com/php/php-src 使用 php-src 里面的 pdo_ocicd pdo_oci/data/server/php72/bin/phpize./configure \\--with-pdo-oci=instantclient,/data/server/oracle_php/instantclient \\--with-php-config=/data/server/php72/bin/php-configmakemake install## 最后安装成功[www@localhost pdo_oci]$ make installInstalling shared extensions: /data/server/php72/lib/php/extensions/no-debug-non-zts-20170718/[www@localhost pdo_oci]$ -----配置 php.ini ------php.ini配置中添加一句 extension=pdo_oci.so php-src pecl","tags":[]},{"title":"Yii2  -model层不为人知的秘密","date":"2019-06-02T13:18:36.494Z","path":"2019/06/02/Yii2/Yii2_常用操作/","text":"console1php yii web-fei-server/bind #WebFeiServerController/actionBind() []:","tags":[]},{"title":"windows  phpstudy curl超时","date":"2019-05-28T03:38:11.073Z","path":"2019/05/28/php/win_phpStudy/","text":"场景: windows7 phpstudy2016 php7.3 nginx, 使用curl file_get_content本地项目之间互相访问一直超时或者失败 场景再现123456789101112131415demo.test.com:80文件 E:\\selfweb\\git_dev\\test\\index.php 内容如下:&lt;?php$file = file_get_contents(\"http://demo.test.com:80/index2.php\");print_r($file);echo \"&lt;br&gt; php-cgi.exe -b demo.test.com:9001 -c php.ini\";------------- 目录 E:\\selfweb\\git_dev\\test\\index2.php 内容如下&lt;?phpecho \"我是 index2.php 从我这里拿数据\";访问 http://demo.test.com:80/index2.php #成功访问 http://demo.test.com:80/index.php #失败 解决办法12345678910111213141516171819202122232425262728293031323334353637383940414243#修改nginx配置,添加81端口,添加9001端口server &#123; listen 80; #这里 server_name demo.test.com 192.168.1.151; charset utf-8; root E:/selfweb/git_dev/test/; index index.php; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9000; #这里 fastcgi_index index.php; include fastcgi.conf; &#125;&#125;server &#123; listen 81; #这里 server_name demo.test.com; charset utf-8; root E:/selfweb/git_dev/test/; index index.php; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9001; #这里 fastcgi_index index.php; include fastcgi.conf; &#125;&#125;#重启phpStudy,在当前php目录下的cmd中运行命令:php-cgi.exe -b demo.test.com:9001 -c php.ini#修改文件文件 E:\\selfweb\\git_dev\\test\\index.php 中端口内容如下:&lt;?php$file = file_get_contents(\"http://demo.test.com:81/index2.php\");print_r($file);echo \"&lt;br&gt; php-cgi.exe -b demo.test.com:9001 -c php.ini\";#再次访问访问 http://demo.test.com:80/index2.php #成功访问 http://demo.test.com:80/index.php #成功 编写bat 脚本123#创建 test_curl.bat 脚本,内容如下set php_nts=D:\\soft_position\\phpStudy20161103\\php\\php-7.3.4-nts%php_nts%\\php-cgi.exe -b demo.test.com:9001 -c %php_nts%\\php.ini","tags":[]},{"title":"ubuntu -docker","date":"2019-05-26T08:17:22.094Z","path":"2019/05/26/docker/docker/","text":"docker使用建议,一个docker 容器中运行一种服务 ubuntu 安装 docker123456789101112131415161718192021222324sudo apt-get updatesudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -#这条命令修改文件位置: /etc/apt/sources.listsudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) \\ stable\" sudo apt-get updatesudo apt-get install docker-ce docker-ce-cli containerd.io#验证: https://docs.docker.com/get-started/sudo docker run hello-world此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条信息性消息并退出 官网Ubuntu安装Docker CE 配置 docker加速12345678910111213141516171819202122cd /etc/docker/ touch daemon.json #没有这个文件手动创建文件里面内容如下:-----------使用docker官方镜像-----以后下载镜像会慢-----&#123; \"registry-mirrors\": [ \"https://registry.docker-cn.com\" ], \"insecure-registries\": []&#125;--------- 使用阿里云进行加速----先到阿里云申请,这里我已经申请好了------&#123; \"registry-mirrors\": [ \"https://qlc9qgml.mirror.aliyuncs.com\" ], \"insecure-registries\": []&#125;-----------------------------------sudo systemctl daemon-reloadsudo systemctl restart docker #重启docker 阿里云官方镜像加速文档 docker安装nginx0112345678910111213docker search nginx #查看nginx镜像docker pull nginx #拉取官方镜像,上面没有配置好docker加速器这里会下非常慢docker images nginx #查看镜像docker run --name container01 -p 8081:80 -d nginx #container01 这个名随便起#--name 容器名字(自己定义)#-p 端口映射#-d 后台运行docker ps #列出所又正在运行的容器 containers #这里列出的容器id记下来,下面会用到#访问测试,这里是端口8081http://127.0.0.1:8081/ docker安装nginx02 部署1234567891011121314151617181920212223242526272829303132#宿主机中创建目录mkdir -p /data/server/docker_fei/nginx/www \\/data/server/docker_fei/nginx/logs \\/data/server/docker_fei/nginx/conf#拷贝容器内 nginx 默认配置文件到本地目录,e765b2939521 容器id可以用 docker ps 查看docker cp e765b2939521:/etc/nginx/nginx.conf /data/server/docker_fei/nginx/conf#部署, 把宿主机中的目录挂载(映射)到docker容器中,这里会!!!重新在创建一个容器!!!docker run -d -p 8082:80 \\--name container04 \\-v /data/server/docker_fei/nginx/www:/usr/share/nginx/html \\-v /data/server/docker_fei/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \\-v /data/server/docker_fei/nginx/logs:/var/log/nginx \\nginx#-p 8082:80： 将容器的 80 端口映射到主机的 8082 端口# -v 将宿主机目录挂载(映射)到容器中cd /data/server/docker_fei/nginx/wwwtouch index.htmlvim index.html #内容如下hello world test /data/server/docker_fei/nginx/www #访问测试,这里是端口8082http://127.0.0.1:8082/docker stop container04 #关闭 container04 这个容器docker start container04 #启动 container04 这个容器docker restart container04 #重启 container04 这个容器##问题 宿主机中的目录挂载(映射)到docker容器中, 修改挂载(映射)文件、端口??????12345678文件地址:/var/lib/docker/containers/容器的hash值在这个目录下修改文件 hostconfig.json Binds 挂载目录PortBindings 端口修改完注意保持原来的格式,还是一行json 进入docker容器没有vim命令123456docker exec -it container01 /bin/bash #进入container01这个容器docker exec -it e765b2939521 /bin/bash #进入e765b2939521这个容器在docker容器中安装vim 命令,先同步在安装apt-get update #同步 /etc/apt/sources.list 和 /etc/apt/sources.list.d 中列出的源的索引apt-get install vim #这个时候安装 其他12345678910111213141516171819202122232425262728docker --versiondocker infodocker image ls #列出所有的镜像docker ps #查看已经运行容器docker ps -a #查看所有容器docker rm 容器名字(或者容器id) #删除容器docker container --help #容器帮助命令docker container ls #查看在运行容器docker container ls -a #查看所有容器docker container ls -aq #查看所有容器iddocker container ls --all #查看所有容器 docker stop container04 #关闭 container04 这个容器docker start container04 #启动 container04 这个容器docker restart container04 #重启 container04 这个容器docker exec -it container01 /bin/bash #进入container01这个容器docker exec -it e765b2939521 /bin/bash #进入e765b2939521这个容器docker attach e765b2939521 #进入e765b2939521这个容器#docker inspect container_name | grep -A10 -n Mounts #查看容器已经挂载的目录docker inspect container04 | grep -A10 -n Mounts#docker create ubuntu:latest #可以指定版本docker run --name 容器名字移除所有容器和镜像(大扫除)docker kill $(docker ps -q) ; docker rm $(docker ps -a -q) ; docker rmi $(docker images -q -a) Docker 资源汇总","tags":[]},{"title":"-find 文件查找","date":"2019-05-26T05:42:25.835Z","path":"2019/05/26/ubuntu/linux_DDU_find/","text":"…… find 命令用来指定目录文件下查找 命令格式1find [选项] [参数] 选项12 参数12 demo12find /home -name \"*.txt\" #在home目录下查找以.txt结尾的文件名find /home -iname \"*.txt\" #忽略大小写","tags":[]},{"title":"PHP -常用功能","date":"2019-05-22T10:52:21.945Z","path":"2019/05/22/php/PHP常用功能/","text":"hello world ………….. PHP常用功能 phpunit aaa bbbb dddd hello world","tags":[]},{"title":"php -函数","date":"2019-05-21T10:42:13.653Z","path":"2019/05/21/php/php函数/","text":"http_build_query1生成 URL-encode 之后的请求字符串：数组array('foo', 'bar', 'baz''); 转为 foo=bar&amp;baz=boom 程序执行函数1234system(\"php -v\");passthru(\"php -v\");exec(\"php -v\");shell_exec(\"php -v\");","tags":[]},{"title":"tcp ip","date":"2019-05-19T15:07:23.364Z","path":"2019/05/19/面试/其他/tcp_ip_从输入到发送请求/","text":"发送消息 12345678 hello world应用层 hello world ↓传输层 tcp + hello world ↓IP层 IP + tcp + hello world ↓链路层 帧头 + IP + tcp + hello world + 帧尾","tags":[]},{"title":"windows cmd 命令","date":"2019-05-17T03:31:57.914Z","path":"2019/05/17/win/win_cmd/","text":"windows中常用命令 帮助命令 help12help #查看所有命令help xcopy #查看xcopy所有参数 xcpoy 复制文件夹1234567参数:/s 复制目录和子目录，除了空的。/e 复制目录和子目录，包括空的。/c 即使有错误，也继续复制/y 禁止提示以确认改写一个xcopy E:\\web\\win_web\\aaa E:\\web\\win_web\\bbb\\bbb_01 /e/c/y #注意目录文件后面不要有\\","tags":[]},{"title":"centos7  -mysql5.7.22 安装","date":"2019-05-09T10:13:28.869Z","path":"2019/05/09/centos/mysql57/","text":"安装依赖1234567yum -y install libxml2 libxml2-devel curl-devel libjpeg-devel libpng-devel freetype-devel libmcrypt-develyum install -y gcc gcc-c++ make automake libaio-devel cmakeyum install -y ncurses-develyum install openssl openssl-devel查看一下cmake 版本cmake --version 下载 [ 注意版本]1234567安装版本 5.7.22；如果是虚拟机建议内容 4G ;wget https://cdn.mysql.com//archives/mysql-5.7/mysql-boost-5.7.22.tar.gz【我这里是下载到 /usr/local/download/ 然后解压到 当前目录, 准备安装到/usr/local/mysql57 】tar zxvf mysql-boost-5.7.22.tar.gz mv mysql-5.7.21 mysqlcd mysql 编译安装123456789101112131415161718cmake . -DBUILD_CONFIG=mysql_release \\-DCPACK_MONOLITHIC_INSTALL=ON \\-DCMAKE_INSTALL_PREFIX=/usr/local/mysql57 \\-DDEFAULT_CHARSET=utf8 \\-DDEFAULT_COLLATION=utf8_general_ci \\-DMYSQL_UNIX_ADDR=/usr/local/mysql57/mysql.sock \\-DMYSQL_TCP_PORT=3306 \\-DMYSQLX_UNIX_ADDR=/usr/local/mysql57/mysqlx.sock \\-DMYSQL_DATADIR=/usr/local/mysql57/data \\-DSYSCONFDIR=/usr/local/mysql57/etc \\-DWITH_BOOST=/usr/local/download/mysql-5.7.22/boost/boost_1_59_0注意这一项：这个是你 boost 下载好的目录，我的这个版本的 MySQL 解压后对应的目录中有这个-DWITH_BOOST=/usr/local/download/mysql-5.7.22/boost/boost_1_59_0注意看编译报错信息,每次出现缺少包,安装完缺少的包,重新解压新的mysql压缩包make #需要很长时间make install 初始化mysql创建 MySQL 组跟用户12groupadd mysqluseradd -r -g mysql -s /bin/false mysql 更改 mysql 目录权限1234567cd /usr/local/mysql57touch mysql.sockchmod -R 777 mysql.sockchown -R mysql .chgrp -R mysql . 初始化 mysql ， 生成 root 用户临时密码，1234567891011初始化要是操作出问题,可以删掉当前目录文件,然后到编译目录先 make install 可以重新生成文件此时要删除 系统中生成的my.cnf 文件 [/etc/my.cnf /etc/my.cnf.d /etc/my.cnf.d/mysql-clients.cnf ]bin/mysqld --initialize --user=mysql通过mysqld初始化data目录时，如果使用--initialize选项，则会为'root'@'localhost'用户创建一个随机密码。该密码会打印在控制台，如下所示行中末尾就是临时密码：2019-05-09T11:41:55.724145Z 1 [Note] A temporary password is generated for root@localhost: yfa!II_T%7dU*****************初始化一个空密码，使用initialize-insecure ****************bin/mysqld --initialize-insecure --user=mysql 启动mysql1234567891011121314!!!如果遇到启动报错记得杀死进程重新启动!!!ps -aux | grep mysqlpkill -9 mysqlps -aux | grep mysqlsupport-files/mysql.server start #启动报错,没有报错则不用执行下面创建文件mkdir /var/log/mariadbtouch /var/log/mariadb/mariadb.logchown -R mysql:mysql /var/log/mariadb/再次启动:support-files/mysql.server start #启动成功 登录mysql 修改密码123456789101112131415161718192021222324252627bin/mysql -u root -palter user 'root'@'localhost' identified by 'new_password'; #修改密码修改完重启mysql 或者 刷新support-files/mysql.server stop 或者flush privileges;----------------------show databases;use mysql;show tables;select * from user;select Host,User from user;select Host,User,authentication_string from user;*************************************************************我这里设置密码： 123456 做测试，实际中设置你认为安全的密码方法1：alter user 'root'@'localhost' identified by '123456';方法2：set password=password('123456');方法3：update user set authentication_string=password('123456') where user='root';( 不建议使用方法3,SQL会记录到日志中 )这里如果不重新设置密码，系统会一直提示：mysql&gt; show databases;ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.****其他****ALTER USER 'root'@'localhost' PASSWORD EXPIRE; #使密码过期","tags":[]},{"title":"mysql -Documentation  手册","date":"2019-04-18T02:17:00.152Z","path":"2019/04/18/mysql/documentation/","text":"sql123456789101112131415161718192021222324SELECT PASSWORD(&apos;mypass&apos;); #生成的密码值SHOW STATUS; SHOW STATUS LIKE &apos;Table%&apos;;SHOW VARIABLES; SHOW VARIABLES LIKE &apos;datadir&apos;;SHOW VARIABLES LIKE &apos;have_symlink&apos;;SHOW VARIABLES LIKE &apos;host_cache_size&apos;;SET GLOBAL host_cache_size=300;SELECT &apos;hello&apos;, &apos;&quot;hello&quot;&apos;, &apos;&quot;&quot;hello&quot;&quot;&apos;, &apos;hel&apos;&apos;lo&apos;, &apos;\\&apos;hello&apos;;SELECT &quot;hello&quot;, &quot;&apos;hello&apos;&quot;, &quot;&apos;&apos;hello&apos;&apos;&quot;, &quot;hel&quot;&quot;lo&quot;, &quot;\\&quot;hello&quot;;SET @t1=1, @t2=2, @t3:=4; #赋值SELECT @t1, @t2, @t3, @t4 := @t1+@t2+@t3;SET NAMES &apos;utf8&apos;;SHOW CHARACTER SET;USE test;SELECT @@character_set_database, @@collation_database;SELECT USER(); 访问控制阶段1,21234567!!! 用户名和密码为空危险 !!!!!!如果User列值为非空，则传入连接中的用户名必须完全匹配。如果 User值为空，则它匹配任何用户名!!!该authentication_string列可以为空白。这不是通配符，并不表示任何密码匹配。这意味着用户必须在不指定密码的情况下进行连接## 查看当前登录用户SELECT CURRENT_USER(); 访问控制阶段1 添加账号,分配权限和删除账号1234567891011创建用户授权GRANT ALL PRIVILEGES ON *.* TO &apos;fei&apos;@&apos;%&apos; IDENTIFIED BY &apos;123456&apos; WITH GRANT OPTION; FLUSH PRIVILEGES;撤销账户权限REVOKE ALL PRIVILEGES ON *.* FROM &apos;fei&apos;@&apos;%&apos;;FLUSH PRIVILEGES;删除账号DROP USER &apos;fei&apos;@&apos;%&apos;;FLUSH PRIVILEGES; 6.2.7添加帐户，分配权限和删除帐户 数据库备份和恢复1234567891011121314创建数据库指定数据库字符集utf8mb4 排序规则 utf8mb4_general_ci ; mysql8有些字符集在低版本mysql没有#使用mysqldump以SQL格式转储数据/data/server/mysql/bin/mysqldump -h127.0.0.1 -uvagrant -p --databases fei fei02 &gt;/data/web/mysql_dump/dump.sql./mysqldump -h127.0.0.1 -uvagrant -p --databases fei fei02 &gt;/data/web/mysql_dump/dump.sql#重新加载SQL格式备份./mysql -h127.0.0.1 -uvagrant -p &lt; /data/web/mysql_dump/dump.sql/data/server/mysql/bin/mysql -h127.0.0.1 -uvagrant -p &lt; /data/web/mysql_dump/dump.sqlsource /data/dump.sql ###这里没有&lt;符号source /data/web/mysql_dump/dump.sql 使用mysqldump以SQL格式转储数据 mysql查看二进制日志文件12#查看mysql二进制日志/data/server/mysql/bin/mysqlbinlog -d demodb binlog.000004 EXPLAIN12 EXPLAIN 输出格式 优化锁定操作12345SHOW STATUS LIKE &apos;Table%&apos;; #查看表上锁争用MyISAM 表锁LOCK TABLES t1 WRITE, temp_t1 WRITE;UNLOCK TABLES; 表锁定问题 字符集123456USE test;SELECT @@character_set_database, @@collation_database;utf8mb4：Unicode字符集的UTF-8编码，每个字符使用一到四个字节。utf8mb3：Unicode字符集的UTF-8编码，每个字符使用一到三个字节。utf8：别名 utf8mb3。 数据类型 mysql5.7.8 新类型 json123CREATE TABLE t1 (jdoc JSON);INSERT INTO t1 VALUES(&apos;&#123;&quot;key1&quot;: &quot;value1&quot;, &quot;key2&quot;: &quot;value2&quot;&#125;&apos;);SELECT JSON_OBJECT(&apos;key1&apos;, 1, &apos;key2&apos;, &apos;abc&apos;); 控制运算符 case if12345678910111213141516171819mysql&gt; SELECT CASE 1 WHEN 1 THEN &apos;one&apos; -&gt; WHEN 2 THEN &apos;two&apos; ELSE &apos;more&apos; END; -&gt; &apos;one&apos;mysql&gt; SELECT CASE 2 WHEN 1 THEN &apos;one&apos; -&gt; WHEN 2 THEN &apos;two&apos; ELSE &apos;more&apos; END; -&gt; &apos;two&apos; mysql&gt; SELECT CASE 3 WHEN 1 THEN &apos;one&apos; -&gt; WHEN 2 THEN &apos;two&apos; ELSE &apos;more&apos; END; -&gt; &apos;more&apos; -----------------mysql&gt; SELECT CASE WHEN 1&gt;0 THEN &apos;true&apos; ELSE &apos;false&apos; END; -&gt; &apos;true&apos; --------------mysql&gt; SELECT IF(1&gt;2,2,3); -&gt; 3 全文搜索功能12345678#自然语言全文搜索mysql&gt; SELECT * FROM articles WHERE MATCH (title,body) AGAINST (&apos;database&apos; IN NATURAL LANGUAGE MODE);#布尔全文搜索mysql&gt; SELECT * FROM articles WHERE MATCH (title,body) AGAINST (&apos;+MySQL -YourSQL&apos; IN BOOLEAN MODE); 全文搜索功能 show 语法1234SHOW COLUMNS FROM city; #显示列SHOW CREATE DATABASE test; #显示创建库语法SHOW CREATE TABLE student2; #显示创建表语法SHOW INDEX FROM test; #显示索引 innoDB 表移动或者复制123456方法一、 复制数据文件(冷备份) 01) 在新的库中新建和原来一样的表 , 在data目录下找到创建的表,删除 .ibd 文件 02) 执行: ALTER TABLE tbl_name DISCARD TABLESPACE; 03) 复制 .ibd 文件,到新刚才删除的位置 04) 执行 ALTER TABLE tbl_name IMPORT TABLESPACE; 告诉InnoDb使用新的.bd文件方法二、 导出和导入（热备份 mysqldump） innoDB 表移动或者复制 innodb 锁123456789101112131415共享锁(S锁) ShareLock排他锁(X锁) ExclusiveLock区别:如果事务T对数据A加上共享锁，则其他事务只能对A再加共享锁，不能加排它锁。只有事务T可以对A进行读取和修改，其他事务只能读取数据而不能修改数据。如果事务T对数据A加上排它锁，只有事务T可以对A进行读取和修改，其他任何事务都不能对A进行读取和修改 SHOW ENGINE INNODB STATUS #解除锁 SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCKS; #查看当前锁定的事务 SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCK_WAITS; #查看当前等锁的事务 SELECT * FROM INFORMATION_SCHEMA.INNODB_TRX; #查看下在锁的事务 kill 线程ID #杀死进程id（就是上面命令的trx_mysql_thread_id列） innodb处理死锁 主从复制123# 在主服务器上，您必须启用二进制日志记录并配置唯一的服务器ID# 在要连接到主服务器的每个从服务器上，必须配置唯一的服务器ID# 在读取二进制日志以进行复制时，为主服务器创建一个单独的用户 基于二进制文件复制 存储过程12345678910111213141516171819202122232425262728293031323334https://dev.mysql.com/doc/refman/5.7/en/stored-routines-syntax.htmlCREATE PROCEDURE CREATE FUNCTIONCALLDROP PROCEDUREDROP FUNCTIONALTER PROCEDUREALTER FUNCTION#一个库中不能出现2个相同的触发器#创建的触发器在数据库 INFORMATION_SCHEMA 的 TRIGGERS 表中可以看到#SELECT * FROM INFORMATION_SCHEMA.TRIGGERSmysql&gt; CREATE TABLE account (acct_num INT, amount DECIMAL(10,2));mysql&gt; CREATE TRIGGER ins_sum BEFORE INSERT ON account FOR EACH ROW SET @sum = @sum + NEW.amount;mysql&gt; SET @sum = 0;mysql&gt; INSERT INTO account VALUES(137,14.98),(141,1937.50),(97,-100.00);mysql&gt; SELECT @sum AS &apos;Total amount inserted&apos;;#查看创建的触发器mysql&gt; SELECT * FROM INFORMATION_SCHEMA.TRIGGERS WHERE TRIGGER_SCHEMA=&apos;test&apos; AND TRIGGER_NAME=&apos;ins_sum&apos; #查看创建触发器语法 mysql&gt; SHOW CREATE TRIGGER test.ins_sum #删除触发器mysql&gt; DROP TRIGGER test.ins_sum; 触发语法和示例 视图12345mysql&gt; CREATE TABLE t (qty INT, price INT);mysql&gt; INSERT INTO t VALUES(3, 50), (5, 60);mysql&gt; CREATE VIEW v AS SELECT qty, price, qty*price AS value FROM t;mysql&gt; SELECT * FROM v;mysql&gt; SELECT * FROM v WHERE qty = 5; 视图","tags":[]},{"title":"-drools 笔记","date":"2019-04-10T11:59:30.324Z","path":"2019/04/10/drools/drools01/","text":"逗号 comma1234567891011121314逗号字符用于分割约束,他具有隐含的 AND 连接语义// Person is at least 50 and weighs at least 80 kgPerson( age &gt; 50, weight &gt; 80 )// Person is at least 50, weighs at least 80 kg and is taller than 2 meter.Person( age &gt; 50, weight &gt; 80, height &gt; 2 )!!!但是逗号不能嵌入到复合约束表达式中,例如括号Person( ( age &gt; 50, weight &gt; 80 ) || height &gt; 2 ) // Do NOT do this: compile error// Use this insteadPerson( ( age &gt; 50 &amp;&amp; weight &gt; 80 ) || height &gt; 2 ) Comma separated AND 嵌套对象的分组访问器123一下2个等效, 注意不要丢了!!!点!!!Person( name == \"mark\", address.city == \"london\", address.country == \"uk\" )Person( name == \"mark\", address.( city == \"london\", country == \"uk\") ) Grouped accessors for nested objects 操作符优先级123456789101112131415(nested) property access . List/Map access [ ] constraint binding : multiplicative * / % additive + - shift &lt;&lt; &gt;&gt; &gt;&gt;&gt; relational &lt; &gt; &lt;= &gt;= instanceof equality == != bit-wise non-short circuiting AND &amp; bit-wise non-short circuiting exclusive OR ^ bit-wise non-short circuiting inclusive OR | logical AND &amp;&amp; logical OR || ternary ? : Comma separated AND , Operators priority 操作符优先级 。⌘ 基本Drools规则语言语法","tags":[]},{"title":"-Apache 压缩","date":"2019-04-02T12:43:44.453Z","path":"2019/04/02/apache/apache压缩/","text":"Apache 压缩 压缩 开启模块123LoadModule deflate_module modules/mod_deflate.soLoadModule headers_module modules/mod_headers.soLoadModule filter_module modules/mod_filter.so 压缩配置123456789101112131415161718192021222324252627&lt;IfModule mod_deflate.c&gt; #告诉浏览器内容进行压缩 # https://httpd.apache.org/docs/2.4/mod/mod_deflate.html#deflatecompressionlevel SetOutputFilter DEFLATE #压缩级别1--9,默认为6 # https://httpd.apache.org/docs/2.4/mod/mod_deflate.html#deflatecompressionlevel DeflateCompressionLevel 6 #不对那些进行压缩 # https://httpd.apache.org/docs/2.4/mod/mod_setenvif.html#setenvifnocase SetEnvIfNoCase Request_URI .(?:gif|jpe?g|png)$ no-gzip dont-vary SetEnvIfNoCase Request_URI .(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary SetEnvIfNoCase Request_URI .(?:pdf|mov|avi|mp3|mp4|rm)$ no-gzip dont-vary #对那些压缩 # https://httpd.apache.org/docs/2.4/mod/mod_filter.html#addoutputfilterbytype AddOutputFilterByType DEFLATE text/* AddOutputFilterByType DEFLATE application/ms* application/vnd* application/postscript application/javascript application/x-javascript AddOutputFilterByType DEFLATE application/x-httpd-php application/x-httpd-fastphp #解决一下兼容问题 # https://httpd.apache.org/docs/2.4/mod/mod_setenvif.html#browsermatch BrowserMatch ^Mozilla/4 gzip-only-text/html BrowserMatch ^Mozilla/4.0[678] no-gzip BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html&lt;/IfModule&gt;","tags":[]},{"title":"linux-vue vue-cli 使用","date":"2019-03-30T07:49:25.144Z","path":"2019/03/30/ubuntu/linux_ubuntu_vue/","text":"!!! node vue 在linux中使用注意环境变量,用户权限 本文的主要以vue3.0以上版本 12345npm install -g @vue/cli-service-global #全局安装vue create hello-world #创建项目(在linux中注意权限和环境变量)npm run serve #运行 oryarn serve #也可以运行 ornpx vue-cli-service serve #也可以运行 Vue CLI 官网","tags":[]},{"title":"linux -node 编译安装, 需要配置环境变量","date":"2019-03-27T12:04:00.255Z","path":"2019/03/27/ubuntu/linux_ubuntu_node/","text":"node 源码编译安装node123456wget https://nodejs.org/dist/v10.15.3/node-v10.15.3.tar.gztar -zxvf node-v10.15.3.tar.gzcd node-v10.15.3./configure --prefix=/data/server/node [有警告,先不用管]make [编译时间比较长,编译1个小时]make install 安装完测试,并创建软连接 1234567891011/data/server/node/bin/node -v #查看node版本/data/server/node/bin/npm -v #查看npm版本这时候输出 npm -v 没有,原因npm需要通过node来执行,所以解决方法有2种01) 创建软连接ln -sv /data/server/node/bin/node /usr/local/bin/nodeln -sv /data/server/node/bin/npm /usr/local/bin/npm02) 修改 vim /etc/profile 添加环境变量PATH=$PATH:/data/server/node/binexport PATH然后执行source /etc/profile 或者 ./profile 使其生效; 执行完后可以通过 echo $PATH 命令查看环境变量 二进制安装node123https://nodejs.org/dist/v10.15.3/node-v10.15.3-linux-x64.tar.xztar -xvf node-v10.15.3-linux-x64.tar.xz -C /data/server解压后可以直接使用,需要配置环境变量,方法同上 其他123456789101112131415161718npm config list #查看npm配置信息npm config edit #编辑配置信息npm config get cache #查看npm缓存目录npm config set cacat #设置缓存目录位置npm config get registry #获取配置使用的地址npm config set registry https://registry.npm.taobao.org #设为淘宝地址windows中显示配置文件位置: C:\\Users\\Administrator\\.npmrc ubuntu图中在用户: /home/fei/.npmrc原文件内容:registry=http://registry.cnpmjs.org/修改淘宝地址:registry=https://registry.npm.taobao.org----------淘宝nmp网址: https://npm.taobao.org/npm install -g cnpm --registry=https://registry.npm.taobao.org #安装配置cnpm","tags":[]},{"title":"ubuntu16 --svn03 编译安装后使用03","date":"2019-03-27T01:34:21.929Z","path":"2019/03/27/ubuntu/linux_ubuntu_svn_03/","text":"svn 多台服务器之间自动发布更新","tags":[]},{"title":"-tar  打包文件","date":"2019-03-01T08:03:37.297Z","path":"2019/03/01/ubuntu/linux_DDU_tar/","text":"首先要弄清两个概念：打包和压缩。打包是指将一大堆文件或目录变成一个总的文件；压缩则是将一个大的文件通过一些压缩算法变成一个小文件 命令格式1tar [选项] [参数] 选项1234567-C &lt;目录&gt;：这个选项用在解压缩，若要在特定目录解压缩，可以使用这个选项。-x或--extract或--get：从备份文件中还原文件-t或--list：列出备份文件的内容；-z或--gzip或--ungzip：通过gzip指令处理备份文件；-f&lt;备份文件&gt;或--file=&lt;备份文件&gt;：指定备份文件；-v或--verbose：显示指令执行过程；-j：支持bzip2解压文件； demo普通打包123tar -cvf aaa_ccc.tar aaa_bbb #仅打包不压缩tar -tvf aaa_ccc.tar #查看包里面文件tar -xvf aaa_ccc.tar -C /home/fei/web/ #解压到 /home/fei/web/ 目录下 以 gzip 压缩1234567tar -zcvf aaa_bbb.tar.gz aaa_bbb #打包后，以 gzip 压缩 tar -ztvf aaa_bbb.tar.gz #查看包里面文件tar -zxvf aaa_bbb.tar.gz -C /home/fei/web/ #解压到 /home/fei/web/ 目录下tar -xvf aaa_bbb.tar.gz -C /home/fei/web/ #没有参数z由于使用 gzip 压缩aaa_bbb.tar.gz 的文件,所以查看的时候aaa_bbb.tar.gz包内文件时,加上 z 这个参数tip: 在这里其实没有 z 这个参数有可以查看 以 bzip2 压缩123456tar -jcvf aaa_bbb.tar.bz2 aaa_bbb #打包后，以 bzip2 压缩 tar -jtvf aaa_bbb.tar.bz2 #查看包里面文件tar -jxvf aaa_bbb.tar.bz2 -C /home/fei/web/ #解压到 /home/fei/web/ 目录下tar -xvf aaa_bbb.tar.bz2 -C /home/fei/web/ #没有参数jtip: 在这里其实没有 j 这个参数有可以查看","tags":[]},{"title":"-maven  centos7","date":"2019-02-27T07:45:45.794Z","path":"2019/02/27/ubuntu/linux_ubuntu_maven/","text":"maven Binary方式安装使用安装maven之前区别系统中安装了 JDK, 12下载 maven http://39.137.67.79/mirror.bit.edu.cn/apache/maven/maven-3/3.6.0/binaries/apache-maven-3.6.0-bin.tar.gz 解压1tar -zxvf apache-maven-3.6.0-bin.tar.gz -C /data/server/ 修改环境变量12345vim /etc/profile#set mavenexport M2_HOME=/data/server/apache-maven-3.6.0export PATH=$PATH:$M2_HOME/bin 验证12source /etc/profile #使环境变量生效mvn -v maven source 方式安装使用","tags":[]},{"title":"linux -wc","date":"2019-02-11T07:25:12.680Z","path":"2019/02/11/ubuntu/linux_ubuntu_wc/","text":"Linux wc命令用于计算字数 ….. 1wc -l 统计文件行数","tags":[]},{"title":"-Apache 配置","date":"2019-02-01T03:57:55.894Z","path":"2019/02/01/apache/apache配置/","text":"Apache 配置.. httpd.conf 配置1234567891011121314151617181920212223242526272829303132&lt;VirtualHost *:80&gt; #官方文档 http://httpd.apache.org/docs/2.4/ #ServerAdmin webmaster@dummy-host.www.phpStudy.net DocumentRoot \"E:/selfweb/git_dev/test/\" ServerName fei.apache.test ServerAlias fei.apache.test #ErrorLog \"logs/dummy-host.www.phpStudy.net-error.log\" #CustomLog \"logs/dummy-host.www.phpStudy.net-access.log\" common &lt;Directory /&gt; #没有index文件显示目录 Options +Indexes +FollowSymLinks +ExecCGI #没有index不显示目录,禁止访问 #Options -Indexes +FollowSymLinks #是否禁用.htaccess 文件配置 AllowOverride All #默认index.php index.html DirectoryIndex index.html index.php Order allow,deny Allow from all Require all granted #404 重定向 #ErrorDocument 404 /test/404.html &lt;/Directory&gt;&lt;/VirtualHost&gt; 配置ssl,支持https 01123456编辑Apache根目录下 conf/httpd.conf 找到 LoadModule ssl_module modules/mod_ssl.soLoadModule socache_shmcb_module modules/mod_socache_shmcb.so和 Include conf/extra/httpd-ssl.conf去掉这3行前面的注释 配置ssl,支持https 02-11234567891011121314151617181920212223242526272829303132333435363738394041424344454647修改 httpd-ssl.conf 文件, a_public.crt a.key a_chain.crt 换成你对应的证书名字vim /data/server/apache/conf/extra/httpd-ssl.conf内容如下:&lt;VirtualHost _default_:443&gt; SSLProtocol all -SSLv2 -SSLv3 SSLCipherSuite HIGH:!RC4:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!EXP:+MEDIUM SSLHonorCipherOrder on SSLCertificateFile /data/server/apache/conf/extra/cert/a_public.crt SSLCertificateKeyFile /data/server/apache/conf/extra/cert/a.key SSLCertificateChainFile /data/server/apache/conf/extra/cert/a_chain.crt ServerName 你的域名:443 DocumentRoot \"/data/web/web01/\" &lt;Directory /data/web/web01/&gt; Options FollowSymlinks DirectoryIndex index.php Allow from all AllowOverride All Require all granted &lt;/Directory&gt; SSLEngine on &lt;FilesMatch \"\\.(cgi|shtml|phtml|php)$\"&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory \"/data/server/apache/cgi-bin\"&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; CustomLog \"/data/server/apache/logs/ssl_request_log\" \\ \"%t %h %&#123;SSL_PROTOCOL&#125;x %&#123;SSL_CIPHER&#125;x \\\"%r\\\" %b\"&lt;/VirtualHost&gt;############ 同时支持http 和 https 访问,需要修改vhost ####################vim /data/server/apache/conf/self_vhosts/vhost.conf &lt;VirtualHost *:80&gt; ServerName 你的域名 DocumentRoot \"/data/web/web01/\" &lt;Directory /data/web/web01/&gt; Options FollowSymlinks DirectoryIndex index.php Allow from all AllowOverride All Require all granted &lt;/Directory&gt;&lt;/VirtualHost&gt; 配置ssl,支持https 02-212345678910111213141516171819202122232425262728293031323334353637383940414243444546474849编辑Apache根目录下 conf/httpd.conf 找到 LoadModule ssl_module modules/mod_ssl.so和 Include conf/extra/httpd-ssl.conf去掉这2行前面的注释这个操作完成后可以修改 vim /data/server/apache/conf/self_vhosts/vhost.conf 文件&lt;VirtualHost *:80&gt; ServerName 你的域名 DocumentRoot \"/data/web/web01/\" &lt;Directory /data/web/web01/&gt; Options FollowSymlinks DirectoryIndex index.php Allow from all AllowOverride All Require all granted &lt;/Directory&gt;&lt;/VirtualHost&gt;&lt;VirtualHost _default_:443&gt; SSLProtocol all -SSLv2 -SSLv3 SSLCipherSuite HIGH:!RC4:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!EXP:+MEDIUM SSLHonorCipherOrder on SSLCertificateFile /data/server/apache/conf/extra/cert/a_public.crt SSLCertificateKeyFile /data/server/apache/conf/extra/cert/a.key SSLCertificateChainFile /data/server/apache/conf/extra/cert/a_chain.crt ServerName 你的域名:443 DocumentRoot \"/data/web/web01/\" &lt;Directory /data/web/web01/&gt; Options FollowSymlinks DirectoryIndex index.php Allow from all AllowOverride All Require all granted &lt;/Directory&gt; SSLEngine on &lt;FilesMatch \"\\.(cgi|shtml|phtml|php)$\"&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory \"/data/server/apache/cgi-bin\"&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; CustomLog \"/data/server/apache/logs/ssl_request_log\" \\ \"%t %h %&#123;SSL_PROTOCOL&#125;x %&#123;SSL_CIPHER&#125;x \\\"%r\\\" %b\"&lt;/VirtualHost&gt; apache 80 跳转到 4431234567891011&lt;VirtualHost *:80&gt; ServerName your.domain.com RewriteEngine on RewriteCond %&#123;SERVER_PORT&#125; !^443$ #所有 http:// 变为 https:// url的内容不会匹配 RewriteRule ^/?(.*)$ https://%&#123;SERVER_NAME&#125;/$1 [L,R] #所有 http:// 变为 https:// 保持url地址内容不变 RewriteRule ^.*$ https://%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [L,R] &lt;/VirtualHost&gt; Apache 正向代理12345678910111213141516171819&lt;virtualHost *:80&gt; ServerName 127.0.0.1:80 DocumentRoot /usr/local/apache2/htdocs/www &lt;Directory /usr/local/apache2/htdocs/www&gt; Options FollowSymLinks AllowOverride All Order allow,deny Allow from all &lt;/Directory&gt; ProxyRequests Off &lt;Proxy *&gt; Order deny,allow Allow from all &lt;/Proxy&gt; # 访问127.0.0.1/fei1/ 的时候 代理到 http://192.168.1.151/ # 注意这里的 / 不能多也不能少,要对应上 ProxyPass /fei1/ http://192.168.1.151/ ProxyPassReverse /fei1/ http://192.168.1.151/&lt;/VirtualHost&gt;","tags":[]},{"title":"-Apache 安装","date":"2019-02-01T03:55:40.173Z","path":"2019/02/01/apache/apache安装/","text":"apache 安装1)官方地址: http://httpd.apache.org/docs/2.4/install.html安装Apache 必须的源码包: [Apache, Apr,Apr-Util,Pcre],并且确认系统中已经安装了[gcc,gcc-c++,make,autoconf,automake], 2)centos系统中可以:1yum install -y gcc gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libpng libpng-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses curl openssl-devel gdbm-devel db4-devel libXpm-devel libX11-devel gd-devel gmp-devel readline-devel libxslt-devel expat-devel xmlrpc-c xmlrpc-c-devel 3),下载好源码1234wget https://mirrors.tuna.tsinghua.edu.cn/apache//httpd/httpd-2.4.37.tar.gzwget https://mirrors.cnnic.cn/apache//apr/apr-1.6.5.tar.gzwget http://mirror.bit.edu.cn/apache//apr/apr-util-1.6.1.tar.gzwget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.36/pcre-8.36.tar.gz 4).安装1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465centos中安装pcre: yum install -y pcre pcre-develubuntu中安装pcre: apt-get install libpcre3 libpcre3-dev#安装过程中缺少依赖自行安装,我的pcre已经用apt安装好了#groupadd deployer useradd -g apache apache #tar -zxvf apr-1.6.5.tar.gz -C /data/server/apache_component#tar -zxvf apr-util-1.6.1.tar.gz -C /data/server/apache_component#tar -zxvf pcre-8.36.tar.gz -C /data/server/apache_component#tar -zxvf httpd-2.4.37.tar.gz -C /data/server/apache_componenttar -zxvf apr-1.6.5.tar.gzcd apr-1.6.5./configure --prefix=/data/server/apache_component/apr-1.6.5makemake installtar -zxvf apr-util-1.6.1.tar.gzcd apr-util-1.6.1./configure \\--prefix=/data/server/apache_component/apr-util-1.6.1 \\--with-apr=/data/server/apache_component/apr-1.6.5makemake install##centos中少库 expat-devel##ubuntu中缺少 apt-get install libexpat-devtar -zxvf httpd-2.4.37.tar.gzcd httpd-2.4.37./configure \\--prefix=/data/server/apache \\--with-apr=/data/server/apache_component/apr-1.6.5 \\--with-apr-util=/data/server/apache_component/apr-util-1.6.1make make install##到这里已经安装完毕,下面配置Apachevim httpd.conf #修改配置ServerName www.test.com:80##Apache常用命令/data/server/apache/bin/apachectl -v #查看 Apache 版本/data/server/apache/bin/apachectl -V #大写V 查看 Apache 版本,安装路径等其他信息/data/server/apache/bin/apachectl -k start #参数k发送信号/data/server/apache/bin/apachectl -k stop/data/server/apache/bin/apachectl restart/data/server/apache/bin/apachectl configtest #检查配置文件是否正确/data/server/apache/bin/apachectl -t #检查配置文件是否正确/data/server/apache/bin/httpd -t #检查配置文件是否正确/data/server/apache/bin/apachectl -S #大写S 显示已解析的vhost设置/data/server/apache/bin/apachectl -help cat /data/server/apache/build/config.nice #查看apache编译参数ps -aux | grep httpd # 查看 apache 状态windows 中命令./httpd.exe -t #查看配置文件是否正确 &lt;Directory /data/www&gt; Deny from all #403 拒绝访问 #ErrorDocument 404 /test/404.html #404 重定向 #ErrorDocument 404 \"This is 404 page\" &lt;/Directory&gt; 5)自定义配置文件1Include conf/self_vhosts/*.conf 让普通用户可以启apache1234##用普通用户安装的时候cd /data/server/apache/binchown root httpd #chown root:www httpdchmod u+s httpd 强制 Apache 返回一个404状态码1234567Redirect 404 / #访问根目录显示404Redirect 500 / #访问根目录显示500&lt;Directory /data/www&gt; Deny from all #403 拒绝访问 #ErrorDocument 404 /test/404.html #404 重定向 #ErrorDocument 404 \"This is 404 page\" #400 显示错误字符串&lt;/Directory&gt; Apache 解析php123456789101112131415161718192021222324252627282930313233343536#方法一: PHP编译的时候使用--with-apxs2'--with-apxs2=/usr/local/apache/bin/apxs' #让Apache支持PHP#查看原来PHP的编译参数/data/server/php7/bin/php -i | grep configure#方法二,在Apache2.4以后支持FCGI方式在Apache的conf中添加自己的文件路径; Include conf/self_vhosts/*.conf&lt;VirtualHost *:80&gt; #ServerAdmin webmaster@localhost ServerName www.afei.com DocumentRoot /data/www #主要是这2个配置 ProxyRequests Off ProxyPassMatch ^/(.*\\.php(/.*)?)$ fcgi://127.0.0.1:9000/data/www/$1 &lt;Directory /data/www&gt; Options FollowSymlinks DirectoryIndex index.php AllowOverride All Require all granted &lt;/Directory&gt;&lt;/VirtualHost&gt;##需要在 conf/httpd.conf 文件中打开4个扩展,把下面这几个的注释都打开#LoadModule proxy_module modules/mod_proxy.so#LoadModule proxy_http_module modules/mod_proxy_http.so #LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so#LoadModule rewrite_module modules/mod_rewrite.so#方法三,解析PHP,需要Apache 2.4.9 以后&lt;FilesMatch \\.php$&gt; SetHandler \"proxy:fcgi://127.0.0.1:9000\"&lt;/FilesMatch&gt; 使用ip访问,骚气操作011234567891011121314151617#http://192.168.1.202/api/hello/world #后端PHP访问方式#http://192.168.1.202/test/dist/index.html #前端访问方式#/data/www/web/test/public 前端&lt;IfModule alias_module&gt; #解析php ProxyRequests Off ProxyPassMatch ^/(.*\\.php(/.*)?)$ fcgi://127.0.0.1:9000/data/www/test/public/$1 Alias /test \"/data/www/test/public\" #使用别名访问&lt;/IfModule&gt;&lt;Directory /data/www/test/public&gt; Options FollowSymlinks DirectoryIndex index.php Allow from all AllowOverride All Require all granted&lt;/Directory&gt; 使用ip访问,骚气操作01123456789101112131415161718192021在 conf/httpd.conf 文件中添加#解析PHP&lt;FilesMatch \\.php$&gt; SetHandler \"proxy:fcgi://127.0.0.1:9000\"&lt;/FilesMatch&gt;#访问方法 ip/index.php&lt;Directory \"/data/www/web/fsnh/api/trunk/public\"&gt; Options Indexes FollowSymLinks MultiViews AllowOverride all Require all granted&lt;/Directory&gt;#访问方法 ip/aaa/index.phpAlias /aaa \"/data/www/cfsh/CFSH/public\"&lt;Directory \"/data/www/cfsh/CFSH/public\"&gt; Options Indexes FollowSymLinks MultiViews AllowOverride all Require all granted&lt;/Directory&gt;","tags":[]},{"title":"-高并发解决方案","date":"2019-01-27T03:38:25.602Z","path":"2019/01/27/面试/高并发解决方案/高并发解决方案/","text":"QPS达到800 方案: CDN加速、负载均衡 QPS达到1000 方案: 静态HTML 缓存 QPS达到2000 方案:做业务分离、分布式存储 (这个时候文件访问锁都成为灾难) 方案处理 流量化: 防盗链处理 前端优化: 减少HTTP请求、添加一异步请求、启用浏览器缓存和文件压缩、CDN加速、简历独立图片服务器 服务端优化:页面静态化、并发处理 数据库优化: 数据库缓存、分库分表、分区操作、读写分离、负载均衡 Web服务器优化:负载均衡 流量化 — 防盗链实现方法:1nginx利用Referer头、nginx的nginx_http_accesskey_module 模块 前端优化 — 减少HTTP请求12345678HTTP连接产生的开销域名解析--&gt;TCP连接--&gt;发送请求--&gt;等待--&gt;下载资源--&gt;解析时间减少HTTP请求的方法1) 图片地图: (简单理解为一个图片上有多个链接)2) CSS精灵: (简单理解为,用css控制图片位置)3) 合并 js 和 css 脚本4) 图片使用 Base64编码减少页面请求 线程进程123单进程单线程: 一个人在一张桌子上吃饭单进程多线程: 多个人在同一张桌子上一起吃饭多进程单线程: 多个人在每个人自己的桌子上吃饭 ####","tags":[]},{"title":"-nginx","date":"2019-01-27T01:58:12.566Z","path":"2019/01/27/nginx/nginx_01/","text":"nginx 相关使用文章介绍 ——–飞- nginx——– 防盗链123456789101112location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$ &#123; # none 允许没有http_refer的请求资源 # blocked 允许不是 http://开头的,不带协议的请求访问资源 # *.test22.com 只允许指定域名访问 valid_referers none blocked *.test22.com; if ($invalid_referer) &#123; #return 403; #return 500; rewrite ^/ https://www.baidu.com/img/bd_logo1.png; &#125; expires 30d;&#125; 强制 Apache 返回一个404状态码12Redirect 404 / #访问根目录显示404Redirect 500 / #访问根目录显示500 访问不存在的页面重定向到首页1234if (!-e $request_filename) &#123; rewrite ^/(.*) /index.html redirect; break;&#125; 伪静态123456789location / &#123; try_files $uri $uri/ /index.php$is_args$args;&#125;location /backend &#123; try_files $uri $uri/ /backend/index.php$is_args$args;&#125;location /api &#123; try_files $uri $uri/ /api/index.php$is_args$args;&#125;","tags":[]},{"title":"ubuntu16 --svn01 源码编译安装","date":"2019-01-26T11:57:38.630Z","path":"2019/01/26/ubuntu/linux_ubuntu_svn_01/","text":"ubuntu16 系统通过源码编译安装 subversion-1.11.1 &amp;&amp; apt-get 安装 安装apr123456wget https://mirrors.cnnic.cn/apache//apr/apr-1.6.5.tar.gztar -zxvf apr-1.6.5.tar.gzcd apr-1.6.5./configure --prefix=/data/server/apache_component/apr-1.6.5makemake install 安装apr-util12345678wget http://mirror.bit.edu.cn/apache//apr/apr-util-1.6.1.tar.gztar -zxvf apr-util-1.6.1.tar.gzcd apr-util-1.6.1./configure \\--prefix=/data/server/apache_component/apr-util-1.6.1 \\--with-apr=/data/server/apache_component/apr-1.6.5makemake install 安装 scons1234567wget https://svwh.dl.sourceforge.net/project/scons/scons/3.0.1/scons-3.0.1.tar.gz[安装这个之前确保已经安装python环境 python --version ]tar -zxvf scons-3.0.1.tar.gzcd scons-3.0.1python setup.py install --prefix=/data/server/apache_component/scons[ ubuntu中可以使用 apt install scons ] 安装self12345678910111213141516171819202122### 注意 scons 使用的是 apt 安装还是 python 方式安装,这里会影响self安装wget https://www.apache.org/dist/serf/serf-1.3.9.tar.bz2tar -jxvf serf-1.3.9.tar.bz2cd serf-1.3.9/data/server/apache_component/scons/bin/scons \\PREFIX=/data/server/apache_component/self \\APR=/data/server/apache_component/apr-1.6.5/bin/apr-1-config \\APU=/data/server/apache_component/apr-util-1.6.1/data/server/apache_component/scons/bin/scons installcp /data/server/apache_component/self/lib/libserf-1.so* /usr/local/lib///--------------------如果 scons 使用了 apt install scons 安装 ,这里self安装也要变scons \\PREFIX=/data/server/other_component/self \\APR=/data/server/other_component/apr-1.6.5/bin/apr-1-config \\APU=/data/server/other_component/apr-util-1.6.1scons installcp /data/server/other_component/self/lib/libserf-1.so* /usr/local/lib/ SQLite 不需要安装,下载下来即可使用1234567891011121314wget https://www.sqlite.org/2015/sqlite-amalgamation-3081101.zipwget https://www.sqlite.org/2015/sqlite-amalgamation-3081101.zipunzip sqlite-amalgamation-3081101.zip解压sqlite-amalgamation包，将解压文件拷贝到subversion解压后的源码根目录中去cp -avr sqlite-amalgamation-3081101 subversion-1.11.1拷贝过去后重命名为sqlite-amalgamation,否则一直会报错 [最后使用的名字为sqlite-amalgamation]mv sqlite-amalgamation-3081101/ sqlite-amalgamation###扩展,官方解释https://www.sqlite.org/amalgamation.htmlhttps://github.com/mirek/sqlite-amalgamation Just copy the amalgamation into your source directory and compile it along with the other C code files in your project. 安装 subversion1234567891011121314151617181920212223wget http://mirrors.shu.edu.cn/apache/subversion/subversion-1.11.1.tar.gzwget http://mirrors.shu.edu.cn/apache/subversion/subversion-1.11.1.tar.gztar -zxvf subversion-1.11.1.tar.gzcd subversion-1.11.1./configure \\--prefix=/data/server/svn \\--with-apr=/data/server/apache_component/apr-1.6.5 \\--with-apr-util=/data/server/apache_component/apr-util-1.6.1 \\--with-serf=/data/server/apache_component/self \\--with-lz4=internal \\--with-utf8proc=internal [ 按照报错提示添加 相应的信息 --with-lz4=internal --with-utf8proc=internal ][!!! 警告,这里不能使用--with-sqlite ,一定要将sqlite-amalgamation拷贝到subversion-1.11.1根目录,并且使用的名字为 sqlite-amalgamation !!!]--with-sqlite=/home/fei/server/sqlite-amalgamation-3081101makemake install 测试1/data/server/svn/bin/svn --version #查看版本信息 安装完后使用svn一直报错1234567891011121314编译安装完后使用svn命令一直报错 ./svn --version./svn: error while loading shared libraries: libserf-1.so.1: cannot open shared object file: No such file or directory解决01办法先使 apt install subversion 安装subversion ,然后 卸载 sudo apt-get remove --purge subversion再次使用 编译安装好的 /data/server/svn/bin/svn --version #查看版本信息 没有报错解决02[未亲自测试]cd /etc/ld.so.conf.d/vim libexpat.conf [或者 vi user-libs.conf]添加 /usr/local/lib 或者 添加 /data/server/other_component/self/lib执行 ldconfig 使配置生效, ldconfig -v 查看 检出一个项目测试123svn checkout svn://192.168.1.11/repo/nh_rbac/aaa_test接下来数据账号密码svn checkout svn://192.168.1.11/repo/test/aaa_test /data/fei #检出到指定目录 ubuntu16 中检出项目12345svn checkout svn://192.168.1.104/repository/test使用一次后账号密码保存位置: /home/fei/.subversion/清除密码: /home/fei/.subversion/auth/svn.simple 删除这个svn.simple 文件夹即可.下次会自从生成这个文件 ubuntu16 系统通过 apt-get 安装svn检查是否安装 svn,并安装12345678910svn svn help //--svn帮助svn --version //--svn版本svnserve --version //--svn server版本卸载命令(–purge 选项表示彻底删除改软件和相关文件)sudo apt-get remove --purge subversion开始安装apt install subversion","tags":[]},{"title":"ubuntu16 --svn02 编译安装后使用","date":"2019-01-26T11:57:38.630Z","path":"2019/01/26/ubuntu/linux_ubuntu_svn_02/","text":"编译安装后使用 创建svn 版本库12mkdir /data/www/svn_repositorysvnadmin create /data/www/svn_repository/repository01 #创建一个新的版本仓库 设置访问权限123456vim conf/svnserve.conf #设置读写,启用密码文件路径 这三个的注释去掉!!!! 注意这三行前面不要有空格,否则后面会一直找不到仓库,报错anon-access = readauth-access = writepassword-db = passwd 添加用户12vim conf/passwd 账户密码内容为: fei_svn=123456 添加访问用户123456vim conf/authz内容如下:admin_groups=fei_svn #用户fei_svn属于admin_groups权限组@admin_groups=rw #admin_groups权限组有读和写*=r #其他用户具只能读 添加子目录访问权限1234567891011vim conf/authz #修改完不需要重启svn,内容如下:admin_groups=fei_svn #用户fei_svn属于admin_groups权限组dev_groups=dafei #用户dafei属于dev_groups权限组[/]@admin_groups = rw[/da]@dev_groups=rw #da 这个子目录需要用最高权限账号在根目录新建,保存后才可以用非管理账号checkout 启动svn12345678svnserve -d -r /data/server/svn/ #-d 后台启动; -r 指定根目录启动 !!!注意这里的路径ps -aux | grep svnserve #查看svnserve是否启动killall svnserve #停止服务#-d 后台启动; -r 指定根目录启动 !!!注意这里的路径/data/server/svn/bin/svnserve -d -r /data/www/svn_repository/repository01ps -aux | grep svnserve #查看svnserve是否启动killall svnserve #停止服务 windows 中访问svn版本库1234#vim conf/svnserve.conf 这个配置文件修改的时候有空格这时候这里会一直练不上#报错信息: unable to connect to a repository url line 19:Option expectedsvn://192.168.1.104/ #访问版本控制 实现svn 代码仓库与web线上代码同步01123456### svn 仓库和代码在同一台服务器svn 服务器中代码目录 /data/www/svn_reposwindow中代码目录 E:\\selfweb\\git_dev\\zzz首先在svn服务器上checkout检出一份,检出到/data/www/svn_repos 目录/data/server/svn/bin/svn checkout svn://192.168.42.128/ /data/www/svn_repos 实现svn 代码仓库与web线上代码同步02123456789101112131415161718### svn 仓库和代码在同一台服务器建立同步脚本cd /data/www/svn_repository/repository01/hookscp post-commit.tmpl post-commitchmod 755 post-commitvim post-commit添加如下代码:(SVN_PATH svn安装目录; WEB_PATH项目目录; svn账号密码)export LANG=en_US.UTF-8SVN_PATH=/data/server/svn/bin/svn WEB_PATH=/data/www/svn_repos $SVN_PATH update $WEB_PATH --username fei_svn --password 123456重启svn 服务killall svnserve #停止服务ps -aux | grep svnserve #查看svnserve是否启动/data/server/svn/bin/svnserve -d -r /data/www/svn_repository/repository01 使用过svn后,账户保存位置1234567linux中/root/.subversion/auth [ cd ~/.subversion/auth] windows中C:\\Documents and Settings\\Administrator\\Application Data\\Subversion\\auth账户信息保存在 svn.simple 文件下 常用命令12345678910/data/server/svn/bin/svn help //--svn帮助/data/server/svn/bin/svn --version #查看版本信息/data/server/svn/bin/svnserve --version //--svn版本信息/data/server/svn/bin/svn checkout svn://192.168.42.128/test./svn checkout svn://192.168.1.11/repo/test /data/www/test #指定检出目录位置svn add index.php #添加svn commit -m \"这里是信息\" index.php #提交svn update #更新","tags":[]},{"title":"Yii2  -model层不为人知的秘密","date":"2019-01-26T01:05:09.325Z","path":"2019/01/26/Yii2/Yii2_model/","text":"属性在 PHP 中，类的成员变量也被称为属性。它们是类定义的一部分， 用来表现一个实例的状态（也就是区分类的不同实例）。 在具体实践中，常常会想用一个稍微特殊些的方法实现属性的读写 123456789101112131415161718192021222324//demo, 场景举例:有一个 int 型时间戳,需要显示为格式化的时间,每次格式化太麻烦//在 model 层中class Book extends \\yii\\db\\ActiveRecord public function getTimeText() &#123; return date('Y/m/d', $this-&gt;time); &#125; public function setTimeText($value) &#123; return $this-&gt;time = strtotime($value); &#125;&#125;//在 controller 层中class BookController extends Controller&#123; public function actionView($id) &#123; $model = Book::findOne($id); print_r($model-&gt;TimeText); //格式化的时间 print_r($model-&gt;time); //原来的 int 时间 &#125;&#125;","tags":[]},{"title":"linux -useradd","date":"2019-01-20T07:44:02.968Z","path":"2019/01/20/ubuntu/linux_ubuntu_useradd/","text":"查看所有用户和用户组,添加删除用户 ……………………………. 查看所有用户123456/etc/group 文件包含所有组/etc/shadow 和 /etc/passwd 系统存在的所有用户名tail -3 /etc/grouptail -3 /etc/shadowtail -3 /etc/passwd 创建用户12345678910useradd -m -s /bin/bash fei_04 ###可以远程登录,也可以执行shell命令 常用useradd fei_02 #创建用户passwd fei_02 #设定密码tail -4 /etc/group #查看用户这样创建的用户登录后不能使用 ll,touch 等其他命令useradd -m fei_03 #创建一个有家目录,远程登录后不能执行命令useradd -m -s /bin/bash fei_04 ##可以远程登录,也可以执行shell命令useradd -s /sbin/nologin fei_05 #创建一个没有家目录,且不能登录的用户 删除用户123userdel fei_03 #如果用户还在登录状态,会出现无法删除,此时要先强制用户退w #查看当前登录用户pkill -kill -t pts/20 # 强制退出用户","tags":[]},{"title":"-mysql -sql other02","date":"2019-01-12T05:43:20.310Z","path":"2019/01/12/mysql/sql_other02/","text":"MySQL 的复制原理及负载均衡MySQL主从复制工作原理:123在主库上把数据更改记录到二进制日志从库将主库的日志复制到自己的中继日志从库读取中继日志中的事件,将其重放到从库数据库中 MySQL主从复制解决的问题:1234数据分布: 随意停止或开始复制,并在不同地理位置分布数据库备份负载均衡:降低单个服务器的压力高可用和故障切换: 帮助应用程序避免单点失败升级测试:可使用更高版本的MySQL作为从库 SQL查询处理的安全方案123451) 使用预处理语句放置SQL注入2)写入数据库的数据要进行特殊字符的转义3)查询错误信息不要反悔给用户,将错误记录到日志PHP端尽量使用PDO对数据库进行相关操作,PDO拥有对预处理语句很好的支持,MySQLi也有,但是可扩展性不如PDO,效率高于PDO MySQL的其他安全设置123456781)定期做备份2)不给用户root权限,合理分配权限3)关闭远程访问数据库权限4)修改root口令,不用默认口令,使用较复杂的口令5)删除多余的用户6)改变root用户名称7)限制一般用户浏览其他库8)限制用户对数据库的访问权限","tags":[]},{"title":"-kill -pkill -killall 终结进程","date":"2019-01-06T04:08:27.517Z","path":"2019/01/06/ubuntu/linux_ubuntu_kill/","text":"-kill -pkill -killall 终结进程 kill 发送指定信号到相应进程12345678910111213ps -aux | grep vimkill 3453#demoroot@ubuntu:/# ps -aux | grep vimfei 3452 0.0 0.9 62048 9344 pts/19 S+ 20:11 0:00 vim hello.phpfei 3453 0.0 0.8 60916 8252 pts/18 S+ 20:11 0:00 vim aaa.txtroot 3468 0.0 0.1 21292 1028 pts/1 S+ 20:14 0:00 grep --color=auto vimroot@ubuntu:/# kill 3453root@ubuntu:/# ps -aux | grep vimfei 3452 0.0 0.9 62048 9344 pts/19 S+ 20:11 0:00 vim hello.phproot 3472 0.0 0.0 21292 880 pts/1 S+ 20:15 0:00 grep --color=auto vimroot@ubuntu:/# pkill 按照进程名称杀死进程12345678910111213141516171819ps -aux | grep vimpkill vim#demoroot@ubuntu:/# ps -aux | grep vimfei 3497 1.6 0.9 62048 9328 pts/19 S+ 20:20 0:00 vim hello.phpfei 3499 1.0 0.8 60916 8368 pts/18 S+ 20:20 0:00 vim aaa.txtroot 3501 0.0 0.1 21292 1012 pts/1 S+ 20:20 0:00 grep --color=auto vimroot@ubuntu:/# pkill vimroot@ubuntu:/# ps -aux | grep vimroot 3504 0.0 0.0 21292 912 pts/1 S+ 20:20 0:00 grep --color=auto vimroot@ubuntu:/# ### 特殊demo, 踢某个用户下线(who w 查看登录用户)pkill -kill -t pts/17pkill -9 -t pts/17fuser -k /dev/pts/17echo “你被管理员踢出了” &gt; /dev/pts/17 &amp;&amp; fuser -k /dev/pts/17","tags":[]},{"title":"ubuntu -path 环境变量篇 -composer 测试","date":"2018-12-29T08:52:40.501Z","path":"2018/12/29/ubuntu/ubuntu_path环境变量_composer/","text":"源码编译完的包,很多时候在任何目录时访问不到的,这时候需要添加环境变量,或者通过链接的形式,链接到系统默认的PATH目录下的一个,这篇文章就是介绍一下这2中添加环境变量的方式; !!!修改系统环境变量后,要退出当前用户重新登录后才可以看到效果; 本章介绍修改文件配置环境变量, 软链接配置环境变量参考node篇 demo背景,采用composer测试,前提编译安装完php 安装composer1curl -sS https://getcomposer.org/installer | /data/server/php7/bin/php 配置环境变量方法 01123456789101112#第一种方式,放到系统默认PATH环境变量目录下cp /test/composer.phar /usr/local/bin/composer 或者mv /test/composer.phar /usr/local/bin/composer###扩展,使用 echo $PATH 可以看到当前的环境变量内容,系统默认的环境变量包括:root@ubuntu:/test# echo $PATH/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/gamesroot@ubuntu:/test# ##查看环境变量 01) echo $PATH02) evn 配置环境变量方法 02 , 使用 PHP 来测试,系统 centos712345678PHP编译安装后的目录: /data/server/php/binvim /etc/profile#centos中配置PHP环境变量:修改 /etc/profile 配置环境变量PATH=$PATH:/data/server/php/binexport PATH然后执行source /etc/profile 或者 ./profile 使其生效; 执行完后可以通过 echo $PATH 命令查看环境变量 添加多个环境变量1234567891011以node 和 PHP 为例修改 /etc/profile 配置环境变量PATH=$PATH:/data/server/node-v10.15.3-linux-x64/bin:/data/server/php7/binexport PATH然后执行source /etc/profile 或者 ./profile 使其生效; 执行完后可以通过 echo $PATH 命令查看环境变量执行 node -vnpm -vphp -vnode 和 PHP 都生效 其他–环境变量顺序1234正常情况下修改/etc/profile在图形界面中需要再修改~/.bashrc #针对当前用户 composer 命令12345678910111213141516171819202122232425composer config -gl #查看composer全局设置composer config --list -g #查看composer全局设置composer require monolog/monolog #安装monologcomposer require monolog/monolog:\"1.24.0\" #安装monolog指定版本composer require \"monolog/monolog:1.24.0\" #安装monolog指定版本composer install composer updatecomposer dump-autoload #添加自定义后文件执行设置镜像地址:1) 全局配置composer config -g repo.packagist composer https://repo.packagist.org2) 当前项目使用 [ 去掉参数-g ] composer config repo.packagist composer https://repo.packagist.orgrepo.packagist.org ip地址: 139.99.121.122 新加坡packagist.org ip地址: 139.99.121.122 新加坡其他镜像地址composer-proxy.jp packagist.jphttps://packagist.laravel-china.org [laravel 中国镜像]https://mirrors.aliyun.com/composer [阿里云 composer 镜像]https://opsx.alibaba.com/mirror [这里可以看到阿里云的所有镜像] composer官方安装文档","tags":[]},{"title":"-算法02","date":"2018-12-23T10:46:17.798Z","path":"2018/12/23/面试/算法/算法_02/","text":"01). 输出 1 到 100 之间的素数(质数) 用一个数分别去除2到这个数之间的所有数,如果被整除就是素数 123456789101112131415// 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 //分析: 用一个数分别去除2到这个数之间的所有数,如果被整除就是素数for ($i = 1; $i &lt;= 100; $i++) &#123; $k = 0; //判断开始和结束的值是否也是素数 for ($j = 1; $j &lt;= $i; $j++) &#123; if ($i % $j == 0) &#123; $k++; &#125; &#125; if ($k == 2) &#123; echo $i; echo \"&amp;nbsp;&amp;nbsp;\"; &#125;&#125; 02). 打印出所有的 “水仙花数 “1234567891011121314// 打印出所有的 \"水仙花数 \"， 三位的水仙花数共有4个：153，370，371，407// 所谓 \"水仙花数 \"是指一个三位数，其各位数字立方和等于该数本身。// 例如：153是一个 \"水仙花数 \"，因为 1^3 + 5^3+ 3^3 = 153for ($i = 100; $i &lt; 1000; $i++) &#123; $hunderds = floor($i / 100); $tens = floor($i / 10) % 10; $ones = floor($i % 10); $temp = pow($hunderds, 3) + pow($tens, 3) + pow($ones, 3); if ($temp == $i) &#123; echo $i; echo \"&amp;nbsp;\"; &#125;&#125; 03). 正整数分解质因数12345678910111213141516171819// 将一个正整数分解质因数。例如：输入90,打印出90=2*3*3*5。// 分析:// 对n进行分解质因数，应先找到一个最小的质数k，然后按下述步骤完成：// (1)如果这个质数恰等于n，则说明分解质因数的过程已经结束，打印出即可。// (2)如果n&lt;&gt;k，但n能被k整除，则应打印出k的值，并用n除以k的商,作为新的正整数n,重复执行第一步。// (3)如果n不能被k整除，则用k+1作为k的值,重复执行第一步$n = 90;echo $n . '=';for ($i = 2; $i &lt; $n + 1; $i ++)&#123; while ($n % $i == 0 &amp;&amp; $n != $i) &#123; $n /= $i; echo $i . \"*\"; &#125; if ($n == $i) &#123; echo $i; break; &#125;&#125; 04). 三目条件嵌套12345678910// 利用条件运算符的嵌套来完成此题：// 学习成绩&gt; =90分的同学用A表示，// 60-89分之间的用B表示，// 60分以下的用C表示。$score = 89;$grade = $score &gt;= 90 ? 'A' : ($score &gt;= 60 &amp;&amp; $score &lt;= 89 ? 'B' : \"C\");echo $grade; 05). 输入两个正整数m和n，求其最大公约数和最小公倍数123456789101112131415161718192021222324252627282930313233343536// 题目：输入两个正整数m和n，求其最大公约数和最小公倍数// 在循环中，只要除数不等于0，用较大数除以较小的数，// 将小的一个数作为下一轮循环的大数，取得的余数作为下一轮循环的较小的数，// 如此循环直到较小的数的值为0，// 返回较大的数，此数即为最大公约数，最小公倍数为两数之积除以最大公约数。// 这种方法叫做: 辗除法function f($x, $y)&#123; if ($x &lt; $y) &#123; $temp = $x; $x = $y; $y = $temp; &#125; while ($y!=0) &#123; if ($x==$y)&#123; return $x; &#125;else&#123; $k = $x % $y; $x = $y; $y = $k; &#125;; &#125; return $x;&#125;$a = 21; $b = 24;$m = f($a, $b); //最大公约数$n = $a * $b / $m; //最小公倍数echo '最大公约数为: ' . $m.\"&amp;nbsp;&amp;nbsp;\";echo '最小公倍数为: ' . $n.\"&amp;nbsp;&amp;nbsp;\";//------------------------------------------------------------// 方法2, 使用php自带的函数,获取最小公约数$gcd = gmp_gcd(\"21\", \"24\");echo gmp_strval($gcd) . \"\\n\"; 06) 求s=a+aa+aaa+aaaa+aa…a的值1234567891011121314151617181920// 题目：求s=a+aa+aaa+aaaa+aa...a的值，其中a是一个数字。// 例如2+22+222+2222+22222(此时共有5个数相加)，几个数相加有键盘控制//$num 数字 $count 几个数相加function fun($num, $count)&#123; $temp = 0; $sum = 0; for ($i = 0; $i &lt; $count; $i++) &#123; $temp = $temp + $num; //获取需要相加的数字 $sum = $sum + $temp; //数字相加 $num = $num * 10; &#125; return $sum;&#125;// echo fun(2, 2); //2+22=24// echo fun(2, 3); //2+22+222=246// echo fun(2, 4); //2+22+222+2222=2468echo fun(2, 5); //2+22+222+2222+22222=24690 07) 完数12345678910111213141516171819// 题目：一个数如果恰好等于它的因子之和，这个数就称为 \"完数 \"。// 例如6=1＋2＋3.编程 找出1000以内的所有完数function fun()&#123; echo \"1到1000的完数有: \"; for ($i = 1; $i &lt; 1000; $i++) &#123; $t = 0; for ($j = 1; $j &lt;= $i / 2; $j++) &#123;//$i/2 减少循环次数 for ($j = 1; $j &lt; $i ; $j++) &#123; if ($i % $j == 0) &#123; $t = $t + $j; &#125; &#125; if ($t == $i) &#123; echo($i .\" \"); &#125; &#125;&#125;fun(); //1到1000的完数有: 6 28 496 08) 四个数字组成三位数1234567891011121314151617181920212223242526// 题目：有1、2、3、4四个数字，// 能组成多少个互不相同且无重复数字的三位数 都是多少function fun()&#123; $x = 0; $y = 0; $z = 0; $arr = []; $_count = 0; //统计个数 for ($x = 1; $x &lt; 5; $x++) &#123; for ($y = 1; $y &lt; 5; $y++) &#123; for ($z = 1; $z &lt; 5; $z++) &#123; if ($x != $y &amp;&amp; $y != $z &amp;&amp; $x != $z) &#123; $_count++; // echo $x * 100 + $y * 10 + $z.'&lt;br/&gt;'; array_push($arr, $x * 100 + $y * 10 + $z); &#125; &#125; &#125; &#125; array_push($arr, ['count' =&gt; $_count]); return $arr;&#125;print_r(fun()); 09) 某年某月某日,第几天12345678910111213141516171819202122232425262728293031// 输入某年某月某日，判断这一天是这一年的第几天function fun($year,$month,$day)&#123; switch ($month) &#123; case 1:$sum=0;break; case 2:$sum=31;break; case 3:$sum=59;break; case 4:$sum=90;break; case 5:$sum=120;break; case 6:$sum=151;break; case 7:$sum=181;break; case 8:$sum=212;break; case 9:$sum=243;break; case 10:$sum=273;break; case 11:$sum=304;break; case 12:$sum=334;break; default:printf(\"data error\");break; &#125; $sum = $sum + $day; if ($year % 400 == 0 || ($year % 4 == 0 &amp;&amp; $year % 100 != 0)) &#123; //判断是不是闰年 $leap = 1; &#125; else &#123; $leap = 0; &#125; if ($leap == 1 &amp;&amp; $month &gt; 2) &#123; //如果是闰年切月份大于2,总天数应该加一天 $sum++; &#125; return $sum;&#125;print_r(fun(2019, 03, 1)); 10) 三元运算符及比较3个数的大小,输出最大的数123456789101112131415161718192021222324252627282930313233// 三元运算符及比较3个数的大小,输出最大的数function fun($a,$b,$c)&#123; $d= $a &gt; $b ? ($a &gt; $c ? $a : $c) : ($b &gt; $c ? $b : $c); return $d;&#125;echo fun(1, 2, 3);//-----------------------------------// 比较3个数的大小, 并从小到大输出function fun($i, $j, $k)&#123; $x = 0; if ($i &gt; $j) &#123; $x = $i; $i = $j; $j = $x; &#125; if ($i &gt; $k) &#123; $x = $i; $i = $k; $k = $x; &#125; if ($j &gt; $k) &#123; $x = $j; $j = $k; $k = $x; &#125; return $i . \" \" . $j . \" \" . $k;&#125;echo fun(10, 0, 3);","tags":[]},{"title":"--login 登录系统后常用命令","date":"2018-12-09T06:39:43.949Z","path":"2018/12/09/ubuntu/linux_ubuntu_login/","text":"介绍： 登录新系统后常用命令 uname 打印系统相关信息123456uname uname -a #显示全部信息uname -m #系统类型uname -nuname -runame -s top1234top 然后按 shift + p ,按照进程处理器占用率排序然后按 Shift + m, 按照进程内存占用率排序然后按 Shift + e, 切换单位K,M,G直接切换 ps 当前系统的进程状态12345678910#选项很多,列举2个demops -aux | grep phpps -aux | nginxps -aux | moreps -aux | head -3[root@localhost ~]# ps aux |head -1; ps aux | grep httpdUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND[root@localhost ~]# ps -aux | grep httpd free 查看内存1free -h #以K，M，G为单位，提高信息的可读性 pmap 报告进程的内存映射关系123456pidof #查找指定名称的进程id号demo: pidof nginxpmap #查看进程的内存印象信息demo: pmap -d 6953pmap 最后一行的值mapped 表示该进程映射的虚拟地址空间大小，也就是该进程预先分配的虚拟内存大小，即ps出的vszwriteable/private 表示进程所占用的私有地址空间大小，也就是该进程实际使用的内存大小 shared 表示进程和其他进程共享的内存大小 vmstat 显示虚拟内存状态12345678910111213141516171819202122232425262728293031vmstat字段说明:Memory（内存）swpd: 使用虚拟内存大小，如果swpd的值不为0，但是SI，SO的值长期为0，这种情况不会影响系统性能。free: 空闲物理内存大小。buff: 用作缓冲的内存大小。cache: 用作缓存的内存大小，如果cache的值大的时候，说明cache处的文件数多，如果频繁访问到的文件都能被cache处，那么磁盘的读IO bi会非常小。/proc/sys/vm/drop_caches 这个文件的值是0--3之间的数字,代表不同改的含义0：不释放（系统默认值）1：释放页缓存2：释放dentries和inodes3：释放所有缓存-------- 释放缓存 --------sync #!!!将所有未写的系统缓冲区写到磁盘中!!!echo 1 &gt; /proc/sys/vm/drop_caches #仅清除pagecache(页面)缓存echo 2 &gt; /proc/sys/vm/drop_caches #清除dentries(目录缓存)和inodeecho 3 &gt; /proc/sys/vm/drop_caches #清除pagecache(页面缓存)，dentries(目录缓存)和inode或者(这和上面是一样的效果)sync sysctl -w vm.drop_caches=1sysctl -w vm.drop_caches=2sysctl -w vm.drop_caches=3系统重启后 /proc/sys/vm/drop_caches 里面的值会自己改为0 df 显示磁盘分区上的可使用的磁盘空间1df -h #以K，M，G为单位，提高信息的可读性 du : 与df不同的是,du命令是对文件和目录磁盘使用的空间查看 du 对文件和目录磁盘使用的空间查看123du -h #以K，M，G为单位，提高信息的可读性du -s #显示目录中文件总和du -sh 123du -h --max-depth=0du -h --max-depth=1du -h --max-depth=2 uptime 查看系统运行时间、用户数、负载12345uptimeroot@ubuntu:/home/fei/www# uptime 18:24:03 up 1:52, 1 user, load average: 0.39, 0.69, 0.37root@ubuntu:/home/fei/www# netstat 系统中网络状态信息(端口) [lsof -i:22 ]123456netstat -lntp # 查看所有监听端口 netstat -antp # 查看所有已经建立的连接, 查看端口是否被应用#查看占用端口22的进程netstat -lntp | grep 22lsof -i:22 crontab 计划任务1crontab -l # 查看当前用户的计划任务服务 w 显示已经登陆系统的用户列表，并显示用户正在执行的指令1234567wroot@ubuntu:/# w #当前登录用户 fei, fei_02 19:46:31 up 1:19, 2 users, load average: 0.18, 0.10, 0.03USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATfei tty7 :0 18:27 1:19m 7.79s 0.58s /sbin/upstart -fei_02 pts/18 192.168.47.1 19:46 12.00s 0.00s 0.00s -sh who 显示目前登录系统的用户信息1234root@ubuntu:/home/fei# whofei tty7 2019-01-05 18:27 (:0)fei_02 pts/17 2019-01-05 22:05 (192.168.47.1)root@ubuntu:/home/fei# write 终端给登录用户发消息123456write fei_02 pts/17ctrl+c 或者 ctrl + d 结束或者:echo “你被管理员踢出了” &gt; /dev/pts/17fuser -k /dev/pts/17 fuser 踢用户下线12fuser -k /dev/pts/17 #使用 w 或者 who 可查看在线用户echo “你被管理员踢出了” &gt; /dev/pts/17 &amp;&amp; fuser -k /dev/pts/17 #发送消息并踢下线 其他12","tags":[]},{"title":"vagrant_03 --VirtualBox --硬盘扩容","date":"2018-11-30T09:17:22.583Z","path":"2018/11/30/centos/vagrant_03_VirtualBox_硬盘扩容/","text":"vagrant 初始的 box 硬盘空间只有 10G,安装 mysql8 就不够用 :( ,下面介绍给主硬盘空间扩容, 操作平台 windows7, box[ubuntu18] 添加环境变量为了接下来方便操作在 windows 中添加 virtualbox 的环境变量 [ 因为下面会多次用到 vboxmanage 命令 ] 12!!! 备份要扩容的文件, 或者全部备份!! vbox , vbox-prev 配置文件要备份 记录要扩容的硬盘的原始信息1234567vboxmanage showhdinfo ubuntu-bionic-18.04-cloudimg.vmdk--------------------------------------------------------$ vboxmanage showhdinfo ubuntu-bionic-18.04-cloudimg.vmdkUUID: 5d02ba81-6f7e-4a8e-8e1b-eadbb30d11d4Parent UUID: base..... 开始扩容12345678910111213141516171819202122232425262728#克隆成 vdi 文件vboxmanage clonehd \"ubuntu-bionic-18.04-cloudimg.vmdk\" \"new-ubuntu-bionic-18.04-cloudimg.vdi\" --format vdi#扩容为 30Gvboxmanage modifyhd \"new-ubuntu-bionic-18.04-cloudimg.vdi\" --resize 30720#转化为原来的 vmdk 格式VBoxManage clonehd \"new-ubuntu-bionic-18.04-cloudimg.vdi\" \"new-ubuntu-bionic-18.04-cloudimg.vmdk\" --format vmdk#查看新 vmdk 信息,记录uuid vboxmanage showhdinfo new-ubuntu-bionic-18.04-cloudimg.vmdk$ vboxmanage showhdinfo new-ubuntu-bionic-18.04-cloudimg.vmdkUUID: f6b42381-fde2-43c2-bcab-3e37731caa9aParent UUID: base--------------------------------------------------#[ del,ren 命令只能在 cmd 或 powershell 中执行]#删除需要扩容的 vmdk del ubuntu-bionic-18.04-cloudimg.vmdk#将扩容后的 vmdk 重命名为原来的文件名ren new-ubuntu-bionic-18.04-cloudimg.vmdk ubuntu-bionic-18.04-cloudimg.vmdk--------------------------------------------------D:\\soft_position\\VirtualBox_linux\\ubuntu18_default_1543569229538_92064&gt; del ubuntu-bionic-18.04-cloudimg.vmdkD:\\soft_position\\VirtualBox_linux\\ubuntu18_default_1543569229538_92064&gt; ren new-ubuntu-bionic-18.04-cloudimg.vmdk ubuntu-bionic-18.04-cloudimg.vmdk 修改 配置文件 uuid12345# 手动修改,图形界面修改都可以ubuntu18_default_1543569229538_92064.vboxubuntu18_default_1543569229538_92064.vbox-prev这2个文件中旧的 uuid 5d02ba81-6f7e-4a8e-8e1b-eadbb30d11d4全部替换为新的 uuid f6b42381-fde2-43c2-bcab-3e37731caa9a 扩容成功","tags":[]},{"title":"-mysql -sql other","date":"2018-11-26T03:59:00.857Z","path":"2018/11/26/mysql/sql_other/","text":"mysql 简单整理 group by ; group_concat 1234567891011121314151617181920SELECT * FROM student_01 GROUP BY `name`;SELECT *,GROUP_CONCAT(name) FROM student_01 GROUP BY `name`;+----+------+---------+-------+| id | name | kecheng | score |+----+------+---------+-------+| 1 | 张三 | 语文 | 81 || 3 | 李四 | 语文 | 76 || 5 | 王五 | 语文 | 81 |+----+------+---------+-------++----+------+---------+-------+--------------------+| id | name | kecheng | score | GROUP_CONCAT(name) |+----+------+---------+-------+--------------------+| 1 | 张三 | 语文 | 81 | 张三,张三 || 3 | 李四 | 语文 | 76 | 李四,李四 || 5 | 王五 | 语文 | 81 | 王五,王五,王五 |+----+------+---------+-------+--------------------+ int (3) int (5) 区别,是否需要零填充12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#没有使用零填充 init(3) CREATE TABLE `test` ( `id` int(3) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;mysql&gt; select * from test;+----+------+| id | name |+----+------+| 1 | 许褚 || 2 | 郭嘉 || 3 | 贾诩 |+----+------+#使用零填充 init(3) zerofill CREATE TABLE `test` ( `id` int(3) unsigned zerofill NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;mysql&gt; select * from test;+-----+------+| id | name |+-----+------+| 001 | 许褚 || 002 | 郭嘉 || 003 | 贾诩 |+-----+------+3 rows in set (0.00 sec)#使用零填充 init(5) zerofill CREATE TABLE `test` ( `id` int(5) unsigned zerofill NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;mysql&gt; select * from test;+-------+------+| id | name |+-------+------+| 00001 | 许褚 || 00002 | 郭嘉 || 00003 | 贾诩 |+-------+------+3 rows in set (0.00 sec) mysql 存储引擎1234567891011#InnoDB表引擎通过一些机制和工具支持真真的热备份支持奔溃后的安全恢复支持行级锁支持外键#MyISAM表引擎5.1版本之前,MyISAM是默认的存储引擎拥有全文索引、压缩、 空间函数不支持事务和行级锁,不支持奔溃后的安全恢复表存储在两个文件,MYD和MYI mysql 锁1234567891011121314151617181920212223当多个查询同一时刻进行数据修改时,就会产生并发控制的问题, 共享锁(读锁) 、排他锁(写锁)#共享锁(读锁)共享的,不堵塞,多个用户可以同时读取一个资源,互不干扰#排他锁(写锁)排他的,一个写锁会阻塞一塔的写锁和读锁,这样可以值允许一个人写进行写入,防止其他用户读取正在写入的资源#demo共享锁(读锁)select * from test; lock table test read; #共享锁unlock TABLES; #解锁update test set name=\"贾诩_update\" where id=03; #排他锁 执行完lock加锁后,update 结束后及时执行解锁操作lock tables test write;update test set name=\"贾诩_update\" where id=03;unlock TABLES;在排他锁执行期间.在当前窗口其他SQL是不能执行的,#通过进程id, kill 掉锁show processlist; #查看锁状态kill id #杀掉等待sqlshow OPEN TABLES where In_use &gt; 0; #查看是否有在锁表 123456粒度锁#表锁系统性能开销最小,会锁定整张表,MyISAM 使用表锁#行锁最大程度地支持并发处理,但是也带来了最大的的锁开销,InnoDb 实现行级锁 12#Mysql 存储过程使用场景,通过处理把封装在容易使用的单元中,简化复杂的操作,保证数据的一致性 mysql 索引1234567891011121314#索引类型: 普通索引(index 另一个名字normal)、唯一索引(unique)、全文索引(fulltext)、空间索引(SPATIAL)ALTER TABLE `test`.`test` ADD INDEX `id_score_score2`(`id`, `score`, `score2`);ALTER TABLE `test`.`test` ADD UNIQUE INDEX `id_score_score2`(`id`, `score`, `score2`);ALTER TABLE `test`.`test` ADD FULLTEXT INDEX `id_score_score2`(`id`, `score`, `score2`);ALTER TABLE `test`.`test` ADD SPATIAL INDEX `id_score_score2`(`id`, `score`, `score2`);SHOW INDEX FROM test #查看表索引 mysql 连接查询12#自己关联自己查询select * from test a1 inner join test a2 on a1.score=a2.score2 数据库优化查找分析查询速度慢的原因 ↓ ↑优化查询过程中的数据访问 ↓↓ ↑优化长难查询语句 ↓↓ ↑优化特定类型的查询语句 ↓↓ ↑↑查找分析查询速度慢的原因 1234分析SQL查询慢的方法 记录慢查询日志 分析查询日志,不要直接打开慢日志进行分析, 这样比较浪费时间和经理,可以使用pt-query-digest工具进行分析 1234使用show profile set profiling=1;开启,服务器上执行的所有语句会检测消耗的时间,存到临时表中 show profiles show profile for query 临时表ID 123使用show status show status 会返回一些计数器,show global status查看服务器级别的所有计数 有时候根据这些计数,可以猜测出那些操作代价较高或者消耗时间多 12使用show processlist 观察是否有大量线程处于不正常的状态护着特征 12使用explain 分析单条SQL语句 123- 访问数据太多导致查询性能下降- 确定应用程序是否存在检索大量超过需要的数据,可能是太多行或列- 确认MySQL服务器是否存在分析大量不必要的数据行 ↑↑ 优化查询过程中的数据访问 12345避免使用如下SQL语句 - 查询不需要的记录,使用limit解决 多表关联返回全部列,指定A.id,A.name,B.age - 总是取出全部列,select * 会让优化器无法完成索引覆盖扫描的优化 - 重复查询相同的数据,可以缓存数据,下次直接读取缓存 1234567是否在扫描额外的记录 - 使用explain来进行分析,如果发现查询需要扫描大量的数据大只返回少数的行, 可以通过以下技巧去优化: -- 使用索引覆盖扫描,吧所有用的列都放在索引中, 这样存储引擎不需要返回表获取对应行就可返回结果 -- 改变数据库和表结构,修改数据表范式 -- 重写SQL语句,让优化器可以以更优的方式进行执行查询 ↑↑ 优化长难语句查询语句 12345678切分查询 将一个大的查询分为多个小的相同的查询: 一次行删除1000万的数据要比一次删除一次1万更加损耗服务器开销, [可先先删除一万暂停一会儿在删除一万]其他:一个复杂查询还是多个简单查询??? MySQL内部每秒能扫描内存中上百万行数据,相比之下,相应数据给客户端就压慢很多 使用尽可能少的查询是好的,但是有时将一个大的查询分解为多个小的查血是很有必要的 1234567分辨关联查询 可以将一条关联语句分解成多条SQL来执行,好处: 让缓存的效率更高 执行单个查询可以减少锁的竞争 在应用层做关联可以更加容易对数据进行拆分, 查询效率会有大幅提升 较少冗余记录查询 ↑↑ 优化特定类型的查询 123456优化 count() 查询 count(*)中的*会忽略所有的列,直接统计所有列数,因此不要使用count(别名) MyISAM中,没有任何where条件非常快 可以使用explain查询近似值,用近似值代替count(*), 增加汇总表 使用缓存 123优化关联查询 确定on或者using子句的列上有索引 确保group by 和 order by 中只有一个表中的列,这样MySQL才有可能使用索引 12优化子查询 尽可能使用关联查询代替 1234优化group by 和 distinct 这两种查询可使用索引来优化,是最有效的优化方法 关联查询中,使用表示列进行分组的效率会更高 如果不需要order by ,进行group by 时使用order by NUll,MySQL不会进行文件排序 12345678优化limit分页 01) limit 便宜量大的时候,查询效率较低,可以记录上次查询的最大id 下次查询的时候直接根据该id来查询 02) limit 数据量问题 select `id`, `name` from `user` where `status` = 1 order by `id` desc limit 10 上面这条SQL如果表中的数据量大的时候,status 为 1的数据不够10表,这条SQL会全表扫描 修改后SQL为:(添加范围) select `id`, `name` from `user` where id&gt;788008 AND `status` = 1 order by `id` desc limit 10 12优化union查询 union all 的效率高于union 综上, 数据库优化: 先找原因定位低效SQL语句,然后根据SQL语句坑你低效的原因做排查,先从索引着手,如果索引没有问题,考虑以上几个方面,数据库访问的问题,长难度语句的问题还是一些特定类型优化的问题","tags":[]},{"title":"--redis key 设计技巧","date":"2018-11-17T13:36:50.812Z","path":"2018/11/17/centos/redis_key_设计技巧/","text":"redis key 设计技巧第一段 表名转化为key的前缀,如 book: tag:第二段 放置用于分区 key 的字段—对于的 mysql 中的主键的列名,如 id userid第三段 放置主键的值,如1 2 3 4 a b c第四段,写要储存的列名 123456789101112131415161718192021222324第一段 表名转化为key的前缀,如 book: tag:第二段 放置用于分区 key 的字段---对于的 mysql 中的主键的列名,如 id userid 第三段 放置主键的值,如1 2 3 4 a b c第四段,写要储存的列名用户表 user , 转换为 key-value 存储 +----+----------+----------+-----------+| id | username | password | email |+----+----------+----------+-----------+| 1 | 张三 | 123456 | 1@qwq.com || 2 | 李四 | 123456 | 2@qq.com |+----+----------+----------+-----------+127.0.0.1:6379&gt; set user:id:1:username zhangsan127.0.0.1:6379&gt; set user:id:1:password 123456127.0.0.1:6379&gt; set user:id:1:email 1@qwq.com127.0.0.1:6379&gt; set user:id:2:username lisi127.0.0.1:6379&gt; set user:id:2:password 123456127.0.0.1:6379&gt; set user:id:2:email 2@qq.com127.0.0.1:6379&gt; keys user*127.0.0.1:6379&gt; keys user:id* mysql 弊端1234567891011121314151617181920212223242526272829303132333435#book 表 tags 表DROP TABLE IF EXISTS `book`;CREATE TABLE `book` ( `bookid` int(10) unsigned NOT NULL AUTO_INCREMENT, `title` char(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL, PRIMARY KEY (`bookid`)) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;DROP TABLE IF EXISTS `tags`;CREATE TABLE `tags` ( `tid` int(10) unsigned NOT NULL AUTO_INCREMENT, `bookid` int(11) DEFAULT NULL, `content` char(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL, PRIMARY KEY (`tid`)) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;#------------------- 测试数据 ---------------INSERT INTO `book` VALUES (&apos;5&apos;, &apos;PHP圣经&apos;);INSERT INTO `book` VALUES (&apos;6&apos;, &apos;ruby实战&apos;);INSERT INTO `book` VALUES (&apos;7&apos;, &apos;mysql 运维&apos;);INSERT INTO `book` VALUES (&apos;8&apos;, &apos;ruby服务端编程&apos;);INSERT INTO `tags` VALUES (&apos;10&apos;, &apos;5&apos;, &apos;PHP&apos;);INSERT INTO `tags` VALUES (&apos;11&apos;, &apos;5&apos;, &apos;WEB&apos;);INSERT INTO `tags` VALUES (&apos;13&apos;, &apos;6&apos;, &apos;ruby&apos;);INSERT INTO `tags` VALUES (&apos;14&apos;, &apos;7&apos;, &apos;database&apos;);INSERT INTO `tags` VALUES (&apos;15&apos;, &apos;8&apos;, &apos;ruby&apos;);INSERT INTO `tags` VALUES (&apos;16&apos;, &apos;8&apos;, &apos;server&apos;);INSERT INTO `tags` VALUES (&apos;12&apos;, &apos;6&apos;, &apos;WEB&apos;);# 查询:即有 web 标签又有 PPH 标签,要用连接查询 select t1.bookid from tags as t1 inner join tags as t2 on t1.bookid=t2.bookid where t1.content=&apos;PHP&apos; and t2.content=&apos;WEB&apos;; # 如果在查有其他标签 web php ruby ,关联的又要多了","tags":[]},{"title":"-crontab 定时任务","date":"2018-11-12T02:07:33.810Z","path":"2018/11/12/centos/crontab_定时任务/","text":"crontabcrontab 文件说明,每个用户都会生成一个自己的 crontab 文件,位于 /var/spool/cron 目录下查看 crontab 详情 cat /etc/crontab 12345678910111213141516171819[root@localhost cron]# cat /etc/crontabSHELL=/bin/bashPATH=/sbin:/bin:/usr/sbin:/usr/binMAILTO=root# For details see man 4 crontabs# Example of job definition:# .---------------- minute (0 - 59)# | .------------- hour (0 - 23)# | | .---------- day of month (1 - 31)# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat# | | | | |# * * * * * user-name command to be executed[root@localhost cron]# ls /var/spool/cronroot #root 用户fei #飞用户 crontab 命令1234567891011121314151617181920sudo apt-get install cron/sbin/service crond start //启动服务/sbin/service crond stop //关闭服务/sbin/service crond restart //重启服务/sbin/service crond reload //重新载入配置/sbin/service crond status //查看服务状态 systemctl start crond.servicesystemctl stop crond.servicesystemctl restart crond.servicesystemctl reload crond.servicesystemctl status crond.service//-----------------------------------------------crontab -u //设定某个用户的cron服务，一般root用户在执行这个命令的时候需要此参数crontab -l //列出某个用户cron服务的详细内容crontab -r //删除没个用户的cron服务crontab -e //编辑某个用户的cron服务 Demo123456789101112#每隔一分钟执行一次*/1 * * * * php /crontab_test/index.php#每小时的第一分,执行1 * * * * php /crontab_test/index.php----------------------------------------------#每隔2小时执行一次; 从整点开始计数0 */2 * * * sh /fei/test.sh#每天的第2小时执行一次0 2 * * * sh /fei/test.sh------------------------ !!!注意这种错误写法 ------#每隔一分钟执行一次* */1 * * * sh /fei/test.sh demo test.sh12345678d1=`date +%Y-%m-%d-%H:%M:%S`echo \" $d1. [ 0 */2 * * * sh /fei/test.sh ] \" &gt;&gt; /fei/ccc.txtd1=`date +%Y-%m-%d-%H:%M:%S`echo \" $d1. [ 0 2 * * * sh /fei/test.sh ] \" &gt;&gt; /fei/ccc.txtd1=`date +%Y-%m-%d-%H:%M:%S`echo \" $d1. [ * */1 * * * sh /fei/test.sh ] \" &gt;&gt; /fei/ccc.txt","tags":[]},{"title":"-观察者模式","date":"2018-11-09T12:42:41.393Z","path":"2018/11/09/面试/设计模式/index_04_观察者模式/","text":"当对象间存在一对多关系时，则使用观察者模式（Observer Pattern）。比如，当一个对象被修改时，则会自动通知它的依赖对象。观察者模式属于行为型模式。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687// ------------PHP 实现观察者模式// php5中提供观察者 observer 与被观察者 subject 的接口// @link http://php.net/manual/zh/class.splsubject.php// @link http://php.net/manual/zh/class.splobjectstorage.phpclass user implements SplSubject &#123; // attach() detach() notify() PHP自带 public function attach(SplObserver $observer) &#123; // TODO: Implement attach() method. $this-&gt;observers-&gt;attach($observer); &#125; public function detach(SplObserver $observer) &#123; // TODO: Implement detach() method. $this-&gt;observers-&gt;detach($observer); &#125; public function notify() &#123; // TODO: Implement notify() method. $this-&gt;observers-&gt;rewind(); while ($this-&gt;observers-&gt;valid()) &#123; $observer = $this-&gt;observers-&gt;current(); $observer-&gt;update($this); // 参数 $this-&gt;observers-&gt;next(); &#125; &#125; //-------------------------------------------- public $lognum; public $hobby; protected $observers = null; public function __construct($hobby) &#123; $this-&gt;lognum = rand(1, 10); $this-&gt;hobby = $hobby; $this-&gt;observers = new SplObjectStorage(); &#125; public function login() &#123; // 操作 session... $this-&gt;notify(); &#125;&#125;class security implements SplObserver&#123; public function update(SplSubject $subject) &#123; // TODO: Implement update() method. if ($subject-&gt;lognum &lt; 3) &#123; echo '这是第 ' . $subject-&gt;lognum . ' 次安全登录 '; &#125;else&#123; echo '这是第' . $subject-&gt;lognum . ' 次安全登录,异常 '; &#125; &#125;&#125;class ad implements SplObserver&#123; public function update(SplSubject $subject) &#123; // TODO: Implement update() method. if ($subject-&gt;hobby == 'sports')&#123; echo ' 台球英锦赛门票预订 '; &#125;else&#123; echo ' 好好学习,天天向上 '; &#125; &#125;&#125;// 实施观察$user = new user('sports');$user-&gt;attach(new security());$user-&gt;attach(new ad());$user-&gt;login();","tags":[]},{"title":"-适配器模式","date":"2018-11-09T12:42:41.393Z","path":"2018/11/09/面试/设计模式/index_05_适配器模式/","text":"将一个类的接口转换成客户希望的另外一个接口。适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。 123456789101112131415161718192021222324252627282930313233343536373839// 适配器模式 -------- 其实平时一直在使用,没有起个名字, 呵呵呵// 服务器端的代码class weather&#123; public static function show() &#123; $today = ['temperature' =&gt; 25, 'wind' =&gt; 7, 'sun' =&gt; 'sunny']; return serialize($today); &#125;&#125;// ========= 客户端调用 ==========$weather = unserialize(weather::show());echo '温度: ', $weather['temperature'], '&lt;br&gt;';echo '风力: ', $weather['wind'], '&lt;br&gt;';echo '阳光: ', $weather['sun'], '&lt;br&gt;';// 来了一批手机上的 java 客户端,不认识 PHP 的串行化后的字符串,怎么办?// 把服务器端的代码改了?? ---旧的客户端又会受影响???// 增加一个适配器class AdapterWeather extends weather&#123; public static function show() &#123; $today = parent::show(); $today = unserialize($today); $today = json_encode($today); return $today; &#125;&#125;// ===== 客户端调用 ======$todayWeather = AdapterWeather::show();$todayWeather = json_decode($todayWeather, true);echo '温度: ', $weather['temperature'], '&lt;br&gt;';echo '风力: ', $weather['wind'], '&lt;br&gt;';echo '阳光: ', $weather['sun'], '&lt;br&gt;';","tags":[]},{"title":"-桥接模式","date":"2018-11-09T12:42:41.393Z","path":"2018/11/09/面试/设计模式/index_06_桥接模式/","text":"将抽象部分与实现部分分离，使它们都可以独立的变化。 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586// 桥接模式 bridge// 论坛给用户发消息,可以是站内短息,email,手机abstract class info&#123; protected $send = null; public function __construct($send) &#123; $this-&gt;send = $send; &#125; abstract public function msg($content); public function send($to, $content) &#123; $content = $this-&gt;msg($content); $this-&gt;send-&gt;send($to, $content); &#125;&#125;class zn&#123; public function send($to, $content) &#123; echo ' 站内给 ', $to, ' 内容是: ', $content; &#125;&#125;class email&#123; public function send($to, $content) &#123; echo ' email给 ', $to, ' 内容是: ', $content; &#125;&#125;class sms&#123; public function send($to, $content) &#123; echo ' sms给 ', $to, ' 内容是: ', $content; &#125;&#125;//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++class commonInfo extends info&#123; public function msg($content) &#123; // TODO: Implement msg() method. return ' 普通 ' . $content; &#125;&#125;class warnInfo extends info&#123; public function msg($content) &#123; // TODO: Implement msg() method. return ' 紧急 ' . $content; &#125;&#125;class dangerInfo extends info&#123; public function msg($content) &#123; // TODO: Implement msg() method. return ' 特急 ' . $content; &#125;&#125;// 用站内发普通消息$commonInfo = new commonInfo(new zn());$commonInfo-&gt;send('小飞飞', 'hello world');echo '&lt;br&gt;';// 用手机发特急信息$dangerInfo = new commonInfo(new sms());$dangerInfo-&gt;send('飞', '这是手机信息');","tags":[]},{"title":"-多态","date":"2018-11-09T12:42:41.377Z","path":"2018/11/09/面试/设计模式/index_01多态/","text":"多态满足三个条件: 子类继承父类 子类重写父类 父类引用指向子类 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// 多态 动物(猫,狗) 猫吃鱼,牛吃草abstract class Animal&#123; abstract function eat();&#125;class Cat extends Animal&#123; function eat() &#123; // TODO: Implement eat() method. echo ' 猫吃鱼 '; &#125;&#125;class Dog extends Animal&#123; function eat() &#123; // TODO: Implement eat() method. echo ' 牛吃草 '; &#125;&#125;class Client&#123; // java 中 foo(Animal $animal) ,声明 cat 和 dog 的父类 animal ,只能传递 animal 的子类 // public function foo(Animal $animal) public function foo($animal) &#123; $animal-&gt;eat(); &#125;&#125;$catClient = new Client();$catClient-&gt;foo(new Cat());$dogClietn = new Client();$dogClietn-&gt;foo(new Dog());// 如果在 class Client 中这样写 public function foo(Animal $animal)// 下面的就会报错class Pig&#123; public function eat() &#123; echo \" 猪飞到上天 \"; &#125;&#125;$pigClient = new Client();$pigClient-&gt;foo(new Pig()); 设计模式参考地址: 设计模式01 设计模式02","tags":[]},{"title":"-工厂方法","date":"2018-11-09T12:42:41.377Z","path":"2018/11/09/面试/设计模式/index_02_工厂方法/","text":"工厂方法定义一个创建对象的接口，让其子类自己决定实例化哪一个工厂类，工厂模式使其创建过程延迟到子类进行。 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586// 工厂方法interface db&#123; function conn();&#125;// 解决简单工厂中在扩展 其他数据库问题,// 比如新增 oracle 数据库 (开闭原则:对于修改是封闭,对于扩展是开放)interface Factory&#123; function createDB();&#125;//服务端开发(不知道将会被谁调用)class dbmysql implements db&#123; public function conn() &#123; // TODO: Implement conn() method. echo \" 连接上Mysql \"; &#125;&#125;class dbsqlite implements db&#123; public function conn() &#123; // TODO: Implement conn() method. echo \" 连接上了sqlite \"; &#125;&#125;class mysqlFactory implements Factory&#123; function createDB() &#123; // TODO: Implement createDB() method. return new dbmysql(); &#125;&#125;class sqliteFactory implements Factory&#123; function createDB() &#123; // TODO: Implement createDB() method. return new dbsqlite(); &#125;&#125;// ===== 客户端开始 ====$mysql_factory = new mysqlFactory();$mysql_create = $mysql_factory-&gt;createDB();$mysql_create-&gt;conn();$sqlite_factory = new sqliteFactory();$sqlite_create = $sqlite_factory-&gt;createDB();$sqlite_create-&gt;conn();// 新增 oracle 数据库// 现在要在服务器端添加 oracle 类class dboracle implements db&#123; function conn() &#123; // TODO: Implement conn() method. echo \"连接上 oracle 数据库\"; &#125;&#125;class oracleFactory implements Factory&#123; function createDB() &#123; // TODO: Implement createDB() method. return new dboracle(); &#125;&#125;$oracle_factory = new oracleFactory();$oracle_create = $oracle_factory-&gt;createDB();$oracle_create-&gt;conn();","tags":[]},{"title":"-单例模式","date":"2018-11-09T12:42:41.377Z","path":"2018/11/09/面试/设计模式/index_03_单例模式/","text":"单例模式( 三私一公 ) 私有的构造方法( 防止类被多次实例化 ) 私有的克隆方法( 防止类被多次克隆 ) 私有的静态属性( 保存类的实例 ) 公有的静态方法( 访问这个类 ) 1234567891011121314151617181920212223242526272829303132// 单例模式 singletonclass singleton&#123; private static $ins = null; public static function getIns() &#123; if (self::$ins == null) &#123; self::$ins = new self(); &#125; return self::$ins; &#125; // 封锁多次 new private function __construct() &#123; &#125; // 封锁克隆 clone private function __clone() &#123; &#125;&#125;$s1 = singleton::getIns();$s2 = singleton::getIns();if ($s1 === $s2) &#123; //是一个对象 echo \"是一个对象\";&#125; else &#123; echo \"不是一个对象\";&#125;","tags":[]},{"title":"-centos 中开机自启","date":"2018-11-09T12:37:58.667Z","path":"2018/11/09/centos/开机自启/","text":"systemctl 设置开机启动123yum install nginx # 安装nginx 做开机启动测试systemctl enable nginx.service # 设为开机启动systemctl disable nginx.service # 停止开机启动 修改 rc.local 设置为开机启动123456789101112### /etc/rc.local 和 /etc/rc.d/rc.local 修改那个都行,我这里修改 /etc/rc.d/rc.local[root@localhost vagrant]# locate rc.local/etc/rc.local/etc/rc.d/rc.local[root@localhost vagrant]#在 /etc/rc.d 目录下,修改 rc.local ,添加执行命令,比如 mkdir /fei_03 创建一个名字叫 fei_03 的目录; 然后 chmod +x /etc/rc.d/rc.local##### ---- 温馨提示,请注意 rc.local 文件里面有个提示如下, # Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure# that this script will be executed during boot.","tags":[]},{"title":"-算法01","date":"2018-10-31T12:08:55.667Z","path":"2018/10/31/面试/算法/算法/","text":"01). 羊生羊一种羊, 第一年生一只小羊, 第四年生生一只小羊, 第五年死 20年后有多少只羊 12345678$arr = [1, 0, 0, 0, 0];for ($i = 1; $i &lt;= 20; $i++) &#123; $tmp = $arr[1] + $arr[3]; array_unshift($arr, $tmp); array_pop($arr);&#125;print_r($arr);echo array_sum($arr); 02). 猴子选大王一群猴子排成一圈，按1,2,…,n依次编号。然后从第1只开始数，数到第m只,把它踢出圈，从它后面再开始数，再数到第m只，在把它踢出去…，如此不停的进行下去，直到最后只剩下一只猴子为止，那只猴子就叫做大王。要求编程模拟此过程，输入m、n, 输出最后那个大王的编号。用程序模拟该过程 123456789101112131415161718function monkey($n ,$m)&#123; $arr = range(1,$n); //构造数组 array(1,2,3,4,5,6,7,8); $i = 0; //设置数组指针 while(count($arr)&gt;1)&#123; //遍历数组，判断当前猴子是否为出局序号，如果是则出局，否则放到数组最后 if(($i+1) % $m ==0) &#123; unset($arr[$i]); &#125; else &#123; //array_push() 函数向第一个参数的数组尾部添加一个或多个元素（入栈），然后返回新数组的长度。 array_push($arr ,$arr[$i]); //本轮非出局猴子放数组尾部 unset($arr[$i]); //删除 &#125; $i++; &#125; return $arr;&#125;print_r(monkey(10,4)); 03). 10 进制; 8进制; 16进制 ; 2 进制12345678910111213141516171819202122232425262728293031323334/** * 生活中常用10进制 * 计算机中常用2进制,8进制,16进制 */// 10 进制echo 123; echo \"&lt;br&gt;\"; //从右到左3个位,分别是以1顶1,以1顶10,以1顶100echo 100 * 1 + 10 * 2 + 1 * 3; echo \"&lt;br&gt;\";// 8 进制echo 0123; echo \"&lt;br&gt;\"; //从做到右3个位,分别是以1顶1,以1顶8,以1顶64echo 64 * 1 + 8 * 2 + 3; echo \"&lt;br&gt;\";echo 027; echo \"&lt;br&gt;\";echo 8 * 2 + 7; echo \"&lt;br&gt;\";//16进制 0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F// A、B、C、D、E、F 不去分大小写echo 0x123; echo \"&lt;br&gt;\"; //从左到右3个位,分别是1顶1,以1顶16,以1顶256echo 256 * 1 + 16 * 2 + 3; echo \"&lt;br&gt;\";// 2 进制, PHP 目前不支持直接表示// 从右到左,分别以1顶1,顶2,顶4,顶8.........../** * 10 进制 2 进制 * 5 0000 0101 * 255 1111 1111, 128+64+32+16+8+4+2+1 * -1 1111 1111 * 像上面8个1,到底理解成255,还是理解成-1 * 这个取决于程序 * 比如在 mysql 中 ,int 则理解为 -1 ,unsigned int理解为255 */// 为什么 程序员总是分不清万圣节和圣诞节? 因为 Oct 31=Dec 25 04). 8瓶水,其中1瓶有毒,那小白鼠做试验,药效发挥需要2小时1234567891011121314151617181920212223242526// 8瓶水,其中1瓶有毒,拿小白鼠做试验,药效发挥需要2小时,最少需要几只老鼠,只能试一次// 分析:// 2 个小时后,小白鼠,只有2种状态: 死/活// 2只小白鼠,有4中组合状态;// n只小白鼠有2^n 次方组合状态// 一共有8瓶药水,最多需要8中状态,就可以区分// 3只老鼠,组合8种状态// 因此理论上与3只老鼠就可以//// 思路:// 把8瓶药水分成两堆,让一只老鼠在其中一堆里面喝水,如果死了,毒药就在这堆里面,// 反之,毒药就在另外一堆里面, 然后// 把有毒药的那一堆分成2堆,让第2只老鼠在其中一堆里喝,如果喝死毒药就在这堆里面,// 反之,毒药就在另外一堆里面, 然后// 把有毒要的那一堆再分成2堆,让第三只老鼠喝就能知道毒药在几号里//// 解答:// 1代表活着,0代表死// 毒药: 1 2 3 4 5 6 7 8// 白鼠1: 0 0 0 0 1 1 1 1// 白鼠2: 0 0 1 1 0 0 1 1// 白鼠3: 0 1 0 1 0 1 0 1// // 白鼠一死, 毒药在 1 2 3 4// 白鼠二死, 毒药在 3 4// 白鼠三死, 毒药在 4 05). 递归123456789function sum($n)&#123; if ($n == 1) &#123; return 1; &#125; return $n + sum($n-1);&#125;echo sum(100); 06). PHP实现斐波那契数列1234567891011121314151617181 1 2 3 5 8 13 21 34 55 .........//用递归实现 输出某一位的数字function fbnq($n)&#123; if($n &lt;= 0) return 0; if($n == 1 || $n == 2) return 1; return fbnq($n - 1) + fbnq($n - 2);&#125;echo fbnq(10); //输出第十个数是 55//经典案例//有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少 (注意:这里是总数,还是对, 斐波那契数列结果是对)// 第30位数字的值$arr = [1,1];for ($i=2; $i &lt; 30; $i++) &#123; $arr[$i]=$arr[$i-1]+$arr[$i-2];&#125;var_dump($arr); 07). 静态变量12345678910111213141516/** * 静态变量 * static 变量有一个特点,在第一次调用声明之后存在,切不随函数结束而结束 * 当函数再次调用时,可以直接利用上次的结果 */function t()&#123; static $a = 5; // $a = 5; $a += 1; return $a;&#125;echo t();echo t();echo t(); 08). 递归练习,计算所有单元的和1234567891011121314151617// 递归函数,计算所有单元的和$arr = [1, 2, 3, [4, [5, 6]]];function sum($arr)&#123; static $sum = 0; // static 当函数再次调用时,可以直接利用上次的结果 foreach ($arr as $value) &#123; if (is_array($value)) &#123; sum($value); &#125; else &#123; $sum += $value; &#125; &#125; return $sum;&#125;echo sum($arr); 09). 递归练习 一个多维数组,如果单元值为数字,则把其值修改为原来2倍123456789101112131415161718192021222324252627282930313233// 一个多维数组,如果单元值为数字,则把其值修改为原来2倍// 方法1$arr = [1, 2, 'b', [3, 'c', [5, 6]]];function double($arr)&#123; foreach ($arr as $key=&gt;$value) &#123; if (is_array($value)) &#123; $arr[$key] = double($arr[$key]); &#125; else &#123; if (is_numeric($value)) &#123; $arr[$key] *= 2; &#125; &#125; &#125; return $arr;&#125;echo \"&lt;pre&gt;\";print_r( double($arr));/////////////-----------------------// 方法2 ,使用系统函数 array_walk_recursive// @see http://php.net/manual/zh/function.array-walk-recursive.php$crr = [1, 2, 'b', [3, 'c', [5, 6]]];;function double_2(&amp;$crr,$key)&#123; if (is_numeric($crr)) &#123; $crr*=2; &#125;&#125;array_walk_recursive($crr, 'double_2');echo \"&lt;pre&gt;\";print_r($crr); 10). 递归创建目录123456789101112131415161718$filepath = \"./test/upload/2018/test.txt\";mk_dir($filepath);// 循环创建目录// 注意,$filepath 最后的文件,名字也会被当成目录创建function mk_dir($dir, $mode = 0755)&#123; if (is_dir($dir) || @mkdir($dir,$mode)) return true; if (!mk_dir(dirname($dir),$mode)) return false; return @mkdir($dir,$mode);&#125;/////////////-----------------------// 方法2 ,使用系统函数 mkdir 第三个参数// @see http://www.php.net/mkdir// 注意,$filepath 最后的文件,名字也会被当成目录创建$filepath = \"./test/upload/2018/test.txt\";mkdir($filepath, 0755, true);","tags":[]},{"title":"--JavaScript -3种事件绑定","date":"2018-10-27T02:55:17.452Z","path":"2018/10/27/JavaScript/JavaScript_15_事件绑定/","text":"1234567891011121314151617181920/** * 第一种绑定:行为结构不分离,效率也低 * &lt;a onclick=\"xxx()\"&gt; * * 第二种绑定:只能绑定1个事件 * xxxDomObject.onclick = function()&#123;&#125; * * 第三种绑定: addEventLister */// 一个页面的 js 由多人团队开发;// A,B 都在写 onload 事件// 则 后面的事件,吧前面的onload 属性值都给覆盖了// 这里只会输出 worldwindow.onload = function () &#123; alert(\"hello\");&#125;;window.onload = function () &#123; alert('world')&#125;;","tags":[]},{"title":"-- JavaScript -面向对象之静态方法","date":"2018-10-27T01:12:25.672Z","path":"2018/10/27/JavaScript/JavaScript_13_面向对象之静态方法/","text":"JS 面向对象中的静态方法1: 构造函数通过 new 来制造对象2: 函数本身也是对象 比如一台豆浆机,转动 (new 调用)时,能返回一杯豆浆(制造出的对象)但反观豆浆机本身,也是台机器,也是个对象豆浆机身上也有属性—如开关,进水口等 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * JS 面向对象中的静态方法 * 1: 构造函数通过 new 来制造对象 * 2: 函数本身也是对象 * * 比如一台豆浆机,转动 (new 调用)时,能返回一杯豆浆(制造出的对象) * 但反观豆浆机本身,也是台机器,也是个对象 * 豆浆机身上也有属性---如开关,进水口等 */// var Hashiqi = function () &#123;// this.bark=function () &#123;// console.log('www');// &#125;// &#125;//上面这个 等效 下面这个function Hashiqi()&#123; this.bark= function () &#123; console.log('www'); &#125;&#125;Hashiqi.ajax = function () &#123; console.log('ajax');&#125;;// var h = new Hashiqi(); //h方法有没有ajax方法?? 答:没有,豆浆机上的开关会跑到豆浆里面吗?// console.log(h);console.log(Hashiqi.ajax);/** * 即: * 1: ajax() 方法是属于\"函数\"本省的,和返回的对象没有关系 * 2: bark要调用,必须 new Hashiqi()得到对象,切由返回对象才能调用, * 3: ajax()方法要调用,不需要 new 对象,直接用 Hashiqi 来调用. */// h.bark();Hashiqi.ajax();/** * 我们之前有没有接触过静态方法? * 答: 有 * * 1: Math.random(); 静态方法 * 2:$.ajax(); 静态方法 * 3:写 jQuery 插件,2种办法 * 3.1: 通过闭包,把方法写到 jQuery 上的原型上( 稍复杂) * 3.3; 直接增加 $ 对象的静态方法 */ demo123456789&lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-1.9.1.js\"&gt; &lt;/script&gt;&lt;script type=\"text/javascript\"&gt; //---------------- demo ------------ //通过静态方法给 jQuery 增加唱歌插件 $.sing = function () &#123; alert('人生最大的悲剧莫过于失去自由 人生最大的痛苦莫过于失去亲人和朋友'); &#125;; $.sing();&lt;/script&gt;","tags":[]},{"title":"-JavaScript  -闭包","date":"2018-10-23T18:19:49.490Z","path":"2018/10/24/JavaScript/JavaScript_06_闭包/","text":"闭包一句话概括 :函数的作用域取决于声明时,而不取决一调用是!!函数的作用取决于声明时,而非调用时 1234567891011121314151617181920212223242526272829function t1() &#123; var age = 20; function t2() &#123; console.log(age) &#125; return t2;&#125;var tmp = t1();/** * 1: 在大部分的语言中, t1 被调用执行,则申请内存 * 并把其局部变量, push 入栈!!! * t1 函数 执行完毕,内部的局部变量,随着函数的退出而销毁 * 因此, age = 20 的局部变量,依靠已经消失了 * * 但是在 js 中 , age = 20 这个变量,却被 t2 捕捉, * 即使 t1 执行完毕,通过 t2 依然能访问该变量 * * 这种情况---返回的函数,并非孤立的函数,甚至吧其周围的变量环境. * 形成了一封闭的\"环境包\",并同返回,所以叫\"闭包\" * * ---- 一句话概括--- 函数的作用域取决于声明时,而不取决一调用是!! * @type &#123;number&#125; */var age = 99;tmp();// 输出 20 函数的作用取决于声明时,而非调用时123456789101112131415function closure() &#123; var sister = '大桃花'; var me = function () &#123; console.log(sister); &#125;; return me;&#125;function place() &#123; var sister = '大福晋'; var girl = closure(); girl();&#125;place(); // 输出 大桃花 闭包计数器01123456789101112// 多个人开发 js 程序,需要一个全局的计数器// 多个人的函数共同用一个计数器,计数器一直增长/** * 解决办法: * 1: 设立一个全局变量 * window.cat = 0; * 调用 ++window.cnt; * * 这个办法可行,但是污染了全局变量, * 其次引入了多人的 js 程序,别人的程序里,也有一个 window.cnt = 'hello'; * 该计数器就损坏了,(所以要尽量避免用全局变量) */ 闭包计数器02 — 闭包维护一个别人污染不到的变量,做计数器1234567891011121314151617181920212223242526// 闭包维护一个别人污染不到的变量,做计数器function counter() &#123; var cnt = 0; // 当 ccounter 执行完毕后,除了返回的 cnter 函数,谁也别想碰到 cnt 变量了 var cnter = function () &#123; return ++cnt; &#125;; return cnter;&#125;var inc = counter();console.log(inc());console.log(inc());console.log(inc());//-----------简化版-----------var cnt = (function () &#123; var cnt = 0; return function () &#123; return ++cnt; &#125; &#125;)();console.log(cnt());console.log(cnt());console.log(cnt()); 闭包计数器03 —在工作中,一般如何避免全局污染或冲突123456789101112131415161718/*** 疑问: cnt 不依然是全局变量吗?* 第3版---在工作中,一般如何避免全局污染或冲突** 1: 统一放在一个全局对象上,如 jQuery-&gt;$* 2:每个人用自己的命名空间*/// jQuery 的计数插件形式$ = &#123;&#125;;$.cnt = (function () &#123; var cnt = 0; return function () &#123; return ++cnt; &#125;&#125;)();console.log($.cnt());console.log($.cnt());console.log($.cnt()); 闭包计数器04 – 把自己的变量,函数,都放在一个对象里123456789101112// 第4版 个人命名空间,在团队开发中也很常见// 其实就是把自己的变量,函数,都放在一个对象里var Y18 = &#123;&#125;;Y18.cnt = (function () &#123;var cnt = 0return function () &#123; return ++cnt;&#125;&#125;)();console.log(Y18.cnt());console.log(Y18.cnt());console.log(Y18.cnt()); demo 练习要求:点击 li ,分别弹出 0,1,2,3 1234567891011121314151617&lt;ul&gt; &lt;li&gt;男&lt;/li&gt; &lt;li&gt;女&lt;/li&gt; &lt;li&gt;老&lt;/li&gt; &lt;li&gt;少&lt;/li&gt;&lt;/ul&gt;&lt;script type=\"text/javascript\"&gt; //要求:点击 li ,分别弹出 0,1,2,3 for (var i = 0, lis = document.getElementsByTagName('li'), len = lis.length; i &lt; len; i++) &#123; lis[i].onclick = (function () &#123; var p=i; return function () &#123; return alert(p); &#125; &#125;)(); &#125;&lt;/script&gt;","tags":[]},{"title":"-JavaScript -this","date":"2018-10-22T15:06:18.079Z","path":"2018/10/22/JavaScript/JavaScript_04_this/","text":"js 的 this 到底是谁??? js 中函数的4中条用方式 1). 作为普通函数来调用12345678910111213141516171819/** * console.log(window.xxx); * 1: 作为普通函数来调用时, * this 的值指向--&gt;window * 准确的说,this 为 null ,但被解释成 window * 在 ECMAScript 表准中, 如果 this 为 null ,则解释成 undefined */console.log(window.xxx); //undefinedfunction t() &#123; this.xxx = 333;&#125;t();console.log(window.xxx);// 输出 333function test() &#123; console.log(this.test_window);&#125;test(); //输出 undefined 作为对象的方法来调用12345678910111213141516171819202122232425/** * 2: 作为对象的方法来调用 * this 指向方法的调用这,即该对象 */var obj = &#123; xx: 99, yy: 88, t: function () &#123; console.log(this.xx); &#125;&#125;;obj.t(); // 输出 99var dog = &#123;xx: 'wangwang'&#125;;dog.t = obj.t;dog.t(); // 输出 wangwang/** * 作为方法调用时, * this 指向其调用那一刻的调用者,即母体对象 * 不管被调用函数,声明时属于方法,还是函数 */show = function () &#123; console.log('show' + this.xx);&#125;dog.t = show;dog.t(); // show wangwang 函数作为构造函数调用时123456789101112131415161718192021222324252627282930/** * 3: 函数作为构造函数调用时 * js 中没有类的概念,创建对象是用构造函数来完成,或者直接用json格式&#123;&#125;来写对象 * * new Dog 发生了一下几个步骤 * a: x系统创建空对象 &#123;&#125; ,(空对象 constructor 属性指向 Dog 函数,先别管) * b: 把函数的 this --&gt; 指向--&gt;该空对象 * c: 执行该函数 * d: 返回该对象 */function Dog(name, age) &#123; this.name = name; this.age = age; this.bark = function () &#123; console.log('this is ' + this.name); //输出 this is huzi &#125;&#125;var dog = new Dog('huzi', 2);dog.bark();// 下面这个返回什么???// 分析: 输出 Pig对象: Pig &#123;age: 99&#125;; 因为函数作为构造函数运行时,return 的值是忽略的,还是返回对象function Pig() &#123; this.age = 99; return 'abc';&#125;var pig = new Pig();console.log(pig); 函数通过 call , apply 调用1234567891011121314151617181920212223242526272829/** * 4. 函数通过 call , apply 调用 * 语法格式: 函数.call(对象,参数,参数,参数,参数........参数N.) */function t(num) &#123; console.log('我的真实年龄是' + this.age); console.log('但是我一般告诉别人我' + (this.age + num));&#125;//var humanObject = &#123;name: 'lisi', age: 28&#125;;// 我的真实年龄是28// 但是我一般告诉别人我18humanObject.t = t;humanObject.t(-10);// 接下来,我们不把 t 赋值为 human 的属性,也能把 this 指向 human// 运行结果:// 我的真实年龄是30// 但是我一般告诉别人我35// 分析:// fn.call(对象obj,参数1,参数2,....参数N)//// 运行如下:// a): fn 函数中的 this---&gt;指向-----&gt;obj// b): 运行 fn(参数1,参数2.....参数N);var wangwuObject = &#123;name: 'wangwu', age: 30&#125;;t.call(wangwuObject, 5);// t.apply(wangwuObject,[5]); demo 练习1234567891011121314151617181920212223name = 'this is window';var obj = &#123; name: 'php', t: function () &#123; console.log(this.name) &#125;&#125;;var dog = &#123;name: 'huzi'&#125;;obj.t(); // 输出 phpvar tmp = obj.t;tmp(); //相当于window.tmp() 输出: this is windowdog.t = obj.t;dog.t(); //输出 huzi(dog.t = obj.t)(); //输出 this is window(function()&#123;console.log(this.name)&#125;)(); //输出 this is window// 分析// (dog.t = obj.t) 是一个表达式,返回值值\"值\",即 t 函数// 强调是值,说明不是通过应用来调用的,而是立即使用函数本身// 效果等同于 (function()&#123;console.log(this.name)&#125;)// null 又被解释成 window 其他 window 全局变量污染12345/** * 有一些经验的,但对 js 理解的不深的同学说: * 有 this 操作的,(如 this.age=xx ) 的函数不能直接用,而是要new 来调用????? * 答: 因为直接用, this 会指向 window ,将会污染去全局变量 */","tags":[]},{"title":"-JavaScript arguments","date":"2018-10-21T15:21:29.510Z","path":"2018/10/21/JavaScript/JavaScript_03_arguments/","text":"argumets 是什么? 答: 是一个对象,是一个长得很像数组的对象 arguments 内容是什么??? 答: arguments是函数运行时的实体参数列表 123456/*** 函数运行期内,关键的三个对象* AO -----&gt; 本函数 AO 上没有某属性,则继续去外层函数的* arguments -----&gt; 每个函数都有自己的 callee ,但 不 向外层接着找 arguments 的相关属性,即 不形成链* this */ demo_01 arguments 是什么?123456789(function (d, e, f) &#123; // 在此函数中无法用 d,e,f 形参来取的 'haha',因为没有相对应的形参 // 但我们可以用 arguments 来获取任意多个的实参 console.log(typeof arguments); // 输出 object console.log(arguments); // 对象 console.log(arguments[0]); // hello --&gt;长得像数组 console.log(arguments[1]); console.log(arguments[3]);&#125;)('hello', 'world', '!', 'haha'); arguments 实际内容12345678910(function (d, e, f) &#123; console.log(d); // 输出 hello arguments[0] = 'China'; console.log(d); // 输出 China ; 形参与对应的 arguments 单元,其实是互相映射的,互相影响&#125;)('hello', 'world', '!', 'haha');//---------------------------------------(function (d, e, f) &#123; console.log(arguments.length); // 输出长度 4 ; 实参个数&#125;)('hello', 'world', '!', 'haha'); 递归 arguments.callee123456789101112131415(function (d, e, f) &#123; console.log(arguments.callee); // 输出 function(d, e, f) &#123; console.log(arguments.callee); &#125;&#125;)('hello', 'world', '!', 'haha');//-----------------------------// 递归 , 求和,输出 5050console.log( (function (n) &#123; if (n &lt;= 1) &#123; return 1; &#125; else &#123; return n + arguments.callee(n - 1); &#125; &#125;)(100));","tags":[]},{"title":"-JavaScript  词法分析期  执行期","date":"2018-10-21T05:12:40.830Z","path":"2018/10/21/JavaScript/JavaScript_02_词法分析/","text":"词法分析期 执行期1234567891011121314151617/** * 第一步: 先分析参数 * 第二部: 在分析变量声明 * 第三个: 分析函数声明 * * 一个函数就能使用的局部变量,就从上面的3步分析而来 * * 具体步骤: * 0: 函数运行前的一瞬间,生成 Active Object(活动对象),下称为 AO * 1:把声明的参数,形成 AO 的属性,值全是 undefined * 2:分析变量声明声明声明!!! 如 var age * 如果 AO 上还没有 age 属性,则添加 AO 属性,值是 undefined * 如果 AO 上已经有 age 属性,则不做任何影响 * 3: 分析函数声明,如 function foo()&#123;&#125; * 则把函数赋给 AO.foo 属性 * 注: 如果此前 foo 属性已经存在,则被无情覆盖了 */ demo_1123456789101112//分析过程// AO &#123;age:unfettered&#125;// 运行过程:// t(5)--&gt;AO.age=5; alert(AO.age); //5// t()---&gt;AO.age 没得到复制,还是 undefinedfunction t(age) &#123; alert(age)&#125;t(5); // 输出 5t(); //输出undefined demo_021234567891011121314151617/** * 分析过程: * 0: 形成 AO=&#123;&#125; * 1: 分析形参 AO = &#123;age:undefined&#125; * 接受形参 AO= &#123;age:5&#125; * 2: 分析 var age ,发现 AO 已经有 age属性,不做任何影响 * * 执行过程: * console.log(age); //66 * AO.age = 66; */function t2(age) &#123; var age= 66; console.log(age); //输出66&#125;t2(5); demo_031234567891011121314151617181920212223/** * 词法分析过程: * 0: AO = &#123;&#125; * 1: 分析参数 AO = &#123;greet:undefined&#125; * 2: 分析 greet 变量声明, AO 已经有greet 属性,因此不做任何影响 * 3: 分析 greet 函数声明, AO.greet = function()&#123;&#125;, 被覆盖成函数 * 执行过程 * console.log(greet); * greet = 'hello'; * console.log(greet); * console.log(greet); */function t3() &#123; console.log(greet);// 输出greet() &#123;&#125; var greet = 'hello'; console.log(greet);// 输出 hello function greet() &#123; &#125; console.log(greet);// 输出 hello&#125;t3(null); demo_0412345678910111213141516171819202122/** * 词法分析过程: * 0: AO = &#123;&#125; * 1: 分析参数 AO = &#123;greet:undefined&#125; * 2: 分析 greet 变量声明, AO 已经有greet 属性,因此不做任何影响 * 3: 分析 greet 函数声明, AO.greet = function()&#123;&#125;, 被覆盖成函数 * 执行过程 * console.log(greet); * console.log(greet); * console.log(greet); */function t3() &#123; console.log(greet);// 输出 greet() &#123;&#125; var greet; console.log(greet);// 输出 greet() &#123;&#125; function greet() &#123; &#125; console.log(greet);// 输出 greet() &#123;&#125;&#125;t3(null); demo_0512345678910111213141516171819202122/** * 分析 * 0: AO = &#123;&#125; * 1: 分析参数 AO =&#123;b:undefined&#125; * 接受参数 AO = &#123;b:2&#125; * 2: 分析 var 声明,此函数没有 var * 3: 分析函数声明, AO = &#123;b:function()&#123;console.log(b);&#125;&#125; * * 执行期: * console.log(b) //function * b(); //由作用域寻找到 a 函数中的 b , 即 function , console.log() 出来 */function a(b) &#123; console.log(b); // 输出 b() &#123; console.log(b); &#125; ****注意这里的注释也会被输出*** function b() &#123; console.log(b); // 输出 b() &#123; console.log(b); &#125; ****注意这里的注释也会被输出*** &#125; b();&#125;a(2); demo_061234567891011121314151617181920212223/** * 词法分析 * 0: AO = &#123;&#125; * 1: 分析参数 AO = &#123;b:undefined&#125; --&gt; &#123;b:2&#125; * 2: 分析 var 声明,没有 * 3: 分析函数声明??? [没有!!!]!!!*** * * (注: b = function()&#123;&#125; ,是一个赋值过程,在执行期才有用) * * 执行过程 * console.log(b); * b = function()&#123; console.log(b); &#125; * console.log(b); */function a(b) &#123; console.log(b); //输出 2 b = function () &#123; console.log(b); // b() &#123; console.log(b); &#125; ****注意这里的注释也会被输出*** &#125;; b();&#125;a(2); demo_07 函数声明 函数赋值123456789101112// 这两种方式 效果不同// t1 是函数声明,虽然全局内也得到一个 t1 变量,值是 function// 而 t2 只是一个复制过程----值是谁? 值是右侧的表达式的返回结果,即函数// 就是说 function ()&#123;&#125; 在js 看来,就和 2*4 8/4 一样,是一个表达式,返回一个结果// 因此 , t1 t2 两种方式在词法分析是,有这本质的区别// 前者 在词法分析阶段,就发挥作用// 而后者,在运行阶段,才发挥作用function t1() &#123;&#125;t2 =function () &#123;&#125; jQuery 最外层代码分析1234567891011121314151617181920212223//----------------- jQuery 最外层代码分析---------------(function (window, undefined) &#123; &#125;) //内层表达式.返回值是函数,包括在小括号李,当成表达式来执行(function (window, undefined) &#123; &#125;(window)) //立即调用// 而内层函数又没有起名字,成为匿名函数// 这种手法,匿名函数,立即执行,不污染全局, 称为 立即执行匿名函数表达式//------------------ 思路: 为什么传 window , 而又不会传 undefined ???--------------//------------------ 传window 是为了速度 --------------// function () &#123;// function () &#123;// function () &#123;// function () &#123;// document.getElementById........ //这个 document 将会向作用域层层上找,直到最外层// &#125;// &#125;// &#125;// &#125;// jQuery 就是为了加快内部查找局部变量的速度,而直接把 window 以参数形式传进来// 这样 window 就在jQuery 内部 AO 上// 不传 undefined 是为了安全// 因为在 IE ,低版本中, undefined 竟然可以重新赋值, 如 undefined = 6;// 声明 undefined 局部变量( 名字是undefined而已),// 同时,又不传参,值自然是 undefined 防止了对外界 undefined 的污染","tags":[]},{"title":"-JavaScript 作用域   词法分析","date":"2018-10-20T23:37:51.465Z","path":"2018/10/21/JavaScript/JavaScript_01_作用域/","text":"注意​ 以 window.xxx 引用全局变量寻找不到,作为某个属性不存在,返回 undefined​ 直接以 xxx 引用某变量,寻找不到,则是报错 xxx is not defined 错误 作用域 入门123var test;console.log(test); // 输出 undefinedconsole.log(test2); //报错 test2 is not defined 词法分析入门123456789101112131415/*** 词法分析 入门* js 代码自上而下执行!!!** 但是---------* js 代码在整体运行分:* 词法分析期* 运行期** 自上而下执行,先有个一个\"词法分析过程\"!!!*/// 分析 词法分析期 var test_1; 赋值期 tes_1='fei';var test_1 = 'fei';console.log(test_1); //输出 feiconsole.log(window.test_1); //输出 fei 作用域 demo12345678910111213141516171819202122232425262728293031323334/** * 作用域 * 在js中,函数嵌套是非常普遍的 * 在函数嵌套中, * * 对变量是如何寻找的? * 答:首先在函数内寻找 * 寻找不到,则往外层寻找 * 直到....全局(window) */var c = 5;function t1() &#123; var d = 6; function t2() &#123; var e = 7; alert(c + d + e); &#125; t2();&#125;t1(); //输出 18//----------------------------var c = 5;function t1() &#123; var d = 6; function t2() &#123; var e = 7; var d=3; alert(c + d + e); &#125; t2();&#125;t1(); //输出 15 声明变量 var 的作用1234567891011121314151617181920212223242526272829303132333435/** * 声明变量 var 的作用 * var 是在函数运行的上下文中,声明一个变量 * 如果不加 var , 则是一个赋值操作 * 但不要狭隘的理解为----声明了一个全局变量 */alert(window.d);//输出 undefinedalert(window.e);//输出 undefinedfunction t() &#123; d = 5;//赋值操作 var e = 6;&#125;t();// 5 d没有加 var 仅仅是一个赋值操作,// 寻找t域内的函数,没有找到继续寻找...直到..&gt;window,最后 window.d = 5alert(window.d); // 输出 5alert(window.e); //输出 undefined//----------------------------------function t1() &#123; var d; function t2() &#123; d = 5; e = 6; &#125; t2();&#125;t1();console.log(e); // 输出 6console.log(d); //报错 is not definedconsole.log(window.e); //输出 6console.log(window.d); //输出 undefined 作用域 demo 2123456789101112131415161718192021var str1 = 'global';function t1() &#123; // 分析 // 这里 str1 这一行执行,在 t1 内寻找 str1--没有找到,又在 window 上寻找 str1--有,打印global // 这里 str2 这一行执行,在 t1 内寻找 str2--没有找到,又在 window 上寻找str2--没有,报错 str2 is not defined console.log(str1); // 输出 global console.log(str2); // 报错 is not defined // console.log(window.str1);// 输出 global // console.log(window.str2);// 输出 undefined // 分析 // 如果执行到这里,才会把全局的 str2变量赋上值 str2 = 'local'; // console.log(str1); // 输出 global // console.log(str2); // 报错 local // console.log(window.str1);// 输出 global // console.log(window.str2);// 输出 local&#125;t1(); 词法分析期 运行期1234567891011121314151617181920212223/* * 1步:先分析 t1 函数 * t()&#123; * var str2; // 分析 t1 内有str2 局部变量,注意此时函数没有执行,因此str2 的值是 undefined * &#125; * * 2步:执行 t1 函数 * console.log(str1); //global * console.log(str2); //undefined * str2 = 'local'; //此时,str 的值为 local */var str1 = 'global';function t1() &#123; console.log(str1); // 输出 global console.log(str2); // 报错 undefined console.log(window.str1);// 输出 global console.log(window.str2);// 输出 undefined var str2 = 'local';&#125;t1(); 扩展 const、let、var之间的区别 ……….","tags":[]},{"title":"-php -vagrant[centos] -xdebug","date":"2018-10-19T16:56:49.264Z","path":"2018/10/20/centos/php_vagrant_xdebug/","text":"!!!! 温馨提醒 PHP版本一点要和xdebug版本对应!!!! 温馨提醒 PHP版本一点要和xdebug版本对应!!!! 温馨提醒 PHP版本一点要和xdebug版本对应 查看安装的xdebug 011234567891011121314[root@localhost php.d]# yum list | grep xdebugRepodata is over 2 weeks old. Install yum-cron? Or run: yum makecache fastphp-composer-xdebug-handler.noarch 1.3.0-1.el7 epel php-pecl-xdebug.x86_64 2.6.1-1.el7.remi.7.2 remi-php72php54-php-pecl-xdebug.x86_64 2.4.1-1.el7.remi remi-safe php55-php-pecl-xdebug.x86_64 2.5.5-1.el7.remi remi-safe php56-php-pecl-xdebug.x86_64 2.5.5-1.el7.remi remi-safe php70-php-pecl-xdebug.x86_64 2.6.1-1.el7.remi remi-safe php71-php-pecl-xdebug.x86_64 2.6.1-1.el7.remi remi-safe php72-php-pecl-xdebug.x86_64 2.6.1-1.el7.remi remi-safe php73-php-pecl-xdebug.x86_64 2.7.0~beta1-1.el7.remi remi-safe [root@localhost php.d]# yum install php-pecl-xdebug 查看安装的xdebug 021234567891011[root@localhost php.d]# ll /etc/php.d/ | grep xdebug-rw-r--r-- 1 root root 37784 Aug 4 05:54 15-xdebug.ini[root@localhost php.d]# vim 15-xdebug.ini zend_extension=xdebug.so xdebug.idekey = \"PHPSTORM\" xdebug.default_enable = 1 xdebug.remote_connect_back = 1 xdebug.remote_port = 9001 xdebug.remote_enable = 1 xdebug.remote_autostart = 1 xdebug.remote_handler=\"dbgp\" 查看安装的xdebug 031234567891011121314151617181920212223242526272829[root@localhost php.d]# php -vPHP 7.2.9 (cli) (built: Aug 15 2018 09:19:33) ( NTS )Copyright (c) 1997-2018 The PHP GroupZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies with Xdebug v2.6.1, Copyright (c) 2002-2018, by Derick Rethans ###这里的配置不要写错了,remote_connect_back这项很重要[root@localhost php.d]# vim 15-xdebug.ini zend_extension=xdebug.so xdebug.idekey = \"PHPSTORM\" xdebug.default_enable = 1 xdebug.remote_connect_back = 1 xdebug.remote_port = 9001 xdebug.remote_enable = 1 xdebug.remote_autostart = 1 xdebug.remote_handler=\"dbgp\" 或者 zend_extension=xdebug.so xdebug.idekey=\"PHPSTORM\" xdebug.remote_connect_back = 1 //这项不要丢了 xdebug.remote_handler = \"dbgp\" xdebug.remote_mode = \"req\" xdebug.remote_host=127.0.0.1 xdebug.remote_enable=on xdebug.remote_port = 9001 xdebug.remote_autostart = no---------------虚拟机配置完毕------------------ windows中配置123456704 Tools--&gt;Vagrant 05 Languages &amp; Frameworks --&gt;PHP--&gt; Debug 06 Languages &amp; Frameworks --&gt;PHP--&gt; Debug --&gt; DBGp Proxy07 Languages &amp; Frameworks --&gt;PHP--&gt; Servers08 Run --&gt; Edit Configurations 添加PHP Web Page09接下来接可以断点调试了","tags":[]},{"title":"-Yii2 验证器  -不为人知的秘密","date":"2018-10-19T16:54:47.861Z","path":"2018/10/20/Yii2/Yii2_validators/","text":"required : 必须值验证属性12[['字段名'],required,'requiredValue'=&gt;'必填值','message'=&gt;'提示信息'];#说明:CRequiredValidator 的别名, 确保了特性不为空. 指定场景1[['title', 'content'], 'required', 'on' =&gt; ['create', 'update']], email : 邮箱验证12['email', 'email'];#说明:CEmailValidator的别名,确保了特性的值是一个有效的电邮地址. match : 正则验证1234[['字段名'],match,'pattern'=&gt;'正则表达式','message'=&gt;'提示信息']; [['字段名'],'match','pattern'=&gt;'/^[1-9]d*|0$/','message'=&gt;'必须为正整数'];[['字段名'],match,'not'=&gt;ture,'pattern'=&gt;'正则表达式','message'=&gt;'提示信息'];/*正则取反*/ #说明:CRegularExpressionValidator 的别名, 确保了特性匹配一个正则表达式. safe : 安全1['description', 'safe']; compare : 比较123['age', 'compare', 'compareValue' =&gt; 30, 'operator' =&gt; '&gt;='];#说明:compareValue(比较常量值) - operator(比较操作符) #说明:CCompareValidator 的别名,确保了特性的值等于另一个特性或常量. default : 默认值12['age', 'default', 'value' =&gt; null];#说明:CDefaultValueValidator 的别名, 为特性指派了一个默认值. file : 文件12['primaryImage', 'file', 'extensions' =&gt; ['png', 'jpg', 'gif'], 'maxSize' =&gt; 1024*1024*1024]; #说明:CFileValidator 的别名, 确保了特性包含了一个上传文件的名称. filter : 滤镜12[['username', 'email'], 'filter', 'filter' =&gt; 'trim', 'skipOnArray' =&gt; true]; #说明:CFilterValidator 的别名, 使用一个filter转换属性. in : 范围12['level', 'in', 'range' =&gt; [1, 2, 3]]; #说明:CRangeValidator 的别名,确保了特性出现在一个预订的值列表里. unique : 唯一性12['username', 'unique'] #说明:CUniqueValidator 的别名,确保了特性在数据表字段中是唯一的. integer : 整数1['age', 'integer']; number : 数字1['salary', 'number']; double : 双精度浮点型1['salary', 'double']; date : 日期1[['from', 'to'], 'date']; string : 字符串1['username', 'string', 'length' =&gt; [4, 24]]; boolean : 是否为一个布尔值12['字段名', 'boolean', 'trueValue' =&gt; true, 'falseValue' =&gt; false, 'strict' =&gt; true]; #说明:CBooleanValidator 的别名 when条件：1['name2', 'required', 'when' =&gt; function ($model) &#123; return empty($model-&gt;name1);&#125;],#说明: 行内验证器–123456789101112131415161718 // password is validated by foo() ['password', 'foo'] public function foo()&#123; $this-&gt;addError('password', '调用这个方法了.'); &#125;----------------['password', 'validatePassword'],public function validatePassword()&#123; $user = User::findByUsername($this-&gt;username); if (!$user || !$user-&gt;validatePassword($this-&gt;password)) &#123; $this-&gt;addError('password', 'Incorrect username or password.'); &#125;&#125; 核心验证器 en 核心验证器 zh-cn 输入验证","tags":[]},{"title":"-sql -DDL","date":"2018-10-14T07:36:53.250Z","path":"2018/10/14/mysql/sql_DDL/","text":"列操作123456789101112desc 表名; ...................................... #查看表结构alter table 表名 add 列名称 属性; .............. # 添加列alter table 表名 add 列名称 属性 after 列名; ... # 指定在某列后面添加alter table 表名 drop 列名; .............. #删除列名alter table 表名 change 旧列名 新列名 新属性 ..... #修改列名alter table a modify change_username varchar(20) ; # 修改列属性alter table a add new_username char(10); # 添加列alter table a add new_username2 char(10) after id; # 添加列,指定在某列后面添加alter table a drop new_username2; #删除列名alter table a change new_username change_username char(5); # 修改列名alter table a modify change_username varchar(20); #修改列属性 表操作1234567891011121314show tables; #查看所有表desc 表名; #查看表结构show create table 表名; # 查看创建表sqlshow tables; #查看表信息show table status where name =&apos;表名&apos;; # 查看某一张表信息rename table 旧表名 to 新表名 #修改表名字delete from user_t; #清空表内容truncate user_t; #清空表内容 id 从最初开始#视图show create view 视图名 #查看建视图过程drop view 视图名 #删除视图create view v1 as select * from student2 #创建视图 as后面跟普通sqlcreate view v2 as select id,name,score from student2 #创建视图 as后面跟普通sql 索引1234567891011121314151617181920212223242526272829#普通索引(index 另一个名字normal)、#唯一索引(unique)、#全文索引(fulltext)、#空间索引(SPATIAL)unique key email(email(10)) #使用索引长度alter table 表名 add index 索引名(字段名) #添加普通索引alter table 表名 drop index 索引名 #删除索引show index from 表名 #查看索引create table a1( name char(5), email char(15), key name(name), unique key email(email));#多列索引create table a3( name char(5), email char(15), key name(name), unique key name_email(name,email));explain select * from a3 WHERE name=&quot;张&quot;; # 分析sqlalter table a1 add unique(name); # 添加唯一索引alter table a1 add index index_name(email) #添加普通索引alter table a1 drop index index_name #删除索引show index from a1 \\G #查看索引 !!!库操作 [此操作比较危险,请谨慎操作]1234567create database 数据库; #创建库create database 数据库 default character set 字符集 collate 排序规则; #创建库指定字符集create database yourdb; #创建库create database yourdb3 default character set utf8mb4 collate utf8mb4_unicode_ci; #创建库指定字符集!!! 数据库的的名字不要直接修改,容易丢数据!!! 不常用,有实际用处sql12345SELECT name, NULL AS hello, ---空值作为一列 &quot;foo&quot; AS bar ---字符串作为一列FROM student2","tags":[]},{"title":"Yii2 ArrayHelp类","date":"2018-10-13T11:05:25.590Z","path":"2018/10/13/Yii2/Yii2_ArrayHelp/","text":"ArrayHelper::toArray12345678910$post = User::find()-&gt;limit(2)-&gt;all();//$post = User::find()-&gt;limit(2)-&gt;asArray()-&gt;all();// echo \"&lt;pre&gt;\"; print_r($post);exit(); //输出所有字段 id,username,email......$data = ArrayHelper::toArray($post,[ 'common\\models\\User'=&gt;[ 'id', 'username' ]]);echo \"&lt;pre&gt;\"; print_r($data); //输出 id username ArrayHelper::merge12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152$array1 = [ 'name' =&gt; 'Yii', 'version' =&gt; '1.1', 'ids' =&gt; [ 1, ], 'validDomains' =&gt; [ 'example.com', 'www.example.com', ], 'emails' =&gt; [ 'admin' =&gt; 'admin@example.com', 'dev' =&gt; 'dev@example.com', ],];$array2 = [ 'version' =&gt; '2.0', 'ids' =&gt; [ 2, ], // Object that represents the replacement of // array value while performing [[ArrayHelper::merge()]]. 'validDomains' =&gt; new \\yii\\helpers\\ReplaceArrayValue([ 'yiiframework.com', 'www.yiiframework.com', ]), // Object that represents the removal of // array value while performing [[ArrayHelper::merge()]]. 'emails' =&gt; [ 'dev' =&gt; new \\yii\\helpers\\UnsetArrayValue(), ],];$result = ArrayHelper::merge($array1, $array2);输出:[ 'name' =&gt; 'Yii', 'version' =&gt; '2.0', 'ids' =&gt; [ //这里合并 1, 2, ], 'validDomains' =&gt; [ //这里替换 'yiiframework.com', 'www.yiiframework.com', ], 'emails' =&gt; [ //这里删除 'admin' =&gt; 'admin@example.com', ],] ArrayHelper::getValue用原生PHP从一个对象、数组、或者包含这两者的一个复杂数据结构中获取数据是非常繁琐的。 你首先得使用 isset 检查 key 是否存在, 然后如果存在你就获取它，如果不存在， 则提供一个默认返回值;;;;;;Yii 提供了一个非常方便的方法来做这件事：ArrayHelper::getValue 123456789101112131415161718192021222324252627class User&#123; public $name; public $name_002=\"我是name_002\";&#125;$array = [ 'foo' =&gt; [ 'bar' =&gt; new User(), 'bar_002' =&gt; new User(), ]];$value = isset($array['foo']['bar']-&gt;name) ? $array['foo']['bar']-&gt;name : null;$value002 = isset($array['foo']['bar']-&gt;name_002) ? $array['foo']['bar']-&gt;name_002 : null;var_dump($value); //输出 nullvar_dump($value002); //输出 我是name_002var_dump(ArrayHelper::getValue($array,'foo.bar.name')); //输出 nullvar_dump(ArrayHelper::getValue($array,'foo.bar.name_002')); //输出 我是name_002var_dump(ArrayHelper::getValue($array, function ($array,$defaultValue) &#123; //输出 我是name_002 return $array['foo']['bar']-&gt;name_002;&#125;));var_dump(ArrayHelper::getValue($array, 'foo.bar.name_002')); //输出 我是name_002var_dump(ArrayHelper::getValue($array, ['foo','bar','name_002'])); //输出 我是name_002 ArrayHelper::setValue覆盖初始值,如果数组中不存在则被创建 12345678$array = [ 'key' =&gt; [ 'in' =&gt; ['k' =&gt; 'value'] ]];ArrayHelper::setValue($array, 'key.in', ['arr' =&gt; 'val']);// 在 `$array` 中写入值的路径可以被指定为一个数组ArrayHelper::setValue($array, ['key', 'in'], ['arr' =&gt; 'val']); 输出12345[ 'key' =&gt; [ 'in' =&gt; ['arr' =&gt; 'val'] ]] 如果路径中包含一个不存在的键,他将被创建12345// 如果 `$array['key']['in']['arr0']` 不为空，则该值将被添加到数组中ArrayHelper::setValue($array, 'key.in.arr0.arr1', 'val');// 如果你想完全覆盖值 `$array['key']['in']['arr0']`ArrayHelper::setValue($array, 'key.in.arr0', ['arr1' =&gt; 'val']); 输出12345678[ 'key' =&gt; [ 'in' =&gt; [ 'k' =&gt; 'value', 'arr0' =&gt; ['arr1' =&gt; 'val'] ] ]] ArrayHelper::remove1234567891011121314$array = ['type' =&gt; 'A', 'options' =&gt; [1, 2]];$type = ArrayHelper::remove($array, 'type');print_r($type); //输出 A print_r($array); //输出 ['options' =&gt; [1, 2]]//note: 与 getValue 方法不同,remove 仅支持简单的键名称,否则返回原来数组//demo: $array = [ 'key' =&gt; [ 'in' =&gt; ['k' =&gt; 'value'] ]];ArrayHelper::remove($array, 'key.in');print_r($array); //返回原来数组 ArrayHelper::removeValue12345678$array = [ 'Bob' =&gt; 'Dylan', 'Michael' =&gt; 'Jackson', 'Mick' =&gt; 'Jagger', 'Janet' =&gt; 'Jackson'];ArrayHelper::removeValue($array, 'Jackson');print_r($array); //返回 ['Bob' =&gt; 'Dylan', 'Mick' =&gt; 'Jagger'] ArrayHelper::index1234567891011121314151617$array = [ ['id' =&gt; '123', 'data' =&gt; 'abc', 'device' =&gt; 'laptop'], ['id' =&gt; '345', 'data' =&gt; 'def', 'device' =&gt; 'tablet'], ['id' =&gt; '345', 'data' =&gt; 'hgi', 'device' =&gt; 'smartphone'],];$result = ArrayHelper::index($array, 'id');$result2 = ArrayHelper::index($array, function ($element) &#123; return $element['id']; //匿名函数作为key传递,返回值结果相同&#125;);print_r($result); print_r($result2); //输出[ '123' =&gt; ['id' =&gt; '123', 'data' =&gt; 'abc', 'device' =&gt; 'laptop'], '345' =&gt; ['id' =&gt; '345', 'data' =&gt; 'hgi', 'device' =&gt; 'smartphone'] // 原始数组的第二个元素由于相同的 ID 而被最后一个元素覆盖] 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354//*******避免第一种的覆盖*****$result = ArrayHelper::index($array, null, 'id'); //第一级id$result = ArrayHelper::index($array, 'device','id'); //第一级id,第二级 device//结果分别是[ '123' =&gt; [ ['id' =&gt; '123', 'data' =&gt; 'abc', 'device' =&gt; 'laptop'] ], '345' =&gt; [ // all elements with this index are present in the result array ['id' =&gt; '345', 'data' =&gt; 'def', 'device' =&gt; 'tablet'], ['id' =&gt; '345', 'data' =&gt; 'hgi', 'device' =&gt; 'smartphone'], ]]-------------------------------------------------------------------------------------- [ '123' =&gt; [ 'laptop' =&gt; [ 'abc' =&gt; ['id' =&gt; '123', 'data' =&gt; 'abc', 'device' =&gt; 'laptop'] ] ], '345' =&gt; [ 'tablet' =&gt; [ 'def' =&gt; ['id' =&gt; '345', 'data' =&gt; 'def', 'device' =&gt; 'tablet'] ], 'smartphone' =&gt; [ 'hgi' =&gt; ['id' =&gt; '345', 'data' =&gt; 'hgi', 'device' =&gt; 'smartphone'] ] ]]note: 第三个参数会增加数组的子分组多维数组$result = ArrayHelper::index($array, 'device',['id','device']); //输出[ '123' =&gt; [ 'laptop'=&gt;[ 'laptop' =&gt; [ 'abc' =&gt; ['id' =&gt; '123', 'data' =&gt; 'abc', 'device' =&gt; 'laptop'] ] ] ], '345' =&gt; [ 'tablet'=&gt;[ 'tablet' =&gt; [ 'def' =&gt; ['id' =&gt; '345', 'data' =&gt; 'def', 'device' =&gt; 'tablet'] ], ], 'smartphone'=&gt;[ 'smartphone' =&gt; [ 'hgi' =&gt; ['id' =&gt; '345', 'data' =&gt; 'hgi', 'device' =&gt; 'smartphone'] ] ] ]]; ArrayHelper::getColumn123456$data = [ ['id' =&gt; '123', 'data' =&gt; 'abc'], ['id' =&gt; '345', 'data' =&gt; 'def'],];$ids = ArrayHelper::getColumn($array, 'id'); //输出 ['123', '345']//如需要额外的转换或者取值的方法比较复杂,第二个参数可以指定一个匿名函数 ArrayHelper::map1234567891011121314151617181920212223$array = [ ['id' =&gt; '123', 'name' =&gt; 'aaa', 'class' =&gt; 'x'], ['id' =&gt; '124', 'name' =&gt; 'bbb', 'class' =&gt; 'x'], ['id' =&gt; '345', 'name' =&gt; 'ccc', 'class' =&gt; 'y'],];$result1 = ArrayHelper::map($array, 'id', 'name');$result2 = ArrayHelper::map($array, 'id', 'name', 'class');//结果分别是[ '123' =&gt; 'aaa', '124' =&gt; 'bbb', '345' =&gt; 'ccc',]------- map($array, 'id', 'name', 'class')这里面的键逆向--------------[ 'x' =&gt; [ '123' =&gt; 'aaa', '124' =&gt; 'bbb', ], 'y' =&gt; [ '345' =&gt; 'ccc', ],] ArrayHelper::keyExists 只能是一维数组12345678910$data1 = [ 'userName' =&gt; 'Alex',];$data2 = [ 'username' =&gt; 'Carsten',];var_dump(ArrayHelper::keyExists('username',$data1,true));//输出 falsevar_dump(ArrayHelper::keyExists('username',$data2,false));//输出 true ArrayHelper::multisort 多维数组排序12345678910111213$data = [ ['age' =&gt; 30, 'name' =&gt; 'Alexander'], ['age' =&gt; 30, 'name' =&gt; 'Brian'], ['age' =&gt; 19, 'name' =&gt; 'Barney'],];ArrayHelper::multisort($data,['age','name'],[SORT_ASC,SORT_DESC]);//输出, age 排序, name 排序[ ['age' =&gt; 19, 'name' =&gt; 'Barney'], ['age' =&gt; 30, 'name' =&gt; 'Brian'], ['age' =&gt; 30, 'name' =&gt; 'Alexander'],]; ArrayHelper::isIndexed ArrayHelper::isAssociative 检测数组是索引数组还是联合数组1234567// 不指定键名的数组$indexed = ['Qiang', 'Paul'];echo ArrayHelper::isIndexed($indexed); //true// 所有键名都是字符串$associative = ['framework' =&gt; 'Yii', 'version' =&gt; '2.0'];echo ArrayHelper::isAssociative($associative); //true ArrayHelper::isIn ArrayHelper::isSubset 测试阵列123456// trueArrayHelper::isIn('a', ['a']);// trueArrayHelper::isIn('a', new \\ArrayObject(['a']));// trueArrayHelper::isSubset(new \\ArrayObject(['a','c']),new \\ArrayObject(['a','b','c'])); ArrayHelper::filter 过滤1234567891011121314151617181920212223$array = [ 'A' =&gt; [1, 2], 'B' =&gt; [ 'C' =&gt; 1, 'D' =&gt; 2, ], 'E' =&gt; 1,];$result1 = ArrayHelper::filter($array,['A']);$result2 = ArrayHelper::filter($array,['A','B.C']);$result3 = ArrayHelper::filter($array,['B','!B.C']);//输出['A' =&gt; [1, 2]];//输出[ 'A' =&gt; [1, 2], 'B' =&gt; ['C' =&gt; 1]]//输出[ 'B' =&gt; ['D' =&gt; 2],] 官网 zh-cn","tags":[]},{"title":"win -Yii2 镜像源","date":"2018-09-29T22:46:22.414Z","path":"2018/09/30/win/composer/","text":"查看composer 全局设置1234composer config -glcomposer 镜像源配置文件:C:\\Users\\Administrator\\AppData\\Roaming\\Composer\\config.json 修改镜像源1234国内镜像composer config -g repo.packagist composer https://packagist.phpcomposer.com国际镜像composer config -g repo.packagist composer https://packagist.org","tags":[]},{"title":"wind -Yii2 添加扩展","date":"2018-09-29T22:46:22.407Z","path":"2018/09/30/win/yii2_composer_vendor/","text":"安装完 Yii2 没有vendor目录12在 yii 跟目录下执行,首次添加最新扩展包composer update 添加 redis 扩展1234567891011121314在根目录执行 composer require yiisoft/yii2-redis 这时在 composer.json 中会自动添加 yiisoft/yii2-redis\": \"^2.0\" 在 vendor/yiisoft/extension.php 中会自动添加'yiisoft/yii2-redis' =&gt; array( 'name' =&gt; 'yiisoft/yii2-redis', 'version' =&gt; '2.0.9.0', 'alias' =&gt; array( '@yii/redis' =&gt; $vendorDir . '/yiisoft/yii2-redis/src', ), ), !!!添加 redis 扩展021234567891011在composer.json 文件中添加 redis扩展 \"yiisoft/yii2-redis\": \"~2.0.0\"\"require\": &#123; \"php\": \"&gt;=5.4.0\", \"yiisoft/yii2\": \"~2.0.6\", \"yiisoft/yii2-bootstrap\": \"~2.0.0\", \"yiisoft/yii2-swiftmailer\": \"~2.0.0 || ~2.1.0\", \"yiisoft/yii2-redis\": \"~2.0.0\"&#125;,然后在根目录执行 composer update,这时候会自动升级 composer.lock 文件,redis 扩展添加成功,[ !!!这种方法会自动升级扩展!!! ] !!! install , update , require添加一个新的扩展包建议使用 composer require 另外2个会更新所有扩展到最新版本 composer install 命令从当前目录读取 composer.json 文件，处理了依赖关系，并把其安装到 vendor 目录下。如果当前目录下存在 composer.lock 文件，它会从此文件读取依赖版本，而不是根据 composer.json 文件去获取依赖。这确保了该库的每个使用者都能得到相同的依赖版本。如果没有 composer.lock 文件，composer 将在处理完依赖关系后创建它. composer update 为了获取依赖的最新版本，并且升级 composer.lock 文件，你应该使用 update 命令。 扩展扩展: 这里配置 reids 后,使用 phpstorm 写代码的时候,redis是没有提示的,比如 Yii::$app-&gt;redis-&gt;set(“hello”,”world”);,这里的reids在phpstorm中是跟踪不到的,解决这个问题,在 \\vendor\\yiisoft\\yii2\\base\\Application.php 中的上面注释中添加如下: @property \\yii\\redis\\Connection $redis 这样 phpstorm 就可以跟踪代码,并且 Yii::$app-&gt;redis-&gt;set(“hello”,”world”); 这个set 也会有提示; 扩展02 view 层 render 提示12# 一般情况下 view 层这个是没有提示的, 在页面的上面添加 /* @var $this \\yii\\web\\View */&lt;?= $this-&gt;render('footer/_about'); ?&gt; 移除扩展包1composer remove yiisoft/yii2-redis 官方解释 https://docs.phpcomposer.com/03-cli.html#init https://docs.phpcomposer.com/03-cli.html#init","tags":[]},{"title":"-sql DML (insert update delete select)基本使用","date":"2018-09-28T15:17:32.613Z","path":"2018/09/28/mysql/sql_DML/","text":"事务123456789101112start transaction;update 表名 set money=money+500 where id = 2;update 表名 set money=money-500 where id = 1;commit;select * from 表名 where id =1;select * from 表名 where id =2;+++++++start transaction;update 表名 set money=money+500 where id = 2;rollback; where having group查询1234567891011121314151617181920212223242526272829303132333435363738394041424344454647要求:查询出2门及2门以上不及格者的平均成绩 demo sql如下:--------------------------------------------------------------------------CREATE TABLE `student2` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL, `subject` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL, `score` double(255,0) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;INSERT INTO `student2` VALUES (&apos;1&apos;, &apos;张三&apos;, &apos;数学&apos;, &apos;90&apos;);INSERT INTO `student2` VALUES (&apos;2&apos;, &apos;张三&apos;, &apos;语文&apos;, &apos;50&apos;);INSERT INTO `student2` VALUES (&apos;3&apos;, &apos;张三&apos;, &apos;地理&apos;, &apos;40&apos;);INSERT INTO `student2` VALUES (&apos;4&apos;, &apos;李四&apos;, &apos;语文&apos;, &apos;55&apos;);INSERT INTO `student2` VALUES (&apos;5&apos;, &apos;李四&apos;, &apos;政治&apos;, &apos;45&apos;);INSERT INTO `student2` VALUES (&apos;6&apos;, &apos;王五&apos;, &apos;政治&apos;, &apos;30&apos;);INSERT INTO `student2` VALUES (&apos;7&apos;, &apos;马六&apos;, &apos;地理&apos;, &apos;80&apos;);INSERT INTO `student2` VALUES (&apos;8&apos;, &apos;马六&apos;, &apos;英语&apos;, &apos;90&apos;);+----+------+---------+-------+--------+| id | name | subject | score | score2 |+----+------+---------+-------+--------+| 1 | 张三 | 数学 | 90 | 10 || 2 | 张三 | 语文 | 50 | 10 || 3 | 张三 | 地理 | 40 | 10 || 4 | 李四 | 语文 | 55 | 10 || 5 | 李四 | 政治 | 45 | 10 || 6 | 王五 | 政治 | 30 | 10 || 7 | 马六 | 地理 | 80 | 10 || 8 | 马六 | 英语 | 90 | 10 |+----+------+---------+-------+--------+--------------------------------------------------------------------------select name,subject,score,score&lt;60 from student2select name,sum(score&lt;60) as gk ,avg(score) as pj from student2 group by name select name,sum(score&lt;60) as gk ,avg(score) as pj from student2 group by name HAVING gk&gt;=2结果:+--------+------+---------+| name | gk | pj |+--------+------+---------+| 张三 | 2 | 60.0000 || 李四 | 2 | 50.0000 |+--------+------+---------++++++++++++++ having 是对表的结果进行查询筛选 ++++++++select * from student2 where id&gt;1select * from student2 having id&gt;1select * from student2 where id&gt;1 having id&lt;5 INNER JOIN 查询123456789101112131415161718192021222324252627282930313233demos sql:--------------------------------------------------------------------------DROP TABLE IF EXISTS `m`;CREATE TABLE `m` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `hid` int(11) DEFAULT NULL COMMENT &apos;主队ID&apos;, `gid` int(11) DEFAULT NULL COMMENT &apos;客队ID&apos;, `mres` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &apos;比赛结果&apos;, `matime` date DEFAULT NULL COMMENT &apos;比赛开始时间&apos;, PRIMARY KEY (`id`)) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;INSERT INTO `m` VALUES (&apos;1&apos;, &apos;1&apos;, &apos;2&apos;, &apos;2:0&apos;, &apos;2006-05-21&apos;);INSERT INTO `m` VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;1:2&apos;, &apos;2006-06-21&apos;);INSERT INTO `m` VALUES (&apos;3&apos;, &apos;3&apos;, &apos;1&apos;, &apos;2:5&apos;, &apos;2006-06-25&apos;);INSERT INTO `m` VALUES (&apos;4&apos;, &apos;2&apos;, &apos;1&apos;, &apos;3:2&apos;, &apos;2006-07-21&apos;);DROP TABLE IF EXISTS `t`;CREATE TABLE `t` ( `tid` int(11) NOT NULL AUTO_INCREMENT, `tname` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &apos;队伍名称&apos;, PRIMARY KEY (`tid`)) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;INSERT INTO `t` VALUES (&apos;1&apos;, &apos;国安&apos;);INSERT INTO `t` VALUES (&apos;2&apos;, &apos;申花&apos;);INSERT INTO `t` VALUES (&apos;3&apos;, &apos;布尔联队&apos;);--------------------------------多次使用INNER JOIN 查询----------------------SELECT m.id,t1.tname,mres,t2.tname,matime FROM mINNER JOIN t as t1 on m.hid=t1.tid INNER JOIN t as t2 ON m.gid=t2.tid union 和 union all!!!! 使用union waring:1.各语句的列数相同2.列名称未必要一直,列名称会使用第一条sql 的列名称为准3.完全相等行将会合并,合并是比较耗时的操作,使用”union all” 可以避免合并 12345678910111213141516171819202122232425262728293031demos sql:--------------------------------------------------------------------------DROP TABLE IF EXISTS `a`;CREATE TABLE `a` ( `id` char(1) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT &apos;&apos;, `num` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;INSERT INTO `a` VALUES (&apos;a&apos;, &apos;5&apos;);INSERT INTO `a` VALUES (&apos;b&apos;, &apos;10&apos;);INSERT INTO `a` VALUES (&apos;c&apos;, &apos;15&apos;);INSERT INTO `a` VALUES (&apos;d&apos;, &apos;10&apos;);DROP TABLE IF EXISTS `b`;CREATE TABLE `b` ( `id` char(1) COLLATE utf8mb4_unicode_ci NOT NULL, `num` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;INSERT INTO `b` VALUES (&apos;b&apos;, &apos;5&apos;);INSERT INTO `b` VALUES (&apos;c&apos;, &apos;15&apos;);INSERT INTO `b` VALUES (&apos;d&apos;, &apos;20&apos;);INSERT INTO `b` VALUES (&apos;e&apos;, &apos;99&apos;);---------------------------------分组后求和--------------------------------------select id,sum(num) from(select id,num from aunion allselect id,num from b) as tmpgroup by id; 数据从B库导入到A库1INSERT INTO a(id,num) SELECT id,num FROM b","tags":[]},{"title":"-systemctl 常用命令","date":"2018-09-26T01:39:34.070Z","path":"2018/09/26/ubuntu/systemctl_常用命令/","text":"systemctl 常用命令 常用命令 1234567891011121314151617181920212223242526272829303132333435常用命令 重新加载service文件： systemctl daemon-reload启动一个服务： systemctl start nginx-1.13.0.service关闭一个服务： systemctl stop nginx-1.13.0.service重启一个服务： systemctl restart nginx-1.13.0.service显示一个服务的状态： systemctl status nginx-1.13.0.service在开机时启用一个服务： systemctl enable nginx-1.13.0.service在开机时禁用一个服务： systemctl disable nginx-1.13.0.service查看服务是否开机启动： systemctl is-enabled nginx-1.13.0.service查看已启动的服务列表： systemctl list-unit-files|grep enabled查看启动失败的服务列表：systemctl --failedapache启动 systemctl start httpd停止 systemctl stop httpd重启 systemctl restart httpdmysql启动 systemctl start mysqld停止 systemctl stop mysqld重启 systemctl restart mysqldphp-fpm启动 systemctl start php-fpm停止 systemctl stop php-fpm重启 systemctl restart php-fpmnginx启动 systemctl start nginx停止 systemctl stop nginx重启 systemctl restart nginx","tags":[]},{"title":"linux-DDU  -vagrant 简单使用02","date":"2018-09-25T15:13:16.231Z","path":"2018/09/25/centos/vagrant_02/","text":"添加一个 box12vagrant box listvagrant box add centos7 centos7-vagrant-180906.box 初始化1vagrant init centos7 启动12vagrant up --provider virtualbox启动时,SSH 没有权限,下面修改配置, 进入虚拟机 virtualBox ,运行远程登录123456789vim /etc/ssh/sshd_config #修改配置文件PubkeyAuthentication yes #注释取消掉重启服务 systemct1 restart sshd.servicewindows端: ssh vagrant@127.0.0.1 -p2222使用密码登录windows端: ssh vagrant@192.168.56.3 #使用指定ip登录 windows 添加私钥 ssh 免密码登录,[在windows中执行]123456vagrant ssh-config #查看实时连接信息cd /c/Users/Administrator/.vagrant.d/scp -P2222 vagrant@127.0.0.1:~/.ssh/id_rsa ./ #从远程复制私钥到windowsmv insecure_private_key insecure_private_key_old #备份原来文件mv id_rsa insecure_private_key 设置 linux 公钥12cp authorized_keys authorized_keys_oldcat id_rsa.pub &gt; authorized_keys 配置 Vagrantfilevagrantfiile1234567891011config.vm.box = \"centos7\"config.vm.network \"private_network\", ip: \"192.168.56.3\"config.vm.network \"public_network\",:bridge=&gt;'en0: Wi-Fi (AirPort)'config.vm.synced_folder \"E:/data_web/webroot/\", \"/data\",mount_options: [\"dmode=775,fmode=775\"]------------------ 这三种写法都可以 ---------------#config.vm.network \"public_network\",:bridge=&gt;'en0: Wi-Fi (AirPort)'#config.vm.network \"public_network\", ip: \"192.168.1.201\"#config.vm.network \"public_network\", ip: \"192.168.1.200\", :bridge =&gt; 'en0: Wi-Fi (AirPort)' 重启1vagrant reload okwindows中 E:/data_web/webroot/ 下创建文件 ,linux 中 /data ,自动同步","tags":[]},{"title":"-curl  一个利用URL规则在命令行下工作的文件传输工具","date":"2018-09-18T16:13:03.075Z","path":"2018/09/19/ubuntu/linux_DDU_curl/","text":"在 linux 中 curl 是一款利用 URL 规则在命令下工作的开源文件传输工具. 以下 demo 中,使用文件 index.php 作为实例演示, index.php 中内容为 1234567//访问本页面的地址为 www.test.com&lt;?phpprint_r($_GET);echo \"分隔符\";print_r($_POST); 没有参数, 获取页面内容1curl www.test.com 参数 I 显示 HTTP 头123curl -I www.test.com [显示头信息,不显示内容]curl -i www.test.com [显示头和内容] 链接保存到文件中1curl www.test.com &gt; index.html 使用 -d -X发送 POST 请求12curl -d \"post1=001&amp;post2=002\" www.test.comcurl -d \"post1=001&amp;post2=002\" -X POST www.test.com # X大写 POST 大写 使用 -d -G 发送 GET 请求 1curl -d \"get01=111&amp;get02=002\" -G GET www.test.com","tags":[]},{"title":"linux-DDU -ln  为文件创建连接","date":"2018-09-11T16:39:29.395Z","path":"2018/09/12/ubuntu/linux_DDU_ln/","text":"ln 使用的时候要写全路径,否则编辑链接后的文件可能会出现错误:1234root@ubuntu:/home/fei/web# tail -f index.html tail: cannot open 'index.html' for reading: Too many levels of symbolic linkstail: no files remainingroot@ubuntu:/home/fei/web# ll 命令格式1ln [参数] [源文件或目录][目标文件或目录] demo 硬链接12ln /home/fei/www/index.html /home/fei/web/ ln /home/fei/www/index.html /home/fei/web/index.txt # [硬链接]源文件变化后.链接的文件也随着变化 硬链接链接文件删除后,源文件不影响;删除源文件后,链接文件不收影响 软连接符号 -s [ 相当于windows中的快捷方式]12ln -s /home/fei/www/test01.txt /home/fei/web/ln -s /home/fei/www/test05.txt /home/fei/web/test_05.txt #test01.txt 源文件变化后.链接的文件也随着变化 软连接符号 -s链接文件删除后,源文件不影响;删除源文件后,链接文件失效 软连接目录1ln -s /home/fei/www/aaa/ /home/fei/web/ 删除软连接12345正确的是：rm -rf link_result错误的是：rm -rf link_result/ #这个会把整个目录都删了测试: ln -s /home/fei/web/link_source /home/fei/www/link_result","tags":[]},{"title":"linux-DDU  -vagrant 简单使用","date":"2018-09-11T15:43:43.356Z","path":"2018/09/11/centos/vagrant简单使用/","text":"常用命令vagrant 常用命令介绍 12345678910111213141516171819202122vagrant init [初始化]vagrant up [启动虚拟机]vagrant halt [关闭虚拟机]vagrant reload [重新启动虚拟机,主要用于重新载入配置文件]vagrant suspend [暂停虚拟机,这是虚拟机的内存,配置信息会暂存至硬盘]vagrant resume [恢复虚拟机]vagrant ssh [ssh登录到虚拟机]vagrant status [查看虚拟机运行状态]vagrant destroy [销毁当前虚拟机]vagrant box add [添加一个box]vagrant box list [显示当前已经添加的box列表]vagrant box remove [删除相应的box]vagrant package [打包命令,可以吧当前运行的虚拟机环境进行打包]vagrant plugin [用于安装卸载插件]vagrant ssh-config [输出用于ssh连接的一些信息]vagrant 创建的虚拟机账号用户名：vagrant 密 码：vagrant root帐号密码：vagrant用vagrant创建的ubuntu系统，root账号密码默认是没有设置的，需要手动设置 sudo passwd 一般使用 1234567891011121314151617181920212223242526272829303132333435363738391. vagrant --help2. vagrant -version3.显示当前已经添加的box列表 vagrant box list 4. 添加 box vagrant box add new-box-name yours-box-name.box(你的box文件)5. 删除 box vagrant box remove yours-box-name6. 指定 box 初始化 vagrant init yours-box-name7.启动 vagrant up vagrant up --provider virtualbox8.关闭 vagrant halt9.重新启动,加载配置文件 vagrant reload10. 挂起 vagrant suspend11. ssh登录 vagrant ssh12. 打包box打包前删除一个文件sudo rm -rf /etc/udev/rules.d/70-persistent-net.rulesvagrant packagevagrant package --base ubuntu18_default_1543569229538_92064 --output php72_mysql8_nginx.box demo: vagrant --help vagrant -version vagrant box list vagrant box add centos7 centos7-vagrant-123456.box vagrant box list vagrant init centos7 vagrant up --provider virtualbox vagrant ssh vagrant reload vagrant ssh vagrant halt ubuntu box -releases版本 centos box","tags":[]},{"title":"-xargs  用作替换工具，读取输入数据重新格式化后输出","date":"2018-08-28T06:12:27.188Z","path":"2018/08/28/ubuntu/linux_DDU_xargs/","text":"demo在目录中搜索含有固定字符串文件命令，比如：在当前目录(及其子目录)中搜索扩展名为 .txt 结尾文件中包含 hello 的内容的行 1234567891011搜索文件中内容grep \"hello\" test01.txt查找 .txt 结尾的文件find -name \"*.txt\"find /home/fei/www -name \"*.txt\"******************************************************************************find -name \"*.txt\" | xargs grep \"hello\"find /home/fei/www -name \"*.txt\" | xargs grep \"hello\"locate *.txt | xargs grep \"hello\" 单行输出文本内容123cat test01.txt | xargscat test01.txt | xargs -n3 [选项 -n] 其他使用场景demo12cat url.txt | xargs wget -c [下载url.txt 中链接的内容]ls | xargs -n2","tags":[]},{"title":"常见4种排序： 冒泡排序、选择排序、插入排序、快速排序","date":"2018-08-26T16:39:59.460Z","path":"2018/08/27/面试/算法/排序/","text":"这里介绍4种常见排序： 冒泡排序、选择排序、插入排序、快速排序 、二分查找 冒泡排序原理：对一组数据，比较相邻数的大小，将值大的放到后面。 1234567891011121314151617181920212223&lt;?php// 冒泡排序function bubbleOrder($arr)&#123; $count = count($arr); $temp = 0; // 外层控制排序次数 for ($i = 0; $i &lt; $count - 1; $i++) &#123; // 内层控制每轮比较次数 for ($j = 0; $j &lt; $count - 1 - $i; $j++) &#123; if ($arr[$j] &gt; $arr[$j + 1]) &#123; $temp = $arr[$j]; $arr[$j] = $arr[$j + 1]; $arr[$j + 1] = $temp; &#125; // print_r($arr); echo \"&lt;br&gt;\"; &#125; &#125; return $arr;&#125;$arr = array(5, 2, 7, 6, 9, 3);$res = bubbleOrder($arr);var_dump($res); 选择排序原理：在一组数据中，选出最小的数与第一个位置交换，​ 然后在剩下的数据中在找出最小的数和第二个位置交换​ 然后在剩下的数据中在找出最小的数和第三个位置交换​ 依次类推直到倒数第二个数和最后一个数对比 12345678910111213141516171819202122232425262728&lt;?php// 选择排序function selcetOrder($arr)&#123; // 定义中间变量 $temp = 0; $count = count($arr); for ($i = 0; $i &lt; $count - 1; $i++) &#123; //定义最小位置 $minIndex = $i; for ($j = $i + 1; $j &lt; $count; $j++) &#123; if ($arr[$j] &lt; $arr[$minIndex]) &#123; $minIndex = $j; &#125; &#125; if ($i != $minIndex) &#123; $temp = $arr[$i]; $arr[$i] = $arr[$minIndex]; $arr[$minIndex] = $temp; &#125; &#125; return $arr;&#125;$arr = array(5, 2, 7, 6, 9, 3);$res = selcetOrder($arr);var_dump($res); 插入排序原理： 将需要排序的书，与前面已经排好的数据从后往前进行比较，使其插入到相应的位置； 1234567891011121314151617181920212223&lt;?php// 插入排序function insertOrder($arr)&#123; $len = count($arr); //控制总循环次数 for ($i = 0; $i &lt; $len; $i++) &#123; $temp = $arr[$i]; for ($j = $i - 1; $j &gt;= 0; $j--) &#123; //从当前位置从后往前进行对比 if ($temp &lt; $arr[$j]) &#123; $arr[$j + 1] = $arr[$j]; $arr[$j] = $temp; &#125;else&#123; break; &#125; &#125; &#125; return $arr;&#125;$arr = array(5, 2, 7, 6, 9, 3);$res = insertOrder($arr);var_dump($res); 快速排序原理：初始一个中间值(一般选择第一个)，将需要排序的数组分成3部分，小于中间的值放左边、中间值、大于中间值的放右边，继续用递归用相同的方式来排序左边和右边，最后合并数组 1234567891011121314151617181920212223242526&lt;?php// 快速排序function quickOrder($arr)&#123; // 判断是否需要运行,下面要拿出一个中间值 if (count($arr)&lt;=1) &#123; return $arr; &#125; $middle = $arr[0]; // 中间值 $left = array(); $right = array(); for ($i = 1; $i &lt; count($arr); $i++) &#123; if ($middle &lt; $arr[$i]) &#123; $right[] = $arr[$i]; &#125; else &#123; $left[] = $arr[$i]; &#125; &#125; // 递归排序划分好的2边数组 $left = quickOrder($left); $right = quickOrder($right); return array_merge($left, array($middle), $right);&#125;$arr = array(5, 2, 7, 6, 9, 3);$res = quickOrder($arr);var_dump($res); 二分查找1234567891011121314151617181920// 正向排序的数组$arr = array(1, 3, 5, 7, 9, 11);// $arr = array(1, 3, 20, 7, 9, 11);// $arr2 = array(11, 9, 7, 5, 3, 1);function binary_search($array, $low, $high, $k)&#123; if ($low &lt;= $high)&#123; $mid = intval(($low+$high)/2); //intval();floor() 都可以无所谓 if ($array[$mid] == $k)&#123; return $mid; &#125;elseif ($k &lt; $array[$mid])&#123; return binary_search($array, $low, $mid-1, $k); &#125;else&#123; return binary_search($array, $mid+1, $high, $k); &#125; &#125; return '必须是正向排序数组';&#125;echo binary_search($arr, 0, 5, 9);","tags":[]},{"title":"-locate 搜索","date":"2018-08-25T18:20:48.726Z","path":"2018/08/26/ubuntu/linux_DDU_locate_updatedb/","text":"使用 locate 搜索前一般先执行 updatedb 来更新 命令格式1locate [选项] [参数] 选项123-n 至多显示 n个输出。-r 使用正规运算式 做寻找的条件。-c 查询指定文件的数目 demo 123locate pwdlocate -n 2 pwd [显示2条输出]locate -r pwdt.* [使用正则] 指定位置搜索1locate aaa/linux.txt 查询指定文件的数目12locate -c pwdlocate -c pwdt","tags":[]},{"title":"-rename  文件重命名","date":"2018-08-19T13:05:44.345Z","path":"2018/08/19/ubuntu/linux_DDU_rename/","text":"命令格式，文件重命名1234567rename [-v] [-n] [-f] perlexpr[files]-v 打印被重命名的文件-n 只显示被重命名的文件，而不实际重命名-f 覆盖已经存在的文件perlexpr 语言格式的正则表达式 demo把 test02.txt 重命名为 test03.txt1rename 's/test02.txt/test03.txt/' test02.txt 参数 -v 打印被重命名的文件1rename -v 's/test03.txt/test02.txt/' test03.txt 参数 -n 只显示被重命名的文件，而不实际重命名1rename -n 's/test02.txt/test03.txt/' test02.txt [实际没有重命名] 参数 -f 覆盖已经存在的文件12rename -f 's/test02.txt/test08.txt/' test02.txtrename -f 's/test02.txt/test08.txt/' *.txt [也可以] 表达式中 替换用 s ,转化用 y 或者trdemo ： 将文件名改为大写12rename 'y/a-z/A-Z/' *.txtrename 'tr/a-z/A-Z/' *.txt","tags":[]},{"title":"-nl  计算文件中行号","date":"2018-08-13T12:26:48.173Z","path":"2018/08/13/ubuntu/linux_DDU_nl/","text":"介绍： 计算文件中行号； 命令格式1nl [选项] [参数] 选项12345678910-b ：指定行号指定的方式，主要有两种： -b a ：表示不论是否为空行，也同样列出行号(类似 cat -n)； -b t ：如果有空行，空的那一行不要列出行号(默认值)；-n ：列出行号表示的方法，主要有三种： -n ln ：行号在萤幕的最左方显示； -n rn ：行号在自己栏位的最右方显示，且不加 0 ； -n rz ：行号在自己栏位的最左方显示，且加 0 ；-w ：行号栏位的占用的位数。 参数-b 指定行号列出 test01.txt 的内容【-b a ; -b t】 demo 123nl -b a test01.txt 【空行显示行号】nl -b t test01.txt 【空行不显示行号】 参数-n 显示行号列出test01.txt 的内容【-n ln ; -n ln; -n rz】 demo 12345nl -n ln test01.txt 【行号在左】nl -n rn test01.txt 【行号在右】nl -n rz test01.txt 【行号在左，且加零】 参数-w 列出行号占用的位数 demo 12nl -n rz -w 3 test01.txtnl -n rz -w 5 test01.txt","tags":[]},{"title":"Ubuntu -nginx","date":"2018-06-07T02:23:37.436Z","path":"2018/06/07/ubuntu/linux_ubuntu_nginx_02/","text":"日志切割 testlog.sh使用脚本切割 nginx 日志，脚本内容如下 123456789101112131415161718192021222324252627282930313233--------------------------nginx.conf--------------------- #打开注释 #log_format main server &#123; listen 80; server_name test.com; location / &#123; root test.com; index index.html index.htm; &#125; access_log logs/test.com.access.log main; &#125; --------------------------testlog.sh---------------------#!/bin/bashLOGPATH=/data/server/nginx-1.4.2/logs/test.com.access.logBASEPATH=/data/$(date -d yesterday +%Y%m)mkdir -p $BASEPATHbak=$BASEPATH/$(date -d yesterday +%Y%m%d%H%M).test.com.access.log#echo $bakmv $LOGPATH $baktouch $LOGPATHkill -USR1 cat /data/server/nginx-1.4.2/logs/nginx.pid-------------------------------------------------- location 精准匹配，正则匹配1234Syntax: location [ = | ~ | ~* | ^~ ] uri &#123; ... &#125;location @name &#123; ... &#125;Default: —Context: server, location location 模块 location 二级目录,忽略index.html12 rewrite 重写12345location /h5cfsh &#123; index index.html; root /usr/local/apache2/htdocs/cfsh/h5cfsh/dist/; rewrite ^(.*)$ /index.html break;&#125;","tags":[]},{"title":"-head -tail -sed 输出文件中的内容","date":"2018-06-06T06:02:36.798Z","path":"2018/06/06/ubuntu/linux_DDU_head_tail/","text":"命令 head命令格式1head [选项] [参数] 选项1-n&lt;数字&gt;：指定显示头部内容的行数； demo 默认显示文件前 10 行内容 参数 n 显示文件的前 2 行 123456#显示文件的前2行head -2 d01.txthead -n 2 d01.txt#输出除了文件最后 2 行的全部内容head -n -2 d01.txt 命令 tail命令格式1tail [选项] [参数] 选项123-n&lt;N&gt;或——line=&lt;N&gt;：输出文件的尾部N（N位数字）行内容。-f&lt;name/descriptor&gt;：显示文件最新追加的内容。“name”表示以文件名的方式监视文件的变化。-F：与选项“-follow=name”和“--retry\"连用时功能相同； demo 默认显示文件最后 10 行内容 选项 n 显示文件最后 2 行内容 12345tail -2 d01.txttail -n 2 d01.txt#从文件第 3 行开始显示内容tail -n +3 d01.txt 选项 f ,动态显示文件内容 123ping 127.0.0.1 &gt; d01.log &amp; #创建动态任务tail -f d01.log #动态显示文件内容 选项 tail -F 功能与 tail -f 功能相同，不同的是执行此命令时文件可以不存在 命令 sed, 其他使用参考 -sed 整理12#显示文件中的指定行内容,显示index.php 中的第2行到第5行内容sed -n '2,5p' index.php 其他12345#文件中前3行写人到新文件head -3 index.php &gt; test.php #文件中后5行写入到新文件中tail -5 index.php &gt; test2.php","tags":[]},{"title":"-less -more  显示目录列表","date":"2018-05-30T00:28:16.082Z","path":"2018/05/30/ubuntu/linux_DDU_less_more/","text":"less 与 more 类似，但使用 less 可以随意浏览文件，而且 less 在查看之前不会加载整个文件 命令 less命令格式1less [选项] [参数] 选项1234567891011121314/字符串：向下搜索“字符串”的功能?字符串：向上搜索“字符串”的功能n：重复前一个搜索（与 / 或 ? 有关）N：反向重复前一个搜索（与 / 或 ? 有关）b 向后翻一页d 向后翻半页h 显示帮助界面q 退出less 命令u 向前滚动半页y 向前滚动一行空格键 滚动一行回车键 滚动一页[pagedown]： 向下翻动一页[pageup]： 向上翻动一页 参数文件：指定要分屏显示内容的文件。 demo12345678910111213less d01.txt #查看文件ps -ef | less #PS查看进程信息并通过 less 分页显示history | less #查看历史使用记录并通过 less 分页显示q 退出less 命令[pagedown]： 向下翻动一页[pageup]： 向上翻动一页less d01.txt d02.txt d03.txt #浏览多个文件说明：输入 :n后,切换到 d02.txt,继续输入:n后,切换到 d03.txt输入 :p后,切换到 d02.txt,继续输入:p后,切换到 d01.txt 命令 moremore命令从前向后读取文件，因此在启动时就加载整个文件。 命令格式1less [选项] [参数] 选项123456789+n 从笫n行开始显示-n 定义屏幕大小为n行+/pattern 在每个档案显示前搜寻该字串（pattern），然后从该字串前两行之后开始显示 -c 从顶部清屏，然后显示-d 提示“Press space to continue，'q' to quit（按空格键继续，按q键退出）”，禁用响铃功能-l 忽略Ctrl+l（换页）字符-p 通过清除窗口而不是滚屏来对文件进行换页，与-c选项相似-s 把连续的多个空行显示为一行-u 把文件内容中的下画线去掉 常用命令 123456789Enter 向下n行，需要定义。默认为1行Ctrl+F 向下滚动一屏空格键 向下滚动一屏Ctrl+B 返回上一屏= 输出当前行的行号：f 输出文件名和当前行的行号V 调用vi编辑器!命令 调用Shell，并执行命令 q 退出more demo12more +1 d01.txt #显示文件中从第1行器内容more +2 d01.txt #显示文件中从第2行器内容 从文件中查找第一个出现 “d01” 字符串的行，并从该处前2行显示输出从文件中查找第一个出现 “3” 字符串的行，并从该处前2行显示输出从文件中查找第一个出现 “hello” 字符串的行，并从该处前2行显示输出 123more +/d01 d01.txtmore +/3 d01.txtmore +/hello d01.txt 123456789设定每屏显示行数more -1 d01.txtmore -2 d01.txt列一个目录下的文件，由于内容太多，我们应该学会用more来分页显示。这得和管道 | 结合起来ls -l | more -1ls -l | more -2q 键退出，enter向下","tags":[]},{"title":"-mkdir  -rmdir 显示目录列表","date":"2018-05-28T09:47:37.194Z","path":"2018/05/28/ubuntu/linux_DDU_mkdir_rmdir/","text":"mkdir 不指定参数，创建文件默认权限 为 755 rwxr-xr-x 命令格式1mkdir [选项] [参数] 选项123-m&lt;目标属性&gt;或--mode&lt;目标属性&gt;建立目录的同时设置目录的权限；-p或--parents 若所要建立目录的上层目录目前尚未建立，则会一并建立上层目录；--version 显示版本信息。 参数目录：指定要创建的目录列表，多个目录之间用空格隔开 demo选项 -m 创建目录并设置权限1mkdir -m 700 /www/test #在 /www 目录下创建子目录test，并设置 700 权限 选项 -m 创建 子目录1mkdir -p aaa/bbb #在当前目录创建 aaa 目录 和 aaa下的bbb目录 rmdir只可以删除空目录 命令格式1rmdir [选项] [参数] 选项1234-p或--parents：删除指定目录后，若该目录的上层目录已变成空目录，则将其一并删除；-v或-verboes：显示命令的详细执行过程；--help：显示命令的帮助信息；--version：显示命令的版本信息。 参数目录列表：要删除的空目录列表。当删除多个空目录时，目录名之间使用空格隔开。 选项 -p 删除空目录12rmdir aaa/bbb #删除 bbb 目录rmdir -p aaa/bbb #删除 bbb 目录，如果aa目录是空也一并删除","tags":[]},{"title":"-sh  shell 脚本","date":"2018-05-28T01:00:49.977Z","path":"2018/05/28/ubuntu/linux_DDU_sh/","text":"简单shell，打印昨天时间，并输出到屏幕上，注意 反引号echo 把执行命令的返回结果输出到屏幕上运行脚本 sh test.sh ; test.sh 内容如下 123456#!/bin/bashecho 'date -d yesterday +%Y%m%d' #没有使用反引号echo `date -d yesterday +%Y%m%d` #使用反引号，输出昨天时间echo `ls /www` #使用反引号，显示 www 目录下文件touch /www/test.txt #在 www 目录下创建 test.txt 文件 demo 2,创建文件，运行命令 sh testlog.sh 12345#!/bin/bashBASEPATH=/data/$(date -d yesterday +%Y%m)bak=$BASEPATH/$(date -d yesterday +%Y%m%d%H%M).test.txtmkdir -p $BASEPATHecho $BASEPATH demo3 运行 test.sh 文件使用 source 命令123456source test.sh # 四个的区别区别, 执行权限; 脚本报错后是否继续执行1) ./test.sh2) sh test.sh3) . test.sh4) source test.sh 利用当前时间作为目录12#!/bin/bashcp -arv /home/fei/www/aaa/ \"/home/fei/www/ffffffffffff_\"$(date +%Y%m%d%H%M) 其他12345678910cat /etc/shells 使用 #sh test.sh #dash test.sh #bash test.sh #rbash test.sh 都是可以执行的 root@ubuntu:/home/fei/web# cat /etc/shells # /etc/shells: valid login shells/bin/sh/bin/dash/bin/bash/bin/rbashroot@ubuntu:/home/fei/web#","tags":[]},{"title":"-cat  连接文件并打印到标准输出设备上 -split 切割文件","date":"2018-05-28T00:28:16.302Z","path":"2018/05/28/ubuntu/linux_DDU_cat_split/","text":"命令格式1cat [选项] [参数] 选项12-n或-number：有1开始对所有输出的行数编号；-b或--number-nonblank：和-n相似，只不过对于空白行不编号； 参数 n 输出行数编号1cat -n d01.txt 参数 b 输出行数编号，忽略空白行1cat -b d01.txt 输出多个文件内容1cat d01.txt d02.txt demo 2 把文件内容写入到新文件中12cat d01.txt &gt; new.txt #将文件 d01.txt 内容放入文件 new.txt 中cat d01.txt d02.txt &gt; new.txt #将文件 d01.txt 和 d02.txt 内容放入文件 new.txt 中 split 切割文件1234567#参数# -a 指定长度# -d 指定数字# -l 按行数切割文件# -b 按大小切割文件split -l 7 test.txt # l 选项根据文件行数切割,每7行切割为一个文件 指定为数字后缀切割123456#-d 指定为数字后缀, -a 指定数字长度split -l 7 test.txt -d -a 4#-a 指定长度 split -l 7 -a 4 test.txt#前缀为fei_split -l 7 -a 4 test.txt fei_ 按大小切割文件1split -b 100 test.txt #每100kb切割文件 当用split 分割好文件后,使用cat可以把文件合并为原来的文件12split -l 7 -a 4 test.txt fei_ #分割文件cat fei_a* &gt; bbb.txt #合并文件","tags":[]},{"title":"-sed 自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序","date":"2018-05-04T03:35:28.804Z","path":"2018/05/04/ubuntu/linux_DDU_sed/","text":"介绍： sed 是实现对流的编辑。要修改原文件记得用参数 i 。 sed命令格式1234sed [options] 'command' file(s)sed [options] -f scriptfile file(s)sed 选项 '参数/文本中内容/新内容' file(s) 选项1234-e&lt;script&gt;或--expression=&lt;script&gt;：以选项中的指定的script来处理输入的文本文件；-h或--help：显示帮助；-n或--quiet或——silent：仅显示script处理后的结果；-V或--version：显示版本信息。 命令12345678a\\ 在当前行下面插入文本。 没有特殊字符直接写 a 即可i\\ 在当前行上面插入文本。 没有特殊字符直接写 i 即可d 删除，删除选择的行。D 删除模板块的第一行。s 替换指定字符n 读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。p 打印模板块的行。q 退出Sed。 sed 替换标记1234g 表示行内全面替换。 p 表示打印行。 \\1 子串匹配标记&amp; 已匹配字符串标记 sed 元字符集12345678910111213^ 匹配行开始，如：/^sed/匹配所有以sed开头的行。$ 匹配行结束，如：/sed$/匹配所有以sed结尾的行。. 匹配一个非换行符的任意字符，如：/s.d/匹配s后接一个任意字符，最后是d。* 匹配0个或多个字符，如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。[] 匹配一个指定范围内的字符，如/[ss]ed/匹配sed和Sed。 [^] 匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。\\(..\\) 匹配子串，保存匹配的字符，如s/\\(love\\)able/\\1rs，loveable被替换成lovers。&amp; 保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love这成**love**。\\&lt; 匹配单词的开始，如:/\\&lt;love/匹配包含以love开头的单词的行。\\&gt; 匹配单词的结束，如/love\\&gt;/匹配包含以love结尾的单词的行。x\\&#123;m\\&#125; 重复字符x，m次，如：/0\\&#123;5\\&#125;/匹配包含5个0的行。x\\&#123;m,\\&#125; 重复字符x，至少m次，如：/0\\&#123;5,\\&#125;/匹配至少有5个0的行。x\\&#123;m,n\\&#125; 重复字符x，至少m次，不多于n次，如：/0\\&#123;5,10\\&#125;/匹配5~10个0的行。 demo选项 i 、n , s ， p 替换文本中指定字符串12345678910sed -i 's/原内容/新内容/g' 文件 #!!!注意这里 g 是全文替换!!!注意这个参数并没有实际修改文件的内容sed 's/d01.txt/dd0011.txt/' d01.txt #对流的修改，没有真实修改文件内容sed -i 's/d01.txt/dd0011.txt/' d01.txt # 真实修改文件内容选项 n 仅显示script处理后的结果 , p 打印模板块的行sed -n 's/d01.txt/dd0011.txt/p' d01.txt #打印发生修改的行，没有真实修改文件sed 's/d01.txt/dd0011.txt/' d01.txt &gt; d01.txt.tmp #保存为临时文件mv d01.txt.tmp d01.txt #确认临时文件修改内容争取后替换原文件 定界符以上命令字符串中使用 / 在 sed 中作为定界符使用，也可以使用任意的定界符 1234567sed 's:d01.txt:dd0011.txt:' d01.txt #对流的修改，没有真实修改文件内容在对文本中含有特殊字符的时候可以考虑使用其他定界符，比如，原内容或者新内容中包含（\"/\" \"#\"）sed -i 's:原内容:新内容:g' 文件名字 sed 's:d01.txt:dd0011.txt:' d01.txtsed -i 's,原内容,新内容,g' 文件名字 sed 's,d01.txt,dd0011.txt,' d01.txtsed -i 's#原内容#新内容#g' 文件名字 sed 's#d01.txt#dd0011.txt#' d01.txtsed -i 's~原内容~新内容~g' 文件名字 sed 's~d01.txt~dd0011.txt~' d01.txt 命令 d 删除操作123456789101112131415删除空白行sed '/^$/d' d01.txt [ 对流的删除 ]sed -i '/^$/d' d01.txt [ 真实删除空白行后，保存 ]删除文件的第2行sed '2d' d01.txt删除文件的第2行到末尾所有行：sed '2,$d' d01.txt 删除文件的最后一行sed '$d' d01.txt删除文件中所有开头是 hello 的行sed '/^hello/d' d01.txt 已匹配字符串标记 &amp; ，注意这个符号12345678正则表达式 \\w\\+ 匹配每一个单词，使用 [&amp;] 替换它，&amp; 对应于之前所匹配到的单词sed 's/\\w\\+/[&amp;]/g' d01.txt [ 使用 &amp; 替换]sed 's/\\w\\+/[]/g' d01.txt [ 空白 ]sed -i 's/\\w\\+/[&amp;]/g' d01.txt [真是替换，并保存]所有以 hello 开头的行都会被替换成他自己加 hi sed 's/^hello/&amp;hi/' d01.txt 字符串匹配标记 \\112345echo this is digit 6 in a number | sed 's/digit \\([0-9]\\)/\\1/'echo this is digit 6 in a number | sed 's/digit \\([0-9]\\)/\\1test/'echo this is test 6 | sed 's/test \\([0-9]\\)/\\1/'echo this is test 6 | sed 's/test \\([0-9]\\)/\\1test/' 命令中 digit 6，被替换成了 6。样式匹配到的子串是 7，(..) 用于匹配子串，对于匹配到的第一个子串就标记为 \\1，依此类推匹配到的第二个结果就是 \\2，例如： 12echo aaa BBB | sed 's/\\([a-z]\\+\\) \\([A-Z]\\+\\)/\\2 \\1/'echo aaa BBB | sed 's/\\([a-z]\\+\\) \\([A-Z]\\+\\)/\\1 \\2/' 12hi 被标记为 1 ,所有 hiLinux 会被替换成 hiUbuntu, 并打印出来sed -n 's/\\(hi\\)Linux/\\1Ubuntu/p' d01.txt 选项 e 允许在同一行里执行多条命令123sed -e '1,2d' -e 's/d01.txt/dd0011.txt/' d01.txt 第一条命令，删除1到2行，第二条命令用 dd0011.txt 替换 d01.txt。 这两条命令的前后顺序有影响，如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果 退出 命令： q12打印挖第3行后，退出sedsed '3q' d01.txt 打印奇数行或偶数行123456sed -n 'p;n' d01.txt #奇数行sed -n 'n;p' d01.txt #偶数行或者sed -n '1~2p' d01.txt #奇数行sed -n '2~2p' d01.txt #偶数行 插入新一行内容1234567sed '4a\\我是新添加行内容' d01.txt #在第4行后插入下一行sed '4a我是新添加行内容' d01.txt #在第4行后插入下一行,[没有特殊字符不用加 \\ 也行]sed '/hello/a\\我是新添加行内容' d01.txt #在所有包含 hello 行后面插入下一行sed '4i\\我是新添加行内容' d01.txt #在第4行前插入下一行sed '4i我是新添加行内容' d01.txt #在第4行前插入下一行,[没有特殊字符不用加 \\ 也行]sed '/hello/i\\我是新添加行内容' d01.txt #在所有包含 hello 行前面面插入下一行 替换某一行内容12sed \"1s/.*/第一行全部替换新内容/\" d01.txt #把第一行内容全部替换sed \"2s/.*/第二行全部替换新内容/\" d01.txt #把第二行内容全部替换 其他12345678910111213sed -i 's/d01.txt/dd0011.txt/' d01.txt # 真实修改文件内容 用参数 i某些转义符\\n 表示新的一行\\r 表示回车\\t 表示水平制表符\\v 表示垂直制表符\\b 表示后退符\\a 表示\"alert\"(蜂鸣或者闪烁)\\0xx 转换为八进制的ASCII码#显示文件中的指定行内容,显示index.php 中的第2行到第5行内容sed -n '2,5p' index.php","tags":[]},{"title":"","date":"2018-05-02T01:20:31.179Z","path":"2018/05/02/ubuntu/linux_DDU_grep/","text":"title: -grep 查找文件里符合条件的字符串 命令格式1grep [选项] [文件] 命令参数12345678910111213141516171819202122232425-a 不要忽略二进制数据。-A&lt;显示列数&gt; 除了显示符合范本样式的那一行之外，并显示该行之后的内容。-b 在显示符合范本样式的那一行之外，并显示该行之前的内容。-c 计算符合范本样式的列数。-C&lt;显示列数&gt;或-&lt;显示列数&gt; 除了显示符合范本样式的那一列之外，并显示该列之前后的内容。-d&lt;进行动作&gt; 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作。-e&lt;范本样式&gt; 指定字符串作为查找文件内容的范本样式。-E 将范本样式为延伸的普通表示法来使用，意味着使用能使用扩展正则表达式。-f&lt;范本文件&gt; 指定范本文件，其内容有一个或多个范本样式，让grep查找符合范本条件的文件内容，格式为每一列的范本样式。-F 将范本样式视为固定字符串的列表。-G 将范本样式视为普通的表示法来使用。-h 在显示符合范本样式的那一列之前，不标示该列所属的文件名称。-H 在显示符合范本样式的那一列之前，标示该列的文件名称。-i 忽略字符大小写的差别。-l 列出文件内容符合指定的范本样式的文件名称。-L 列出文件内容不符合指定的范本样式的文件名称。-n 在显示符合范本样式的那一列之前，标示出该列的编号。-q 不显示任何信息。-R/-r 此参数的效果和指定“-d recurse”参数相同。-s 不显示错误信息。-v 反转查找。-w 只显示全字符合的列。-x 只显示全列符合的列。-y 此参数效果跟“-i”相同。-o 只输出文件中匹配到的部分。 在文件中搜索一个单词，命令会返回一个包含 PHP 的文本【行或者段落】12grep PHP aaa.txtgrep php aaa.txt 多个文件中搜索，命令会返回一个包含 PHP 的文本【行或者段落】1grep php aaa.txt bbb.txt 选项 -v 输出除 xxxxxx 之外的所有行或者段落1grep -v php aaa.txt 选项 -E 使用正则表达式12grep -E \"[1-9]+\" aaa.txt 或者egrep \"[1-9]+\" aaa.txt 选项 -o 只输出文件中匹配到的部分12grep -o php aaa.txtgrep -o PHP aaa.txt 选项 -c 统计文本或者文本中包含匹配字符串的行数[ 选项 -n ]123456统计grep -c \"PHP\" aaa.txt选项 -n 输出包含匹配字符串的行数grep -n \"PHP\" aaa.txtgrep -n \"php\" aaa.txt 选项 -l 搜索多个文件并查找匹配文本在那个文件中123grep -l php aaa.txt bbb.txtgrep -l php *.txtgrep -l PHP *.txt 选项 -r 递归搜索文件123grep PHP . -r [ . 表示当前目录]grep PHP . -r -ngrep PHP /home/www/test -r -n [ 指定目录 ] 选项 -i 忽略大小写搜索文件1grep -i php aaa.txt 选项 -e 扩展多个匹配样式1grep -e php -e The aaa.txt [ 搜索 PHP、搜索 The ] 选项 -q 静默输出，一般配合 if 逻辑判断1234567if grep -q hello aaa.txt ; then echo yes;else echo no; fiif grep -q php aaa.txt ; then echo yes;else echo no; figrep -q php aaa.phpgrep -q hello aaa.php不会输出任何内容，命令运行成功返回 0 ，失败返回非 0 值，一般配合逻辑判断使用 选项 -A -B -C 显示匹配结果之后行、之前行、之前之后行12345678910111213141516171819测试文件 aaa.php 内容如下，注意看行号： 1 I am aaa.php 2 222 3 hello world 3 line 4 444 5 hello php grep_test 6 666 7 hello world 7 line 8 888 9 hello worldgrep -A1 -n php aaa.php [ 1代表显示多少行，-n 表示显示行号]显示匹配结果之后 1 行grep -A1 -n php aaa.php [ 匹配结果之后的1行 ]grep -B1 -n php aaa.php [ 匹配结果之前的1行 ]grep -C1 -n php aaa.php [ 匹配结果之前的1行和之后一行]grep -C1 -n php aaa.php 其他： grep家族总共有三个：grep，egrep，fgrep。","tags":[]},{"title":"-ls 显示目录列表","date":"2018-05-02T01:14:42.225Z","path":"2018/05/02/ubuntu/linux_DDU_ls/","text":"命令格式1ls[选项][文件][目录] 命令参数1234567891011121314151617181920212223242526272829303132-a：显示所有档案及目录（ls内定将档案名或目录名称为“.”的视为影藏，不会列出）；-A：显示除影藏文件“.”和“..”以外的所有文件列表；-c：与“-lt”选项连用时，按照文件状态时间排序输出目录内容，排序的依据是文件的索引节点中的ctime字段。与“-l”选项连用时，则排序的一句是文件的状态改变时间；-C：多列显示输出结果。这是默认选项；-l：与“-C”选项功能相反，所有输出信息用单列格式输出，不输出为多列；以长格式显示目录下的内容列表。输出的信息从 左到右依次包括文件名，文件类型、权限模式、硬连接数、所有者、组、文件大小和文件的最后修改时间等；-L：如果遇到性质为符号链接的文件或目录，直接列出该链接所指向的原始文件或目录；-f：此参数的效果和同时指定“aU”参数相同，并关闭“lst”参数的效果；-F：在每个输出项后追加文件的类型标识符，具体含义：“*”表示具有可执行权限的普通文件，“/”表示目录，“@”表示符号链接，“|”表示命令管道FIFO，“=”表示sockets套接字。当文件为普通文件时，不输出任何标识符；-r：以文件名反序排列并输出目录内容列表；-R：递归处理，将指定目录下的所有文件及子目录一并处理；--full-time：列出完整的日期与时间； 等价于full-iso--time-style=long-iso 显示时间风格//////////// 以下不经常用到 //////////////-b：将文件中的不可输出的字符以反斜线“”加字符编码的方式输出；-d：仅显示目录名，而不显示目录下的内容列表。显示符号链接文件本身，而不显示其所指向的目录列表；-i：显示文件索引节点号（inode）。一个索引节点代表一个文件；-k：以KB（千字节）为单位显示文件大小；-m：用“,”号区隔每个文件和目录的名称；-n：以用户识别码和群组识别码替代其名称；-s：显示文件和目录的大小，以区块为单位；-t：用文件和目录的更改时间排序；--color[=WHEN]：使用不同的颜色高亮显示不同类型的。 选项 a 、c 、 l 显示目录12345678ls -als -Als -cls -C [ 大写 ]ls -l [常用这个]ls -L 选项 full-time123ls --full-timels -l --time-style=long-isols -l --time-style=local 排除某些文件显示123456ls *.txt|egrep -v '(*.md)'ls *.txt|egrep -v *.mdls | grep -v aaa.txtls *.txt | grep -v aaa.txtls *.txt | egrep -v aaa.txt 显示某一目录下文件，显示 www 目录下文件1ls -l /www","tags":[]},{"title":"-rm  删除文件或目录","date":"2018-04-29T02:04:58.022Z","path":"2018/04/29/ubuntu/linux_DDU_rm/","text":"命令格式1rm [选项] 文件… 命令参数​ -d： 直接把欲删除的目录的硬连接数据删除成0，删除该目录；​ -f, –force 忽略不存在的文件，从不给出提示。​ -i, –interactive 进行交互式删除​ -r, -R, –recursive 指示rm将参数中列出的全部目录和子目录均递归地删除。​ -v, –verbose 详细显示进行的步骤​ –help 显示此帮助信息并退出​ –version 输出版本信息并退出 选项 i 交互式删除1rm -i aaa.txt baa.txt 选项 r 递归删除目录及子目录中文件1rm -r aaa/ 选项 f 直接删除没有任何提示1rm -f bbaa.txt 选项 v 详细显示进行的步骤1rm -v bbb.txt 选项 i 交互式删除，某一类文件1rm -i *aa.txt 排除指定文件删除123456789删除所有 txt 结尾的文件，除了 aaa.txt rm `ls *.txt|egrep -v aaa.txt`rm `ls *.txt|egrep -v '(aaa.txt|bbb.txt|ccc.txt)'`rm `ls *.txt|egrep -v '(aaa.*)'`rm `ls *.txt|egrep -v '(*.md)'` rm命令可以用 -i 选项，这个选项在使用文件扩展名字符删除多个文件时特别有用 ………………………………unlink 命令删除文件，不能删除目录………………………… demo: 删除文件 test02.txt 1unlink test02.txt","tags":[]},{"title":"ubuntu16 -php7 extension imagick","date":"2018-04-20T02:07:11.699Z","path":"2018/04/20/ubuntu/php_extension_imagick/","text":"Extension 之 imagick温馨提示: 在安装过程中出现错误，一般是由于缺少编译工具包导致，可根据提示参照第一步安装相应的工具包即可 安装 ImageMagick12345678wget http://www.imagemagick.org/download/ImageMagick.tar.gz解压到指定目录【我这里是 /data/server/other_component/】tar -zxvf ImageMagick.tar.gz -C /data/server/other_component/cd ImageMagick-7.0.7-28/./configure --prefix=/data/server/other_component/ImageMagick-7.0.7-28 make &amp;&amp; make installexport PKG_CONFIG_PATH=/data/server/other_component/ImageMagick-7.0.7-28/lib/pkgconfig/ #设置环境变量 【重启电脑执行下一步】 安装 imagick123456789101112131415161718wget http://pecl.php.net/get/imagick-3.4.3.tgz解压到指定目录【我这里是 /data/server/other_component/】tar -zxvf imagick-3.4.3.tgz -C /data/server/other_component/cd imagick-3.4.3//data/server/php7/bin/phpize #用phpize生成configure配置文件，[找到你PHP安装位置中的phpsize]./configure \\--with-php-config=/data/server/php7/bin/php-config \\--with-imagick=/data/server/other_component/ImageMagick-7.0.7-28 make &amp; make install安装完成后提示如下，表示安装成功：root@www:/data/server/other_component/phpredis-4.0.0# make installInstalling shared extensions: /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/root@www:/data/server/other_component/phpredis-4.0.0# 配置123456789安装完成后配置【找到 php.ini 的位置添加扩展】：vi /etc/php/7.0/cli/php.inivi /data/server/php7/lib/php.ini 这两个里面都要写上一以下内容：extension=imagick.so拷贝扩展，否则 在 【cli PHP -m】 模式中看不到扩展：cp /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/imagick.so /usr/lib/php/20151012/ 重启php-fpm12345重启php-fpm查找PHP服务 ps aux | grep php-fpmpkill -9 phpphp启动命令/data/server/php7/sbin/php-fpm 查看扩展12345php -m | grep imagick提示如下root@www:/data/server/other_component/ImageMagick-7.0.7-28# php -m | grep redisimagickroot@www:/data/server/other_component/ImageMagick-7.0.7-28# PHP扩展imagick下载网址 PHP扩展下载网址","tags":[]},{"title":"ubuntu16 -php7 extension redis","date":"2018-04-20T01:06:28.885Z","path":"2018/04/20/ubuntu/php_extension_redis/","text":"Extension 之 redis下载 redis 包12wget https://github.com/nicolasff/phpredis/archive/4.0.0.tar.gzwget http://pecl.php.net/get/redis-4.0.0.tgz 安装redis12345678910111213解压到指定目录【我这里是 /data/server/other_component/】tar -zxvf 4.0.0.tar.gz -C /data/server/other_component/cd phpredis-4.0.0//data/server/php7/bin/phpize #用phpize生成configure配置文件，[找到你PHP安装位置中的phpsize]./configure --with-php-config=/data/server/php7/bin/php-config #配置makemake install安装完成后提示如下，表示安装成功：root@www:/data/server/other_component/phpredis-4.0.0# make installInstalling shared extensions: /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/root@www:/data/server/other_component/phpredis-4.0.0# 配置 redis1234567891011安装完成后配置【找到 php.ini 的位置添加扩展】：vi /etc/php/7.0/cli/php.inivi /data/server/php7/lib/php.ini 这两个里面都要写上一以下内容：extension=redis.so拷贝扩展，否则 在 【cli PHP -m】 模式中看不到扩展：cp /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/opcache.a /usr/lib/php/20151012/cp /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/opcache.so /usr/lib/php/20151012/cp /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/redis.so /usr/lib/php/20151012/ 重启php-fpm 并查看扩展123456789101112重启php-fpm查找PHP服务 ps aux | grep php-fpmpkill -9 phpphp启动命令/data/server/php7/sbin/php-fpm查看扩展php -m | grep redis提示如下root@www:/data/server/other_component/phpredis-4.0.0# php -m | grep redisredisroot@www:/data/server/other_component/phpredis-4.0.0# 历史版本 历史版本2 PHP扩展下载网址","tags":[]},{"title":"-vim  编辑文件","date":"2018-04-19T05:38:39.682Z","path":"2018/04/19/ubuntu/linux_DDU_vim/","text":"跳转到指定行123:5 回车:10 回车:15 回车 替换123456利用 :s 命令可以实现字符串的替换。具体的用法包括：:s/str1/str2/ 用字符串 str2 替换[行]中[首次]出现的字符串 str1:s/str1/str2/g 用字符串 str2 替换[行]中[所有]出现的字符串 str1:.,$ s/str1/str2/g 用字符串 str2 替换[正文]当前[行到末尾]所有出现的字符串 str1:1,$ s/str1/str2/g 用字符串 str2 替换[正文]中[所有]出现的字符串 str1:g/str1/s//str2/g 功能同上 其他123u #撤销ctrl + r #反撤销shift + G #最后一行","tags":[]},{"title":"centos -PHP7","date":"2018-04-18T09:57:15.508Z","path":"2018/04/18/centos/php/","text":"centos PHP7 安装安装依赖12345yum install -y epel-releaseyum -y install libxslt libxslt-develyum -y install libxml2 libxml2-devel libjpeg-devel libpng-devel libmcrypt-develyum -y install curl-devel freetype-develyum install openssl openssl-devel 安装12345678安装phpwget http://cn2.php.net/get/php-7.0.28.tar.gz/from/this/mirrormv mirror php-7.0.28.tar.gz解压到你指定的目录，我这里选择 /data/server/ 目录tar -zxvf php-7.0.28.tar.gz -C /data/server/mv php-7.0.28 php7cd php7/ 编译12345678910111213141516171819202122232425262728293031323334353637./configure --prefix=/data/server/php7 \\ --with-curl \\ --with-freetype-dir \\ --with-gd \\ --with-gettext \\ --with-iconv-dir \\ --with-kerberos \\ --with-libdir=lib64 \\ --with-libxml-dir \\ --with-mysqli \\ --with-openssl \\ --with-pcre-regex \\ --with-pdo-mysql \\ --with-pdo-sqlite \\ --with-pear \\ --with-png-dir \\ --with-xmlrpc \\ --with-xsl \\ --with-zlib \\ --enable-fpm \\ --enable-bcmath \\ --enable-libxml \\ --enable-inline-optimization \\ --enable-gd-native-ttf \\ --enable-mbregex \\ --enable-mbstring \\ --enable-opcache \\ --enable-pcntl \\ --enable-shmop \\ --enable-soap \\ --enable-sockets \\ --enable-sysvsem \\ --enable-xml \\ --enable-zip \\ --enable-mysqlnd \\ --with-pdo-mysql=mysqlnd \\ --with-mcrypt 预处理ok后，make 编译123make &amp;&amp; make install最后用 make test 测试一下【这个过程时间比较长】 安装完毕123查看 php 版本/data/server/php7/bin/php -v这时候在命令窗口执行 php -v ,会提示命令找不到,需要配置环境变量,详情看下文 配置PHP12345cp /data/server/php7/php.ini-development /data/server/php7/lib/php.inicp /data/server/php7/etc/php-fpm.conf.default /data/server/php7/etc/php-fpm.confcp /data/server/php7/etc/php-fpm.d/www.conf.default /data/server/php7/etc/php-fpm.d/www.conf官方这里拷贝文件有点不一样，注意一下 添加 PHP 启动用户12345678910111213groupadd wwwuseradd -r -g www -s /bin/false www设置 PHP 启动用户cd /data/server/php7/etc/php-fpm.dvi www.conf 修改23、24行，内容如下： user = 启动fpm的用户名 group = 启动fpm的用户所在组 user = www group = www修改完启动 PHP-fpm php 启动命令1/data/server/php7/sbin/php-fpm 配置虚拟主机测试一下在 /data/www/ 目录下创建 index.php 内容如下： 123&lt;?phpecho phpinfo();?&gt; 在 nginx 中配置虚拟主机 12345678910111213141516server &#123; listen 80; server_name 127.0.0.1 192.168.1.230; client_max_body_size 10m; charset utf-8; #access_log /data/server/tengine/logs/127.0.0.1_access.log; #error_log /data/server/tengine/logs/127.0.0.1_error.log; root /data/www/; # index index.html; index index.php; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi.conf; &#125;&#125; 配置环境变量123456这时候在命令窗口执行 php -v ,会提示命令找不到,需要配置环境变量,详情看下文修改 /etc/profile 配置环境变量PATH=$PATH:/data/server/php/binexport PATH然后执行source /etc/profile 或者 ./profile 使其生效; 执行完后可以通过 echo $PATH 命令查看环境变量,在次执行 PHP -v 就看到PHP信息","tags":[]},{"title":"ubuntu -mysql others","date":"2018-04-18T05:16:40.763Z","path":"2018/04/18/ubuntu/linux_ubuntu_mysql_others/","text":"mysql 5.6 其他查看 MySQL 配置;1234windows下是my.inilinux下是my.cnflinux 中 locate my.cnf 就出来了（没有的话先updatedb） MySQL 忘记密码1234567891、查找 my.cnf 配置文件位置，在文件最后添加 skip-grant-tables 保存退出，修改完密码记得删掉2、修改密码，命令MySQL&gt; UPDATE mysql.user SET Password=PASSWORD('你的密码') where USER='root';MySQL&gt; flush privileges; MySQL&gt; exit;yum 安装的mysql 跳过密码,修改配置文件无效,可以使用命令跳过密码/usr/bin/mysqld_safe --skip-grant-tables 执行后,从新开一个窗口,连接数据库 确定 MySQL 中文件位置123456789101112131415161、locate mysql.server 找到后启动 mysql ./mysql.server start2、 ps -aux | grep mysql 看到信息如下（我自己的）：root 19312 0.0 0.0 113256 1596 pts/2 S 14:09 0:00 /bin/sh /usr/bin/mysqld_safe #数据库登录运行路径--datadir=/var/lib/mysql #数据库文件的存放路径--pid-file=/var/lib/mysql/iZ2ze8dugwavcbouiggqoeZ.pidmysql 19413 0.1 5.8 1236108 465644 pts/2 Sl 14:09 0:01 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql #数据库文件的存放路径--plugin-dir=/usr/lib64/mysql/plugin --user=mysql --log-error=/var/lib/mysql/iZ2ze8dugwavcbouiggqoeZ.err #错误日志--pid-file=/var/lib/mysql/iZ2ze8dugwavcbouiggqoeZ.pid 创建行用户并授权给指定数据库权限【以下命令在服务器 MySQL 中运行】1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253541、登录MySQLmysql -u root -p2、创建新用户CREATE USER '用户名'@'ip地址' IDENTIFIED BY '密码'; % 代表所有ip都能访问localhost 代表本机才能访问123.123.123.123 代表指定ip才能访问3、验证账号是否创建成功SELECT host, user, password FROM mysql.user WHERE user='用户';4、给新建用户授权指定数据库GRANT &lt;privileges&gt; ON &lt;database&gt;.&lt;table&gt; TO 'myuser'@'localhost';命令中 &lt;privileges&gt; 代表着用逗号分隔权限列表&lt;database&gt;.&lt;table&gt; 代表数据库.表demo：GRANT ALL ON &lt;database&gt;.&lt;table&gt; TO 'myuser'@'localhost';GRANT CREATE,INSERT ON &lt;database&gt;.&lt;table&gt; TO 'myuser'@'localhost';以下是一些可用权限&lt;privileges&gt;：ALL: 所有可用的权限CREATE: 创建库、表和索引LOCK_TABLES: 锁定表ALTER: 修改表DELETE: 删除表INSERT: 插入表或列SELECT: 检索表或列的数据CREATE_VIEW: 创建视图SHOW_DATABASES: 列出数据库DROP: 删除库、表和视图5、验证给用户的权限SHOW GRANTS FOR '用户名'@'ip地址';6、移除权限REVOKE &lt;privileges&gt; ON &lt;database&gt;.&lt;table&gt; FROM '用户名'@'ip地址';demo：CREATE DATABASE afei_db;CREATE USER 'afei'@'%' IDENTIFIED BY '123456';SELECT host, user, password FROM mysql.user WHERE user='afei';grant all privileges on afei_db.* to 'afei'@'%'; #没有指定密码授权SHOW GRANTS FOR 'afei'@'%';flush privileges; #刷新扩展命令grant all privileges on afei.* to afei@l% identified by '123456'; #指定命令授权drop user 'afei'@'%'; #删除用户 linux 查看 MySQL 版本1、在help中查找 mysql –help |grep Distrib2、在help中查找 mysql –help |grep Distrib Mysql 常用性能分析方法??123456select version(); #查版本号show processlist; #查看那些线程正在运行show profiles; show profiles for query 3; #更具query_id 查看某个查询的详细时间耗费explian + sql # 分析执行计划和最左前缀原理reset query cache; #清除缓存 mysql SQL 执行顺序12345678910(7) SELECT (8) DISTINCT &lt;select_list&gt;(1) FROM &lt;left_table&gt;(3) &lt;join_type&gt; JOIN &lt;right_table&gt;(2) ON &lt;join_condition&gt;(4) WHERE &lt;where_condition&gt;(5) GROUP BY &lt;group_by_list&gt;(6) HAVING &lt;having_condition&gt;(9) ORDER BY &lt;order_by_condition&gt;(10) LIMIT &lt;limit_number&gt;","tags":[]},{"title":"computer install ubuntu16","date":"2018-04-17T07:09:50.973Z","path":"2018/04/17/ubuntu/ubuntu_install/","text":"电脑安装ubuntu系统下载： ubuntu下载1wget https://www.ubuntu.com/download/desktop 安装好 UltraISO 软碟通 ，安装完软件后，打开软件，点击文件打开，找到刚才下载的 ubuntu 的 ISO 文件，点击开开，完成 ISO 文件的加载。接着插入 u 盘，点击 UltraISO 启动选项，然后找到写入硬盘选项，点击它进入将要操作的界面，最后点击写入; install","tags":[]},{"title":"ubuntu16 Redmine","date":"2018-04-13T03:54:09.902Z","path":"2018/04/13/ubuntu/Redmine/","text":"Rvm+Ruby+Rails 【具体细节效果以后版本修改……】rvm是用于管理多个ruby版本的一个管理器 123456789101112131415161718192021sudo apt-get update sudo apt-get upgradegpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3curl -sSL https://get.rvm.io | bash -s stable//如果上面的连接失败，可以尝试:curl -L https://raw.githubusercontent.com/wayneeseguin/rvm/master/binscripts/rvm-installer | bash -s stable 载入 Rvm 环境[ 根据提示操作 ] source /etc/profile.d/rvm.sh检查Rvm是否安装成功 rvm -v用 RVM 安装 Ruby 环境(同时把RubyGems也安装） rvm requirements rvm install 2.5.1 #可以到 Ruby(https://www.ruby-lang.org/en/downloads/)官网查看最新版本号，时间比较长RVM装好后，可以执行以下命令将刚才安装的Ruby版本，设置系统ruby默认版本 rvm use 2.5.1 --default 由于某些原因，调整gem安装目录至国内镜像，有且仅有一个就好！ 1234567891011121314151617181920212223242526272829303132333435检查下Ruby和RubyGems的版本 ruby -v gem -vgem update --system gem -v 换源 gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org gem sources --add https://ruby.taobao.org/ --remove https://rubygems.org gem sources -l //查看在用的gem源 显示如下：root@ubuntu:/data/server# gem sources -l*** CURRENT SOURCES ***https://rubygems.org/https://gems.ruby-china.org/root@ubuntu:/data/server# 安装bundlers gem install bundler安装Rails gem install rails 5.2.0 # 可以到rails官网查看最新版本号 或者使用： gem install rails #自己默认选择最新版查看版本 rails -v 最后检查一下所有版本 rvm -v ruby -v rails -v bundler -v适当升级gem update --system Redmine1234wget http://www.redmine.org/releases/redmine-3.4.5.tar.gztar -zxvf redmine-3.4.5.tar.gz -C /data/servermv redmine-3.4.5 redminecd redmine 设置数据库连接Redmine 需要 nginx 和 MySQL 自行安装这里不再安装 12cp config/database.yml.example config/database.yml vim config/database.yml 安装依赖包12345678910#查看缺少依赖包，安装完依赖后执行一次这个命令,直到到出现 Bundle complete!bundle install --without development test 我的值缺少依赖包如下：apt-get install libmysqlclient-dev不在缺少依赖，显示如下：Bundle complete! 31 Gemfile dependencies, 55 gems now installed.Gems in the groups development and test were not installed.Use `bundle info [gemname]` to see where a bundled gem is installed. Session 存储秘钥1rake generate_secret_token 生成redmine的数据库表结构和初始化数据12RAILS_ENV=production rake db:migrate //生成表结构RAILS_ENV=production rake redmine:load_default_data //初始化数据 创建上传文件的目录，设置文件夹的权限1234567useradd redminepasswd redmine //设置redmine账户的密码这里先不做mkdir -p tmp tmp/pdf public/plugin_assets/chown -R redmine:redmine files log tmp public/plugin_assetschmod -R 755 files log tmp public/plugin_assets/ 测试12ruby bin/rails server webrick -e productionruby bin/rails server webrick -e production -b 0.0.0.0 -p3000 #允许远程访问 其他默认账户 admin/admin 初次登录需要修改密码， 关机重启后，需要再次运行 source /etc/profile.d/rvm.sh 载入环境 网站： https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/ https://www.phusionpassenger.com/library/install/standalone/install/oss/tarball/ 下载地址： https://www.phusionpassenger.com/latest_stable_tarball https://www.phusionpassenger.com/latest_stable_tarball 12wget https://www.phusionpassenger.com/latest_stable_tarballtar -xzvf passenger-X.X.X.tar.gz -C /somewhere-permanent rootroot 内容start 代码分为行内代码和代码块 行内代码使用&lt;p&gt;这里使用代码块&lt;/p&gt; 这里没有代码块 代码语法高亮 1echo \"dddddd\"; 12var abc = \"123\";alert(abc); 我是a里面的内容","tags":[]},{"title":"Markdown语法","date":"2018-04-11T07:57:10.336Z","path":"2018/04/11/hexo/Markdown语法/","text":"这里是标题内容start代码分为行内代码和代码块 行内代码使用&lt;p&gt;这里使用代码块&lt;/p&gt; 这里没有代码块 代码语法高亮 1echo \"dddddd\"; 12var abc = \"123\";alert(abc); 我是a里面的内容","tags":[]},{"title":"ubuntu -mysql5.6.39","date":"2018-04-08T02:48:50.322Z","path":"2018/04/08/ubuntu/linux_ubuntu_mysql_02/","text":"mysql5.6.39编译环境1sudo apt install make cmake gcc g++ perl bison libaio-dev libncurses5 libncurses5-dev libnuma-dev 下载12345678安装版本5.6.39wget https://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.39.tar.gzwget https://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.39.tar.gz【解压到你指定的目录，我这里选择 /data/server/ 】tar zxvf mysql-5.6.39.tar.gz -C /data/server/mv mysql-5.6.39 mysqlcd mysql 编译安装12345678910111213141516171819202122232425262728293031323334353637383940414243cmake \\-DCMAKE_INSTALL_PREFIX=/data/server/mysql \\-DMYSQL_DATADIR=/data/server/mysql/data \\-DSYSCONFDIR=/data/server/mysql/etc \\-DWITH_MYISAM_STORAGE_ENGINE=1 \\-DWITH_INNOBASE_STORAGE_ENGINE=1 \\-DWITH_MEMORY_STORAGE_ENGINE=1 \\-DWITH_READLINE=1 \\-DMYSQL_UNIX_ADDR=/data/server/mysql/mysql.sock \\-DMYSQL_TCP_PORT=3306 \\-DENABLED_LOCAL_INFILE=1 \\-DWITH_PARTITION_STORAGE_ENGINE=1 \\-DEXTRA_CHARSETS=all \\-DDEFAULT_CHARSET=utf8 \\-DDEFAULT_COLLATION=utf8_general_cimake &amp;&amp; make install注意事项：重新编译时，需要清除旧的对象文件和缓存信息# make clean# rm -f CMakeCache.txt# rm -rf /data/server/etc/my.cnf编译参数： https://dev.mysql.com/doc/refman/5.6/en/source-configuration-options.html编译参数： https://dev.mysql.com/doc/refman/5.6/en/source-configuration-options.htmlcmake \\-DCMAKE_INSTALL_PREFIX=/data/server/mysql \\ 安装路径-DMYSQL_DATADIR=/data/server/mysql/data \\ 文件存放路径-DSYSCONFDIR=/etc \\ 配置文件路径 /data/server/mysql/etc-DWITH_MYISAM_STORAGE_ENGINE=1 \\-DWITH_INNOBASE_STORAGE_ENGINE=1 \\-DWITH_MEMORY_STORAGE_ENGINE=1 \\-DWITH_READLINE=1 \\-DMYSQL_UNIX_ADDR=/tmp/mysql/mysql.sock \\ sock文件路径/data/server/mysql/mysql.sock-DMYSQL_TCP_PORT=3306 \\-DENABLED_LOCAL_INFILE=1 \\-DWITH_PARTITION_STORAGE_ENGINE=1 \\-DEXTRA_CHARSETS=all \\-DDEFAULT_CHARSET=utf8 \\ 字符集 -DDEFAULT_CHARSET=utf8mb4 -DDEFAULT_COLLATION=utf8_general_ci 排序字符集 -DDEFAULT_COLLATION=utf8mb4_general_ci 创建 mysql 组跟用户1234567检查系统中是否已经存在 mysql 用户，如果没有则创建cat /etc/passwd | grep mysqlcat /etc/group | grep mysql创建 mysql 用户sudo groupadd mysqlsudo useradd -r -g mysql -s /bin/false mysql 更改 mysql 目录权限123cd /data/server/mysqlsudo chown -R mysql .sudo chgrp -R mysql . 初始化数据库123456789101112131415161718192021222324252627282930313233343536chmod +x mysql_install_db 或者 chmod +x scripts/mysql_install_db./scripts/mysql_install_db --basedir=/data/server/mysql --datadir=/data/server/mysql/data --user=mysql初始化后提示：To start mysqld at boot time you have to copysupport-files/mysql.server to the right place for your systemPLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !To do so, start the server, then issue the following commands: /data/server/mysql/bin/mysqladmin -u root password 'new-password' /data/server/mysql/bin/mysqladmin -u root -h ubuntu password 'new-password'Alternatively you can run: /data/server/mysql/bin/mysql_secure_installationwhich will also give you the option of removing the testdatabases and anonymous user created by default. This isstrongly recommended for production servers.See the manual for more instructions.You can start the MySQL daemon with: cd . ; /data/server/mysql/bin/mysqld_safe &amp;You can test the MySQL daemon with mysql-test-run.pl cd mysql-test ; perl mysql-test-run.plPlease report any problems at http://bugs.mysql.com/The latest information about MySQL is available on the web at http://www.mysql.comSupport MySQL by buying support/licenses at http://shop.mysql.comNew default config file was created as /data/server/mysql/my.cnf andwill be used by default by the server when you start it.You may edit this file to change server settings 启动数据库12345678chmod +x mysql.server 或者 chmod +x support-files/mysql.server ./support-files/mysql.server start 初始化密码，我这里设置密码： 123456 做测试，实际中设置你认为安全的密码 /data/server/mysql/bin/mysqladmin -u root password '123456' 登录MySQL bin/mysql -u root -p 创建新用户，并允许远程连接123456789101112131415命令: GRANT ALL PRIVILEGES ON *.* TO 'username'@'host' IDENTIFIED BY 'new_password' WITH GRANT OPTION; . 点代表所有表username 代表你创建的用户名host 代表你指定在那台机器可以登录，本地登录就是 localhost ，允许所有远程登录就是 % ；new_password 代表该用户的登录密码，密码可以为空，如果是空则改用户可以不需要密码登录demo:新增超级权限并允许远程访问：GRANT ALL PRIVILEGES ON *.* TO 'afei2'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION; FLUSH PRIVILEGES;查看创建的新用户信息：SELECT `Host`,`User`,`Password`,authentication_string,password_expired FROM `user`; MySQL 命令123456support-files/mysql.server startsupport-files/mysql.server stop/data/server/mysql/bin/mysql -u root -pmysql -h 你登录的ip -u username -P 3306 -p 【远程登录】demo： mysql -h 192.168.1.230 -u afei2 -p 查看 mysql 默认读取 my.cnf 的目录如果没有设置使用指定目录的my.cnf，mysql启动时会读取安装目录根目录及默认目录下的my.cnf文件。查看mysql启动时读取配置文件的默认目录 1234567891011121314151617181920212223242526mysql --help|grep 'my.cnf'输出：root@ubuntu:/data/server/mysql/bin# mysql --help|grep 'my.cnf'/etc/my.cnf /etc/mysql/my.cnf ~/.my.cnf order of preference, my.cnf, $MYSQL_TCP_PORT,root@ubuntu:/data/server/mysql/bin# //////////////////或者/////////////////./bin/mysqld --verbose --help |grep -A 1 'Default options'输出：root@ubuntu:/data/server/mysql# ./bin/mysqld --verbose --help |grep -A 1 'Default options'2018-04-08 01:55:32 0 [Note] --secure-file-priv is set to NULL. Operations related to importing and exporting data are disabled2018-04-08 01:55:32 0 [Note] ./bin/mysqld (mysqld 5.6.39) starting as process 34387 ...2018-04-08 01:55:32 34387 [Note] Plugin 'FEDERATED' is disabled.Default options are read from the following files in the given order: /etc/my.cnf /etc/mysql/my.cnf /data/server/mysql/etc/my.cnf ~/.my.cnf 2018-04-08 01:55:32 34387 [Note] Binlog end2018-04-08 01:55:32 34387 [Note] Shutting down plugin 'CSV'2018-04-08 01:55:32 34387 [Note] Shutting down plugin 'MyISAM'root@ubuntu:/data/server/mysql# /etc/my.cnf, /etc/mysql/my.cnf, /usr/local/etc/my.cnf, ~/.my.cnf 这些就是mysql默认会搜寻my.cnf的目录，顺序排前的优先 查看错误日志位置1234567891011121314151617修改 my.cnf 文件指定错误日志位置log_error=/data/mysql.log错误日志默认存放位置为数据目录下，你也可以用下面命令查看:SHOW GLOBAL VARIABLES LIKE '%log_error%';mysql&gt; SHOW GLOBAL VARIABLES LIKE '%log_error%';+---------------------+-----------------+| Variable_name | Value |+---------------------+-----------------+| binlog_error_action | IGNORE_ERROR || log_error | /data/mysql.log |+---------------------+-----------------+2 rows in set (0.00 sec)mysql&gt; mysql官方预编译配置参数","tags":[]},{"title":"BlueLake 主题配置","date":"2018-03-26T09:14:29.039Z","path":"2018/03/26/hexo/hexo-BlueLake/","text":"添加本地搜索安装插件hexo-generator-json-content来创建JSON数据文件 1npm install hexo-generator-json-content@2.2.0 --save 在根配置 _config.yml 添加配置 123456789101112131415161718jsonContent: meta: false pages: false posts: title: true date: true path: true text: true raw: false content: false slug: false updated: false comments: false link: false permalink: false excerpt: false categories: false tags: true 在主题 _config.yml 中添加 1local_search: true #安装好 BlueLake主题后，会有这个配置 BlueLake : 主题底部的访问量统计,不显示问题; 1234567891011按照作者配置:主题_config.yml themes/BlueLake/_config.ymlbusuanzi: true这个配置完后,需要修改 themes\\BlueLake\\layout\\_partial\\after_footer.jade 这个文件把卜算子地址改为如下:script(src='https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js', async)不蒜子作者提示:域名已经更换http://busuanzi.ibruce.info/","tags":[]},{"title":"ubuntu16 -swoole","date":"2018-03-21T15:18:58.852Z","path":"2018/03/21/ubuntu/linux_ubuntu_swoole/","text":"swoolephp7 中安装swoole1.9.1 1234567891011121314151617181920212223242526272829303132333435363738394041安装依赖apt-get install libpcre3 libpcre3-dev *********************************************cd /data/server/wget https://github.com/swoole/swoole-src/archive/v1.9.1-stable.tar.gztar zxvf v1.9.1-stable.tar.gz -C /data/server/cd swoole-src-1.9.1-stable/data/server/php7/bin/phpize【 这一步很少出问题： 我的报错如下：错误一： root@ubuntu:/data/server/swoole-src-1.9.1-stable# /data/server/php7/bin/phpize Configuring for: PHP Api Version: 20151012 Zend Module Api No: 20151012 Zend Extension Api No: 320151012 Cannot find autoconf. Please check your autoconf installation and the $PHP_AUTOCONF environment variable. Then, rerun this script.错误二: Cannot find config.m4. Make sure that you run '/data/server/php7/bin/phpize' in the top level source directory of the module解决方法：sudo apt-get install m4sudo apt-get install autoconf 】./configure --with-php-config=/data/server/php7/bin/php-configmakemake install最后安装成功后显示：root@ubuntu:/data/server/swoole-src-1.9.1-stable# make installInstalling shared extensions: /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/root@ubuntu:/data/server/swoole-src-1.9.1-stable# 配置php支持swoolevi /data/server/php7/lib/php.ini #######编辑配置文件，在最后一行添加以下内容(查找php.ini最好的方法就是phpinfo) 12345vi /etc/php/7.0/cli/php.inivi /data/server/php7/lib/php.ini 这两个里面都要写上一以下内容：extension=swoole.so 重启php-fpm1234查找PHP服务 ps aux | grep php-fpmpkill -9 phpphp启动命令/data/server/php7/sbin/php-fpm 先用 php -m 看一下,没有 swoole ，扩展，检索一下 locate php.ini ,发现在 /etc/php/7.0/cli/php.ini 这里还有一个，这里也加上 extension=swoole.so ，在看看有没有，如果还是没有， php -ini|grep ‘extesion_dir’ 看一下，发现如下错误： 12345678root@ubuntu:/home/afei# php -ini|grep 'extesion_dir'PHP Warning: PHP Startup: Unable to load dynamic library '/usr/lib/php/20151012/swoole.so' - /usr/lib/php/20151012/swoole.so: cannot open shared object file: No such file or directory in Unknown on line 0root@ubuntu:/home/afei# cd /usr/lib/php/20151012root@ubuntu:/usr/lib/php/20151012# ls -l解决办法， 拷贝一份过去： cp /data/server/php7/lib/php/extensions/no-debug-non-zts-20151012/swoole.so /usr/lib/php/20151012/ 在phpinfo页面可以看到关于swoole的选项，说明安装成功 其他123401) 让phpstorm 对 swoole的函数提示下载地址 https://github.com/swoole/ide-helperphpstorm--&gt;settings--&gt;languages&amp;Frameworks--&gt;(Include path)添加下载的文件 swoole官方文档","tags":[]},{"title":"ubuntu15 -tengine","date":"2018-03-17T03:42:21.995Z","path":"2018/03/17/ubuntu/linux_ubuntu_tengine/","text":"Tengine 官网安装相当简略，这里详细安装一次（ubuntu15 安装 tengine） 安装必要的编译环境Tengine 安装需要使用源代码自行编译，所以安装前需要安装必要的编译工具 123sudo apt-get updatesudo apt-get install g++apt-get install libgd-dev 安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径PCRE1234567wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.38.tar.gz解压到你指定的目录tar -zxvf pcre-8.38.tar.gz -C /data/server/tengine_componentmv pcre-8.38 pcrecd pcre/./configure --prefix=/data/server/tengine_component/pcremake &amp;&amp; make install OpenSSL1234567wget http://www.openssl.org/source/openssl-1.0.2.tar.gz解压到你指定的目录tar -zxvf openssl-1.0.2.tar.gz -C /data/server/tengine_componentmv openssl-1.0.2 opensslcd openssl/./config --prefix=/data/server/tengine_component/opensslmake &amp;&amp; make install 这个执行时间稍微长一点 Zlib1234567wget http://zlib.net/zlib-1.2.11.tar.gz解压到你指定的目录tar -zxvf zlib-1.2.11.tar.gz -C /data/server/tengine_componentmv zlib-1.2.11 zlibcd zlib/./configure --prefix=/data/server/tengine_component/zlibmake &amp;&amp; make install 下载12345678910111213141516171819202122###有空试试这个不添加应该也是可以的，安装完有2个报错，不用理会，手动创建 logs 目录，修改权限；###groupadd wwwuseradd -s /sbin/nologin -g www www///////////////////////////////////////////////////////////wget http://tengine.taobao.org/download/tengine-2.1.2.tar.gz解压到你指定的目录tar -zxvf tengine-2.1.2.tar.gz -C /data/server/mv tengine-2.1.2 tenginecd tengine./configure --prefix=/data/server/tengine \\--with-pcre=/data/server/tengine_component/pcre \\--with-openssl=/data/server/tengine_component/openssl \\--with-http_gzip_static_module \\--with-http_realip_module \\--with-http_stub_status_module \\--with-http_concat_module \\--with-zlib=/data/server/tengine_component/zlibmake &amp;&amp; make install 注意配置的时候 –with-pcre 、–with-openssl、–with-zlib的路径为源文件的路径 检测是否可用123/data/server/tengine/sbin/nginx -t没有logs目录，那就创建一个logs目录： mkdir logs 启动关闭命令1234567/data/server/tengine/sbin/nginx -t/data/server/tengine/sbin/nginx -s start/data/server/tengine/sbin/nginx -s stop/data/server/tengine/sbin/nginx -s reloadpid出错时，可以使用这个：/data/server/tengine/sbin/nginx -c /data/server/tengine/conf/nginx.conf 扩展：有时候，我们有好多域名，为了方便我们修改一下 nginx.conf ,修改内容如下，主要是最后一句 include servers/*;然后在nginx.conf 当前位置创建 servers 目录；【修改之前记得把原来的备份 cp nginx.conf nginx.conf_backups 】 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#user nobody;worker_processes 1;#error_log logs/error.log;#error_log logs/error.log notice;#error_log logs/error.log info;#pid logs/nginx.pid;events &#123; worker_connections 1024;&#125;# load modules compiled as Dynamic Shared Object (DSO)##dso &#123;# load ngx_http_fastcgi_module.so;# load ngx_http_rewrite_module.so;#&#125;http &#123; include mime.types; default_type application/octet-stream; charset utf-8;# server_tokens off;# server_names_hash_bucket_size 128; # client_header_buffer_size 32k; # large_client_header_buffers 4 32k; # client_max_body_size 20m; # client_body_buffer_size 128k; client_header_timeout 30m; client_body_timeout 30m; # client_body_temp_path /dev/shm/client_body_temp_path 1 2; send_timeout 30m; #sendfile on; # tcp_nopush on; # tcp_nodelay on; keepalive_timeout 60; # fastcgi_connect_timeout 300; # fastcgi_send_timeout 300; # fastcgi_read_timeout 300; # fastcgi_buffer_size 256k; # fastcgi_buffers 4 256k; # fastcgi_busy_buffers_size 512k; # fastcgi_temp_file_write_size 512k; # fastcgi_temp_path /dev/shm/factcgi_temp_path 1 2; # fastcgi_cache_path /dev/shm/fastcgi_cache levels=1:2 keys_zone=PHPCACHE:1024m inactive=15m; # fastcgi_cache_key \"$scheme$request_method$host$request_uri\"; # fastcgi_cache_use_stale error timeout invalid_header http_500; # fastcgi_intercept_errors on; #开启后支持4XX 和 5XX 错误自定义 gzip on; gzip_vary on; gzip_min_length 10k; gzip_buffers 4 16k; gzip_http_version 1.0; gzip_comp_level 2; gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml application/javascript; gzip_disable \"MSIE [1-6]\\.\"; include servers/*;&#125; demo 测试，在新建的 servers 目录下创建 文件 127.0.0.1 12345678910111213141516171819202122232425262728server &#123; listen 80; server_name 127.0.0.1; client_max_body_size 0m; charset utf-8; #access_log /data/server/tengine/logs/127.0.0._access.log; #error_log /data/server/tengine/logs/127.0.0._error.log; root /data/www/; index index.html;&#125;或者：server &#123; listen 80; server_name 127.0.0.1 192.168.1.232; client_max_body_size 0m; charset utf-8; #access_log /data/server/tengine/logs/127.0.0._access.log; #error_log /data/server/tengine/logs/127.0.0._error.log; root /data/www/; index index.html index.php; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi.conf; &#125; &#125; Tengine 官网安装","tags":[]},{"title":"ubuntu15 -mysql5.7","date":"2018-03-17T03:42:21.995Z","path":"2018/03/17/ubuntu/linux_ubuntu_mysql/","text":"mysql 5.7安装在终端执行 以下命令123sudo apt-get install mysql-serversudo apt install mysql-clientsudo apt install libmysqlclient-dev 安装完用以下命测试,出现图中说明 OK 1sudo netstat -tap | grep mysql 进入 mysql1mysql -uroot -p 然后回车输入密码 设置 mysql 运行远程访问1sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf 1、注释掉 bind-address = 127.0.0.1 保存退出【在43行】2、grant all on . to root@’%’ identified by ‘你的密码’ with grant option;3、flush privileges;4、exit; 退出 mysql服务5、重启服务： service mysql restart 卸载mysql123456sudo apt-get remove mysql-serversudo apt-get autoremove mysql-serversudo apt-get remove mysql-common //这个很重要清理残留数据；dpkg -l |grep ^rc|awk '&#123;print $2&#125;' |sudo xargs dpkg -P mysql 手动安装编译环境1sudo apt install make cmake gcc g++ perl bison libaio-dev libncurses5 libncurses5-dev libnuma-dev 下载【注意版本】1234567安装版本 5.7.21；如果是虚拟机建议内容 4G ;wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-boost-5.7.21.tar.gz【解压到你指定的目录，我这里选择 /data/server/ 】tar zxvf mysql-boost-5.7.21.tar.gz -C /data/server/mv mysql-5.7.21 mysqlcd mysql 编译安装12345678910111213141516171819202122232425262728 可以试试这个参数选项 -DDEFAULT_CHARSET=utf8mb4 -DDEFAULT_COLLATION=utf8mb4_general_ci--------------------------------------cmake . -DBUILD_CONFIG=mysql_release \\-DCPACK_MONOLITHIC_INSTALL=ON \\-DCMAKE_INSTALL_PREFIX=/data/server/mysql \\-DDEFAULT_CHARSET=utf8 \\-DDEFAULT_COLLATION=utf8_general_ci \\-DMYSQL_UNIX_ADDR=/data/server/mysql/mysql.sock \\-DMYSQL_TCP_PORT=3306 \\-DMYSQLX_UNIX_ADDR=/data/server/mysql/mysqlx.sock \\-DMYSQL_DATADIR=/data/server/mysql/data \\-DSYSCONFDIR=/data/server/mysql/etc \\-DWITH_BOOST=/data/server/mysql/boost/boost_1_59_0make &amp;&amp; make install注意这一项：这个是你 boost 下载好的目录，我的这个版本的 MySQL 解压后对应的目录中有这个-DWITH_BOOST=/data/server/mysql/boost/boost_1_59_0make 的过程比较耗时；耐心等待，make install 就很快啦官方预编译配置参数：https://dev.mysql.com/doc/refman/5.7/en/source-configuration-options.html#cmake-general-optionshttps://dev.mysql.com/doc/refman/5.7/en/source-configuration-options.html#cmake-general-options 这个过程时间比较长………… 初始化设置 mysql创建 MySQL 组跟用户12sudo groupadd mysqlsudo useradd -r -g mysql -s /bin/false mysql 更改 mysql 目录权限123456789101112##cd /data/server/mysql##sudo chown -R mysql .##sudo chgrp -R mysql .这里不用 . 来操作cd /data/serverchown -R mysql mysql57 #把目录下的所有文件变为mysql用户,在回到上级目录修改为rootchgrp -R mysql mysql57cd ../chown root mysql57chgrp root mysql57 初始化 mysql ， 生成 root 用户临时密码，12345678sudo bin/mysqld --initialize --user=mysql通过mysqld初始化data目录时，如果使用--initialize选项，则会为'root'@'localhost'用户创建一个随机密码。该密码会打印在控制台，如下所示行中末尾就是临时密码：2018-03-29T01:10:08.161779Z 1 [Note] A temporary password is generated for root@localhost: xJB.L-TJ)2wB*****************初始化一个空密码，使用initialize-insecure ****************sudo bin/mysqld --initialize-insecure --user=mysql 启动 mysql1234567891011121314151617181920support-files/mysql.server startbin/mysql -u root -palter user 'root'@'localhost' identified by 'new_password'; #修改密码修改完重启mysql 或者 刷新support-files/mysql.server stop 或者flush privileges;*************************************************************我这里设置密码： 123456 做测试，实际中设置你认为安全的密码方法1：alter user 'root'@'localhost' identified by '123456';方法2：set password=password('123456');方法3：update user set authentication_string=password('123456') where user='root';( 不建议使用方法3,SQL会记录到日志中 )这里如果不重新设置密码，系统会一直提示：mysql&gt; show databases;ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.****其他****ALTER USER 'root'@'localhost' PASSWORD EXPIRE; #使密码过期 设为系统服务123456cp /data/server/mysql/support-files/mysql.server /etc/init.d/mysqldsystemctl daemon-reload [重新加载 service 文件]systemctl start mysqldsystemctl stop mysqldsystemctl restart mysqld 创建新用户，并允许远程连接123456789101112命令: GRANT ALL PRIVILEGES ON *.* TO 'username'@'host' IDENTIFIED BY 'new_password' WITH GRANT OPTION; . 点代表所有表username 代表你创建的用户名host 代表你指定在那台机器可以登录，本地登录就是 localhost ，允许所有远程登录就是 % ；new_password 代表该用户的登录密码，密码可以为空，如果是空则改用户可以不需要密码登录demo:新增超级权限并允许远程访问：GRANT ALL PRIVILEGES ON *.* TO 'afei2'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION; FLUSH PRIVILEGES; MySQL 命令123456support-files/mysql.server startsupport-files/mysql.server stop/data/server/mysql/bin/mysql -u root -pmysql -h 你登录的ip -u username -P 3306 -p 【远程登录】demo： mysql -h 192.168.1.230 -u afei2 -p mysql 配置文件 my.cnf12345678910111213mysql5.7 以后版本中编译安装完后没有my.cnf 文件,需要自己创建./bin/mysql --help|grep 'my.cnf' #查看mysql默认读取的my.cnf/data/server/mysql 下新建 mkdir etc cd etctouch my.cnf #权限 chmod 644 /data/server/mysql/etc/my.cnf 权限过大会出问题chown mysql:mysql -R etc/my.cnf #用户在my.cnf 中修改日志配置测试文件是否生效[mysqld]log-error = /data/server/mysql/mysql_log/error.log mysql 命令行工具中 \\c 取消之前的输入,重新开始输入123mysql&gt; fdfds \\cmysql&gt; show tables ddjfkldjfdklsf \\cmysql&gt; show tables; mysql 命令行工具中 \\G 竖向显示内容 12mysql&gt; show tables \\G;mysql&gt; show table status \\G; mysql 命令行工具中 \\q 退出终端 1mysql&gt; \\q; mysql官方下载地址 mysql官方下载地址 mysql官方预编译配置参数 mysql官方手册","tags":[]},{"title":"ubuntu16 -php7.0.28","date":"2018-03-17T03:41:47.255Z","path":"2018/03/17/ubuntu/linux_ubuntu_php/","text":"源码编译安装php7.0 依赖安装，安装依赖123456789101112131415161718192021222324252627282930313233343536apt-get install libxml2 libxml2-devapt-get install opensslapt-get install libssl-devapt-get install curlapt-get install libcurl4-gnutls-devapt-get install libxslt-devapt-get install libpng-devapt-get install libfreetype6-dev// RetHat CentOS or Fedora 使用下面安装命令yum install curl curl-devel****************一般使用的依赖都是以下这些***************************安装相关依赖库sudo apt-get updatesudo apt-get install libxml2-dev#安装gccsudo apt-get install build-essentialsudo apt-get install openssl sudo apt-get install libssl-dev sudo apt-get install makesudo apt-get install curlsudo apt-get install libcurl4-gnutls-devsudo apt-get install libjpeg-devsudo apt-get install libpng-devsudo apt-get install libmcrypt-devsudo apt-get install libreadline6 libreadline6-devapt-get -y install libfreetype6-dev sudo apt-get install libxslt1-dev 下载 PHP 源码1234567wget http://cn2.php.net/get/php-7.0.28.tar.gz/from/this/mirrormv mirror php-7.0.28.tar.gz解压到你指定的目录，我这里选择 /data/server/ 目录tar -zxvf php-7.0.28.tar.gz -C /data/server/mv php-7.0.28 php7cd php7/ 查看安装帮助，执行配置脚本进行配置1234567891011121314151617181920212223242526272829303132333435363738# ./configure --help# ./configure --prefix=/data/server/php7 \\ --with-curl \\ --with-freetype-dir \\ --with-gd \\ --with-gettext \\ --with-iconv-dir \\ --with-kerberos \\ --with-libdir=lib64 \\ --with-libxml-dir \\ --with-mysqli \\ --with-openssl \\ --with-pcre-regex \\ --with-pdo-mysql \\ --with-pdo-sqlite \\ --with-pear \\ --with-png-dir \\ --with-xmlrpc \\ --with-xsl \\ --with-zlib \\ --enable-fpm \\ --enable-bcmath \\ --enable-libxml \\ --enable-inline-optimization \\ --enable-gd-native-ttf \\ --enable-mbregex \\ --enable-mbstring \\ --enable-opcache \\ --enable-pcntl \\ --enable-shmop \\ --enable-soap \\ --enable-sockets \\ --enable-sysvsem \\ --enable-xml \\ --enable-zip \\ --enable-mysqlnd \\ --with-pdo-mysql=mysqlnd \\ --with-mcrypt 我的错误 Configure Command ‘./configure’ ‘–prefix=/data/server/php7’ ‘–with-gd’ ‘–with-freetype-dir’ ‘–enable-gd-native-ttf’ ‘–enable-mysqlnd’ ‘–with-pdo-mysql=mysqlnd’ ‘–with-openssl’ ‘–with-mcrypt’ ‘–enable-mbstring’ ‘–enable-zip’ ‘–enable-fpm’ Server API FPM/FastCGI Virtual Directory Support disabled Configuration File (php.ini) Path /data/server/php7/lib Loaded Configuration File (none) 【正常情况这里不应该没有值的，还是之前的编译有问题，请仔细查看 正常应该是这个值 /data/server/php7/lib/php.ini】 Scan this dir for additional .ini files (none) Additional .ini files parsed (none) 之前安装过依赖这里就可以不用装，然后会提示部分依赖没有安装，安装依赖 123456789101112131415161718192021222324252627282930313233343536apt-get install libxml2 libxml2-devapt-get install opensslapt-get install libssl-devapt-get install curlapt-get install libcurl4-gnutls-devapt-get install libxslt-devapt-get install libpng-devapt-get install libfreetype6-dev// RetHat CentOS or Fedora 使用下面安装命令yum install curl curl-devel****************一般使用的依赖都是以下这些***************************安装相关依赖库sudo apt-get updatesudo apt-get install libxml2-dev#安装gccsudo apt-get install build-essentialsudo apt-get install openssl sudo apt-get install libssl-dev sudo apt-get install makesudo apt-get install curlsudo apt-get install libcurl4-gnutls-devsudo apt-get install libjpeg-devsudo apt-get install libpng-devsudo apt-get install libmcrypt-devsudo apt-get install libreadline6 libreadline6-devapt-get -y install libfreetype6-dev sudo apt-get install libxslt1-dev 预处理ok后，make 编译123make &amp;&amp; make install最后用 make test 测试一下【这个过程时间比较长】 安装完毕12345#查看 php 版本 ,这个时候没有环境变量,全局还不能使用 php -v,下问有介绍/data/server/php7/bin/php -v #查看配置文件,没有加载,需要自己复制一份 php.ini/data/server/php7/bin/php --ini 配置PHP123456cp /data/server/php7/php.ini-development /data/server/php7/lib/php.inicp /data/server/php7/etc/php-fpm.conf.default /data/server/php7/etc/php-fpm.confcp /data/server/php7/etc/php-fpm.d/www.conf.default /data/server/php7/etc/php-fpm.d/www.conf官方这里拷贝文件有点不一样，注意一下 添加 PHP 启动用户1234567891011121314PHP 安装默认使用 www 用户，这里根据自己情况添加用户groupadd managersuseradd -r -g managers -s /bin/false managers设置 PHP 启动用户cd /data/server/php7/etc/php-fpm.dvi www.conf 修改23、24行，内容如下： user = 启动fpm的用户名 group = 启动fpm的用户所在组 user = managers group = managers修改完启动 PHP-fpm php 启动命令1/data/server/php7/sbin/php-fpm 配置虚拟主机测试一下在 /data/www/ 目录下创建 index.php 内容如下： 123&lt;?phpecho phpinfo();?&gt; 在 nginx 中配置虚拟主机 12345678910111213141516server &#123; listen 80; server_name 127.0.0.1 192.168.1.230; client_max_body_size 10m; charset utf-8; #access_log /data/server/tengine/logs/127.0.0.1_access.log; #error_log /data/server/tengine/logs/127.0.0.1_error.log; root /data/www/; # index index.html; index index.php; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi.conf; &#125;&#125; 扩展： 使用 php -m 查看扩展,提示如下： 12345678root@ubuntu:/data/server/php7/bin# php -mThe program 'php' can be found in the following packages: * php7.0-cli * hhvmTry: apt install &lt;selected package&gt;root@ubuntu:/data/server/php7/bin# apt install php7.0-cli安装： apt install php7.0-cli PHP命令 12345678910111213php --ini #查看PHP的配置文件php -ini #查看php.ini里面的配置php -a #进入交互模式,可以写PHP代码,demo: 输入 echo \"hello world\"; 然后回车显示hello world查询 PHP 服务 ps aux | grep php-fpmpkill -9 phpphp启动命令/data/server/php7/sbin/php-fpm#查看PHP的编译参数/data/server/php7/bin/php -i | grep configure此命令使用场景:编译web服务器由nginx换为Apache的时候需要在Apache中添加PHP模块, PHP需要添加 --with-apxs2 后重新编译 配置 php 全局变量1234567891011PHP编译安装后的目录: /data/server/php7/binvim /etc/profile#centos中配置PHP环境变量:修改 /etc/profile 配置环境变量PATH=$PATH:/data/server/php7/binexport PATH然后执行source /etc/profile 或者 ./profile 使其生效; 执行完后可以通过 echo $PATH 命令查看环境变量###PATH=$PATH:/data/server/php/bin 意思加入环境变量###export PATH 意思使环境变量生效 PHP官网下载地址 PHP官方安装文档","tags":[]},{"title":"win server 2008 部署php","date":"2018-03-15T03:57:07.089Z","path":"2018/03/15/win/win_server_2008_IIS/","text":"配置IIS （安装好 PHPstudy 后测试php）在计算机右击,选择管理，出现服务器管理界面；或者打开“开始”菜单→“服务器管理”，出现服务器管理界面 添加角色，下一步，选择 web 服务器（IIS）,下一步 选择 CGI,一直下一步 安装好IIS后，需要测试一下，在浏览器中输入 localhost ，如果出现 IIS7 欢迎界面说明正常； 配置一个新网站，打开 IIS 管理器（“开始”→“所有程序”→“管理工具”→“internet 信息服务（IIS）管理器”）；备注：使用 PHPstudy 打开 IIS 管理器，需要提前安装好 PHPstudy； 添加好后，在 IIS 管理器中，在刚才添加的网站 “网站名称” 上右键，点击 “编辑权限” ，进入后点击“安全”选项卡，再点击其中的“编辑” 。打开“编辑”窗口后点击“添加”按钮。添加一个“用户”到权限用户列表中，然后为其勾选除了“完全控制”之外的权限。然后点击“确定” “应用”。 结束后，在刚才选择的物理路径下创建 index.html ,然后用记事本打开，输入 ”hello world“ 测试； 如果是做 PHP 开发，安装好 PHPstudy 后，可出在刚才选择的物理路径下创建 index.php ,然后用记事本打开，输入 如下做测试 123&lt;?phpecho phpinfo();?&gt;","tags":[]},{"title":"ubuntu -lnmp环境","date":"2018-03-13T03:46:22.702Z","path":"2018/03/13/ubuntu/linux_ubuntu_lnmp/","text":"LNMP环境搭建使用命令下载 nginx 安装包 nginx官网 nginx官网 nginx官网","tags":[]},{"title":"ubuntu -shipyard","date":"2018-03-09T07:17:50.419Z","path":"2018/03/09/ubuntu/linux_ubuntu_shipyard/","text":"Shipyard简介待完善。。。。。。。 Shipyard 是一个基于 Web 的 Docker 管理工具，支持多 host，可以把多个 Docker host 上的 containers 统一管理；可以查看 images，甚至 build images；并提供 RESTful API 等 安装 shipyard1docker run --rm -v /var/run/docker.sock:/var/run/docker.sock shipyard/deploy start Shipyard官网最近官网不能访问","tags":[]},{"title":"-scp  Linux之间复制文件和目录","date":"2018-03-08T06:12:17.060Z","path":"2018/03/08/ubuntu/linux_DDU_scp/","text":"scp 简介scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。另外，scp还非常不占资源，不会提高多少系统负荷，在这一点上，rsync就远远不及它了。虽然 rsync比scp会快一点，但当小文件众多的情况下，rsync会导致硬盘I/O非常高，而scp基本不影响系统正常使用 命令格式scp [参数] [原路径] [目标路径] 命令参数-1 强制scp命令使用协议ssh1-2 强制scp命令使用协议ssh2-4 强制scp命令只使用IPv4寻址-6 强制scp命令只使用IPv6寻址-B 使用批处理模式（传输过程中不询问传输口令或短语）-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）-p 保留原文件的修改时间，访问时间和访问权限。-q 不显示传输进度条。-r 递归复制整个目录。-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。-l limit 限定用户所能使用的带宽，以Kbit/s为单位。-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，-P port 注意是大写的P, port是指定数据传输用到的端口号-S program 指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项 使用实例使用scp前提：两台服务器必须都安装 ssh 从本地服务器复制到远程服务器复制文件1234567891011注意目标文件的权限:scp local_file remote_username@remote_ip:remote_folder或者scp local_file remote_username@remote_ip:remote_file或者scp local_file remote_ip:remote_folder或者scp local_file remote_ip:remote_filedemo：scp test2_01.test dafei@192.168.1.113:/data/www/test/ 第1,2个指定了用户名，命令执行后需要输入用户密码，第1个仅指定了远程的目录，文件名字不变，第2个指定了文件名第3,4个没有指定用户名，命令执行后需要输入用户名和密码（默认使用root），第3个仅指定了远程的目录，文件名字不变，第4个指定了文件名 复制目录1234567-r参数不要遗漏：【否则报错： not a regular file】scp -r local_folder remote_username@remote_ip:remote_folder或者scp -r local_folder remote_ip:remote_folder demo:scp -r test2 dafei@192.168.1.113:/data/www/test/ 第1个指定了用户名，命令执行后需要输入用户密码；第2个没有指定用户名，命令执行后需要输入用户名和密码(默认使用root)； 从远程服务器复制到本地服务器从远程复制到本地的scp命令与上面的命令雷同，只要将从本地复制到远程的命令后面2个参数互换顺序就行了 从远程拷贝文件到本地目录 123scp root@remote_ip:remote_file local_folderdemo：scp dafei@192.168.1.87:/data/www/test2/test2_01.test /data/www/test/ 从远处复制目录到本地123scp -r root@remote_ip:remote_folder local_folderdemo:scp -r dafei@192.168.1.87:/data/www/test2 /data/www/test/ 其他 expect-nt","tags":[]},{"title":"ubuntu -tomact","date":"2018-03-01T03:10:38.581Z","path":"2018/03/01/ubuntu/linux_ubuntu_tomact/","text":"官网下载 Tomact 包上传到服务器12然后解压：sudo tar -zxvf apache-tomcat-9.0.5.tar.gz 在 /data/server 目录创建 tomcat 目录；然后将文件夹 apache-tomcat-9.0.5 移动到 /data/server/tomcat 下： 12mkdir tomcatsudo mv apache-tomcat-9.0.5 /data/server/tomcat/ 进入/data/server/tomcat/apache-tomcat-9.0.5/bin，编辑 startup.sh12345678910在最后一行加入下信息;#set java environmentexport JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161 ## 这里要注意要换成自己解压的 jdk 目录export JRE_HOME=$&#123;JAVA_HOME&#125;/jreexport CLASSPATH=.:%&#123;JAVA_HOME&#125;/lib:%&#123;JRE_HOME&#125;/libexport PATH=$&#123;JAVA_HOME&#125;/bin:$PATH#tomcatexport TOMCAT_HOME=/data/server/tomcat/apache-tomcat-9.0.5 ## 这里要注意要换成自己解压的 tomcat 目录 启动1sudo ./startup.sh 关闭 tomcat ，需要在 shutdown.sh 对应的位置添加信息12345678910在最后一行加入下信息;#set java environmentexport JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161 ## 这里要注意要换成自己解压的 jdk 目录export JRE_HOME=$&#123;JAVA_HOME&#125;/jreexport CLASSPATH=.:%&#123;JAVA_HOME&#125;/lib:%&#123;JRE_HOME&#125;/libexport PATH=$&#123;JAVA_HOME&#125;/bin:$PATH#tomcatexport TOMCAT_HOME=/data/server/tomcat/apache-tomcat-9.0.5 ## 这里要注意要换成自己解压的 tomcat 目录 停止1sudo ./shutdown.sh 加入开机启动：把catalina.sh文件复制到/etc/init.d123456789101112131415161718sudo cp -p /data/server/tomcat/apache-tomcat-9.0.5/bin/catalina.sh /etc/init.d/tomcat 编辑tomcat文件： sudo vim /etc/init.d/tomcat 在开头写如下内容：【提醒：这里一定要注意书写格式，不能有空格，有#的注释部分也要写全，不要遗漏】### BEGIN INIT INFO # Provides: tomcat # Required-Start: $local_fs $network # Required-Stop: $local_fs # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: tomcat service # Description: tomcat service daemon ### END INIT INFO CATALINA_HOME=/data/server/tomcat/apache-tomcat-9.0.5 JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161 添加自启动服务1update-rc.d tomcat defaults 测试，关机重启访问 localhost:8080 或者 192.168.1.113:8080 tomact 命令1234service tomcat &#123;start|stop|restart&#125;service tomcat stopservice tomcat startservice tomcat restart","tags":[]},{"title":"Ubuntu -jdk","date":"2018-02-28T06:05:48.360Z","path":"2018/02/28/ubuntu/linux_ubuntu_jdk/","text":"Ubuntu 安装 jdk 2 种方式1、 通过 ppa 源方式安装 jdk82、通过官网下载安装包安装 jdk8 检测linux多少位： getconf LONG_BIT 我的系统是64位 使用 ppa 源方式安装添加ppa12sudo add-apt-repository ppa:webupd8team/javasudo apt-get update 安装oracle-java-installer1sudo apt-get install oracle-java8-installer 接下来会出现连个界面，选择ok、yes 即可 查看java版本1java -version 卸载jdk1sudo apt-get remove openjdk* 直接下载 jdk 压缩包方式安装官网下载 jdkjdk1.8 官网地址 选择相应的系统 .tar.gz 包，然后用ssh上传到服务器【提醒：不要在服务器直接下载，否则解压会出错】 解压缩，放到指定目录1sudo tar -zxvf jdk-8u161-linux-x64.tar.gz -C /usr/lib/jvm 修改环境变量1sudo vim ~/.bashrc #或者修改 vim /etc/profile 文件的末尾追加下面内容 12345#set oracle jdk environmentexport JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161 ## 这里要注意目录要换成自己解压的jdk 目录export JRE_HOME=$&#123;JAVA_HOME&#125;/jre export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH 设置系统默认 jdk 版本12345678sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.8.0_161/bin/java 300 sudo update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/jdk1.8.0_161/bin/javac 300 sudo update-alternatives --install /usr/bin/jar jar /usr/lib/jvm/jdk1.8.0_161/bin/jar 300 sudo update-alternatives --install /usr/bin/javah javah /usr/lib/jvm/jdk1.8.0_161/bin/javah 300 sudo update-alternatives --install /usr/bin/javap javap /usr/lib/jvm/jdk1.8.0_161/bin/javap 300 然后执行sudo update-alternatives --config java 测试 jdk1java -version","tags":[]},{"title":"Ubuntu16 -nginx","date":"2018-02-26T07:13:09.109Z","path":"2018/02/26/ubuntu/linux_ubuntu_nginx/","text":"安装nginx 01安装nginx123456789sudo apt-get install nginx启动 ngnnx: sudo service nginx start扩展centos nginx 重启service nginx restart/etc/init.d/nginx stop/etc/init.d/nginx start 查看nginx配置文件目录123ps -aux | grep nginx 【返回结果包含安装目录】nginx -t 【返回结果包含配置文件目录】cat /etc/nginx/nginx.conf 编译安装02安装必要的编译环境,[ 在ubuntu18中编译安装参考另一篇文章]Tengine 安装需要使用源代码自行编译，所以安装前需要安装必要的编译工具 1234567sudo apt-get install build-essentialsudo apt-get install libtoolsudo apt-get install g++centos 平台编译环境命令：yum -y install gcc automake autoconf libtool makeyum install gcc gcc-c++ 安装所需要的组件【pcre、openssl、zlib】，组件安装的时候注意路径 PCRE12345678!!!只需要解压即可,nginx安装的时候,指定到解压目录就okwget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.38.tar.gz解压到你指定的目录tar -zxvf pcre-8.38.tar.gz -C /data/server/nginx_componentmv pcre-8.38 pcrecd pcre/./configure --prefix=/data/server/nginx_component/pcremake &amp;&amp; make install OpenSSL12345678!!!只需要解压即可,nginx安装的时候,指定到解压目录就okwget http://www.openssl.org/source/openssl-1.0.2.tar.gz解压到你指定的目录tar -zxvf openssl-1.0.2.tar.gz -C /data/server/nginx_componentmv openssl-1.0.2 opensslcd openssl/./config --prefix=/data/server/nginx_component/opensslmake &amp;&amp; make install Zlib12345678!!!只需要解压即可,nginx安装的时候,指定到解压目录就okwget http://zlib.net/zlib-1.2.11.tar.gz解压到你指定的目录tar -zxvf zlib-1.2.11.tar.gz -C /data/server/nginx_componentmv zlib-1.2.11 zlibcd zlib/./configure --prefix=/data/server/nginx_component/zlibmake &amp;&amp; make install 下载nginx安装包，我选择的是 1.4.2123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051./configure --help 可以查看nginx的编译参数说明,这里可以看到nginx需要的【pcre、openssl、zlib】的源码位置,所有者三个东西可以不用需要编译安装,只需要有源码即可wget http://nginx.org/download/nginx-1.4.2.tar.gz解压到 /data/server/nginx 目录（可以根据实际情况选择目录）：tar -zxvf nginx-1.4.2.tar.gz -C /data/server/mv nginx-1.4.2 nginxcd nginx##注意路径 ./configure --prefix=/data/server/nginx \\--with-http_ssl_module \\--with-pcre=/data/server/nginx_component/pcre \\--with-zlib=/data/server/nginx_component/zlib \\--with-openssl=/data/server/nginx_component/openssl make &amp; make install 安装完的提示：.........test -f '/data/server/nginx/nginx.conf' || cp conf/nginx.conf '/data/server/nginx/nginx.conf'cp conf/nginx.conf '/data/server/nginx/nginx.conf.default'test -d '/data/server/nginx' || mkdir -p '/data/server/nginx'test -d '/usr/local/nginx/logs' || mkdir -p '/usr/local/nginx/logs'test -d '/usr/local/nginx/html' || cp -R html '/usr/local/nginx'test -d '/usr/local/nginx/logs' || mkdir -p '/usr/local/nginx/logs'make[1]: Leaving directory '/data/server/nginx'[1]+ Exit 2 ****************************-------------如果执行make报错-----------cc1: all warnings being treated as errorsobjs/Makefile:447: recipe for target 'objs/src/core/ngx_murmurhash.o' failedmake[1]: *** [objs/src/core/ngx_murmurhash.o] Error 1make[1]: Leaving directory '/data/download/nginx-1.4.2'Makefile:8: recipe for target 'build' failedmake: *** [build] Error 2-------- 修改 /nginx-1.4.2/objs/Makefile----现在修改 /nginx-1.4.2/objs/Makefile 2 CC = cc 3 CFLAGS = -pipe -O -W -Wall -Wpointer-arith -Wno-unused -Werror -g 4 CPP = cc -E 5 LINK = $(CC)去掉这里面的 -Werror 重新make,不要重新编译---------------------------------------makemake install**************************** 注意配置的时候 –with-pcre 、–with-openssl、–with-zlib的路径为源文件的路径 检测是否可用12/data/server/nginx/nginx -t./nginx -t 报错：12345678安装完会有异常,没有 pid 文件，那就创建一个 pid 文件root@ubuntu:/data/server/nginx# /data/server/nginx/nginx -s reloadnginx: [error] open() \"/data/server/nginx/nginx.pid\" failed (2: No such file or directory)root@ubuntu:/data/server/nginx# touch nginx.pidroot@ubuntu:/data/server/nginx# /data/server/nginx/nginx -s reloadnginx: [error] invalid PID number \"\" in \"/data/server/nginx/nginx.pid\"root@ubuntu:/data/server/nginx# /data/server/nginx/nginx -c /data/server/nginx/conf/nginx.confroot@ubuntu:/data/server/nginx# /data/server/nginx/nginx -s reload 命令1234567/data/server/nginx/nginx -t 【检查配置】/data/server/nginx/nginx 【启动命令】/data/server/nginx/nginx -s stop 【停止命令】/data/server/nginx/nginx -s reload 【重启命令：】pid出错时，可以使用这个：/data/server/nginx/nginx -c /data/server/nginx/conf/nginx.conf 编译安装03下载1234当前操作目录位置： /home/fei/serverwget http://nginx.org/download/nginx-1.4.2.tar.gztar -zxvf nginx-1.4.2.tar.gz -C /home/fei/servercd nginx-1.4.2 配置12345678910111213./configure --prefix=/data/server/nginx-1.4.2发现少包，安装缺少的包sudo apt-get install libpcre3 libpcre3-dev 再次配置【 一直到不在缺少包 】./configure --prefix=/data/server/nginx-1.4.2【 常见缺少少包： pcre、openssl、zlib，安装这三个包命令如下】sudo apt-get install libpcre3 libpcre3-dev sudo apt-get install openssl libssl-dev sudo apt-get install zlib1g-dev 配置 OK 后，继续操作 编译安装1make &amp;&amp; make install 检测是否可用1/data/server/nginx-1.4.2/sbin/nginx -t 安装完成后，原文件就没有用了 命令12345678910111213/data/server/nginx/nginx -t 【检查配置】/data/server/nginx/nginx 【启动命令】/data/server/nginx/nginx -s stop 【停止命令】/data/server/nginx/nginx -s reload 【重启命令：】/data/server/nginx/nginx -v 【查看nginx版本】/data/server/nginx/nginx -V 【大写V 检查编译参数】pid出错时，可以使用这个：/data/server/nginx/nginx -c /data/server/nginx/conf/nginx.conf让nginx 返回http状态码return 403;return 500; 其他让普通用户可以启动nginx1234用root用户进入....nginx/sbin然后chown root nginxchmod u+s nginx然后通过普通用户就可以启动了。 nginx 官网 nginx 官网下载 nginx 官网linux安装","tags":[]},{"title":"ubuntu -jenkins","date":"2018-02-17T03:06:40.377Z","path":"2018/02/17/ubuntu/linux_ubuntu_jenkins/","text":"下载war 包第一种安装方式：前提：系统中必须安装好jdk，我的 jdk 是1.8 将下载好的war包放到linux中；切换到 jenkins.war 存放目录，输入命令： java -jar jenkins.war 然后在浏览器中输入localhost:8080,就可以打开Jenkins 这种方式安装好后命令窗口会一直保持打开状态，不太实用； 第二种安装方式，在 tomcat 中启动 不管用那种方法，安装后登录时空白，现在没有时间弄了，有知道的请留言 安装12345678wget -q -O - https://pkg.jenkins.io/debian/jenkins-ci.org.key | sudo apt-key add -sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list'sudo apt-get updatesudo apt-get install jenkins如果是升级，直接使用一下命令sudo apt-get updatesudo apt-get install jenkins 卸载12345678910//服务sudo apt-get remove jenkins//安装包，注意这里如果不是ubuntu那就yumsudo apt-get remove --auto-remove jenkins//配置和数据sudo apt-get purge jenkinssudo apt-get purge --auto-remove jenkins","tags":[]},{"title":"Ubuntu -git","date":"2018-02-13T09:19:02.210Z","path":"2018/02/13/ubuntu/linux_ubuntu_git/","text":"前言：本地: windows7 ip: 192.168.1.105服务器Ubuntu ： Ubuntu 15.10 ip: 192.168.1.113 【cat /etc/issue】 Ubuntu中git安装123git --version 【检测当前环境是否安装git】sudo apt-get install git 【安装git】 新增用户12新增用户(用户名为git_dafei),用于运行git服务，回车后输入密码adduser git_dafei 初始git仓库，12345我在 /home/git_dafei/code ( mkdir -p /home/git_dafei/code 注意创建这个目录后的所有者，权限)这个目录下，使用 git init 这个--bare 选项为它设置一个空的存储库，一般服务器上的 Git 仓库是以 .git 结尾的空仓库git init --bare test.git 开始本地(windows)操作 本地生成公钥,位置 C:\\Users\\Administrator\\.ssh 或者 ~/.ssh1ssh-keygen -t rsa ls ~/.ssh/ 将win用户的公钥(即 id_rsa.pub )添加到服务器上1234 scp ~/.ssh/id_rsa.pub git_dafei@192.168.1.113:/home/git_dafei/ [扩展:使用ssh端口 ] scp -P 22 ~/.ssh/id_rsa.pub git_dafei@192.168.1.113:/home/git_dafei/ 将本地用户的公钥添加到认证文件中1234cd /home/git_dafeimkdir .sshtouch authorized_keys 【在 .ssh中创建 】cat id_rsa.pub &gt;&gt; .ssh/authorized_keys [如果没有 authorized_keys 请创建 touch authorized_keys 修改文件所有者为 git_dafei 用户123456789101112131415161718chown -R git_dafei:git_dafei /home/git_dafeichmod 755 /home/git_dafei/ # 1. 用户git_dafei目录755权限chmod 700 /home/git_dafei/.ssh # 2. .ssh目录700权限chmod 600 /home/git_dafei/.ssh/authorized_keys # 3. authorized_keys 600权限 ////////////////////效果//////////////////////////drwxr-xr-x 2 git_dafei git_dafei 4096 Feb 14 19:39 .ssh 【修改前权限】chmod 700 /home/git_dafei/.sshdrwx------ 2 git_dafei git_dafei 4096 Feb 14 19:39 .ssh 【修改后权限】【修改前权限】：-rw-r--r-- 1 git_dafei git_dafei 401 Feb 14 19:40 /home/git_dafei/.ssh/authorized_keys chmod 600 /home/git_dafei/.ssh/authorized_keys【修改后权限】-rw------- 1 git_dafei git_dafei 401 Feb 14 19:40 /home/git_dafei/.ssh/authorized_keys 修改ssh配置文件12修改ssh配置文件/etc/ssh/sshd_config，取消这行(33行) AuthorizedKeysFile %h/.ssh/authorized_keys 前面的注释修改完重启ssh: service ssh restart 安全123为例安全，禁止 git_dafei 用户 shell登录，需要修改 /etc/passwd将 git_dafei:x:1002:1002:,,,:/home/git_dafei:/bin/bash改为 git_dafei:x:1002:1002:,,,:/home/git_dafei:/usr/bin/git-shell 在win中clone刚才创建的test.git12345克隆的用户有错git clone git_dafei@192.168.1.113:/home/git_dafei/code/test.gitgit clone 上面设置的用户名@服务器ip:/home/git_dafei/code/test.gitgit clone ssh://git_dafei@192.168.1.113:22 /home/git_dafei/code/test.git [指定ssh端口克隆] Ubuntu git官方文档git官方文档","tags":[]},{"title":"ubuntu15 -redis安装","date":"2018-02-12T09:04:26.148Z","path":"2018/02/12/ubuntu/linux_ubuntu_redis/","text":"redis2种安装方式 安装redis1234sudo apt-get install redis-server 启动redisredis-server 检查redis 进程1ps -aux|grep redis 终端输入：redis-cli 测试redis是否成功 redis 设置密码123456789reids默认是不需要密码的，设置密码sudo vi /etc/redis/redis.conf 在397行： 取消 注释 # requirepass foobared 设置新密码： requirepass redis_pwd_123456 让 reids 远程登录 注释bind，在69行 # bind 127.0.0.1 修改后重启redis1sudo /etc/init.d/redis-server restart 记得使用密码登录奥！！！ 卸载redis1sudo apt-get purge --auto-remove redis-server 2、编译安装下载1234wget http://download.redis.io/releases/redis-4.0.8.tar.gztar -xzvf redis-4.0.8.tar.gz -C /data/server/cd redis-4.0.8/make 启动redismake完后 redis-4.0.8目录下会出现编译后的redis服务程序redis-server,还有用于测试的客户端程序redis-cli,两个程序位于安装目录 src 目录下，下面启动redis服务. 12cd src/./redis-server redis设置密码123456789reids默认是不需要密码的，设置密码vi redis.conf 在500行： 取消 注释 # requirepass foobared 设置新密码： requirepass redis_pwd_123456让 reids 远程登录 注释bind，在69行 # bind 127.0.0.1 修改后启动redis1src/redis-server ./redis.conf 【指定配置文件启动】 设置 reids 后台启动1234567891011121314151617181920vi redis.conf 在136行把 daemonize no 改成 daemonize yes修改完重启redis：src/redis-server ./redis.conf 【指定配置文件启动】/data/server/redis-4.0.8/src/redis-server ./redis.conf 【指定配置文件启动】/data/server/redis-4.0.8/src/redis-server /data/server/redis-4.0.8/redis.conf 【指定配置文件启动】后台启动后关闭命令：./redis-cli -h 127.0.0.1 -a redis_pwd_123456 -p 6379 shutdown/data/server/redis-4.0.8/src/redis-cli -h 127.0.0.1 -a redis_pwd_123456 -p 6379 shutdown指定密码登录：/data/server/redis-4.0.8/src/redis-cli -a redis_pwd_123456./redis-cli -a redis_pwd_123456./redis-cli 回车后,输入 auth 密码测试数据：set key1 \"hello world\"get key1 redis官网下载地址 redis官网安装","tags":[]},{"title":"Ubuntu -ssh","date":"2018-02-12T06:25:27.548Z","path":"2018/02/12/ubuntu/linux_ubuntu_ssh/","text":"安装客户端1sudo apt install openssh-client 安装服务端1sudo apt install openssh-server 配置1查看手册 man sshd_config 在编辑配置文件之前，您应该生成一个原始文件的拷贝并对其写保护，以便您可以参考原始文件并在必要时重用它。拷贝 /etc/ssh/sshd_config 文件并对其写保护可以通过在终端提示符后运行下列命令 12sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.originalsudo chmod a-w /etc/ssh/sshd_config.original 要设置您 OpenSSH 在 TCP 2222 端口而不是缺省的 TCP 20 端口监听，可以如下使用改变 Port 语句： Port 2222 要让 sshd 允许基于公钥登录证书，可以简单添加或修改该行语句： PubkeyAuthentication yes If the line is already present, then ensure it is not commented out. 要使您的 OpenSSH 服务器显示 /etc/issue.net 文件的内容以作为预登录 Banner，只需简单地将下行添加或修改： Banner /etc/issue.net 在 /etc/ssh/sshd_config 文件中。 在修改 /etc/ssh/sshd_config 文件之后，保存该文件并重启 sshd 服务器应用程序以使之生效。可以在终端提示符后使用下列命令： 1sudo systemctl restart sshd.service SSH服务器命令1234567停止服务：sudo /etc/init.d/ssh stop启动服务：sudo /etc/init.d/ssh start重启服务：sudo /etc/init.d/ssh restart登录： ssh 用户名@远程ip demo： ssh dafei@192.168.1.82 ssh -p 22 dafei@192.168.1.82 [指定端口登录]断开连接：exit; 如果细心，可能发现远程登录不能用root登录，解决办法： 修改 /etc/ssh/sshd_config 配置文件 1234526 # Authentication:27 LoginGraceTime 12028 # PermitRootLogin prohibit-password 【找到这一行注释掉】29 PermitRootLogin yes 【改为yes】30 StrictModes yes 其他证书登录、无密码登录这里不在写，有需要的自己网上找资料；这个也是修改 sshd_config 文件 扩展： Ubuntu ssh","tags":[]},{"title":"ubuntu -docker","date":"2018-02-08T02:04:31.865Z","path":"2018/02/08/ubuntu/linux_ubuntu_docker/","text":"Linux ubuntu docker前提条件 Docker要求Ubuntu系统内核版本高于3.10，查看内核版本 1uname -r 系统版本没有问题，docker安装一直包这错。试一下docker命令，检查镜像信息 123docker images现在Ubuntu系统提示安装docker命令，我们执行apt-get install docker.io 查看docker版本123docker versionsudo docker run hello-world 【确认docker是否安装成功】 ———————–到这里docker已经安装完成———————— 安装docker-compose12345678910111213141516171819202122232425sudo curl -L https://github.com/docker/compose/releases/download/1.17.1/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-composesudo chmod +x /usr/local/bin/docker-composecurl -L https://raw.githubusercontent.com/docker/compose/1.8.0/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose 【bash 补全命令】////////如果出现超时，加上2个参数： ///////////--connect-timeout 100000 -m 1000000-m为数据最大传输时间curl -L \"https://github.com/docker/compose/releases/download/1.9.0/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose --connect-timeout 100000 -m 1000000 ////////////////////////////////////////////docker-compose -version 【检测 docker-compose 版本】sudo rm /usr/local/bin/docker-compose 【卸载docker-compose】-----------------------------------------------docker-compose 命令docker-compose ps 查看容器运行状态docker-compose restart #重启所有容器docker-compose restart App1 #重启App1docker-compose stop #停止所有容器docker-compose rm #删除所有容器docker-compose stop App1 #停止App1docker-compose -f docker-compose.yml down 停止并删除容器、网络、镜像、数据卷 ———————–到这里docker-compose已经安装完成———————— Docker Compose 搭建 Rails温馨提示： 复制粘贴命令的时候注意别丢信息 创建项目目录12mkdir myappcd myapp 创建 Dockerfile文件，包含以下内容12345678FROM ruby:2.3.3RUN apt-get update -qq &amp;&amp; apt-get install -y build-essential libpq-dev nodejsRUN mkdir /myappWORKDIR /myappCOPY Gemfile /myapp/GemfileCOPY Gemfile.lock /myapp/Gemfile.lockRUN bundle installCOPY . /myapp 创建 Gemfile 文件，包含以下内容12source 'https://rubygems.org'gem 'rails', '5.0.0.1' 创建空的 Gemfile.lock 文件1touch Gemfile.lock 创建一个 docker-compose.yml ，包含以下内容温馨提示：docker-compose.yml 中 version: ‘3’ 改为 version: ‘2’ 12345678910111213version: '2'services: db: image: postgres web: build: . command: bundle exec rails s -p 3000 -b '0.0.0.0' volumes: - .:/myapp ports: - \"3000:3000\" depends_on: - db 接下来执行1docker-compose run web rails new . --force --database=postgresql 查看现在的目录： ls -l 修改权限，重建 Docker 镜像12sudo chown -R $USER:$USER .docker-compose build 修改 config/database.yml 文件如果担心修改错误，可以先备份原文件： cp database.yml database.yml_backup 123456789101112131415161718192021清空 database.yml 文件echo \" \"&gt;database.ymldatabase.yml 文件写入以下内容default: &amp;default adapter: postgresql encoding: unicode host: db username: postgres password: pool: 5development: &lt;&lt;: *default database: myapp_developmenttest: &lt;&lt;: *default database: myapp_test 启动应用1docker-compose up 创建数据库，在另一个终端中，执行1docker-compose run web rake db:create 用浏览器访问 http://localhost:3000 ，你会看到 Rails 的欢迎信息： If you are using Docker Machine, then docker-machine ip MACHINE_VM returns the Docker host IP address, to which you can append the port (&lt;Docker-Host-IP&gt;:3000). Compose and Rail 官方文档","tags":[]},{"title":"ubuntu系统","date":"2018-02-07T02:54:13.969Z","path":"2018/02/07/ubuntu/linux_ubuntu_centos/","text":"虚拟机安装完ubuntu后root没有密码12设置root密码sudo passwd 虚拟机安装完centos后重新设置root密码12设置root密码passwd 用户切换：1234567891011121314sudo su (切换到root用户)； su user（user是你自己安装时候的用户名；切换到普通用户）其他命令：修改文件权限： sudo chmod -R 777 文件名安装文件命令： sudo apt-get install 文件名 清空某个文件 echo \"\" &gt;log.log 动态查看内容 tail -f api_v1.log 修改文件权限 sudo chmod -R 777 文件名 ubuntu安装好系统后，vi不能正常使用方向键和退格键ubuntu中vi在编辑状态下方向键不能用，还有回格键不能删除等我们平时习惯的一些键都不能使用。解决办法：可以安装vim full版本，在full版本下键盘正常，安装好后同样使用vi命令。 12345678910111213141516171819202122232425262728-----------（1）-----一般安装步骤------------------ sudo apt-get remove vim-common sudo apt-get install vim-----------（2）------直接安装vim 报错 packet 不存在、找不到 请换源，参考下面-----------进入/etc/apt/ cd /etc/apt对 sources.list文件进行备份 sudo cp sources.list sources.list.bak删除掉 sources.list 中的内容【命令 echo \"\"&gt;sources.list 】，选择阿里云源 deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse------------（3）换源结束-------------------------------apt-get update 先更新一下现在可以安装vim sudo apt-get install vim centos7换源12345678910111213进入 /etc/yum.repos.d/ cd /etc/yum.repos.d/对 CentOS-Base.repo 文件备份 CentOS-Base.repo.backups cp -avr CentOS-Base.repo CentOS-Base.repo.backupscenos7的源;wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo或者curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo yum clean all #清理缓存 yum makecache #生成新缓存 yum update -y #更新源设置 关闭防火墙1systemctl stop firewalld.service OPSX阿里巴巴开源镜像站","tags":[]},{"title":"数据库账号管理","date":"2018-02-01T07:46:08.453Z","path":"2018/02/01/mysql_DDU_数据库账号/","text":"注意事项 分配数据库账号权限时，请按最小权限原则和业务角色创建账号，并合理分配只读和读写权限。必要时可以把数据库账号和数据库拆分成更小粒度，使每个数据库账号只能访问其业务之内的数据。如果不需要数据库写入操作，请分配只读权限 为保障数据库的安全，请将数据库账号的密码设置为强密码，并定期更换。","tags":[]},{"title":"-cp  创建文件和目录的副本","date":"2018-01-29T07:31:05.919Z","path":"2018/01/29/ubuntu/linux_DDU_cp/","text":"不带任何参数,运行cpcp最基本命令，拷贝file_3.txt 从一个位置复制到另一个位置 12345ls -all 【递归展示目录本文中会多次用到】----------------------------cp file_3.txt /home/destination_file或者cp /home/soruce_file2/file_3.txt /home/destination_file 拷贝多个文件拷贝多个文件，我们只需将文件名字用空格隔开。或者使用*拷贝所有文件 12cp file_3.txt file_4.txt /home/destination_filecp * /home/destination_file 【拷贝所有文件，注意观察截图，aaa目录没有拷贝成功，稍后解决】 拷贝一个目录-r 或者 -R ，不论目录是否为空都会拷贝 1cp -r aaa/ /home/destination_file 【这就解决上次没有拷贝aaa目录】 创建文件硬链接，而不是拷贝他们拷贝文件意味着你必须使用一些存储空间来储存拷贝的文件。有时候出于某种原因，你可能想要创建“快捷方式”或者链接到文件，而不是拷贝它们。要做到这一点，我们可以使用-l选项。 1cp -l file_3.txt /home/destination_file 创建文件的软连接【符号链接、快捷方式…..】软连接（符号链接）用 -s实现 1cp -s file_3.txt file_44.txt 文件归档使用 -a 选项来归档文件。保留链接和文件属性，递归拷贝目录，相当于下面的d、p、r三个选项组合。 1cp -a * /home/destination_file/ 只拷贝文件属性只拷贝文件属性，不拷贝文件内容，使用 –attributes-only 选项 1cp --attributes-only file_3.txt /home/destination_file/ 显示正在做什么默认情况下，拷贝是不会显示拷贝时发生了什么，我们可以使用 -v选项 1cp -v * /home/destination_file/ 目标文件时间是最新更改，源文件时间老拷贝时，目标文件先存着和源文件同名文件，切目标文件时间是最新更改，使用 -u,不会覆盖最新文件 1cp -vu file_3.txt file_4.txt /home/destination_file/ 使用交互模式交互模式下会询问是否覆盖目标目录下的文件。使用 -i 选项 1cp -i file_3.txt file_4.txt /home/destination_file/ 创建备份文件目标文件中存在与源文件同名文件，使用 -b 选项，备份目标文件，拷贝新文件 1cp -bv * /home/destination_file/ 强制拷贝使用 -f 强制拷贝文件。如果目标文件不能打开，可以用 -f 尝试一下。 1cp -f * /home/destination_file/ 在拷贝之前先删除目标可以用，–remove-destination 选项 实现。这个选项与上面的-f选项形成对照。如果 cp 命令在目标目录下发现同名文件， cp 命令会先删除目标文件，然后再拷贝一份新的。 1cp --remove-destination -v * /home/destination_file/ 其他： 123一般情况下用这个命令 【参数avr】cd /home/www/Downloadscp -avr * /data/www/","tags":[]},{"title":"阿里云CDN上实现https","date":"2018-01-18T03:15:31.841Z","path":"2018/01/18/阿里云CDN上实现https/","text":"SSL证书管理对于静态资源的请求，由于存储在阿里OSS上，并在前端使用了阿里云CDN,因此将相关SSL证书的信息在阿里云CDN上配置一下就ok。 1客户端-------请求（js,img，css）------&gt;CDN----&gt;云存储OSS 从阿里云CA证书服务下载证书 下载解压后得到2个文件： xxx.pem xxx.key 在阿里云CDN管理控制台找到 HTTPS设置点击域名中的配置,然后找到HTTPS设置，修改配置 打开之前下载好的xxx.pem 和 xxx.key ,将里面的内容分别复制到证书对应位置,建议跳转类型设置为默认，保存之后用HTTPS访问你的静态资源，测试一下","tags":[]},{"title":"计算两点之间的距离","date":"2017-12-30T13:50:12.635Z","path":"2017/12/30/mysql_DDU_计算两点之间的距离/","text":"MySql查询执行流程图12345发送语句查询缓存查询优化执行查询返回结果 计算两点之间的距离一个典型的例子是计算以某个点为中心，一定半径内的所有点。典型的实际案例可能是查找某个附近所有可以出租的房子，或者社交网站中“匹配”附近的用户，等等。假设我们有如下表：123456789CREATE TABLE `locations` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(30) DEFAULT NULL, `lat` float NOT NULL, `lon` float NOT NULL, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;INSERT INTO locations(name,lat,lon)VALUES(\"Charlottesville,Virginia\",38.03,-78.48),(\"Chicago,Illinois\",41.85,-87.65),(\"Mashington,DC\",38.89,-77.04) 这里经度和纬度的单位是“度”，通常我们假设地球是圆的，然后使用两点所在最大圆（半正矢）公式来计算两点之间的距离。现在有坐标latA和lonA、latB和lonB，那么点A和点B的距离计算公式如下： 1234AcOS(COS(latA)*COS(latB)*COS(lonA-lonB)+SIN(1atA)*SIN(LatB)) 计算出的结果是一个弧度，如果要将结果的单位转换成英里或者千米，则需要乘以地球的半径，也就是3959英里或者6371千米。假设我们需要找出所有距离Baron所居住的地方Charlottesville100英里以内的点，那么我们需要将经纬度带入上面的计算公式： 12345678910111213SELECT * FROM locations WHERE 3979*ACOS(COS(radians(lat))*COS(radians(38.03))*COS(radians(lon)-radians(-78.48))+SIN(radians(lat))*SIN(radians(38.03)))&lt;=100;+----+--------------------------+-------+--------+| id | name | lat | lon |+----+--------------------------+-------+--------+| 1 | Charlottesville,Virginia | 38.03 | -78.48 || 3 | Mashington,DC | 38.89 | -77.04 |+----+--------------------------+-------+--------+ 这类查询不仅无法使用索引，而且还会非常消耗CPU时间，给服务器带来很大的压力，而且我们还得反复计算这个。那要怎样优化呢?这个设计中有几个地方可以微优化。第一，看看是否真的需要这么精确的计算。其实这种算法已经有很多不精确的地方了，如下所示：两个地方之间的直线距离可能是100英里，但实际上它们之间的行走距离很可能不是这个值。无论你们在哪两个地方，要到达彼此位置的行走距离多半都不是直线距离，路上可能需要绕很多的弯，比如说如果有一条河，需要绕远走到一个有桥的地方。所以，这里计算的绝对距离只是一个参考值。 如果我们根据邮政编码来确定某个人所在的地区，再根据这个地区的中心位置计算他和别人的距离，那么这本身就是一个估算。Baron 住在Charlottesville，不过不是在中心地区，他对华盛顿物理位置的中心也不感兴趣。所以，通常并不需要精确计算，很多应用如果这样计算，多半是认真过头了。这类似于有效数字的估算：计算结果的精度永远都不会比测量的值更高。（换句话说，“错进，错出”。） 如果不需要太高的精度，那么我们认为地球是圆的应该也没什么问题，其实准确的说应该是椭圆。根据毕达哥拉斯定理，做些三角函数变换，我们可以把上面的公式转换得更简单，只需要做些求和、乘积以及平方根运算，就可以得出一个点是否在另一个点多少英里之内。益习等等，为什么就到这为止？我们是否真需要计算一个圆周呢？为什么不直接使用一个正方形代替?边长为200英里的正方形，一个顶点到中心的距离大概是141英里，这和实际计算的100英里相差得并不是那么远。那我们根据正方形公式来计算弧度为0.0253（100英里）的中心到边长的距离： 12345678910SELECT * FROM locations WHERE lat BETWEEN 38.03 - DEGREES(0.0253) AND 38.03 + DEGREES(0.0253)AND lon BETWEEN -78.48 - DEGREES(0.0253) AND -78.48 + DEGREES(0.0253);+----+--------------------------+-------+--------+| id | name | lat | lon |+----+--------------------------+-------+--------+| 1 | Charlottesville,Virginia | 38.03 | -78.48 || 3 | Mashington,DC | 38.89 | -77.04 |+----+--------------------------+-------+--------+ 现在我们看看如何使用索引来优化这个查询。简单地，我们可以增加索引（lat,lon)或者（lon,lat)。不过这样做效果并不会很好。正如我们所知，MySQL5.5和之前的版本，如果第一列是范围查询的话，就无法使用素引后面的列了。因为两个列都是范围的，所以这里只能使用索引的一个列（BETMEEN等效于一个大于和一个小于）。我们再次想起了通常使用的IN（）优化。我们先新增两个列，用来存储坐标的近似值FLOOR()，然后在查询中使用IN（）将所有点的整数值都放到列表中。下面是我们需要新增的列和索引： 12345678ALTER TABLE locations ADD lat_floor INT NOT NULL DEFAULT 0, ADD lon_floor INT NOT NULL DEFAULT 0, ADD KEY (lat_floor,lon_floor);-----------------------------------------UPDATE locationsSET lat_floor = FLOOR(lat),lon_floor=FLOOR(lon); 现在我们可以根据坐标的一定范围的近似值来搜索了，这个近似值包括最小值和最大值，地理上分别对应的是南北。下面的查询为我们只展示了如何查某个范围的所有点：数值需要在应用程序中计算而不是MySQL中： 12345678910SELECT FLOOR(38.03 - DEGREES(0.0253))AS lat_1b,CEILING( 38.03 + DEGREES(0.0253))AS lat_lub,FLOOR(-78.48 - DEGREES(0.0253))AS 1on_1b,CEILING(-78.48 + DEGREES(0.0253))AS 1on_ub;------------------------------------------------------+--------+---------+--------+--------+| lat_1b | lat_lub | 1on_1b | 1on_ub |+--------+---------+--------+--------+| 36 | 40 | -80 | -77 |+--------+---------+--------+--------+ 现在我们就可以生成IN（）列表中的整数了，也就是前面计算的地板和天花板数值之间的数字。下面是加上WHERE条件的完整查询：12345678910111213现在我们就可以生成IN（）列表中的整数了，也就是前面计算的地板和天花板数值之间的数字。下面是加上WHERE条件的完整查询：SELECT * FROM locationsWHERE lat BETWEEN 38.03-DEGREES(0.0253)AND 38.03 + DEGREES(0.0253)AND lon BETWEEN-78.48-DEGREES(0.0253)AND-78.48 +DEGREES(0.0253)AND lat_floor IN(36,37,38,39,40)AND lon_floor IN(-80,-79,-78,-77);+----+--------------------------+-------+--------+-----------+-----------+| id | name | lat | lon | lat_floor | lon_floor |+----+--------------------------+-------+--------+-----------+-----------+| 1 | Charlottesville,Virginia | 38.03 | -78.48 | 38 | -79 || 3 | Mashington,DC | 38.89 | -77.04 | 38 | -78 |+----+--------------------------+-------+--------+-----------+-----------+ 使用近似值会让我们的计算结果有些偏差，所以我们还需要一些额外的条件剔除在正方形之外的点。这和前面使用CRC32做哈希索引类似：先建一个索引帮我们过滤出近似值，再使用精确条件匹配所有的记录并移除不满足条件的记录。事实上，到这时我们就无须根据正方形的近似来过滤数据了，我们可以使用最大圆公式或者毕达哥拉斯定理来计算： 123456789101112131415SELECT * FROM locationsWHERE lat_floor IN(36,37,38,39,40)AND lon_floor IN(-80,-79,-78,-77)AND 3979*ACOS(COS(radians(lat))*COS(radians(38.03))*COS(radians(lon)-radians(-78.48))+SIN(radians(lat))*SIN(radians(38.03)))&lt;=100;----------------------------------------------+----+--------------------------+-------+--------+-----------+-----------+| id | name | lat | lon | lat_floor | lon_floor |+----+--------------------------+-------+--------+-----------+-----------+| 1 | Charlottesville,Virginia | 38.03 | -78.48 | 38 | -79 || 3 | Mashington,DC | 38.89 | -77.04 | 38 | -78 |+----+--------------------------+-------+--------+-----------+-----------+ 这时计算精度再次回到前面——使用一个精确的圆周——不过，现在的做法更快。只要能够高效地过滤掉大部分的点，例如使用近似整数和索引，之后再做精确数学计算的代价并不大。只是不要直接使用大圆周的算法，否则速度会很慢。 Sphinx有很多内置的地理信息搜索功能，比MySQL实现要好很多。如果正在考虑使用MyISAM的GIS函数，并使用上面的技巧来计算，那么你需要记住：这样做效果并不会很好，MyISAM本身也并不适合大数据量、高并发的应用，另外MyISAM本身还有一些弱点，如数据文件崩溃、表级锁等。 回顾一下上面的案例，我们采用了下面这些常用的优化策略：·尽量少做事，可能的话尽量不做事。这个案例中就不要对所有的点计算大圆周公式；先使用简单的方案过滤大多数数据，然后再到过滤出来的更小的集合上使用复杂的公式运算。 快速地完成事情。确保在你的设计中尽可能地让查询都用上合适的索引，使用近似计算（例如本案例中，认为地球是平的，使用一个正方形来近似圆周）来避免复杂的计算。 需要的时候，尽可能让应用程序完成一些计算。例如本案例中，在应用程序中计算所有的三角函数。","tags":[]},{"title":"-mv   移动或重命名文件/目录","date":"2017-12-19T02:09:17.291Z","path":"2017/12/19/ubuntu/linux_DDU_mv/","text":"移动文件移动文件时需要注意的是文件的源地址和目标地址必须不同。这里有个例子，想要将file_1.txt文件从当前目录移动到其它目录，以/home/destination_file为例，语法应该如下： 1mv file_1.txt /home/destination_file/ 移动多个文件如果想一次移动多个文件，我们可以将他们放在一行并用空格分开。 123mv file_2.txt file_3.txt file_4.txt /home/destination_file/或者mv file_&#123;2,3,4&#125;.txt /home/destination_file/ 如果你的文件夹有规律可循那么你就可以使用通配符，比如，为了移除所有以.txt为扩展名的文件夹，我们可以使用下面的命令： 1mv *.txt /home/destination_file/ 移动目录不同于复制命令，用mv命令移动目录相当于直接。移动目录你可以使用不带选项的mv命令。 1mv /soruce_file/ /home/destination_file/ 重命名文件或目录我们也用mv命令来重命名文件或目录，不过目标位置必须相同才可以。然后文件名字必须不同。假定我们当前做所在目录为/home/soruce_file 123mv file_1.txt file_new1.txt如果是绝对路径，应该像下面这样：mv /home/soruce_file/file_2.txt /home/soruce_file/file_new2.txt 重命名目录12上一段的规则同样适用于目录。mv /home/soruce_file/ /home/soruce_file2/ 打印移动信息当你移动或重命名一大堆文件或目录时，你可能会想在不去目标位置去查看的情况下知道自己的命令是否成功地执行了。这就用到-v选项了。 1mv -v /home/soruce_file2/*.txt /home/destination_file/ 使用交互模式当你将文件移动到其他位置，而那个位置恰好有同样的文件，这时mv命令会覆盖掉原来的文件，对于mv的这一行为一般不会有什么提示。如果想产生一个关于覆盖文件的提示，我们可以使用-i选项。 1mv -i /home/soruce_file2/file_3.txt /home/destination_file/ 这个提示会让我们知道目标位置处file_3.txt的存在。如果我们按y键，那么那个文件将会被删除，否则不会 使用更新选项-i 选项会提示我们关于覆盖文件的提示，而 -u 则只在源文件比目标文件新时才执行更新，如果目标文件比源文件新，则不会执行。让我们看一看下面的例子： 1mv -uv /home/soruce_file2/*.txt /home/destination_file/ 不要覆盖任何已存在的文件如果-i选项询问我们是否覆盖文件，那么-n选项将不会允许我么覆盖任何已存在的文件， 1mv -vn /home/soruce_file2/file_new_time2.txt /home/destination_file/ 复制时创建备份默认情况下，移动文件将会覆盖已存在的目标文件。但是如果我们移动错了文件而目标文件已经被新的文件覆盖了，这时应该怎么办才好呢？-b选项可以办到，该选项会在新文件覆盖旧文件时将旧文件做备份。 1mv -bv /home/soruce_file2/file_new_time2.txt /home/destination_file/ 无条件覆盖已经存在的文件覆盖已经存在的文件或目录，使用-f选项。如果同时指定了 -f 选项和 -i 或 -n 选项，则 -f 选项会覆盖它们——即不进行任何提示而覆盖。所以在使用此参数的时候，你要保持头脑清醒，知道自己在做什么。 1mv -f /home/soruce_file2/file_new_time2.txt /home/destination_file/ 总结移动文件和目录命令是Linux系统的基本命令。通常你可以通过man mv 或者 mv –help显示mv的手册页以了解更多详细信息。","tags":[]},{"title":"YII2搭建后台并实现rbac权限控制","date":"2017-12-08T05:22:48.734Z","path":"2017/12/08/Yii2搭建后台并实现rbac权限控/","text":"安装Yii2参考官网安装文档yiiframeworkyiichina 配置数据库1234567891011创建数据库： create database yii2advanced default charset utf8;修改common/config/main-local.php数据库配置 'db' =&gt; [ 'class' =&gt; 'yii\\db\\Connection', 'dsn' =&gt; 'mysql:host=localhost;dbname=yii2advanced', 'username' =&gt; 'root', 'password' =&gt; 'root', 'charset' =&gt; 'utf8', ], 使用composer安装yii2-admin1234composer require mdmsoft/yii2-admin \"~2.0\"!!!温馨提示：建议安装 1.0 版本不安装 2.0 版本!!!composer require mdmsoft/yii2-admin \"~1.0\" 配置yii2-admin运行环境123456789101112131415161718192021222324权限控制在后台，所以在 backend/config/main.php 中配置以下内容：return [ 'modules' =&gt; [ 'admin' =&gt; [ 'class' =&gt; 'mdm\\admin\\Module', 'layout' =&gt; 'left-menu',//yii2-admin的导航菜单 ] ... ], ... 'components' =&gt; [ ... 'authManager' =&gt; [ 'class' =&gt; 'yii\\rbac\\DbManager', // 使用数据库管理配置文件 ] ], 'as access' =&gt; [ 'class' =&gt; 'mdm\\admin\\components\\AccessControl', 'allowActions' =&gt; [ 'site/*',//允许访问的节点，可自行添加 'admin/*',//允许所有人访问admin节点及其子节点 ] ],]; 创建数据表123456789101112131415161718php yii migrate --migrationPath=@mdm/admin/migrations执行sql：（自带的rbac） 修改配置文件console/config/main-local.phpreturn [ 'bootstrap' =&gt; ['gii'], 'modules' =&gt; [ 'gii' =&gt; 'yii\\gii\\Module', ], 'components' =&gt; [ \"authManager\" =&gt; [ \"class\" =&gt; 'yii\\rbac\\DbManager', \"defaultRoles\" =&gt; [\"guest\"], ], ],];cd到advance目录下面执行yii migrate --migrationPath=@yii/rbac/migrations 中文显示123456789101112131415161718192021222324在 common\\config\\main.php 中配置return [ 'language' =&gt; 'zh-CN', //中文显示 'aliases' =&gt; [ '@bower' =&gt; '@vendor/bower-asset', '@npm' =&gt; '@vendor/npm-asset', ], 'vendorPath' =&gt; dirname(dirname(__DIR__)) . '/vendor', 'components' =&gt; [ 'cache' =&gt; [ 'class' =&gt; 'yii\\caching\\FileCache', ], ],];现在可以查看后台：&lt;Your domain name&gt;/index.php?r=admin/user&lt;Your domain name&gt;/index.php?r=admin&lt;Your domain name&gt;/index.php?r=admin/route&lt;Your domain name&gt;/index.php?r=admin/permission&lt;Your domain name&gt;/index.php?r=admin/menu&lt;Your domain name&gt;/index.php?r=admin/role&lt;Your domain name&gt;/index.php?r=admin/assignment 配置授权demo12345678910111213141516以一个自定义的节点books为例，节点books下共有index 图书列表，view 查看图书，create创建图书，update 更新图书，delete 删除图书这个5个节点，，可以通过gii生成这些代码。配置目标：未登录用户仅能访问index节点一般用户能访问index，view，create三个节点管理员能访问所有节点---------------------------在 backend/config/main.php 中修改配置以下内容： 'as access' =&gt; [ 'class' =&gt; 'mdm\\admin\\components\\AccessControl', 'allowActions' =&gt; [ //'site/*',//允许访问的节点，可自行添加 //'admin/*',//允许所有人访问admin节点及其子节点 \"*\"//不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题 ] ], 添加可分配权限列表在路由列表中，添加book各个节点路由由表添加至右侧可分配路由列表中，如下: 在权限列表=》新增权限，填好后提交，然后填的路由规则即可，如下： 添加角色并分配权限 分配角色手动注册用户，我这里注册admin和test进行测试。其中admin为管理员，test为一般用户 ！！！测试权限之前12345678910！！！ 测试权限之前，把这里注释掉在 backend/config/main.php 中修改配置以下内容： 'as access' =&gt; [ 'class' =&gt; 'mdm\\admin\\components\\AccessControl', 'allowActions' =&gt; [ //'site/*',//允许访问的节点，可自行添加 //'admin/*',//允许所有人访问admin节点及其子节点 //\"*\"//把这个注释掉！！！ ] ], 开始测试12345678910111213141516171819201、以管理员身份登录时，可以进行所有操作。ok2、如果不登录，在访问book首页的时候会跳转到登录页面。预期结果是未登录时能访问book首页，就是说当前系统默认不认可我们配置给未登录用户的权限。有2中办法第一种 在 backend/config/main.php 中加一行指定默认规则的代码即可，如下：'authManager'=&gt; [ 'class' =&gt; 'yii\\rbac\\DbManager', 'defaultRoles' =&gt; ['未登录用户'],//添加此行代码，指定默认规则为 '未登录用户'],或者在 backend/config/main.php 修改为： 'as access' =&gt; [ 'class' =&gt; 'mdm\\admin\\components\\AccessControl', 'allowActions' =&gt; [ //'site/*',//允许访问的节点，可自行添加 //'admin/*',//允许所有人访问admin节点及其子节点 //\"*\"//不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题 \"book/index\",//未登录用户也可以访问图书列表 ] ], …… 安装yii2 AdminLTE后台主题123composer require dmstr/yii2-adminlte-asset \"^2.1\"安装过程中可能需要输入github的token 引入主题123456789101112131415161718192021方式一：(建议使用这种方式)复制整个vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app目录下的layouts目录和site目录到backend/views，覆盖原始文件。方式二：'components' =&gt; [ 'view' =&gt; [ 'theme' =&gt; [ 'pathMap' =&gt; [ '@app/views' =&gt; '@vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app' ], ], ],],现在可以查看后台：&lt;Your domain name&gt;/index.php?r=admin%2Fuser！！！如果访问权限相关的路径，如/admin/route/index并不是上面看到的样式，请将配置文件中的modules数组中配置的layouts的值删掉即可。如下： 'admin' =&gt; [ 'class' =&gt; 'mdm\\admin\\Module', //'layout' =&gt; 'left-menu',//yii2-admin的导航菜单 ] 配置数据库，登录123456789101112131415161718192021222324251、修改common/config/main-local.php数据库配置 'db' =&gt; [ 'class' =&gt; 'yii\\db\\Connection', 'dsn' =&gt; 'mysql:host=localhost;dbname=yii2advanced', 'username' =&gt; 'root', 'password' =&gt; 'root', 'charset' =&gt; 'utf8', ],2、注册后台账户，登录 3、在 common\\config\\main.php 中配置return [ 'language' =&gt; 'zh-CN', //中文显示 'aliases' =&gt; [ '@bower' =&gt; '@vendor/bower-asset', '@npm' =&gt; '@vendor/npm-asset', ], 'vendorPath' =&gt; dirname(dirname(__DIR__)) . '/vendor', 'components' =&gt; [ 'cache' =&gt; [ 'class' =&gt; 'yii\\caching\\FileCache', ], ],]; 配置简短路由123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051在 backend/config/main.php文件的compontents加上下面的配置\"urlManager\" =&gt; [ //用于表明urlManager是否启用URL美化功能，在Yii1.1中称为path格式URL， // Yii2.0中改称美化。 // 默认不启用。但实际使用中，特别是产品环境，一般都会启用。 \"enablePrettyUrl\" =&gt; true, // 是否启用严格解析，如启用严格解析，要求当前请求应至少匹配1个路由规则， // 否则认为是无效路由。 // 这个选项仅在 enablePrettyUrl 启用后才有效。 \"enableStrictParsing\" =&gt; false, // 是否在URL中显示入口脚本。是对美化功能的进一步补充。 \"showScriptName\" =&gt; false, // 指定续接在URL后面的一个后缀，如 .html 之类的。仅在 enablePrettyUrl 启用时有效。 \"suffix\" =&gt; \"\", \"rules\" =&gt; [ \"&lt;controller:\\w+&gt;/&lt;id:\\d+&gt;\"=&gt;\"&lt;controller&gt;/view\", \"&lt;controller:\\w+&gt;/&lt;action:\\w+&gt;\"=&gt;\"&lt;controller&gt;/&lt;action&gt;\" ],],配置web serverApache作为服务器，在应用的目录 backend/web下面创建.htaccess文件并添加如下内容：Options +FollowSymLinksIndexIgnore */*RewriteEngine on# if a directory or a file exists, use it directlyRewriteCond %&#123;REQUEST_FILENAME&#125; !-fRewriteCond %&#123;REQUEST_FILENAME&#125; !-d# otherwise forward it to index.phpRewriteRule . index.phpnginx用户，修改server部分，如下：server &#123; listen 80; server_name yourdomain; root yourdirectory/backend/web; index index.php index.html; charset utf-8; location / &#123; index index.php; if (!-e $request_filename) &#123; rewrite ^(.*)$ /index.php/$1 last; break; &#125; &#125; location ~ .+\\.php($|/) &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi.conf; &#125;&#125; 启动更多分配路由我们先访问路由页面 /admin/route ，尽可能的把左侧的全部选中，然后移动到右侧，并记得给当前用户分配相关的可访问权限。 添加菜单1234567891011121314访问菜单列表 admin/menu 点击添加菜单admin/menu/create按钮。&gt; 如果这个时候你没有权限访问了，需要在配置文件（backend/config/main.php）的 as access数组暂时允许当前用户访问任意权限，并在我们添加完权限的时候去掉as access的设置，切记。 'as access' =&gt; [ 'class' =&gt; 'mdm\\admin\\components\\AccessControl', 'allowActions' =&gt; [ //'site/*',//允许访问的节点，可自行添加 //'admin/*',//允许所有人访问admin节点及其子节点 \"*\"//不配置这个是访问不到gii，使用完记得修改回来，否则权限会出问题 //\"book/index\",//未登录用户也可以访问图书列表 ] ], ？？？？？？？？？父级一直添加不上？？？先手动修改数据库？？？？最后解决这个问题？？？？ 添加界面如下： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364一、例如添加一级菜单\"权限管理\"，按照如下填写：名称：权限管理父级名称：不填路由：/admin/default/index排序：1数据：暂不填写二、添加一个二级菜单\"角色列表\"，如下：名称：角色列表父级名称：权限管理路由：/admin/role/index排序：2数据：暂不填写三、添加一个二级菜单\"权限列表\"，如下：名称：权限列表父级名称：权限管理路由：/admin/permission/index排序：3数据：暂不填写四、添加一个二级菜单\"路由列表\"，如下：名称：路由列表父级名称：权限管理路由：/admin/route/index排序：4数据：暂不填写五、添加一个二级菜单\"规则管理\"，如下：名称：规则管理父级名称：权限管理路由：/admin/rule/index排序：5数据：暂不填写六、添加一个二级菜单\"分配用户到角色\"，如下：名称：分配用户到角色父级名称：权限管理路由：/admin/assignment/index排序：6数据：暂不填写七、添加一个二级菜单\"菜单列表\"，如下：名称：菜单列表父级名称：权限管理路由：/admin/menu/index排序：7数据：暂不填写八、添加一个二级菜单\"用户列表\"，如下：名称：用户列表父级名称：权限管理路由：/admin/user/index排序：8数据：暂不填写九、添加一个二级菜单\"图书列表\"，如下：名称：图书列表父级名称：权限管理路由：/book/index排序：9数据：暂不填写具体如下 左侧菜单展示12345678910111213141516171819202122232425262728293031323334修改&lt;project&gt;/backend/views/layouts/left.php文件（保证这个文件是从&lt;project&gt;/vendor/dmstr/yii2-adminlte-asset/example-views/yiisoft/yii2-app/views/layouts/left.php地方复制过来的，否则去修改源文件），添加如下代码：侧菜单上把权限的栏目加上,代码可直接复制，放置于 &lt;section class=\"sidebar\"&gt;&lt;/section&gt;标签内即可 //第一种显示方式 $callback = function($menu)&#123; return [ 'label' =&gt; $menu['name'], 'url' =&gt; [$menu['route']], 'icon' =&gt; $menu['data'], 'items' =&gt; $menu['children'] ]; &#125;; use mdm\\admin\\components\\MenuHelper; $items = MenuHelper::getAssignedMenu(Yii::$app-&gt;user-&gt;id, null, $callback, true); echo dmstr\\widgets\\Menu::widget([ 'options' =&gt; ['class' =&gt; 'sidebar-menu', 'data-widget'=&gt; 'tree'], 'items' =&gt; $items ]); //第二种显示方式 //use mdm\\admin\\components\\MenuHelper; use yii\\bootstrap\\Nav; echo Nav::widget( [ //\"encodeLabels\" =&gt; false, \"options\" =&gt; [\"class\" =&gt; \"sidebar-menu\", 'data-widget'=&gt; 'tree'], \"items\" =&gt; MenuHelper::getAssignedMenu(Yii::$app-&gt;user-&gt;id), ] ); 整合完毕后存在问题（原因是 yii2-admin 2.0版本）一、菜单小图标并控制菜单显示：我们在创建菜单的时候，没填写的”数据”一栏，我们填写 Font Awesome 从这里面选择图标，例如在品牌图标中 使用这个是 fa fa-android ；我们在 菜单“数据”一栏应该写 android，如图： 二、菜单列表中父级一直添加不上 ，父级名意图提示样式会跑到最左侧，路由意图样式会跑到最左侧（yii2-admin 版本1.0没有此问题） 解决办法： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114一、解决父级添加不上：修改&lt;project&gt;/vendor/mdmsoft/yii2-admin/models/Menu.php中原来： public function rules() &#123; return [ [['name'], 'required'], [['parent_name'], 'in', 'range' =&gt; static::find()-&gt;select(['name'])-&gt;column(), 'message' =&gt; 'Menu \"&#123;value&#125;\" not found.'], [['parent', 'route', 'data', 'order'], 'default'], [['parent'], 'filterParent', 'when' =&gt; function() &#123; return !$this-&gt;isNewRecord; &#125;], [['order'], 'integer'], [['route'], 'in', 'range' =&gt; static::getSavedRoutes(), 'message' =&gt; 'Route \"&#123;value&#125;\" not found.'] ]; &#125; 修改后： public function rules() &#123; return [ [['name'], 'required'], [['parent_name'], 'in', 'range' =&gt; static::find()-&gt;select(['name'])-&gt;column(), 'message' =&gt; 'Menu \"&#123;value&#125;\" not found.'], [['parent', 'route', 'data', 'order'], 'default'], /*[['parent'], 'filterParent', 'when' =&gt; function() &#123; return !$this-&gt;isNewRecord; &#125;],*/ [['parent_name'], 'filterParent'],//修改此方法 [['order'], 'integer'], [['route'], 'in', 'range' =&gt; static::getSavedRoutes(), 'message' =&gt; 'Route \"&#123;value&#125;\" not found.'] ]; &#125; 原来： public function filterParent() &#123; $parent = $this-&gt;parent; $db = static::getDb(); $query = (new Query)-&gt;select(['parent']) -&gt;from(static::tableName()) -&gt;where('[[id]]=:id'); while ($parent) &#123; if ($this-&gt;id == $parent) &#123; $this-&gt;addError('parent_name', 'Loop detected.'); return; &#125; $parent = $query-&gt;params([':id' =&gt; $parent])-&gt;scalar($db); &#125; &#125; 修改后： public function filterParent() &#123; //修改此方法 $value = $this-&gt;parent_name; $parent = self::findOne(['name' =&gt; $value]); if ($parent) &#123; $id = $this-&gt;id; $parent_id = $parent-&gt;id; while ($parent) &#123; if ($parent-&gt;id == $id) &#123; $this-&gt;addError('parent_name', 'Loop detected.'); return; &#125; $parent = $parent-&gt;menuParent; &#125; $this-&gt;parent = $parent_id; &#125; &#125; 二、解决意图提示样式下载 yiisoft/yii2-juiphp composer.phar require --prefer-dist yiisoft/yii2-jui现在已经可以上试试效果，完全没有问题，如果不想用form中原来的书写方式可以按下面的办法；修改 &lt;project&gt;/vendor/mdmsoft/yii2-admin/views/menu/_form.php中parent_name和route表单：修改之前： &lt;?= $form-&gt;field($model, 'parent_name')-&gt;textInput(['id' =&gt; 'parent_name']) ?&gt; &lt;?= $form-&gt;field($model, 'route')-&gt;textInput(['id' =&gt; 'route']) ?&gt;修改之后： &lt;?= $form-&gt;field($model, 'parent_name')-&gt;widget('yii\\jui\\AutoComplete',[ 'options'=&gt;['class'=&gt;'form-control'], 'clientOptions'=&gt;[ 'source'=&gt; Menu::find()-&gt;select(['name'])-&gt;column() ] ]) ?&gt; &lt;?= $form-&gt;field($model, 'route')-&gt;widget('yii\\jui\\AutoComplete',[ 'options'=&gt;['class'=&gt;'form-control'], 'clientOptions'=&gt;[ 'source'=&gt; Menu::getSavedRoutes() ] ]) ?&gt;三、在 &lt;project&gt;/vendor/mdmsoft/yii2-admin/views/role/_form.php 同样会有样式问题，按照二的步骤修改即可 使用到的时候再改就可以。 修改后的： &lt;?= $form-&gt;field($model, 'ruleName')-&gt;widget('yii\\jui\\AutoComplete', [ 'options' =&gt; [ 'class' =&gt; 'form-control', ], 'clientOptions' =&gt; [ 'source' =&gt; array_keys(Yii::$app-&gt;authManager-&gt;getRules()), ] ]) ?&gt;","tags":[]},{"title":"hexo常用命令笔记","date":"2017-11-30T03:37:25.596Z","path":"2017/11/30/hexo/hexo常用命令笔记/","text":"hexo123npm install hexo -g #安装 npm update hexo -g #升级 hexo init #初始化 简写12345hexo n \"我的博客\" == hexo new \"我的博客\" #新建文章hexo p == hexo publishhexo g == hexo generate#生成hexo s == hexo server #启动服务预览hexo d == hexo deploy#部署 服务器1234567hexo server #Hexo 会监视文件变动并自动更新，您无须重启服务器。hexo server -s #静态模式hexo server -p 5000 #更改端口hexo server -i 192.168.1.1 #自定义 IPhexo clean #清除缓存 网页正常情况下可以忽略此条命令hexo g #生成静态网页hexo d #开始部署 监视文件变动123456789hexo generate #使用 Hexo 生成静态文件快速而且简单hexo generate --watch #监视文件变动完成后部署两个命令的作用是相同的hexo generate --deployhexo deploy --generatehexo deploy -ghexo server -g 草稿1hexo publish [layout] &lt;title&gt; 模版123456789hexo new \"postName\" #新建文章hexo new page \"pageName\" #新建页面hexo generate #生成静态页面至public目录hexo server #开启预览访问端口（默认端口4000，'ctrl + c'关闭server）hexo deploy #将.deploy目录部署到GitHubhexo new [layout] &lt;title&gt;hexo new photo \"My Gallery\"hexo new \"Hello World\" --lang tw 变量 描述 layout 布局 title 标题 date 建立 12345678910title: 使用Hexo搭建个人博客layout: postdate: 2014-03-03 19:07:43comments: truecategories: Blogtags: [Hexo]keywords: Hexo, Blogdescription: 暮色匆匆去，音消尘也无模版（Scaffold）hexo new photo \"My Gallery\" 设置文章摘要以上是文章摘要 以下是余下全文 写作12hexo new page &lt;title&gt;hexo new post &lt;title&gt; 变量 描述 :title 标题 :year 建立的年份（4 位数） :month 建立的月份（2 位数） :i_month 建立的月份（去掉开头的零） :day 建立的日期（2 位数） :i_day 建立的日期（去掉开头的零） 推送到服务器上123hexo n #写文章hexo g #生成hexo d #部署 #可与hexo g合并为 hexo d -g 报错1.找不到git部署 1ERROR Deployer not found: git 解决方法 1npm install hexo-deployer-git --save 3.部署类型设置githexo 3.0 部署类型不再是github，_config.yml 中修改 123456# Deployment## Docs: http://hexo.io/docs/deployment.htmldeploy: type: git repository: git@***.github.com:***/***.github.io.git branch: master xcodebuild 123xcode-select: error: tool 'xcodebuild' requires Xcode, but active developer directory '/Library/Developer/CommandLineTools' is a command line tools instancenpm install bcrypt RSS不显示安装RSS插件 1npm install hexo-generator-feed --save 开启RSS功能编辑hexo/_config.yml，添加如下代码： 1rss: /atom.xml #rss地址 默认即可 开启评论1.我使用多说代替自带的评论，在多说 网站注册 &gt; 后台管理 &gt; 添加新站点 &gt; 工具 === 复制通用代码 里面有 short_name 1 在根目录 _config.yml 添加一行 disqus_shortname: jslite 是在多说注册时产生的复制到 themes\\landscape\\layout\\_partial\\article.ejs2 把 1234567&lt;% if (!index &amp;&amp; post.comments &amp;&amp; config.disqus_shortname)&#123; %&gt;&lt;section id=\"comments\"&gt;&lt;div id=\"disqus_thread\"&gt; &lt;noscript&gt;Please enable JavaScript to view the &lt;a href=\"//disqus.com/?ref_noscript\"&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;&lt;/div&gt;&lt;/section&gt;&lt;% &#125; %&gt; 改为 1234567891011121314151617181920&lt;% if (!index &amp;&amp; post.comments &amp;&amp; config.disqus_shortname)&#123; %&gt; &lt;section id=\"comments\"&gt; &lt;!-- 多说评论框 start --&gt; &lt;div class=\"ds-thread\" data-thread-key=\"&lt;%= post.layout %&gt;-&lt;%= post.slug %&gt;\" data-title=\"&lt;%= post.title %&gt;\" data-url=\"&lt;%= page.permalink %&gt;\"&gt;&lt;/div&gt; &lt;!-- 多说评论框 end --&gt; &lt;!-- 多说公共JS代码 start (一个网页只需插入一次) --&gt; &lt;script type=\"text/javascript\"&gt; var duoshuoQuery = &#123;short_name:'&lt;%= config.disqus_shortname %&gt;'&#125;; (function() &#123; var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); &#125;)(); &lt;/script&gt; &lt;!-- 多说公共JS代码 end --&gt; &lt;/section&gt;&lt;% &#125; %&gt; hexo-git-backup12345678910111213141516安装备份插件参考网址： https://github.com/coneycode/hexo-git-backupUpdateif you install with --save, you must remove firstly when you update it.$ npm remove hexo-git-backup$ npm install hexo-git-backup --save--------------------------------------安装主题参考网址： https://github.com/chaooo/hexo-theme-BlueLakegit clone https://github.com/chaooo/hexo-theme-BlueLake.git themes/BlueLake-------------------------------------生成、部署hexo ghexo dhexo bhexo server -p 5000 【本地查看】 hexo12","tags":[]},{"title":"Hello World","date":"2017-11-30T02:44:53.743Z","path":"2017/11/30/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","tags":[]}]